BEGIN;
\i test/setup.sql
-- While the datestyle is set for the database, the pg_regress tool sets the MDY format
-- to ensure consistent date formatting, so we must manually override this
SET datestyle TO 'ISO, DMY';
\if :{?DEBUG}
SET client_min_messages TO debug1;
\else
SET client_min_messages TO NOTICE;
\endif
-- Create temporary function to execute queries as system user
CREATE OR REPLACE FUNCTION test.sudo_exec(
    sql text,
    OUT results jsonb
) RETURNS jsonb
SECURITY DEFINER LANGUAGE plpgsql AS $sudo_exec$
DECLARE
    result_rows jsonb;
BEGIN
    -- Check if the SQL starts with common DDL keywords
    IF sql ~* '^\s*(CREATE|DROP|ALTER|TRUNCATE|GRANT|REVOKE|ANALYZE)' THEN
        -- For DDL statements, execute directly
        EXECUTE sql;
        results := '[]'::jsonb;
    ELSE
        -- For DML/queries, wrap in a SELECT to capture results
        EXECUTE format('
            SELECT COALESCE(
                jsonb_agg(row_to_json(t)),
                ''[]''::jsonb
            )
            FROM (%s) t',
            sql
        ) INTO result_rows;
        results := result_rows;
    END IF;
END;
$sudo_exec$;
-- Grant execute to public since this is for testing
GRANT EXECUTE ON FUNCTION test.sudo_exec(text) TO PUBLIC;
\echo Add users for testing purposes
Add users for testing purposes
SELECT * FROM public.user_create(p_display_name => 'Test Admin', p_email => 'test.admin@statbus.org', p_statbus_role => 'admin_user'::statbus_role, p_password => 'Admin#123!');
         email          |  password  
------------------------+------------
 test.admin@statbus.org | Admin#123!
(1 row)

SELECT * FROM public.user_create(p_display_name => 'Test Regular', p_email => 'test.regular@statbus.org', p_statbus_role => 'regular_user'::statbus_role, p_password => 'Regular#123!');
          email           |   password   
--------------------------+--------------
 test.regular@statbus.org | Regular#123!
(1 row)

SELECT * FROM public.user_create(p_display_name => 'Test Restricted', p_email => 'test.restricted@statbus.org', p_statbus_role => 'restricted_user'::statbus_role, p_password => 'Restricted#123!');
            email            |    password     
-----------------------------+-----------------
 test.restricted@statbus.org | Restricted#123!
(1 row)

CREATE OR REPLACE PROCEDURE test.remove_pg_temp_for_tx_user_switch(p_keep_tables text[] DEFAULT '{}')
LANGUAGE plpgsql
AS $remove_pg_temp_for_tx_user_switch$
DECLARE
    rec record;
    v_found_count integer := 0;
BEGIN
    RAISE DEBUG 'Running test.remove_pg_temp_for_tx_user_switch(p_keep_tables => %)...', p_keep_tables;
    -- Remove temporary cache tables used by import, as we switch user inside the *same* transaction,
    -- and the new user can not modify tables owned by the previous import.
    -- This generic loop cleans up all tables and views in the pg_temp schema, except those specified to keep.
    FOR rec IN
        SELECT
            c.relname,
            c.relkind
        FROM pg_catalog.pg_class AS c
        LEFT JOIN pg_catalog.pg_namespace AS n ON n.oid = c.relnamespace
        WHERE c.relkind IN ('r', 'p', 'v', 'm') AND n.oid = pg_my_temp_schema() -- r=table, p=partitioned, v=view, m=materialized
          AND c.relname <> ALL(p_keep_tables)
    LOOP
        v_found_count := v_found_count + 1;
        IF rec.relkind IN ('r', 'p', 'm') THEN
            RAISE DEBUG '  -> Dropping temp TABLE %', rec.relname;
            EXECUTE format('DROP TABLE IF EXISTS pg_temp.%I CASCADE', rec.relname);
        ELSIF rec.relkind = 'v' THEN
            RAISE DEBUG '  -> Dropping temp VIEW %', rec.relname;
            EXECUTE format('DROP VIEW IF EXISTS pg_temp.%I CASCADE', rec.relname);
        END IF;
    END LOOP;

    RAISE DEBUG '...finished test.remove_pg_temp_for_tx_user_switch(). Found and dropped % objects.', v_found_count;

    -- This procedure is part of the sql_saga extension and has its own cleanup logic.
    -- While the loop above handles tables/views, this call ensures any other temporary
    -- objects it creates are also cleaned up.
    CALL sql_saga.temporal_merge_drop_temp_tables();
END;
$remove_pg_temp_for_tx_user_switch$;
\echo "Setting up Statbus to load establishments without legal units"
"Setting up Statbus to load establishments without legal units"
-- A Super User configures statbus.
CALL test.set_user_from_email('test.admin@statbus.org');
\i samples/norway/getting-started.sql
\i samples/norway/settings.sql
INSERT INTO settings(activity_category_standard_id,country_id)
SELECT (SELECT id FROM activity_category_standard WHERE code = 'nace_v2.1')
     , (SELECT id FROM public.country WHERE iso_2 = 'NO')
ON CONFLICT (only_one_setting)
DO UPDATE SET
   activity_category_standard_id = EXCLUDED.activity_category_standard_id,
   country_id = EXCLUDED.country_id
   WHERE settings.only_one_setting = EXCLUDED.only_one_setting;
;
\i samples/norway/activity_category/activity_category_norway.sql
\copy public.activity_category_available_custom FROM 'samples/norway/activity_category/activity_category_norway.csv' WITH (FORMAT csv, DELIMITER ',', QUOTE '"', HEADER true);
\i samples/norway/regions/norway-regions-2024.sql
\copy public.region_upload(path, name) FROM 'samples/norway/regions/norway-regions-2024.csv' WITH (FORMAT csv, DELIMITER ',', QUOTE '"', HEADER true);
\i samples/norway/sector/sector_norway.sql
\copy public.sector_custom_only FROM 'samples/norway/sector/sector_norway.csv' WITH (FORMAT csv, DELIMITER ',', QUOTE '"', HEADER true);
\i samples/norway/legal_form/legal_form_norway.sql
\copy public.legal_form_custom_only FROM 'samples/norway/legal_form/legal_form_norway.csv' WITH (FORMAT csv, DELIMITER ',', QUOTE '"', HEADER true);
\i samples/norway/data_source/data_source_norway.sql
\copy public.data_source_custom (code, name) FROM 'samples/norway/data_source/data_source_norway.csv' WITH (FORMAT csv, DELIMITER ',', QUOTE '"', HEADER true);
SELECT acs.code
  FROM public.settings AS s
  JOIN activity_category_standard AS acs
    ON s.activity_category_standard_id = acs.id;
   code    
-----------
 nace_v2.1
(1 row)

SELECT count(*) FROM public.activity_category_available;
 count 
-------
  2215
(1 row)

SELECT count(*) FROM public.region;
 count 
-------
   417
(1 row)

SELECT count(*) FROM public.legal_form_available;
 count 
-------
    46
(1 row)

SELECT count(*) FROM public.sector_available;
 count 
-------
    33
(1 row)

-- SAVEPOINT before_loading_units; -- Removed to simplify transaction handling, aligning with other tests.
SELECT
    (SELECT COUNT(DISTINCT id) AS distinct_unit_count FROM public.establishment) AS establishment_count,
    (SELECT COUNT(DISTINCT id) AS distinct_unit_count FROM public.legal_unit) AS legal_unit_count,
    (SELECT COUNT(DISTINCT id) AS distinct_unit_count FROM public.enterprise) AS enterprise_count;
 establishment_count | legal_unit_count | enterprise_count 
---------------------+------------------+------------------
                   0 |                0 |                0
(1 row)

-- Create Import Job for Legal Units (Era)
INSERT INTO public.import_job (definition_id, slug, description, note, edit_comment)
SELECT
    (SELECT id FROM public.import_definition WHERE slug = 'legal_unit_source_dates'),
    'import_03_lu_era',
    'Import Legal Units Era (03_load_and_verify_history_functions.sql)',
    'Import job for legal units from test/data/03_norwegian-legal-units-over-time.csv using legal_unit_source_dates definition.',
    'Test data load (03_load_and_verify_history_functions.sql)';
\echo "User uploads the legal units over time (via import job: import_03_lu_era)"
"User uploads the legal units over time (via import job: import_03_lu_era)"
\copy public.import_03_lu_era_upload(valid_from,valid_to,tax_ident,name,birth_date,death_date,physical_address_part1,physical_postcode,physical_postplace,physical_region_code,physical_country_iso_2,postal_address_part1,postal_postcode,postal_postplace,postal_region_code,postal_country_iso_2,primary_activity_category_code,secondary_activity_category_code,sector_code,legal_form_code,data_source_code) FROM 'test/data/03_norwegian-legal-units-over-time.csv' WITH (FORMAT csv, DELIMITER ',', QUOTE '"', HEADER true);
\echo Run worker processing for legal units
Run worker processing for legal units
--SET client_min_messages TO DEBUG1;
CALL worker.process_tasks(p_queue => 'import');
--SET client_min_messages TO NOTICE;
SELECT queue, state, count(*) FROM worker.tasks AS t JOIN worker.command_registry AS c ON t.command = c.command WHERE c.queue != 'maintenance' GROUP BY queue,state ORDER BY queue,state;
   queue   |   state   | count 
-----------+-----------+-------
 analytics | pending   |     5
 import    | completed |    47
(2 rows)

-- Create Import Job for Establishments (Era for LU)
INSERT INTO public.import_job (definition_id, slug, description, note, edit_comment)
SELECT
    (SELECT id FROM public.import_definition WHERE slug = 'establishment_for_lu_source_dates'),
    'import_03_esflu_era',
    'Import Establishments Era for LU (03_load_and_verify_history_functions.sql)',
    'Import job for establishments from test/data/03_norwegian-establishments-over-time.csv using establishment_for_lu_source_dates definition.',
    'Test data load (03_load_and_verify_history_functions.sql)';
\echo "User uploads the establishments over time (via import job: import_03_esflu_era)"
"User uploads the establishments over time (via import job: import_03_esflu_era)"
\copy public.import_03_esflu_era_upload(valid_from, valid_to, tax_ident,legal_unit_tax_ident,name,birth_date,death_date,physical_address_part1,physical_postcode,physical_postplace,physical_region_code,physical_country_iso_2,postal_address_part1,postal_postcode,postal_postplace,postal_region_code,postal_country_iso_2,primary_activity_category_code,secondary_activity_category_code,data_source_code,unit_size_code,employees,turnover) FROM 'test/data/03_norwegian-establishments-over-time.csv' WITH (FORMAT csv, DELIMITER ',', QUOTE '"', HEADER true);
\echo Run worker processing for establishments
Run worker processing for establishments
--SET client_min_messages TO DEBUG1;
CALL worker.process_tasks(p_queue => 'import');
--SET client_min_messages TO NOTICE;
SELECT queue, state, count(*) FROM worker.tasks AS t JOIN worker.command_registry AS c ON t.command = c.command WHERE c.queue != 'maintenance' GROUP BY queue,state ORDER BY queue,state;
   queue   |   state   | count 
-----------+-----------+-------
 analytics | pending   |     7
 import    | completed |    94
(2 rows)

\echo "Checking unit counts after import processing"
"Checking unit counts after import processing"
SELECT
    (SELECT COUNT(DISTINCT id) AS distinct_unit_count FROM public.establishment) AS establishment_count,
    (SELECT COUNT(DISTINCT id) AS distinct_unit_count FROM public.legal_unit) AS legal_unit_count,
    (SELECT COUNT(DISTINCT id) AS distinct_unit_count FROM public.enterprise) AS enterprise_count;
 establishment_count | legal_unit_count | enterprise_count 
---------------------+------------------+------------------
                   1 |                2 |                2
(1 row)

\echo "Test get_statistical_history_periods with specific date range - yearly resolution"
"Test get_statistical_history_periods with specific date range - yearly resolution"
SELECT
    resolution,
    year,
    month,
    prev_stop,
    curr_start,
    curr_stop
FROM public.get_statistical_history_periods(
    p_resolution := 'year'::public.history_resolution,
    p_valid_from := '2018-01-01'::DATE,
    p_valid_until := '2021-01-01'::DATE
)
ORDER BY year;
 resolution | year | month | prev_stop  | curr_start | curr_stop  
------------+------+-------+------------+------------+------------
 year       | 2018 |       | 2017-12-31 | 2018-01-01 | 2018-12-31
 year       | 2019 |       | 2018-12-31 | 2019-01-01 | 2019-12-31
 year       | 2020 |       | 2019-12-31 | 2020-01-01 | 2020-12-31
(3 rows)

\echo "Test get_statistical_history_periods with NULL parameters (should use bounded range)"
"Test get_statistical_history_periods with NULL parameters (should use bounded range)"
SELECT
    resolution,
    year,
    month,
    prev_stop,
    curr_start,
    curr_stop
FROM public.get_statistical_history_periods(
    p_resolution := 'year'::public.history_resolution
)
WHERE year BETWEEN EXTRACT(YEAR FROM current_date - interval '5 years')::int
              AND EXTRACT(YEAR FROM current_date)::int
ORDER BY year;
 resolution | year | month | prev_stop  | curr_start | curr_stop  
------------+------+-------+------------+------------+------------
 year       | 2020 |       | 2019-12-31 | 2020-01-01 | 2020-12-31
 year       | 2021 |       | 2020-12-31 | 2021-01-01 | 2021-12-31
 year       | 2022 |       | 2021-12-31 | 2022-01-01 | 2022-12-31
 year       | 2023 |       | 2022-12-31 | 2023-01-01 | 2023-12-31
 year       | 2024 |       | 2023-12-31 | 2024-01-01 | 2024-12-31
 year       | 2025 |       | 2024-12-31 | 2025-01-01 | 2025-12-31
(6 rows)

\echo "Test get_statistical_history_periods with empty table simulation"
"Test get_statistical_history_periods with empty table simulation"
-- Test with specific date range, which will use default values since table is empty at this point
SELECT
    resolution,
    year,
    month,
    prev_stop,
    curr_start,
    curr_stop
FROM public.get_statistical_history_periods(
    p_resolution := 'year'::public.history_resolution,
    p_valid_from := '2020-01-01'::DATE,
    p_valid_until := '2023-01-01'::DATE
)
WHERE year BETWEEN 2020 AND 2022
ORDER BY year;
 resolution | year | month | prev_stop  | curr_start | curr_stop  
------------+------+-------+------------+------------+------------
 year       | 2020 |       | 2019-12-31 | 2020-01-01 | 2020-12-31
 year       | 2021 |       | 2020-12-31 | 2021-01-01 | 2021-12-31
 year       | 2022 |       | 2021-12-31 | 2022-01-01 | 2022-12-31
(3 rows)

\echo "Test get_statistical_history_periods with specific date range - monthly resolution"
"Test get_statistical_history_periods with specific date range - monthly resolution"
SELECT
    resolution,
    year,
    month,
    prev_stop,
    curr_start,
    curr_stop
FROM public.get_statistical_history_periods(
    p_resolution := 'year-month'::public.history_resolution,
    p_valid_from := '2019-06-01'::DATE,
    p_valid_until := '2020-01-01'::DATE
)
ORDER BY year, month;
 resolution | year | month | prev_stop  | curr_start | curr_stop  
------------+------+-------+------------+------------+------------
 year-month | 2019 |     6 | 2019-05-31 | 2019-06-01 | 2019-06-30
 year-month | 2019 |     7 | 2019-06-30 | 2019-07-01 | 2019-07-31
 year-month | 2019 |     8 | 2019-07-31 | 2019-08-01 | 2019-08-31
 year-month | 2019 |     9 | 2019-08-31 | 2019-09-01 | 2019-09-30
 year-month | 2019 |    10 | 2019-09-30 | 2019-10-01 | 2019-10-31
 year-month | 2019 |    11 | 2019-10-31 | 2019-11-01 | 2019-11-30
 year-month | 2019 |    12 | 2019-11-30 | 2019-12-01 | 2019-12-31
(7 rows)

\echo Run worker processing for analytics tasks
Run worker processing for analytics tasks
CALL worker.process_tasks(p_queue => 'analytics');
SELECT queue, state, count(*) FROM worker.tasks AS t JOIN worker.command_registry AS c ON t.command = c.command WHERE c.queue != 'maintenance' GROUP BY queue,state ORDER BY queue,state;
   queue   |   state   | count 
-----------+-----------+-------
 analytics | completed |     9
 import    | completed |    94
(2 rows)

\echo "Inspecting import job data for import_03_lu_era (showing error rows first)"
"Inspecting import job data for import_03_lu_era (showing error rows first)"
(SELECT row_id, state, errors, tax_ident_raw, name_raw, valid_from_raw, valid_to_raw, merge_status
FROM public.import_03_lu_era_data
WHERE state = 'error'
ORDER BY row_id)
UNION ALL
(SELECT row_id, state, errors, tax_ident_raw, name_raw, valid_from_raw, valid_to_raw, merge_status
FROM public.import_03_lu_era_data
WHERE state != 'error'
ORDER BY row_id
LIMIT 5);
 row_id |   state   | errors | tax_ident_raw |       name_raw        | valid_from_raw | valid_to_raw |                                       merge_status                                       
--------+-----------+--------+---------------+-----------------------+----------------+--------------+------------------------------------------------------------------------------------------
      1 | processed | {}     | 823573673     | KRANLØFT ENK          | 2010-01-01     | 2012-12-31   | {"legal_unit": "APPLIED", "primary_activity": "APPLIED", "physical_location": "APPLIED"}
      2 | processed | {}     | 921835809     | KRAN & SPESIALLØFT AS | 2013-01-01     | infinity     | {"legal_unit": "APPLIED", "primary_activity": "APPLIED", "physical_location": "APPLIED"}
(2 rows)

\echo "Checking import job status for import_03_lu_era"
"Checking import job status for import_03_lu_era"
SELECT slug, state, total_rows, imported_rows, error IS NOT NULL AS has_error,
       (SELECT COUNT(*) FROM public.import_03_lu_era_data dr WHERE dr.state = 'error') AS error_rows,
       error
FROM public.import_job
WHERE slug = 'import_03_lu_era'
ORDER BY slug;
       slug       |  state   | total_rows | imported_rows | has_error | error_rows | error 
------------------+----------+------------+---------------+-----------+------------+-------
 import_03_lu_era | finished |          2 |             2 | f         |          0 | 
(1 row)

\echo "Inspecting import job data for import_03_esflu_era (showing error rows first)"
"Inspecting import job data for import_03_esflu_era (showing error rows first)"
(SELECT row_id, state, errors, tax_ident_raw, legal_unit_tax_ident_raw, name_raw, valid_from_raw, valid_to_raw, merge_status
FROM public.import_03_esflu_era_data
WHERE state = 'error'
ORDER BY row_id)
UNION ALL
(SELECT row_id, state, errors, tax_ident_raw, legal_unit_tax_ident_raw, name_raw, valid_from_raw, valid_to_raw, merge_status
FROM public.import_03_esflu_era_data
WHERE state != 'error'
ORDER BY row_id
LIMIT 5);
 row_id |   state   | errors | tax_ident_raw | legal_unit_tax_ident_raw |       name_raw        | valid_from_raw | valid_to_raw |                                                                     merge_status                                                                     
--------+-----------+--------+---------------+--------------------------+-----------------------+----------------+--------------+------------------------------------------------------------------------------------------------------------------------------------------------------
      1 | processed | {}     | 895406732     | 823573673                | KRANLØFT ENK          | 2010-01-01     | 2012-12-31   | {"establishment": "APPLIED", "stat_turnover": "APPLIED", "stat_employees": "APPLIED", "primary_activity": "APPLIED", "physical_location": "APPLIED"}
      2 | processed | {}     | 895406732     | 921835809                | KRAN & SPESIALLØFT AS | 2013-01-01     | 2015-12-31   | {"establishment": "APPLIED", "stat_turnover": "APPLIED", "stat_employees": "APPLIED", "primary_activity": "APPLIED", "physical_location": "APPLIED"}
      3 | processed | {}     | 895406732     | 921835809                | KRAN & SPESIALLØFT AS | 2016-01-01     | 2018-12-31   | {"establishment": "APPLIED", "stat_turnover": "APPLIED", "stat_employees": "APPLIED", "primary_activity": "APPLIED", "physical_location": "APPLIED"}
      4 | processed | {}     | 895406732     | 921835809                | KRAN & SPESIALLØFT AS | 2019-01-01     | 2019-02-28   | {"establishment": "APPLIED", "stat_turnover": "APPLIED", "stat_employees": "APPLIED", "primary_activity": "APPLIED", "physical_location": "APPLIED"}
      5 | processed | {}     | 895406732     | 921835809                | KRAN & SPESIALLØFT AS | 2019-03-01     | 2019-04-30   | {"establishment": "APPLIED", "stat_turnover": "APPLIED", "stat_employees": "APPLIED", "primary_activity": "APPLIED", "physical_location": "APPLIED"}
(5 rows)

\echo "Checking import job status for import_03_esflu_era"
"Checking import job status for import_03_esflu_era"
SELECT slug, state, total_rows, imported_rows, error IS NOT NULL AS has_error,
       (SELECT COUNT(*) FROM public.import_03_esflu_era_data dr WHERE dr.state = 'error') AS error_rows,
       error
FROM public.import_job
WHERE slug = 'import_03_esflu_era'
ORDER BY slug;
        slug         |  state   | total_rows | imported_rows | has_error | error_rows | error 
---------------------+----------+------------+---------------+-----------+------------+-------
 import_03_esflu_era | finished |         10 |            10 | f         |          0 | 
(1 row)

\echo "Checking statistical_history_periods from statistical_unit data"
"Checking statistical_history_periods from statistical_unit data"
SELECT * FROM public.get_statistical_history_periods()
-- Only list previous years, so the test is stable over time.
WHERE year <= 2023;
 resolution | year | month | prev_stop  | curr_start | curr_stop  
------------+------+-------+------------+------------+------------
 year       | 2010 |       | 2009-12-31 | 2010-01-01 | 2010-12-31
 year       | 2011 |       | 2010-12-31 | 2011-01-01 | 2011-12-31
 year       | 2012 |       | 2011-12-31 | 2012-01-01 | 2012-12-31
 year       | 2013 |       | 2012-12-31 | 2013-01-01 | 2013-12-31
 year       | 2014 |       | 2013-12-31 | 2014-01-01 | 2014-12-31
 year       | 2015 |       | 2014-12-31 | 2015-01-01 | 2015-12-31
 year       | 2016 |       | 2015-12-31 | 2016-01-01 | 2016-12-31
 year       | 2017 |       | 2016-12-31 | 2017-01-01 | 2017-12-31
 year       | 2018 |       | 2017-12-31 | 2018-01-01 | 2018-12-31
 year       | 2019 |       | 2018-12-31 | 2019-01-01 | 2019-12-31
 year       | 2020 |       | 2019-12-31 | 2020-01-01 | 2020-12-31
 year       | 2021 |       | 2020-12-31 | 2021-01-01 | 2021-12-31
 year       | 2022 |       | 2021-12-31 | 2022-01-01 | 2022-12-31
 year       | 2023 |       | 2022-12-31 | 2023-01-01 | 2023-12-31
 year-month | 2010 |     1 | 2009-12-31 | 2010-01-01 | 2010-01-31
 year-month | 2010 |     2 | 2010-01-31 | 2010-02-01 | 2010-02-28
 year-month | 2010 |     3 | 2010-02-28 | 2010-03-01 | 2010-03-31
 year-month | 2010 |     4 | 2010-03-31 | 2010-04-01 | 2010-04-30
 year-month | 2010 |     5 | 2010-04-30 | 2010-05-01 | 2010-05-31
 year-month | 2010 |     6 | 2010-05-31 | 2010-06-01 | 2010-06-30
 year-month | 2010 |     7 | 2010-06-30 | 2010-07-01 | 2010-07-31
 year-month | 2010 |     8 | 2010-07-31 | 2010-08-01 | 2010-08-31
 year-month | 2010 |     9 | 2010-08-31 | 2010-09-01 | 2010-09-30
 year-month | 2010 |    10 | 2010-09-30 | 2010-10-01 | 2010-10-31
 year-month | 2010 |    11 | 2010-10-31 | 2010-11-01 | 2010-11-30
 year-month | 2010 |    12 | 2010-11-30 | 2010-12-01 | 2010-12-31
 year-month | 2011 |     1 | 2010-12-31 | 2011-01-01 | 2011-01-31
 year-month | 2011 |     2 | 2011-01-31 | 2011-02-01 | 2011-02-28
 year-month | 2011 |     3 | 2011-02-28 | 2011-03-01 | 2011-03-31
 year-month | 2011 |     4 | 2011-03-31 | 2011-04-01 | 2011-04-30
 year-month | 2011 |     5 | 2011-04-30 | 2011-05-01 | 2011-05-31
 year-month | 2011 |     6 | 2011-05-31 | 2011-06-01 | 2011-06-30
 year-month | 2011 |     7 | 2011-06-30 | 2011-07-01 | 2011-07-31
 year-month | 2011 |     8 | 2011-07-31 | 2011-08-01 | 2011-08-31
 year-month | 2011 |     9 | 2011-08-31 | 2011-09-01 | 2011-09-30
 year-month | 2011 |    10 | 2011-09-30 | 2011-10-01 | 2011-10-31
 year-month | 2011 |    11 | 2011-10-31 | 2011-11-01 | 2011-11-30
 year-month | 2011 |    12 | 2011-11-30 | 2011-12-01 | 2011-12-31
 year-month | 2012 |     1 | 2011-12-31 | 2012-01-01 | 2012-01-31
 year-month | 2012 |     2 | 2012-01-31 | 2012-02-01 | 2012-02-29
 year-month | 2012 |     3 | 2012-02-29 | 2012-03-01 | 2012-03-31
 year-month | 2012 |     4 | 2012-03-31 | 2012-04-01 | 2012-04-30
 year-month | 2012 |     5 | 2012-04-30 | 2012-05-01 | 2012-05-31
 year-month | 2012 |     6 | 2012-05-31 | 2012-06-01 | 2012-06-30
 year-month | 2012 |     7 | 2012-06-30 | 2012-07-01 | 2012-07-31
 year-month | 2012 |     8 | 2012-07-31 | 2012-08-01 | 2012-08-31
 year-month | 2012 |     9 | 2012-08-31 | 2012-09-01 | 2012-09-30
 year-month | 2012 |    10 | 2012-09-30 | 2012-10-01 | 2012-10-31
 year-month | 2012 |    11 | 2012-10-31 | 2012-11-01 | 2012-11-30
 year-month | 2012 |    12 | 2012-11-30 | 2012-12-01 | 2012-12-31
 year-month | 2013 |     1 | 2012-12-31 | 2013-01-01 | 2013-01-31
 year-month | 2013 |     2 | 2013-01-31 | 2013-02-01 | 2013-02-28
 year-month | 2013 |     3 | 2013-02-28 | 2013-03-01 | 2013-03-31
 year-month | 2013 |     4 | 2013-03-31 | 2013-04-01 | 2013-04-30
 year-month | 2013 |     5 | 2013-04-30 | 2013-05-01 | 2013-05-31
 year-month | 2013 |     6 | 2013-05-31 | 2013-06-01 | 2013-06-30
 year-month | 2013 |     7 | 2013-06-30 | 2013-07-01 | 2013-07-31
 year-month | 2013 |     8 | 2013-07-31 | 2013-08-01 | 2013-08-31
 year-month | 2013 |     9 | 2013-08-31 | 2013-09-01 | 2013-09-30
 year-month | 2013 |    10 | 2013-09-30 | 2013-10-01 | 2013-10-31
 year-month | 2013 |    11 | 2013-10-31 | 2013-11-01 | 2013-11-30
 year-month | 2013 |    12 | 2013-11-30 | 2013-12-01 | 2013-12-31
 year-month | 2014 |     1 | 2013-12-31 | 2014-01-01 | 2014-01-31
 year-month | 2014 |     2 | 2014-01-31 | 2014-02-01 | 2014-02-28
 year-month | 2014 |     3 | 2014-02-28 | 2014-03-01 | 2014-03-31
 year-month | 2014 |     4 | 2014-03-31 | 2014-04-01 | 2014-04-30
 year-month | 2014 |     5 | 2014-04-30 | 2014-05-01 | 2014-05-31
 year-month | 2014 |     6 | 2014-05-31 | 2014-06-01 | 2014-06-30
 year-month | 2014 |     7 | 2014-06-30 | 2014-07-01 | 2014-07-31
 year-month | 2014 |     8 | 2014-07-31 | 2014-08-01 | 2014-08-31
 year-month | 2014 |     9 | 2014-08-31 | 2014-09-01 | 2014-09-30
 year-month | 2014 |    10 | 2014-09-30 | 2014-10-01 | 2014-10-31
 year-month | 2014 |    11 | 2014-10-31 | 2014-11-01 | 2014-11-30
 year-month | 2014 |    12 | 2014-11-30 | 2014-12-01 | 2014-12-31
 year-month | 2015 |     1 | 2014-12-31 | 2015-01-01 | 2015-01-31
 year-month | 2015 |     2 | 2015-01-31 | 2015-02-01 | 2015-02-28
 year-month | 2015 |     3 | 2015-02-28 | 2015-03-01 | 2015-03-31
 year-month | 2015 |     4 | 2015-03-31 | 2015-04-01 | 2015-04-30
 year-month | 2015 |     5 | 2015-04-30 | 2015-05-01 | 2015-05-31
 year-month | 2015 |     6 | 2015-05-31 | 2015-06-01 | 2015-06-30
 year-month | 2015 |     7 | 2015-06-30 | 2015-07-01 | 2015-07-31
 year-month | 2015 |     8 | 2015-07-31 | 2015-08-01 | 2015-08-31
 year-month | 2015 |     9 | 2015-08-31 | 2015-09-01 | 2015-09-30
 year-month | 2015 |    10 | 2015-09-30 | 2015-10-01 | 2015-10-31
 year-month | 2015 |    11 | 2015-10-31 | 2015-11-01 | 2015-11-30
 year-month | 2015 |    12 | 2015-11-30 | 2015-12-01 | 2015-12-31
 year-month | 2016 |     1 | 2015-12-31 | 2016-01-01 | 2016-01-31
 year-month | 2016 |     2 | 2016-01-31 | 2016-02-01 | 2016-02-29
 year-month | 2016 |     3 | 2016-02-29 | 2016-03-01 | 2016-03-31
 year-month | 2016 |     4 | 2016-03-31 | 2016-04-01 | 2016-04-30
 year-month | 2016 |     5 | 2016-04-30 | 2016-05-01 | 2016-05-31
 year-month | 2016 |     6 | 2016-05-31 | 2016-06-01 | 2016-06-30
 year-month | 2016 |     7 | 2016-06-30 | 2016-07-01 | 2016-07-31
 year-month | 2016 |     8 | 2016-07-31 | 2016-08-01 | 2016-08-31
 year-month | 2016 |     9 | 2016-08-31 | 2016-09-01 | 2016-09-30
 year-month | 2016 |    10 | 2016-09-30 | 2016-10-01 | 2016-10-31
 year-month | 2016 |    11 | 2016-10-31 | 2016-11-01 | 2016-11-30
 year-month | 2016 |    12 | 2016-11-30 | 2016-12-01 | 2016-12-31
 year-month | 2017 |     1 | 2016-12-31 | 2017-01-01 | 2017-01-31
 year-month | 2017 |     2 | 2017-01-31 | 2017-02-01 | 2017-02-28
 year-month | 2017 |     3 | 2017-02-28 | 2017-03-01 | 2017-03-31
 year-month | 2017 |     4 | 2017-03-31 | 2017-04-01 | 2017-04-30
 year-month | 2017 |     5 | 2017-04-30 | 2017-05-01 | 2017-05-31
 year-month | 2017 |     6 | 2017-05-31 | 2017-06-01 | 2017-06-30
 year-month | 2017 |     7 | 2017-06-30 | 2017-07-01 | 2017-07-31
 year-month | 2017 |     8 | 2017-07-31 | 2017-08-01 | 2017-08-31
 year-month | 2017 |     9 | 2017-08-31 | 2017-09-01 | 2017-09-30
 year-month | 2017 |    10 | 2017-09-30 | 2017-10-01 | 2017-10-31
 year-month | 2017 |    11 | 2017-10-31 | 2017-11-01 | 2017-11-30
 year-month | 2017 |    12 | 2017-11-30 | 2017-12-01 | 2017-12-31
 year-month | 2018 |     1 | 2017-12-31 | 2018-01-01 | 2018-01-31
 year-month | 2018 |     2 | 2018-01-31 | 2018-02-01 | 2018-02-28
 year-month | 2018 |     3 | 2018-02-28 | 2018-03-01 | 2018-03-31
 year-month | 2018 |     4 | 2018-03-31 | 2018-04-01 | 2018-04-30
 year-month | 2018 |     5 | 2018-04-30 | 2018-05-01 | 2018-05-31
 year-month | 2018 |     6 | 2018-05-31 | 2018-06-01 | 2018-06-30
 year-month | 2018 |     7 | 2018-06-30 | 2018-07-01 | 2018-07-31
 year-month | 2018 |     8 | 2018-07-31 | 2018-08-01 | 2018-08-31
 year-month | 2018 |     9 | 2018-08-31 | 2018-09-01 | 2018-09-30
 year-month | 2018 |    10 | 2018-09-30 | 2018-10-01 | 2018-10-31
 year-month | 2018 |    11 | 2018-10-31 | 2018-11-01 | 2018-11-30
 year-month | 2018 |    12 | 2018-11-30 | 2018-12-01 | 2018-12-31
 year-month | 2019 |     1 | 2018-12-31 | 2019-01-01 | 2019-01-31
 year-month | 2019 |     2 | 2019-01-31 | 2019-02-01 | 2019-02-28
 year-month | 2019 |     3 | 2019-02-28 | 2019-03-01 | 2019-03-31
 year-month | 2019 |     4 | 2019-03-31 | 2019-04-01 | 2019-04-30
 year-month | 2019 |     5 | 2019-04-30 | 2019-05-01 | 2019-05-31
 year-month | 2019 |     6 | 2019-05-31 | 2019-06-01 | 2019-06-30
 year-month | 2019 |     7 | 2019-06-30 | 2019-07-01 | 2019-07-31
 year-month | 2019 |     8 | 2019-07-31 | 2019-08-01 | 2019-08-31
 year-month | 2019 |     9 | 2019-08-31 | 2019-09-01 | 2019-09-30
 year-month | 2019 |    10 | 2019-09-30 | 2019-10-01 | 2019-10-31
 year-month | 2019 |    11 | 2019-10-31 | 2019-11-01 | 2019-11-30
 year-month | 2019 |    12 | 2019-11-30 | 2019-12-01 | 2019-12-31
 year-month | 2020 |     1 | 2019-12-31 | 2020-01-01 | 2020-01-31
 year-month | 2020 |     2 | 2020-01-31 | 2020-02-01 | 2020-02-29
 year-month | 2020 |     3 | 2020-02-29 | 2020-03-01 | 2020-03-31
 year-month | 2020 |     4 | 2020-03-31 | 2020-04-01 | 2020-04-30
 year-month | 2020 |     5 | 2020-04-30 | 2020-05-01 | 2020-05-31
 year-month | 2020 |     6 | 2020-05-31 | 2020-06-01 | 2020-06-30
 year-month | 2020 |     7 | 2020-06-30 | 2020-07-01 | 2020-07-31
 year-month | 2020 |     8 | 2020-07-31 | 2020-08-01 | 2020-08-31
 year-month | 2020 |     9 | 2020-08-31 | 2020-09-01 | 2020-09-30
 year-month | 2020 |    10 | 2020-09-30 | 2020-10-01 | 2020-10-31
 year-month | 2020 |    11 | 2020-10-31 | 2020-11-01 | 2020-11-30
 year-month | 2020 |    12 | 2020-11-30 | 2020-12-01 | 2020-12-31
 year-month | 2021 |     1 | 2020-12-31 | 2021-01-01 | 2021-01-31
 year-month | 2021 |     2 | 2021-01-31 | 2021-02-01 | 2021-02-28
 year-month | 2021 |     3 | 2021-02-28 | 2021-03-01 | 2021-03-31
 year-month | 2021 |     4 | 2021-03-31 | 2021-04-01 | 2021-04-30
 year-month | 2021 |     5 | 2021-04-30 | 2021-05-01 | 2021-05-31
 year-month | 2021 |     6 | 2021-05-31 | 2021-06-01 | 2021-06-30
 year-month | 2021 |     7 | 2021-06-30 | 2021-07-01 | 2021-07-31
 year-month | 2021 |     8 | 2021-07-31 | 2021-08-01 | 2021-08-31
 year-month | 2021 |     9 | 2021-08-31 | 2021-09-01 | 2021-09-30
 year-month | 2021 |    10 | 2021-09-30 | 2021-10-01 | 2021-10-31
 year-month | 2021 |    11 | 2021-10-31 | 2021-11-01 | 2021-11-30
 year-month | 2021 |    12 | 2021-11-30 | 2021-12-01 | 2021-12-31
 year-month | 2022 |     1 | 2021-12-31 | 2022-01-01 | 2022-01-31
 year-month | 2022 |     2 | 2022-01-31 | 2022-02-01 | 2022-02-28
 year-month | 2022 |     3 | 2022-02-28 | 2022-03-01 | 2022-03-31
 year-month | 2022 |     4 | 2022-03-31 | 2022-04-01 | 2022-04-30
 year-month | 2022 |     5 | 2022-04-30 | 2022-05-01 | 2022-05-31
 year-month | 2022 |     6 | 2022-05-31 | 2022-06-01 | 2022-06-30
 year-month | 2022 |     7 | 2022-06-30 | 2022-07-01 | 2022-07-31
 year-month | 2022 |     8 | 2022-07-31 | 2022-08-01 | 2022-08-31
 year-month | 2022 |     9 | 2022-08-31 | 2022-09-01 | 2022-09-30
 year-month | 2022 |    10 | 2022-09-30 | 2022-10-01 | 2022-10-31
 year-month | 2022 |    11 | 2022-10-31 | 2022-11-01 | 2022-11-30
 year-month | 2022 |    12 | 2022-11-30 | 2022-12-01 | 2022-12-31
 year-month | 2023 |     1 | 2022-12-31 | 2023-01-01 | 2023-01-31
 year-month | 2023 |     2 | 2023-01-31 | 2023-02-01 | 2023-02-28
 year-month | 2023 |     3 | 2023-02-28 | 2023-03-01 | 2023-03-31
 year-month | 2023 |     4 | 2023-03-31 | 2023-04-01 | 2023-04-30
 year-month | 2023 |     5 | 2023-04-30 | 2023-05-01 | 2023-05-31
 year-month | 2023 |     6 | 2023-05-31 | 2023-06-01 | 2023-06-30
 year-month | 2023 |     7 | 2023-06-30 | 2023-07-01 | 2023-07-31
 year-month | 2023 |     8 | 2023-07-31 | 2023-08-01 | 2023-08-31
 year-month | 2023 |     9 | 2023-08-31 | 2023-09-01 | 2023-09-30
 year-month | 2023 |    10 | 2023-09-30 | 2023-10-01 | 2023-10-31
 year-month | 2023 |    11 | 2023-10-31 | 2023-11-01 | 2023-11-30
 year-month | 2023 |    12 | 2023-11-30 | 2023-12-01 | 2023-12-31
(182 rows)

\echo "Checking timepoints."
"Checking timepoints."
WITH timepoints_with_tax_ident AS (
    SELECT tp.unit_type,
           tp.unit_id,
           tp.timepoint,
           -- For enterprises, the tax_ident is constant over its life. Find it once robustly.
           CASE
               WHEN tp.unit_type = 'enterprise' THEN
                   (SELECT tei.external_idents->>'tax_ident'
                    FROM public.enterprise_external_idents AS tei
                    WHERE tei.unit_id = tp.unit_id ORDER BY tei.valid_from LIMIT 1)
               ELSE
                   public.get_external_idents(tp.unit_type, tp.unit_id)->>'tax_ident'
           END AS tax_ident
    FROM public.timepoints AS tp
)
SELECT tpti.unit_type,
       tpti.tax_ident,
       tpti.timepoint
FROM timepoints_with_tax_ident AS tpti
ORDER BY tpti.unit_type, tpti.tax_ident, tpti.timepoint;
   unit_type   | tax_ident | timepoint  
---------------+-----------+------------
 establishment | 895406732 | 2010-01-01
 establishment | 895406732 | 2013-01-01
 establishment | 895406732 | 2016-01-01
 establishment | 895406732 | 2019-01-01
 establishment | 895406732 | 2019-03-01
 establishment | 895406732 | 2019-05-01
 establishment | 895406732 | 2019-07-01
 establishment | 895406732 | 2019-09-01
 establishment | 895406732 | 2019-11-01
 establishment | 895406732 | 2020-01-01
 establishment | 895406732 | infinity
 legal_unit    | 823573673 | 2010-01-01
 legal_unit    | 823573673 | 2013-01-01
 legal_unit    | 921835809 | 2013-01-01
 legal_unit    | 921835809 | 2016-01-01
 legal_unit    | 921835809 | 2019-01-01
 legal_unit    | 921835809 | 2019-03-01
 legal_unit    | 921835809 | 2019-05-01
 legal_unit    | 921835809 | 2019-07-01
 legal_unit    | 921835809 | 2019-09-01
 legal_unit    | 921835809 | 2019-11-01
 legal_unit    | 921835809 | 2020-01-01
 legal_unit    | 921835809 | infinity
 enterprise    | 823573673 | 2010-01-01
 enterprise    | 823573673 | 2013-01-01
 enterprise    | 921835809 | 2013-01-01
 enterprise    | 921835809 | 2016-01-01
 enterprise    | 921835809 | 2019-01-01
 enterprise    | 921835809 | 2019-03-01
 enterprise    | 921835809 | 2019-05-01
 enterprise    | 921835809 | 2019-07-01
 enterprise    | 921835809 | 2019-09-01
 enterprise    | 921835809 | 2019-11-01
 enterprise    | 921835809 | 2020-01-01
 enterprise    | 921835809 | infinity
(35 rows)

\echo "Checking timesegments."
"Checking timesegments."
WITH timesegments_with_tax_ident AS (
    SELECT ts.unit_type,
           ts.unit_id,
           ts.valid_from,
           ts.valid_until,
           -- For enterprises, the tax_ident is constant over its life. Find it once robustly.
           CASE
               WHEN ts.unit_type = 'enterprise' THEN
                   (SELECT tei.external_idents->>'tax_ident'
                    FROM public.enterprise_external_idents AS tei
                    WHERE tei.unit_id = ts.unit_id ORDER BY tei.valid_from LIMIT 1)
               ELSE
                   public.get_external_idents(ts.unit_type, ts.unit_id)->>'tax_ident'
           END AS tax_ident
    FROM public.timesegments AS ts
)
SELECT tsti.unit_type,
       tsti.tax_ident,
       tsti.valid_from,
       tsti.valid_until
FROM timesegments_with_tax_ident AS tsti
ORDER BY tsti.unit_type, tsti.tax_ident, tsti.valid_from;
   unit_type   | tax_ident | valid_from | valid_until 
---------------+-----------+------------+-------------
 establishment | 895406732 | 2010-01-01 | 2013-01-01
 establishment | 895406732 | 2013-01-01 | 2016-01-01
 establishment | 895406732 | 2016-01-01 | 2019-01-01
 establishment | 895406732 | 2019-01-01 | 2019-03-01
 establishment | 895406732 | 2019-03-01 | 2019-05-01
 establishment | 895406732 | 2019-05-01 | 2019-07-01
 establishment | 895406732 | 2019-07-01 | 2019-09-01
 establishment | 895406732 | 2019-09-01 | 2019-11-01
 establishment | 895406732 | 2019-11-01 | 2020-01-01
 establishment | 895406732 | 2020-01-01 | infinity
 legal_unit    | 823573673 | 2010-01-01 | 2013-01-01
 legal_unit    | 921835809 | 2013-01-01 | 2016-01-01
 legal_unit    | 921835809 | 2016-01-01 | 2019-01-01
 legal_unit    | 921835809 | 2019-01-01 | 2019-03-01
 legal_unit    | 921835809 | 2019-03-01 | 2019-05-01
 legal_unit    | 921835809 | 2019-05-01 | 2019-07-01
 legal_unit    | 921835809 | 2019-07-01 | 2019-09-01
 legal_unit    | 921835809 | 2019-09-01 | 2019-11-01
 legal_unit    | 921835809 | 2019-11-01 | 2020-01-01
 legal_unit    | 921835809 | 2020-01-01 | infinity
 enterprise    | 823573673 | 2010-01-01 | 2013-01-01
 enterprise    | 921835809 | 2013-01-01 | 2016-01-01
 enterprise    | 921835809 | 2016-01-01 | 2019-01-01
 enterprise    | 921835809 | 2019-01-01 | 2019-03-01
 enterprise    | 921835809 | 2019-03-01 | 2019-05-01
 enterprise    | 921835809 | 2019-05-01 | 2019-07-01
 enterprise    | 921835809 | 2019-07-01 | 2019-09-01
 enterprise    | 921835809 | 2019-09-01 | 2019-11-01
 enterprise    | 921835809 | 2019-11-01 | 2020-01-01
 enterprise    | 921835809 | 2020-01-01 | infinity
(30 rows)

\echo "Checking timesegments_years."
"Checking timesegments_years."
-- This test checks historical years derived from all loaded test data.
-- Years after 2025 are exlucded, to make the test deterministic as time passes.
SELECT year FROM public.timesegments_years
WHERE year <= 2025
ORDER BY year;
 year 
------
 2010
 2011
 2012
 2013
 2014
 2015
 2016
 2017
 2018
 2019
 2020
 2021
 2022
 2023
 2024
 2025
(16 rows)

\echo "Checking timeline_establishment data"
"Checking timeline_establishment data"
WITH timeline_establishment_with_tax_ident AS (
    SELECT te.*,
           public.get_external_idents(te.unit_type, te.unit_id)->>'tax_ident' AS tax_ident
    FROM public.timeline_establishment AS te
)
SELECT tet.unit_type
     , tet.tax_ident
     , tet.valid_from
     , tet.valid_to
     , tet.valid_until
     , tet.name
     , tet.birth_date
     , tet.death_date
     , tet.search
     , tet.primary_activity_category_path
     , tet.secondary_activity_category_path
     , tet.activity_category_paths
     , tet.sector_path
     , tet.sector_code
     , tet.sector_name
     , tet.data_source_codes
     , tet.legal_form_code
     , tet.legal_form_name
     , tet.physical_address_part1
     , tet.physical_address_part2
     , tet.physical_address_part3
     , tet.physical_postcode
     , tet.physical_postplace
     , tet.physical_region_path
     , tet.physical_country_iso_2
     , tet.postal_address_part1
     , tet.postal_address_part2
     , tet.postal_address_part3
     , tet.postal_postcode
     , tet.postal_postplace
     , tet.postal_region_path
     , tet.postal_country_iso_2
     , tet.invalid_codes
FROM timeline_establishment_with_tax_ident AS tet
ORDER BY tet.unit_type, tet.tax_ident, tet.valid_from, tet.valid_until;
   unit_type   | tax_ident | valid_from |  valid_to  | valid_until |         name          | birth_date | death_date |             search              | primary_activity_category_path | secondary_activity_category_path | activity_category_paths | sector_path | sector_code | sector_name | data_source_codes | legal_form_code | legal_form_name | physical_address_part1 | physical_address_part2 | physical_address_part3 | physical_postcode | physical_postplace | physical_region_path | physical_country_iso_2 | postal_address_part1 | postal_address_part2 | postal_address_part3 | postal_postcode | postal_postplace | postal_region_path | postal_country_iso_2 | invalid_codes 
---------------+-----------+------------+------------+-------------+-----------------------+------------+------------+---------------------------------+--------------------------------+----------------------------------+-------------------------+-------------+-------------+-------------+-------------------+-----------------+-----------------+------------------------+------------------------+------------------------+-------------------+--------------------+----------------------+------------------------+----------------------+----------------------+----------------------+-----------------+------------------+--------------------+----------------------+---------------
 establishment | 895406732 | 2010-01-01 | 2012-12-31 | 2013-01-01  | KRANLØFT ENK          | 2010-01-01 |            | 'enk':2 'kranløft':1            | H.49.4.1.0                     |                                  | {H.49.4.1.0}            |             |             |             | {brreg}           |                 |                 | Vestlyvegen 219        |                        |                        | 4347              | LYE                | 11.21                | NO                     |                      |                      |                      |                 |                  |                    |                      | 
 establishment | 895406732 | 2013-01-01 | 2015-12-31 | 2016-01-01  | KRAN & SPESIALLØFT AS | 2010-01-01 |            | 'as':3 'kran':1 'spesialløft':2 | H.49.4.1.0                     |                                  | {H.49.4.1.0}            |             |             |             | {brreg}           |                 |                 | Vestlyvegen 219        |                        |                        | 4347              | LYE                | 11.21                | NO                     |                      |                      |                      |                 |                  |                    |                      | 
 establishment | 895406732 | 2016-01-01 | 2018-12-31 | 2019-01-01  | KRAN & SPESIALLØFT AS | 2010-01-01 |            | 'as':3 'kran':1 'spesialløft':2 | H.49.4.1.0                     |                                  | {H.49.4.1.0}            |             |             |             | {brreg}           |                 |                 | Vestlyvegen 219        |                        |                        | 4347              | LYE                | 11.21                | NO                     |                      |                      |                      |                 |                  |                    |                      | 
 establishment | 895406732 | 2019-01-01 | 2019-02-28 | 2019-03-01  | KRAN & SPESIALLØFT AS | 2010-01-01 |            | 'as':3 'kran':1 'spesialløft':2 | H.49.4.1.0                     |                                  | {H.49.4.1.0}            |             |             |             | {brreg}           |                 |                 | Vestlyvegen 219        |                        |                        | 4347              | LYE                | 11.21                | NO                     |                      |                      |                      |                 |                  |                    |                      | 
 establishment | 895406732 | 2019-03-01 | 2019-04-30 | 2019-05-01  | KRAN & SPESIALLØFT AS | 2010-01-01 |            | 'as':3 'kran':1 'spesialløft':2 | H.49.4.1.0                     |                                  | {H.49.4.1.0}            |             |             |             | {brreg}           |                 |                 | Vestlyvegen 219        |                        |                        | 4347              | LYE                | 11.21                | NO                     |                      |                      |                      |                 |                  |                    |                      | 
 establishment | 895406732 | 2019-05-01 | 2019-06-30 | 2019-07-01  | KRAN & SPESIALLØFT AS | 2010-01-01 |            | 'as':3 'kran':1 'spesialløft':2 | H.49.4.1.0                     |                                  | {H.49.4.1.0}            |             |             |             | {brreg}           |                 |                 | Vestlyvegen 219        |                        |                        | 4347              | LYE                | 11.21                | NO                     |                      |                      |                      |                 |                  |                    |                      | 
 establishment | 895406732 | 2019-07-01 | 2019-08-31 | 2019-09-01  | KRAN & SPESIALLØFT AS | 2010-01-01 |            | 'as':3 'kran':1 'spesialløft':2 | H.49.4.1.0                     |                                  | {H.49.4.1.0}            |             |             |             | {brreg}           |                 |                 | Vestlyvegen 219        |                        |                        | 4347              | LYE                | 11.21                | NO                     |                      |                      |                      |                 |                  |                    |                      | 
 establishment | 895406732 | 2019-09-01 | 2019-10-31 | 2019-11-01  | KRAN & SPESIALLØFT AS | 2010-01-01 |            | 'as':3 'kran':1 'spesialløft':2 | H.49.4.1.0                     |                                  | {H.49.4.1.0}            |             |             |             | {brreg}           |                 |                 | Vestlyvegen 219        |                        |                        | 4347              | LYE                | 11.21                | NO                     |                      |                      |                      |                 |                  |                    |                      | 
 establishment | 895406732 | 2019-11-01 | 2019-12-31 | 2020-01-01  | KRAN & SPESIALLØFT AS | 2010-01-01 |            | 'as':3 'kran':1 'spesialløft':2 | H.49.4.1.0                     |                                  | {H.49.4.1.0}            |             |             |             | {brreg}           |                 |                 | Vestlyvegen 219        |                        |                        | 4347              | LYE                | 11.21                | NO                     |                      |                      |                      |                 |                  |                    |                      | 
 establishment | 895406732 | 2020-01-01 | infinity   | infinity    | KRAN & SPESIALLØFT AS | 2010-01-01 |            | 'as':3 'kran':1 'spesialløft':2 | H.49.4.1.0                     |                                  | {H.49.4.1.0}            |             |             |             | {brreg}           |                 |                 | Vestlyvegen 219        |                        |                        | 4347              | LYE                | 11.21                | NO                     |                      |                      |                      |                 |                  |                    |                      | 
(10 rows)

\echo "Checking timeline_establishment stats"
"Checking timeline_establishment stats"
WITH timeline_establishment_stats_with_tax_ident AS (
    SELECT tes.*,
           public.get_external_idents(tes.unit_type, tes.unit_id)->>'tax_ident' AS tax_ident
    FROM public.timeline_establishment AS tes
)
SELECT unit_type
     , tax_ident
     , valid_from
     , valid_to
     , valid_until
     , stats
FROM timeline_establishment_stats_with_tax_ident
ORDER BY unit_type, tax_ident, valid_from, valid_until;
   unit_type   | tax_ident | valid_from |  valid_to  | valid_until |                  stats                  
---------------+-----------+------------+------------+-------------+-----------------------------------------
 establishment | 895406732 | 2010-01-01 | 2012-12-31 | 2013-01-01  | {"turnover": 1500000, "employees": 1}
 establishment | 895406732 | 2013-01-01 | 2015-12-31 | 2016-01-01  | {"turnover": 3000000, "employees": 3}
 establishment | 895406732 | 2016-01-01 | 2018-12-31 | 2019-01-01  | {"turnover": 12000000, "employees": 9}
 establishment | 895406732 | 2019-01-01 | 2019-02-28 | 2019-03-01  | {"turnover": 60000000, "employees": 25}
 establishment | 895406732 | 2019-03-01 | 2019-04-30 | 2019-05-01  | {"turnover": 60000000, "employees": 30}
 establishment | 895406732 | 2019-05-01 | 2019-06-30 | 2019-07-01  | {"turnover": 60000000, "employees": 35}
 establishment | 895406732 | 2019-07-01 | 2019-08-31 | 2019-09-01  | {"turnover": 60000000, "employees": 40}
 establishment | 895406732 | 2019-09-01 | 2019-10-31 | 2019-11-01  | {"turnover": 60000000, "employees": 50}
 establishment | 895406732 | 2019-11-01 | 2019-12-31 | 2020-01-01  | {"turnover": 60000000, "employees": 40}
 establishment | 895406732 | 2020-01-01 | infinity   | infinity    | {"turnover": 70000000, "employees": 45}
(10 rows)

\echo "Checking timeline_legal_unit data"
"Checking timeline_legal_unit data"
WITH timeline_legal_unit_with_tax_ident AS (
    SELECT tlu.*,
           public.get_external_idents(tlu.unit_type, tlu.unit_id)->>'tax_ident' AS tax_ident
    FROM public.timeline_legal_unit AS tlu
)
SELECT tlut.unit_type
     , tlut.tax_ident
     , tlut.valid_from
     , tlut.valid_to
     , tlut.valid_until
     , name
     , birth_date
     , death_date
     , search
     , primary_activity_category_path
     , secondary_activity_category_path
     , activity_category_paths
     , sector_path
     , sector_code
     , sector_name
     , data_source_codes
     , legal_form_code
     , legal_form_name
     , physical_address_part1
     , physical_address_part2
     , physical_address_part3
     , physical_postcode
     , physical_postplace
     , physical_region_path
     , physical_country_iso_2
     , postal_address_part1
     , postal_address_part2
     , postal_address_part3
     , postal_postcode
     , postal_postplace
     , tlut.postal_region_path
     , tlut.postal_country_iso_2
     , tlut.invalid_codes
FROM timeline_legal_unit_with_tax_ident AS tlut
ORDER BY tlut.unit_type, tlut.tax_ident, tlut.valid_from, tlut.valid_until;
 unit_type  | tax_ident | valid_from |  valid_to  | valid_until |         name          | birth_date | death_date |             search              | primary_activity_category_path | secondary_activity_category_path | activity_category_paths |     sector_path      | sector_code |        sector_name         | data_source_codes | legal_form_code |   legal_form_name   | physical_address_part1 | physical_address_part2 | physical_address_part3 | physical_postcode | physical_postplace | physical_region_path | physical_country_iso_2 | postal_address_part1 | postal_address_part2 | postal_address_part3 | postal_postcode | postal_postplace | postal_region_path | postal_country_iso_2 | invalid_codes 
------------+-----------+------------+------------+-------------+-----------------------+------------+------------+---------------------------------+--------------------------------+----------------------------------+-------------------------+----------------------+-------------+----------------------------+-------------------+-----------------+---------------------+------------------------+------------------------+------------------------+-------------------+--------------------+----------------------+------------------------+----------------------+----------------------+----------------------+-----------------+------------------+--------------------+----------------------+---------------
 legal_unit | 823573673 | 2010-01-01 | 2012-12-31 | 2013-01-01  | KRANLØFT ENK          | 2010-01-01 | 2012-12-31 | 'enk':2 'kranløft':1            | H.49.4.1.0                     |                                  | {H.49.4.1.0}            | innl.a_ikke_fin.2100 | 2100        | Private aksjeselskaper mv. | {brreg,skatt}     | ENK             | Enkeltpersonforetak | Vestlyvegen 219        |                        |                        | 4347              | LYE                | 11.21                | NO                     |                      |                      |                      |                 |                  |                    |                      | 
 legal_unit | 921835809 | 2013-01-01 | 2015-12-31 | 2016-01-01  | KRAN & SPESIALLØFT AS | 2013-01-01 |            | 'as':3 'kran':1 'spesialløft':2 | H.49.4.1.0                     |                                  | {H.49.4.1.0}            | innl.a_ikke_fin.2100 | 2100        | Private aksjeselskaper mv. | {brreg,skatt}     | AS              | Aksjeselskap        | Vestlyvegen 219        |                        |                        | 4347              | LYE                | 11.21                | NO                     |                      |                      |                      |                 |                  |                    |                      | 
 legal_unit | 921835809 | 2016-01-01 | 2018-12-31 | 2019-01-01  | KRAN & SPESIALLØFT AS | 2013-01-01 |            | 'as':3 'kran':1 'spesialløft':2 | H.49.4.1.0                     |                                  | {H.49.4.1.0}            | innl.a_ikke_fin.2100 | 2100        | Private aksjeselskaper mv. | {brreg,skatt}     | AS              | Aksjeselskap        | Vestlyvegen 219        |                        |                        | 4347              | LYE                | 11.21                | NO                     |                      |                      |                      |                 |                  |                    |                      | 
 legal_unit | 921835809 | 2019-01-01 | 2019-02-28 | 2019-03-01  | KRAN & SPESIALLØFT AS | 2013-01-01 |            | 'as':3 'kran':1 'spesialløft':2 | H.49.4.1.0                     |                                  | {H.49.4.1.0}            | innl.a_ikke_fin.2100 | 2100        | Private aksjeselskaper mv. | {brreg,skatt}     | AS              | Aksjeselskap        | Vestlyvegen 219        |                        |                        | 4347              | LYE                | 11.21                | NO                     |                      |                      |                      |                 |                  |                    |                      | 
 legal_unit | 921835809 | 2019-03-01 | 2019-04-30 | 2019-05-01  | KRAN & SPESIALLØFT AS | 2013-01-01 |            | 'as':3 'kran':1 'spesialløft':2 | H.49.4.1.0                     |                                  | {H.49.4.1.0}            | innl.a_ikke_fin.2100 | 2100        | Private aksjeselskaper mv. | {brreg,skatt}     | AS              | Aksjeselskap        | Vestlyvegen 219        |                        |                        | 4347              | LYE                | 11.21                | NO                     |                      |                      |                      |                 |                  |                    |                      | 
 legal_unit | 921835809 | 2019-05-01 | 2019-06-30 | 2019-07-01  | KRAN & SPESIALLØFT AS | 2013-01-01 |            | 'as':3 'kran':1 'spesialløft':2 | H.49.4.1.0                     |                                  | {H.49.4.1.0}            | innl.a_ikke_fin.2100 | 2100        | Private aksjeselskaper mv. | {brreg,skatt}     | AS              | Aksjeselskap        | Vestlyvegen 219        |                        |                        | 4347              | LYE                | 11.21                | NO                     |                      |                      |                      |                 |                  |                    |                      | 
 legal_unit | 921835809 | 2019-07-01 | 2019-08-31 | 2019-09-01  | KRAN & SPESIALLØFT AS | 2013-01-01 |            | 'as':3 'kran':1 'spesialløft':2 | H.49.4.1.0                     |                                  | {H.49.4.1.0}            | innl.a_ikke_fin.2100 | 2100        | Private aksjeselskaper mv. | {brreg,skatt}     | AS              | Aksjeselskap        | Vestlyvegen 219        |                        |                        | 4347              | LYE                | 11.21                | NO                     |                      |                      |                      |                 |                  |                    |                      | 
 legal_unit | 921835809 | 2019-09-01 | 2019-10-31 | 2019-11-01  | KRAN & SPESIALLØFT AS | 2013-01-01 |            | 'as':3 'kran':1 'spesialløft':2 | H.49.4.1.0                     |                                  | {H.49.4.1.0}            | innl.a_ikke_fin.2100 | 2100        | Private aksjeselskaper mv. | {brreg,skatt}     | AS              | Aksjeselskap        | Vestlyvegen 219        |                        |                        | 4347              | LYE                | 11.21                | NO                     |                      |                      |                      |                 |                  |                    |                      | 
 legal_unit | 921835809 | 2019-11-01 | 2019-12-31 | 2020-01-01  | KRAN & SPESIALLØFT AS | 2013-01-01 |            | 'as':3 'kran':1 'spesialløft':2 | H.49.4.1.0                     |                                  | {H.49.4.1.0}            | innl.a_ikke_fin.2100 | 2100        | Private aksjeselskaper mv. | {brreg,skatt}     | AS              | Aksjeselskap        | Vestlyvegen 219        |                        |                        | 4347              | LYE                | 11.21                | NO                     |                      |                      |                      |                 |                  |                    |                      | 
 legal_unit | 921835809 | 2020-01-01 | infinity   | infinity    | KRAN & SPESIALLØFT AS | 2013-01-01 |            | 'as':3 'kran':1 'spesialløft':2 | H.49.4.1.0                     |                                  | {H.49.4.1.0}            | innl.a_ikke_fin.2100 | 2100        | Private aksjeselskaper mv. | {brreg,skatt}     | AS              | Aksjeselskap        | Vestlyvegen 219        |                        |                        | 4347              | LYE                | 11.21                | NO                     |                      |                      |                      |                 |                  |                    |                      | 
(10 rows)

\x
\echo "Checking timeline_legal_unit stats"
"Checking timeline_legal_unit stats"
WITH timeline_legal_unit_stats_with_tax_ident AS (
    SELECT tlus.*,
           public.get_external_idents(tlus.unit_type, tlus.unit_id)->>'tax_ident' AS tax_ident
    FROM public.timeline_legal_unit AS tlus
)
SELECT unit_type
     , tax_ident
     , valid_from
     , valid_to
     , valid_until
     , name
     , stats
     , jsonb_pretty(stats_summary) AS stats_summary
FROM timeline_legal_unit_stats_with_tax_ident
ORDER BY unit_type, tax_ident, valid_from, valid_until;
-[ RECORD 1 ]-+---------------------------------------------
unit_type     | legal_unit
tax_ident     | 823573673
valid_from    | 2010-01-01
valid_to      | 2012-12-31
valid_until   | 2013-01-01
name          | KRANLØFT ENK
stats         | {}
stats_summary | {                                           +
              |     "turnover": {                           +
              |         "max": 1500000,                     +
              |         "min": 1500000,                     +
              |         "sum": 1500000,                     +
              |         "mean": 1500000.00,                 +
              |         "type": "number",                   +
              |         "count": 1,                         +
              |         "stddev": 0.00,                     +
              |         "variance": 0.00,                   +
              |         "sum_sq_diff": 0.00,                +
              |         "coefficient_of_variation_pct": 0.00+
              |     },                                      +
              |     "employees": {                          +
              |         "max": 1,                           +
              |         "min": 1,                           +
              |         "sum": 1,                           +
              |         "mean": 1.00,                       +
              |         "type": "number",                   +
              |         "count": 1,                         +
              |         "stddev": 0.00,                     +
              |         "variance": 0.00,                   +
              |         "sum_sq_diff": 0.00,                +
              |         "coefficient_of_variation_pct": 0.00+
              |     }                                       +
              | }
-[ RECORD 2 ]-+---------------------------------------------
unit_type     | legal_unit
tax_ident     | 921835809
valid_from    | 2013-01-01
valid_to      | 2015-12-31
valid_until   | 2016-01-01
name          | KRAN & SPESIALLØFT AS
stats         | {}
stats_summary | {                                           +
              |     "turnover": {                           +
              |         "max": 3000000,                     +
              |         "min": 3000000,                     +
              |         "sum": 3000000,                     +
              |         "mean": 3000000.00,                 +
              |         "type": "number",                   +
              |         "count": 1,                         +
              |         "stddev": 0.00,                     +
              |         "variance": 0.00,                   +
              |         "sum_sq_diff": 0.00,                +
              |         "coefficient_of_variation_pct": 0.00+
              |     },                                      +
              |     "employees": {                          +
              |         "max": 3,                           +
              |         "min": 3,                           +
              |         "sum": 3,                           +
              |         "mean": 3.00,                       +
              |         "type": "number",                   +
              |         "count": 1,                         +
              |         "stddev": 0.00,                     +
              |         "variance": 0.00,                   +
              |         "sum_sq_diff": 0.00,                +
              |         "coefficient_of_variation_pct": 0.00+
              |     }                                       +
              | }
-[ RECORD 3 ]-+---------------------------------------------
unit_type     | legal_unit
tax_ident     | 921835809
valid_from    | 2016-01-01
valid_to      | 2018-12-31
valid_until   | 2019-01-01
name          | KRAN & SPESIALLØFT AS
stats         | {}
stats_summary | {                                           +
              |     "turnover": {                           +
              |         "max": 12000000,                    +
              |         "min": 12000000,                    +
              |         "sum": 12000000,                    +
              |         "mean": 12000000.00,                +
              |         "type": "number",                   +
              |         "count": 1,                         +
              |         "stddev": 0.00,                     +
              |         "variance": 0.00,                   +
              |         "sum_sq_diff": 0.00,                +
              |         "coefficient_of_variation_pct": 0.00+
              |     },                                      +
              |     "employees": {                          +
              |         "max": 9,                           +
              |         "min": 9,                           +
              |         "sum": 9,                           +
              |         "mean": 9.00,                       +
              |         "type": "number",                   +
              |         "count": 1,                         +
              |         "stddev": 0.00,                     +
              |         "variance": 0.00,                   +
              |         "sum_sq_diff": 0.00,                +
              |         "coefficient_of_variation_pct": 0.00+
              |     }                                       +
              | }
-[ RECORD 4 ]-+---------------------------------------------
unit_type     | legal_unit
tax_ident     | 921835809
valid_from    | 2019-01-01
valid_to      | 2019-02-28
valid_until   | 2019-03-01
name          | KRAN & SPESIALLØFT AS
stats         | {}
stats_summary | {                                           +
              |     "turnover": {                           +
              |         "max": 60000000,                    +
              |         "min": 60000000,                    +
              |         "sum": 60000000,                    +
              |         "mean": 60000000.00,                +
              |         "type": "number",                   +
              |         "count": 1,                         +
              |         "stddev": 0.00,                     +
              |         "variance": 0.00,                   +
              |         "sum_sq_diff": 0.00,                +
              |         "coefficient_of_variation_pct": 0.00+
              |     },                                      +
              |     "employees": {                          +
              |         "max": 25,                          +
              |         "min": 25,                          +
              |         "sum": 25,                          +
              |         "mean": 25.00,                      +
              |         "type": "number",                   +
              |         "count": 1,                         +
              |         "stddev": 0.00,                     +
              |         "variance": 0.00,                   +
              |         "sum_sq_diff": 0.00,                +
              |         "coefficient_of_variation_pct": 0.00+
              |     }                                       +
              | }
-[ RECORD 5 ]-+---------------------------------------------
unit_type     | legal_unit
tax_ident     | 921835809
valid_from    | 2019-03-01
valid_to      | 2019-04-30
valid_until   | 2019-05-01
name          | KRAN & SPESIALLØFT AS
stats         | {}
stats_summary | {                                           +
              |     "turnover": {                           +
              |         "max": 60000000,                    +
              |         "min": 60000000,                    +
              |         "sum": 60000000,                    +
              |         "mean": 60000000.00,                +
              |         "type": "number",                   +
              |         "count": 1,                         +
              |         "stddev": 0.00,                     +
              |         "variance": 0.00,                   +
              |         "sum_sq_diff": 0.00,                +
              |         "coefficient_of_variation_pct": 0.00+
              |     },                                      +
              |     "employees": {                          +
              |         "max": 30,                          +
              |         "min": 30,                          +
              |         "sum": 30,                          +
              |         "mean": 30.00,                      +
              |         "type": "number",                   +
              |         "count": 1,                         +
              |         "stddev": 0.00,                     +
              |         "variance": 0.00,                   +
              |         "sum_sq_diff": 0.00,                +
              |         "coefficient_of_variation_pct": 0.00+
              |     }                                       +
              | }
-[ RECORD 6 ]-+---------------------------------------------
unit_type     | legal_unit
tax_ident     | 921835809
valid_from    | 2019-05-01
valid_to      | 2019-06-30
valid_until   | 2019-07-01
name          | KRAN & SPESIALLØFT AS
stats         | {}
stats_summary | {                                           +
              |     "turnover": {                           +
              |         "max": 60000000,                    +
              |         "min": 60000000,                    +
              |         "sum": 60000000,                    +
              |         "mean": 60000000.00,                +
              |         "type": "number",                   +
              |         "count": 1,                         +
              |         "stddev": 0.00,                     +
              |         "variance": 0.00,                   +
              |         "sum_sq_diff": 0.00,                +
              |         "coefficient_of_variation_pct": 0.00+
              |     },                                      +
              |     "employees": {                          +
              |         "max": 35,                          +
              |         "min": 35,                          +
              |         "sum": 35,                          +
              |         "mean": 35.00,                      +
              |         "type": "number",                   +
              |         "count": 1,                         +
              |         "stddev": 0.00,                     +
              |         "variance": 0.00,                   +
              |         "sum_sq_diff": 0.00,                +
              |         "coefficient_of_variation_pct": 0.00+
              |     }                                       +
              | }
-[ RECORD 7 ]-+---------------------------------------------
unit_type     | legal_unit
tax_ident     | 921835809
valid_from    | 2019-07-01
valid_to      | 2019-08-31
valid_until   | 2019-09-01
name          | KRAN & SPESIALLØFT AS
stats         | {}
stats_summary | {                                           +
              |     "turnover": {                           +
              |         "max": 60000000,                    +
              |         "min": 60000000,                    +
              |         "sum": 60000000,                    +
              |         "mean": 60000000.00,                +
              |         "type": "number",                   +
              |         "count": 1,                         +
              |         "stddev": 0.00,                     +
              |         "variance": 0.00,                   +
              |         "sum_sq_diff": 0.00,                +
              |         "coefficient_of_variation_pct": 0.00+
              |     },                                      +
              |     "employees": {                          +
              |         "max": 40,                          +
              |         "min": 40,                          +
              |         "sum": 40,                          +
              |         "mean": 40.00,                      +
              |         "type": "number",                   +
              |         "count": 1,                         +
              |         "stddev": 0.00,                     +
              |         "variance": 0.00,                   +
              |         "sum_sq_diff": 0.00,                +
              |         "coefficient_of_variation_pct": 0.00+
              |     }                                       +
              | }
-[ RECORD 8 ]-+---------------------------------------------
unit_type     | legal_unit
tax_ident     | 921835809
valid_from    | 2019-09-01
valid_to      | 2019-10-31
valid_until   | 2019-11-01
name          | KRAN & SPESIALLØFT AS
stats         | {}
stats_summary | {                                           +
              |     "turnover": {                           +
              |         "max": 60000000,                    +
              |         "min": 60000000,                    +
              |         "sum": 60000000,                    +
              |         "mean": 60000000.00,                +
              |         "type": "number",                   +
              |         "count": 1,                         +
              |         "stddev": 0.00,                     +
              |         "variance": 0.00,                   +
              |         "sum_sq_diff": 0.00,                +
              |         "coefficient_of_variation_pct": 0.00+
              |     },                                      +
              |     "employees": {                          +
              |         "max": 50,                          +
              |         "min": 50,                          +
              |         "sum": 50,                          +
              |         "mean": 50.00,                      +
              |         "type": "number",                   +
              |         "count": 1,                         +
              |         "stddev": 0.00,                     +
              |         "variance": 0.00,                   +
              |         "sum_sq_diff": 0.00,                +
              |         "coefficient_of_variation_pct": 0.00+
              |     }                                       +
              | }
-[ RECORD 9 ]-+---------------------------------------------
unit_type     | legal_unit
tax_ident     | 921835809
valid_from    | 2019-11-01
valid_to      | 2019-12-31
valid_until   | 2020-01-01
name          | KRAN & SPESIALLØFT AS
stats         | {}
stats_summary | {                                           +
              |     "turnover": {                           +
              |         "max": 60000000,                    +
              |         "min": 60000000,                    +
              |         "sum": 60000000,                    +
              |         "mean": 60000000.00,                +
              |         "type": "number",                   +
              |         "count": 1,                         +
              |         "stddev": 0.00,                     +
              |         "variance": 0.00,                   +
              |         "sum_sq_diff": 0.00,                +
              |         "coefficient_of_variation_pct": 0.00+
              |     },                                      +
              |     "employees": {                          +
              |         "max": 40,                          +
              |         "min": 40,                          +
              |         "sum": 40,                          +
              |         "mean": 40.00,                      +
              |         "type": "number",                   +
              |         "count": 1,                         +
              |         "stddev": 0.00,                     +
              |         "variance": 0.00,                   +
              |         "sum_sq_diff": 0.00,                +
              |         "coefficient_of_variation_pct": 0.00+
              |     }                                       +
              | }
-[ RECORD 10 ]+---------------------------------------------
unit_type     | legal_unit
tax_ident     | 921835809
valid_from    | 2020-01-01
valid_to      | infinity
valid_until   | infinity
name          | KRAN & SPESIALLØFT AS
stats         | {}
stats_summary | {                                           +
              |     "turnover": {                           +
              |         "max": 70000000,                    +
              |         "min": 70000000,                    +
              |         "sum": 70000000,                    +
              |         "mean": 70000000.00,                +
              |         "type": "number",                   +
              |         "count": 1,                         +
              |         "stddev": 0.00,                     +
              |         "variance": 0.00,                   +
              |         "sum_sq_diff": 0.00,                +
              |         "coefficient_of_variation_pct": 0.00+
              |     },                                      +
              |     "employees": {                          +
              |         "max": 45,                          +
              |         "min": 45,                          +
              |         "sum": 45,                          +
              |         "mean": 45.00,                      +
              |         "type": "number",                   +
              |         "count": 1,                         +
              |         "stddev": 0.00,                     +
              |         "variance": 0.00,                   +
              |         "sum_sq_diff": 0.00,                +
              |         "coefficient_of_variation_pct": 0.00+
              |     }                                       +
              | }

\x
\echo "Checking timeline_enterprise data"
"Checking timeline_enterprise data"
WITH timeline_enterprise_with_tax_ident AS (
    SELECT te_base.*,
           eei.external_idents->>'tax_ident' AS tax_ident
    FROM public.timeline_enterprise AS te_base
    LEFT JOIN public.enterprise_external_idents AS eei
           ON eei.unit_type = te_base.unit_type
          AND eei.unit_id = te_base.unit_id
          AND daterange(eei.valid_from, eei.valid_until, '[)')
           && daterange(te_base.valid_from, te_base.valid_until, '[)')
)
SELECT te.unit_type
     , te.tax_ident
     , te.valid_from
     , te.valid_to
     , te.valid_until
     , te.name
     , te.birth_date
     , te.death_date
     , te.search
     , te.primary_activity_category_path
     , te.secondary_activity_category_path
     , te.activity_category_paths
     , te.sector_path
     , te.sector_code
     , te.sector_name
     , te.data_source_codes
     , te.legal_form_code
     , te.legal_form_name
     , te.physical_address_part1
     , te.physical_address_part2
     , te.physical_address_part3
     , te.physical_postcode
     , te.physical_postplace
     , te.physical_region_path
     , te.physical_country_iso_2
     , te.postal_address_part1
     , te.postal_address_part2
     , te.postal_address_part3
     , te.postal_postcode
     , te.postal_postplace
     , te.postal_region_path
     , te.postal_country_iso_2
     , te.invalid_codes
FROM timeline_enterprise_with_tax_ident AS te
ORDER BY te.unit_type, te.tax_ident, te.valid_from, te.valid_until;
 unit_type  | tax_ident | valid_from |  valid_to  | valid_until |         name          | birth_date | death_date |             search              | primary_activity_category_path | secondary_activity_category_path | activity_category_paths |     sector_path      | sector_code |        sector_name         | data_source_codes | legal_form_code |   legal_form_name   | physical_address_part1 | physical_address_part2 | physical_address_part3 | physical_postcode | physical_postplace | physical_region_path | physical_country_iso_2 | postal_address_part1 | postal_address_part2 | postal_address_part3 | postal_postcode | postal_postplace | postal_region_path | postal_country_iso_2 | invalid_codes 
------------+-----------+------------+------------+-------------+-----------------------+------------+------------+---------------------------------+--------------------------------+----------------------------------+-------------------------+----------------------+-------------+----------------------------+-------------------+-----------------+---------------------+------------------------+------------------------+------------------------+-------------------+--------------------+----------------------+------------------------+----------------------+----------------------+----------------------+-----------------+------------------+--------------------+----------------------+---------------
 enterprise | 823573673 | 2010-01-01 | 2012-12-31 | 2013-01-01  | KRANLØFT ENK          | 2010-01-01 | 2012-12-31 | 'enk':2 'kranløft':1            | H.49.4.1.0                     |                                  | {H.49.4.1.0}            | innl.a_ikke_fin.2100 | 2100        | Private aksjeselskaper mv. | {brreg,skatt}     | ENK             | Enkeltpersonforetak | Vestlyvegen 219        |                        |                        | 4347              | LYE                | 11.21                | NO                     |                      |                      |                      |                 |                  |                    |                      | 
 enterprise | 921835809 | 2013-01-01 | 2015-12-31 | 2016-01-01  | KRAN & SPESIALLØFT AS | 2013-01-01 |            | 'as':3 'kran':1 'spesialløft':2 | H.49.4.1.0                     |                                  | {H.49.4.1.0}            | innl.a_ikke_fin.2100 | 2100        | Private aksjeselskaper mv. | {brreg,skatt}     | AS              | Aksjeselskap        | Vestlyvegen 219        |                        |                        | 4347              | LYE                | 11.21                | NO                     |                      |                      |                      |                 |                  |                    |                      | 
 enterprise | 921835809 | 2016-01-01 | 2018-12-31 | 2019-01-01  | KRAN & SPESIALLØFT AS | 2013-01-01 |            | 'as':3 'kran':1 'spesialløft':2 | H.49.4.1.0                     |                                  | {H.49.4.1.0}            | innl.a_ikke_fin.2100 | 2100        | Private aksjeselskaper mv. | {brreg,skatt}     | AS              | Aksjeselskap        | Vestlyvegen 219        |                        |                        | 4347              | LYE                | 11.21                | NO                     |                      |                      |                      |                 |                  |                    |                      | 
 enterprise | 921835809 | 2019-01-01 | 2019-02-28 | 2019-03-01  | KRAN & SPESIALLØFT AS | 2013-01-01 |            | 'as':3 'kran':1 'spesialløft':2 | H.49.4.1.0                     |                                  | {H.49.4.1.0}            | innl.a_ikke_fin.2100 | 2100        | Private aksjeselskaper mv. | {brreg,skatt}     | AS              | Aksjeselskap        | Vestlyvegen 219        |                        |                        | 4347              | LYE                | 11.21                | NO                     |                      |                      |                      |                 |                  |                    |                      | 
 enterprise | 921835809 | 2019-03-01 | 2019-04-30 | 2019-05-01  | KRAN & SPESIALLØFT AS | 2013-01-01 |            | 'as':3 'kran':1 'spesialløft':2 | H.49.4.1.0                     |                                  | {H.49.4.1.0}            | innl.a_ikke_fin.2100 | 2100        | Private aksjeselskaper mv. | {brreg,skatt}     | AS              | Aksjeselskap        | Vestlyvegen 219        |                        |                        | 4347              | LYE                | 11.21                | NO                     |                      |                      |                      |                 |                  |                    |                      | 
 enterprise | 921835809 | 2019-05-01 | 2019-06-30 | 2019-07-01  | KRAN & SPESIALLØFT AS | 2013-01-01 |            | 'as':3 'kran':1 'spesialløft':2 | H.49.4.1.0                     |                                  | {H.49.4.1.0}            | innl.a_ikke_fin.2100 | 2100        | Private aksjeselskaper mv. | {brreg,skatt}     | AS              | Aksjeselskap        | Vestlyvegen 219        |                        |                        | 4347              | LYE                | 11.21                | NO                     |                      |                      |                      |                 |                  |                    |                      | 
 enterprise | 921835809 | 2019-07-01 | 2019-08-31 | 2019-09-01  | KRAN & SPESIALLØFT AS | 2013-01-01 |            | 'as':3 'kran':1 'spesialløft':2 | H.49.4.1.0                     |                                  | {H.49.4.1.0}            | innl.a_ikke_fin.2100 | 2100        | Private aksjeselskaper mv. | {brreg,skatt}     | AS              | Aksjeselskap        | Vestlyvegen 219        |                        |                        | 4347              | LYE                | 11.21                | NO                     |                      |                      |                      |                 |                  |                    |                      | 
 enterprise | 921835809 | 2019-09-01 | 2019-10-31 | 2019-11-01  | KRAN & SPESIALLØFT AS | 2013-01-01 |            | 'as':3 'kran':1 'spesialløft':2 | H.49.4.1.0                     |                                  | {H.49.4.1.0}            | innl.a_ikke_fin.2100 | 2100        | Private aksjeselskaper mv. | {brreg,skatt}     | AS              | Aksjeselskap        | Vestlyvegen 219        |                        |                        | 4347              | LYE                | 11.21                | NO                     |                      |                      |                      |                 |                  |                    |                      | 
 enterprise | 921835809 | 2019-11-01 | 2019-12-31 | 2020-01-01  | KRAN & SPESIALLØFT AS | 2013-01-01 |            | 'as':3 'kran':1 'spesialløft':2 | H.49.4.1.0                     |                                  | {H.49.4.1.0}            | innl.a_ikke_fin.2100 | 2100        | Private aksjeselskaper mv. | {brreg,skatt}     | AS              | Aksjeselskap        | Vestlyvegen 219        |                        |                        | 4347              | LYE                | 11.21                | NO                     |                      |                      |                      |                 |                  |                    |                      | 
 enterprise | 921835809 | 2020-01-01 | infinity   | infinity    | KRAN & SPESIALLØFT AS | 2013-01-01 |            | 'as':3 'kran':1 'spesialløft':2 | H.49.4.1.0                     |                                  | {H.49.4.1.0}            | innl.a_ikke_fin.2100 | 2100        | Private aksjeselskaper mv. | {brreg,skatt}     | AS              | Aksjeselskap        | Vestlyvegen 219        |                        |                        | 4347              | LYE                | 11.21                | NO                     |                      |                      |                      |                 |                  |                    |                      | 
(10 rows)

\x
\echo "Checking timeline_enterprise stats"
"Checking timeline_enterprise stats"
WITH timeline_enterprise_stats_with_tax_ident AS (
    SELECT tes_base.*,
           eei.external_idents->>'tax_ident' AS tax_ident
    FROM public.timeline_enterprise AS tes_base
    LEFT JOIN public.enterprise_external_idents AS eei
           ON eei.unit_type = tes_base.unit_type
          AND eei.unit_id = tes_base.unit_id
          AND daterange(eei.valid_from, eei.valid_until, '[)')
           && daterange(tes_base.valid_from, tes_base.valid_until, '[)')
)
SELECT unit_type
     , tax_ident
     , valid_from
     , valid_to
     , valid_until
     , name
     , jsonb_pretty(stats_summary) AS stats_summary
FROM timeline_enterprise_stats_with_tax_ident
ORDER BY unit_type, tax_ident, valid_from, valid_until;
-[ RECORD 1 ]-+---------------------------------------------
unit_type     | enterprise
tax_ident     | 823573673
valid_from    | 2010-01-01
valid_to      | 2012-12-31
valid_until   | 2013-01-01
name          | KRANLØFT ENK
stats_summary | {                                           +
              |     "turnover": {                           +
              |         "max": 1500000,                     +
              |         "min": 1500000,                     +
              |         "sum": 1500000,                     +
              |         "mean": 1500000.00,                 +
              |         "type": "number",                   +
              |         "count": 1,                         +
              |         "stddev": 0.00,                     +
              |         "variance": 0.00,                   +
              |         "sum_sq_diff": 0.00,                +
              |         "coefficient_of_variation_pct": 0.00+
              |     },                                      +
              |     "employees": {                          +
              |         "max": 1,                           +
              |         "min": 1,                           +
              |         "sum": 1,                           +
              |         "mean": 1.00,                       +
              |         "type": "number",                   +
              |         "count": 1,                         +
              |         "stddev": 0.00,                     +
              |         "variance": 0.00,                   +
              |         "sum_sq_diff": 0.00,                +
              |         "coefficient_of_variation_pct": 0.00+
              |     }                                       +
              | }
-[ RECORD 2 ]-+---------------------------------------------
unit_type     | enterprise
tax_ident     | 921835809
valid_from    | 2013-01-01
valid_to      | 2015-12-31
valid_until   | 2016-01-01
name          | KRAN & SPESIALLØFT AS
stats_summary | {                                           +
              |     "turnover": {                           +
              |         "max": 3000000,                     +
              |         "min": 3000000,                     +
              |         "sum": 3000000,                     +
              |         "mean": 3000000.00,                 +
              |         "type": "number",                   +
              |         "count": 1,                         +
              |         "stddev": 0.00,                     +
              |         "variance": 0.00,                   +
              |         "sum_sq_diff": 0.00,                +
              |         "coefficient_of_variation_pct": 0.00+
              |     },                                      +
              |     "employees": {                          +
              |         "max": 3,                           +
              |         "min": 3,                           +
              |         "sum": 3,                           +
              |         "mean": 3.00,                       +
              |         "type": "number",                   +
              |         "count": 1,                         +
              |         "stddev": 0.00,                     +
              |         "variance": 0.00,                   +
              |         "sum_sq_diff": 0.00,                +
              |         "coefficient_of_variation_pct": 0.00+
              |     }                                       +
              | }
-[ RECORD 3 ]-+---------------------------------------------
unit_type     | enterprise
tax_ident     | 921835809
valid_from    | 2016-01-01
valid_to      | 2018-12-31
valid_until   | 2019-01-01
name          | KRAN & SPESIALLØFT AS
stats_summary | {                                           +
              |     "turnover": {                           +
              |         "max": 12000000,                    +
              |         "min": 12000000,                    +
              |         "sum": 12000000,                    +
              |         "mean": 12000000.00,                +
              |         "type": "number",                   +
              |         "count": 1,                         +
              |         "stddev": 0.00,                     +
              |         "variance": 0.00,                   +
              |         "sum_sq_diff": 0.00,                +
              |         "coefficient_of_variation_pct": 0.00+
              |     },                                      +
              |     "employees": {                          +
              |         "max": 9,                           +
              |         "min": 9,                           +
              |         "sum": 9,                           +
              |         "mean": 9.00,                       +
              |         "type": "number",                   +
              |         "count": 1,                         +
              |         "stddev": 0.00,                     +
              |         "variance": 0.00,                   +
              |         "sum_sq_diff": 0.00,                +
              |         "coefficient_of_variation_pct": 0.00+
              |     }                                       +
              | }
-[ RECORD 4 ]-+---------------------------------------------
unit_type     | enterprise
tax_ident     | 921835809
valid_from    | 2019-01-01
valid_to      | 2019-02-28
valid_until   | 2019-03-01
name          | KRAN & SPESIALLØFT AS
stats_summary | {                                           +
              |     "turnover": {                           +
              |         "max": 60000000,                    +
              |         "min": 60000000,                    +
              |         "sum": 60000000,                    +
              |         "mean": 60000000.00,                +
              |         "type": "number",                   +
              |         "count": 1,                         +
              |         "stddev": 0.00,                     +
              |         "variance": 0.00,                   +
              |         "sum_sq_diff": 0.00,                +
              |         "coefficient_of_variation_pct": 0.00+
              |     },                                      +
              |     "employees": {                          +
              |         "max": 25,                          +
              |         "min": 25,                          +
              |         "sum": 25,                          +
              |         "mean": 25.00,                      +
              |         "type": "number",                   +
              |         "count": 1,                         +
              |         "stddev": 0.00,                     +
              |         "variance": 0.00,                   +
              |         "sum_sq_diff": 0.00,                +
              |         "coefficient_of_variation_pct": 0.00+
              |     }                                       +
              | }
-[ RECORD 5 ]-+---------------------------------------------
unit_type     | enterprise
tax_ident     | 921835809
valid_from    | 2019-03-01
valid_to      | 2019-04-30
valid_until   | 2019-05-01
name          | KRAN & SPESIALLØFT AS
stats_summary | {                                           +
              |     "turnover": {                           +
              |         "max": 60000000,                    +
              |         "min": 60000000,                    +
              |         "sum": 60000000,                    +
              |         "mean": 60000000.00,                +
              |         "type": "number",                   +
              |         "count": 1,                         +
              |         "stddev": 0.00,                     +
              |         "variance": 0.00,                   +
              |         "sum_sq_diff": 0.00,                +
              |         "coefficient_of_variation_pct": 0.00+
              |     },                                      +
              |     "employees": {                          +
              |         "max": 30,                          +
              |         "min": 30,                          +
              |         "sum": 30,                          +
              |         "mean": 30.00,                      +
              |         "type": "number",                   +
              |         "count": 1,                         +
              |         "stddev": 0.00,                     +
              |         "variance": 0.00,                   +
              |         "sum_sq_diff": 0.00,                +
              |         "coefficient_of_variation_pct": 0.00+
              |     }                                       +
              | }
-[ RECORD 6 ]-+---------------------------------------------
unit_type     | enterprise
tax_ident     | 921835809
valid_from    | 2019-05-01
valid_to      | 2019-06-30
valid_until   | 2019-07-01
name          | KRAN & SPESIALLØFT AS
stats_summary | {                                           +
              |     "turnover": {                           +
              |         "max": 60000000,                    +
              |         "min": 60000000,                    +
              |         "sum": 60000000,                    +
              |         "mean": 60000000.00,                +
              |         "type": "number",                   +
              |         "count": 1,                         +
              |         "stddev": 0.00,                     +
              |         "variance": 0.00,                   +
              |         "sum_sq_diff": 0.00,                +
              |         "coefficient_of_variation_pct": 0.00+
              |     },                                      +
              |     "employees": {                          +
              |         "max": 35,                          +
              |         "min": 35,                          +
              |         "sum": 35,                          +
              |         "mean": 35.00,                      +
              |         "type": "number",                   +
              |         "count": 1,                         +
              |         "stddev": 0.00,                     +
              |         "variance": 0.00,                   +
              |         "sum_sq_diff": 0.00,                +
              |         "coefficient_of_variation_pct": 0.00+
              |     }                                       +
              | }
-[ RECORD 7 ]-+---------------------------------------------
unit_type     | enterprise
tax_ident     | 921835809
valid_from    | 2019-07-01
valid_to      | 2019-08-31
valid_until   | 2019-09-01
name          | KRAN & SPESIALLØFT AS
stats_summary | {                                           +
              |     "turnover": {                           +
              |         "max": 60000000,                    +
              |         "min": 60000000,                    +
              |         "sum": 60000000,                    +
              |         "mean": 60000000.00,                +
              |         "type": "number",                   +
              |         "count": 1,                         +
              |         "stddev": 0.00,                     +
              |         "variance": 0.00,                   +
              |         "sum_sq_diff": 0.00,                +
              |         "coefficient_of_variation_pct": 0.00+
              |     },                                      +
              |     "employees": {                          +
              |         "max": 40,                          +
              |         "min": 40,                          +
              |         "sum": 40,                          +
              |         "mean": 40.00,                      +
              |         "type": "number",                   +
              |         "count": 1,                         +
              |         "stddev": 0.00,                     +
              |         "variance": 0.00,                   +
              |         "sum_sq_diff": 0.00,                +
              |         "coefficient_of_variation_pct": 0.00+
              |     }                                       +
              | }
-[ RECORD 8 ]-+---------------------------------------------
unit_type     | enterprise
tax_ident     | 921835809
valid_from    | 2019-09-01
valid_to      | 2019-10-31
valid_until   | 2019-11-01
name          | KRAN & SPESIALLØFT AS
stats_summary | {                                           +
              |     "turnover": {                           +
              |         "max": 60000000,                    +
              |         "min": 60000000,                    +
              |         "sum": 60000000,                    +
              |         "mean": 60000000.00,                +
              |         "type": "number",                   +
              |         "count": 1,                         +
              |         "stddev": 0.00,                     +
              |         "variance": 0.00,                   +
              |         "sum_sq_diff": 0.00,                +
              |         "coefficient_of_variation_pct": 0.00+
              |     },                                      +
              |     "employees": {                          +
              |         "max": 50,                          +
              |         "min": 50,                          +
              |         "sum": 50,                          +
              |         "mean": 50.00,                      +
              |         "type": "number",                   +
              |         "count": 1,                         +
              |         "stddev": 0.00,                     +
              |         "variance": 0.00,                   +
              |         "sum_sq_diff": 0.00,                +
              |         "coefficient_of_variation_pct": 0.00+
              |     }                                       +
              | }
-[ RECORD 9 ]-+---------------------------------------------
unit_type     | enterprise
tax_ident     | 921835809
valid_from    | 2019-11-01
valid_to      | 2019-12-31
valid_until   | 2020-01-01
name          | KRAN & SPESIALLØFT AS
stats_summary | {                                           +
              |     "turnover": {                           +
              |         "max": 60000000,                    +
              |         "min": 60000000,                    +
              |         "sum": 60000000,                    +
              |         "mean": 60000000.00,                +
              |         "type": "number",                   +
              |         "count": 1,                         +
              |         "stddev": 0.00,                     +
              |         "variance": 0.00,                   +
              |         "sum_sq_diff": 0.00,                +
              |         "coefficient_of_variation_pct": 0.00+
              |     },                                      +
              |     "employees": {                          +
              |         "max": 40,                          +
              |         "min": 40,                          +
              |         "sum": 40,                          +
              |         "mean": 40.00,                      +
              |         "type": "number",                   +
              |         "count": 1,                         +
              |         "stddev": 0.00,                     +
              |         "variance": 0.00,                   +
              |         "sum_sq_diff": 0.00,                +
              |         "coefficient_of_variation_pct": 0.00+
              |     }                                       +
              | }
-[ RECORD 10 ]+---------------------------------------------
unit_type     | enterprise
tax_ident     | 921835809
valid_from    | 2020-01-01
valid_to      | infinity
valid_until   | infinity
name          | KRAN & SPESIALLØFT AS
stats_summary | {                                           +
              |     "turnover": {                           +
              |         "max": 70000000,                    +
              |         "min": 70000000,                    +
              |         "sum": 70000000,                    +
              |         "mean": 70000000.00,                +
              |         "type": "number",                   +
              |         "count": 1,                         +
              |         "stddev": 0.00,                     +
              |         "variance": 0.00,                   +
              |         "sum_sq_diff": 0.00,                +
              |         "coefficient_of_variation_pct": 0.00+
              |     },                                      +
              |     "employees": {                          +
              |         "max": 45,                          +
              |         "min": 45,                          +
              |         "sum": 45,                          +
              |         "mean": 45.00,                      +
              |         "type": "number",                   +
              |         "count": 1,                         +
              |         "stddev": 0.00,                     +
              |         "variance": 0.00,                   +
              |         "sum_sq_diff": 0.00,                +
              |         "coefficient_of_variation_pct": 0.00+
              |     }                                       +
              | }

\x
\x
\echo "Check statistical_unit"
"Check statistical_unit"
WITH statistical_unit_ordered AS (
    SELECT su_base.*,
           su_base.external_idents->>'tax_ident' AS tax_ident_for_ordering
    FROM public.statistical_unit AS su_base
)
SELECT valid_from
     , valid_to
     , valid_until
     , unit_type
     , external_idents
     , jsonb_pretty(
          public.remove_ephemeral_data_from_hierarchy(
          to_jsonb(statistical_unit_ordered.*)
          -'stats'
          -'stats_summary'
          -'valid_from'
          -'valid_to'
          -'unit_type'
          -'external_idents'
          -'tax_ident_for_ordering'
          )
     ) AS statistical_unit_data
     , jsonb_pretty(stats) AS stats
     , jsonb_pretty(stats_summary) AS stats_summary
 FROM statistical_unit_ordered
 ORDER BY valid_from, valid_until, unit_type, tax_ident_for_ordering;
-[ RECORD 1 ]---------+--------------------------------------------------------------------------------------
valid_from            | 2010-01-01
valid_to              | 2012-12-31
valid_until           | 2013-01-01
unit_type             | establishment
external_idents       | {"tax_ident": "895406732"}
statistical_unit_data | {                                                                                    +
                      |     "name": "KRANLØFT ENK",                                                          +
                      |     "search": "'enk':2 'kranløft':1",                                                +
                      |     "domestic": true,                                                                +
                      |     "landline": null,                                                                +
                      |     "tag_paths": [                                                                   +
                      |     ],                                                                               +
                      |     "birth_date": "2010-01-01",                                                      +
                      |     "death_date": null,                                                              +
                      |     "fax_number": null,                                                              +
                      |     "sector_code": null,                                                             +
                      |     "sector_name": null,                                                             +
                      |     "sector_path": null,                                                             +
                      |     "status_code": "active",                                                         +
                      |     "valid_until": "2013-01-01",                                                     +
                      |     "web_address": null,                                                             +
                      |     "phone_number": null,                                                            +
                      |     "email_address": null,                                                           +
                      |     "invalid_codes": null,                                                           +
                      |     "mobile_number": null,                                                           +
                      |     "has_legal_unit": true,                                                          +
                      |     "unit_size_code": "tny",                                                         +
                      |     "legal_form_code": null,                                                         +
                      |     "legal_form_name": null,                                                         +
                      |     "postal_altitude": null,                                                         +
                      |     "postal_latitude": null,                                                         +
                      |     "postal_postcode": null,                                                         +
                      |     "postal_longitude": null,                                                        +
                      |     "postal_postplace": null,                                                        +
                      |     "data_source_codes": [                                                           +
                      |         "brreg"                                                                      +
                      |     ],                                                                               +
                      |     "last_edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",+
                      |     "physical_altitude": null,                                                       +
                      |     "physical_latitude": null,                                                       +
                      |     "physical_postcode": "4347",                                                     +
                      |     "used_for_counting": true,                                                       +
                      |     "physical_longitude": null,                                                      +
                      |     "physical_postplace": "LYE",                                                     +
                      |     "postal_region_code": null,                                                      +
                      |     "postal_region_path": null,                                                      +
                      |     "physical_region_code": "1121",                                                  +
                      |     "physical_region_path": "11.21",                                                 +
                      |     "postal_address_part1": null,                                                    +
                      |     "postal_address_part2": null,                                                    +
                      |     "postal_address_part3": null,                                                    +
                      |     "postal_country_iso_2": null,                                                    +
                      |     "physical_address_part1": "Vestlyvegen 219",                                     +
                      |     "physical_address_part2": null,                                                  +
                      |     "physical_address_part3": null,                                                  +
                      |     "physical_country_iso_2": "NO",                                                  +
                      |     "activity_category_paths": [                                                     +
                      |         "H.49.4.1.0"                                                                 +
                      |     ],                                                                               +
                      |     "included_enterprise_count": null,                                               +
                      |     "included_legal_unit_count": null,                                               +
                      |     "included_establishment_count": 1,                                               +
                      |     "primary_activity_category_code": "49.410",                                      +
                      |     "primary_activity_category_path": "H.49.4.1.0",                                  +
                      |     "secondary_activity_category_code": null,                                        +
                      |     "secondary_activity_category_path": null                                         +
                      | }
stats                 | {                                                                                    +
                      |     "turnover": 1500000,                                                             +
                      |     "employees": 1                                                                   +
                      | }
stats_summary         | {                                                                                    +
                      |     "turnover": {                                                                    +
                      |         "max": 1500000,                                                              +
                      |         "min": 1500000,                                                              +
                      |         "sum": 1500000,                                                              +
                      |         "mean": 1500000,                                                             +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0,                                                                 +
                      |         "variance": 0,                                                               +
                      |         "sum_sq_diff": 0,                                                            +
                      |         "coefficient_of_variation_pct": 0                                            +
                      |     },                                                                               +
                      |     "employees": {                                                                   +
                      |         "max": 1,                                                                    +
                      |         "min": 1,                                                                    +
                      |         "sum": 1,                                                                    +
                      |         "mean": 1,                                                                   +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0,                                                                 +
                      |         "variance": 0,                                                               +
                      |         "sum_sq_diff": 0,                                                            +
                      |         "coefficient_of_variation_pct": 0                                            +
                      |     }                                                                                +
                      | }
-[ RECORD 2 ]---------+--------------------------------------------------------------------------------------
valid_from            | 2010-01-01
valid_to              | 2012-12-31
valid_until           | 2013-01-01
unit_type             | legal_unit
external_idents       | {"tax_ident": "823573673"}
statistical_unit_data | {                                                                                    +
                      |     "name": "KRANLØFT ENK",                                                          +
                      |     "search": "'enk':2 'kranløft':1",                                                +
                      |     "domestic": true,                                                                +
                      |     "landline": null,                                                                +
                      |     "tag_paths": [                                                                   +
                      |     ],                                                                               +
                      |     "birth_date": "2010-01-01",                                                      +
                      |     "death_date": "2012-12-31",                                                      +
                      |     "fax_number": null,                                                              +
                      |     "sector_code": "2100",                                                           +
                      |     "sector_name": "Private aksjeselskaper mv.",                                     +
                      |     "sector_path": "innl.a_ikke_fin.2100",                                           +
                      |     "status_code": "active",                                                         +
                      |     "valid_until": "2013-01-01",                                                     +
                      |     "web_address": null,                                                             +
                      |     "phone_number": null,                                                            +
                      |     "email_address": null,                                                           +
                      |     "invalid_codes": null,                                                           +
                      |     "mobile_number": null,                                                           +
                      |     "has_legal_unit": true,                                                          +
                      |     "unit_size_code": null,                                                          +
                      |     "legal_form_code": "ENK",                                                        +
                      |     "legal_form_name": "Enkeltpersonforetak",                                        +
                      |     "postal_altitude": null,                                                         +
                      |     "postal_latitude": null,                                                         +
                      |     "postal_postcode": null,                                                         +
                      |     "postal_longitude": null,                                                        +
                      |     "postal_postplace": null,                                                        +
                      |     "data_source_codes": [                                                           +
                      |         "brreg",                                                                     +
                      |         "skatt"                                                                      +
                      |     ],                                                                               +
                      |     "last_edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",+
                      |     "physical_altitude": null,                                                       +
                      |     "physical_latitude": null,                                                       +
                      |     "physical_postcode": "4347",                                                     +
                      |     "used_for_counting": true,                                                       +
                      |     "physical_longitude": null,                                                      +
                      |     "physical_postplace": "LYE",                                                     +
                      |     "postal_region_code": null,                                                      +
                      |     "postal_region_path": null,                                                      +
                      |     "physical_region_code": "1121",                                                  +
                      |     "physical_region_path": "11.21",                                                 +
                      |     "postal_address_part1": null,                                                    +
                      |     "postal_address_part2": null,                                                    +
                      |     "postal_address_part3": null,                                                    +
                      |     "postal_country_iso_2": null,                                                    +
                      |     "physical_address_part1": "Vestlyvegen 219",                                     +
                      |     "physical_address_part2": null,                                                  +
                      |     "physical_address_part3": null,                                                  +
                      |     "physical_country_iso_2": "NO",                                                  +
                      |     "activity_category_paths": [                                                     +
                      |         "H.49.4.1.0"                                                                 +
                      |     ],                                                                               +
                      |     "included_enterprise_count": null,                                               +
                      |     "included_legal_unit_count": 1,                                                  +
                      |     "included_establishment_count": 1,                                               +
                      |     "primary_activity_category_code": "49.410",                                      +
                      |     "primary_activity_category_path": "H.49.4.1.0",                                  +
                      |     "secondary_activity_category_code": null,                                        +
                      |     "secondary_activity_category_path": null                                         +
                      | }
stats                 | {                                                                                    +
                      | }
stats_summary         | {                                                                                    +
                      |     "turnover": {                                                                    +
                      |         "max": 1500000,                                                              +
                      |         "min": 1500000,                                                              +
                      |         "sum": 1500000,                                                              +
                      |         "mean": 1500000.00,                                                          +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0.00,                                                              +
                      |         "variance": 0.00,                                                            +
                      |         "sum_sq_diff": 0.00,                                                         +
                      |         "coefficient_of_variation_pct": 0.00                                         +
                      |     },                                                                               +
                      |     "employees": {                                                                   +
                      |         "max": 1,                                                                    +
                      |         "min": 1,                                                                    +
                      |         "sum": 1,                                                                    +
                      |         "mean": 1.00,                                                                +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0.00,                                                              +
                      |         "variance": 0.00,                                                            +
                      |         "sum_sq_diff": 0.00,                                                         +
                      |         "coefficient_of_variation_pct": 0.00                                         +
                      |     }                                                                                +
                      | }
-[ RECORD 3 ]---------+--------------------------------------------------------------------------------------
valid_from            | 2010-01-01
valid_to              | 2012-12-31
valid_until           | 2013-01-01
unit_type             | enterprise
external_idents       | {"tax_ident": "823573673"}
statistical_unit_data | {                                                                                    +
                      |     "name": "KRANLØFT ENK",                                                          +
                      |     "search": "'enk':2 'kranløft':1",                                                +
                      |     "domestic": true,                                                                +
                      |     "landline": null,                                                                +
                      |     "tag_paths": [                                                                   +
                      |     ],                                                                               +
                      |     "birth_date": "2010-01-01",                                                      +
                      |     "death_date": "2012-12-31",                                                      +
                      |     "fax_number": null,                                                              +
                      |     "sector_code": "2100",                                                           +
                      |     "sector_name": "Private aksjeselskaper mv.",                                     +
                      |     "sector_path": "innl.a_ikke_fin.2100",                                           +
                      |     "status_code": "active",                                                         +
                      |     "valid_until": "2013-01-01",                                                     +
                      |     "web_address": null,                                                             +
                      |     "phone_number": null,                                                            +
                      |     "email_address": null,                                                           +
                      |     "invalid_codes": null,                                                           +
                      |     "mobile_number": null,                                                           +
                      |     "has_legal_unit": true,                                                          +
                      |     "unit_size_code": null,                                                          +
                      |     "legal_form_code": "ENK",                                                        +
                      |     "legal_form_name": "Enkeltpersonforetak",                                        +
                      |     "postal_altitude": null,                                                         +
                      |     "postal_latitude": null,                                                         +
                      |     "postal_postcode": null,                                                         +
                      |     "postal_longitude": null,                                                        +
                      |     "postal_postplace": null,                                                        +
                      |     "data_source_codes": [                                                           +
                      |         "brreg",                                                                     +
                      |         "skatt"                                                                      +
                      |     ],                                                                               +
                      |     "last_edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",+
                      |     "physical_altitude": null,                                                       +
                      |     "physical_latitude": null,                                                       +
                      |     "physical_postcode": "4347",                                                     +
                      |     "used_for_counting": true,                                                       +
                      |     "physical_longitude": null,                                                      +
                      |     "physical_postplace": "LYE",                                                     +
                      |     "postal_region_code": null,                                                      +
                      |     "postal_region_path": null,                                                      +
                      |     "physical_region_code": "1121",                                                  +
                      |     "physical_region_path": "11.21",                                                 +
                      |     "postal_address_part1": null,                                                    +
                      |     "postal_address_part2": null,                                                    +
                      |     "postal_address_part3": null,                                                    +
                      |     "postal_country_iso_2": null,                                                    +
                      |     "physical_address_part1": "Vestlyvegen 219",                                     +
                      |     "physical_address_part2": null,                                                  +
                      |     "physical_address_part3": null,                                                  +
                      |     "physical_country_iso_2": "NO",                                                  +
                      |     "activity_category_paths": [                                                     +
                      |         "H.49.4.1.0"                                                                 +
                      |     ],                                                                               +
                      |     "included_enterprise_count": 1,                                                  +
                      |     "included_legal_unit_count": 1,                                                  +
                      |     "included_establishment_count": 1,                                               +
                      |     "primary_activity_category_code": "49.410",                                      +
                      |     "primary_activity_category_path": "H.49.4.1.0",                                  +
                      |     "secondary_activity_category_code": null,                                        +
                      |     "secondary_activity_category_path": null                                         +
                      | }
stats                 | 
stats_summary         | {                                                                                    +
                      |     "turnover": {                                                                    +
                      |         "max": 1500000,                                                              +
                      |         "min": 1500000,                                                              +
                      |         "sum": 1500000,                                                              +
                      |         "mean": 1500000.00,                                                          +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0.00,                                                              +
                      |         "variance": 0.00,                                                            +
                      |         "sum_sq_diff": 0.00,                                                         +
                      |         "coefficient_of_variation_pct": 0.00                                         +
                      |     },                                                                               +
                      |     "employees": {                                                                   +
                      |         "max": 1,                                                                    +
                      |         "min": 1,                                                                    +
                      |         "sum": 1,                                                                    +
                      |         "mean": 1.00,                                                                +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0.00,                                                              +
                      |         "variance": 0.00,                                                            +
                      |         "sum_sq_diff": 0.00,                                                         +
                      |         "coefficient_of_variation_pct": 0.00                                         +
                      |     }                                                                                +
                      | }
-[ RECORD 4 ]---------+--------------------------------------------------------------------------------------
valid_from            | 2013-01-01
valid_to              | 2015-12-31
valid_until           | 2016-01-01
unit_type             | establishment
external_idents       | {"tax_ident": "895406732"}
statistical_unit_data | {                                                                                    +
                      |     "name": "KRAN & SPESIALLØFT AS",                                                 +
                      |     "search": "'as':3 'kran':1 'spesialløft':2",                                     +
                      |     "domestic": true,                                                                +
                      |     "landline": null,                                                                +
                      |     "tag_paths": [                                                                   +
                      |     ],                                                                               +
                      |     "birth_date": "2010-01-01",                                                      +
                      |     "death_date": null,                                                              +
                      |     "fax_number": null,                                                              +
                      |     "sector_code": null,                                                             +
                      |     "sector_name": null,                                                             +
                      |     "sector_path": null,                                                             +
                      |     "status_code": "active",                                                         +
                      |     "valid_until": "2016-01-01",                                                     +
                      |     "web_address": null,                                                             +
                      |     "phone_number": null,                                                            +
                      |     "email_address": null,                                                           +
                      |     "invalid_codes": null,                                                           +
                      |     "mobile_number": null,                                                           +
                      |     "has_legal_unit": true,                                                          +
                      |     "unit_size_code": "tny",                                                         +
                      |     "legal_form_code": null,                                                         +
                      |     "legal_form_name": null,                                                         +
                      |     "postal_altitude": null,                                                         +
                      |     "postal_latitude": null,                                                         +
                      |     "postal_postcode": null,                                                         +
                      |     "postal_longitude": null,                                                        +
                      |     "postal_postplace": null,                                                        +
                      |     "data_source_codes": [                                                           +
                      |         "brreg"                                                                      +
                      |     ],                                                                               +
                      |     "last_edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",+
                      |     "physical_altitude": null,                                                       +
                      |     "physical_latitude": null,                                                       +
                      |     "physical_postcode": "4347",                                                     +
                      |     "used_for_counting": true,                                                       +
                      |     "physical_longitude": null,                                                      +
                      |     "physical_postplace": "LYE",                                                     +
                      |     "postal_region_code": null,                                                      +
                      |     "postal_region_path": null,                                                      +
                      |     "physical_region_code": "1121",                                                  +
                      |     "physical_region_path": "11.21",                                                 +
                      |     "postal_address_part1": null,                                                    +
                      |     "postal_address_part2": null,                                                    +
                      |     "postal_address_part3": null,                                                    +
                      |     "postal_country_iso_2": null,                                                    +
                      |     "physical_address_part1": "Vestlyvegen 219",                                     +
                      |     "physical_address_part2": null,                                                  +
                      |     "physical_address_part3": null,                                                  +
                      |     "physical_country_iso_2": "NO",                                                  +
                      |     "activity_category_paths": [                                                     +
                      |         "H.49.4.1.0"                                                                 +
                      |     ],                                                                               +
                      |     "included_enterprise_count": null,                                               +
                      |     "included_legal_unit_count": null,                                               +
                      |     "included_establishment_count": 1,                                               +
                      |     "primary_activity_category_code": "49.410",                                      +
                      |     "primary_activity_category_path": "H.49.4.1.0",                                  +
                      |     "secondary_activity_category_code": null,                                        +
                      |     "secondary_activity_category_path": null                                         +
                      | }
stats                 | {                                                                                    +
                      |     "turnover": 3000000,                                                             +
                      |     "employees": 3                                                                   +
                      | }
stats_summary         | {                                                                                    +
                      |     "turnover": {                                                                    +
                      |         "max": 3000000,                                                              +
                      |         "min": 3000000,                                                              +
                      |         "sum": 3000000,                                                              +
                      |         "mean": 3000000,                                                             +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0,                                                                 +
                      |         "variance": 0,                                                               +
                      |         "sum_sq_diff": 0,                                                            +
                      |         "coefficient_of_variation_pct": 0                                            +
                      |     },                                                                               +
                      |     "employees": {                                                                   +
                      |         "max": 3,                                                                    +
                      |         "min": 3,                                                                    +
                      |         "sum": 3,                                                                    +
                      |         "mean": 3,                                                                   +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0,                                                                 +
                      |         "variance": 0,                                                               +
                      |         "sum_sq_diff": 0,                                                            +
                      |         "coefficient_of_variation_pct": 0                                            +
                      |     }                                                                                +
                      | }
-[ RECORD 5 ]---------+--------------------------------------------------------------------------------------
valid_from            | 2013-01-01
valid_to              | 2015-12-31
valid_until           | 2016-01-01
unit_type             | legal_unit
external_idents       | {"tax_ident": "921835809"}
statistical_unit_data | {                                                                                    +
                      |     "name": "KRAN & SPESIALLØFT AS",                                                 +
                      |     "search": "'as':3 'kran':1 'spesialløft':2",                                     +
                      |     "domestic": true,                                                                +
                      |     "landline": null,                                                                +
                      |     "tag_paths": [                                                                   +
                      |     ],                                                                               +
                      |     "birth_date": "2013-01-01",                                                      +
                      |     "death_date": null,                                                              +
                      |     "fax_number": null,                                                              +
                      |     "sector_code": "2100",                                                           +
                      |     "sector_name": "Private aksjeselskaper mv.",                                     +
                      |     "sector_path": "innl.a_ikke_fin.2100",                                           +
                      |     "status_code": "active",                                                         +
                      |     "valid_until": "2016-01-01",                                                     +
                      |     "web_address": null,                                                             +
                      |     "phone_number": null,                                                            +
                      |     "email_address": null,                                                           +
                      |     "invalid_codes": null,                                                           +
                      |     "mobile_number": null,                                                           +
                      |     "has_legal_unit": true,                                                          +
                      |     "unit_size_code": null,                                                          +
                      |     "legal_form_code": "AS",                                                         +
                      |     "legal_form_name": "Aksjeselskap",                                               +
                      |     "postal_altitude": null,                                                         +
                      |     "postal_latitude": null,                                                         +
                      |     "postal_postcode": null,                                                         +
                      |     "postal_longitude": null,                                                        +
                      |     "postal_postplace": null,                                                        +
                      |     "data_source_codes": [                                                           +
                      |         "brreg",                                                                     +
                      |         "skatt"                                                                      +
                      |     ],                                                                               +
                      |     "last_edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",+
                      |     "physical_altitude": null,                                                       +
                      |     "physical_latitude": null,                                                       +
                      |     "physical_postcode": "4347",                                                     +
                      |     "used_for_counting": true,                                                       +
                      |     "physical_longitude": null,                                                      +
                      |     "physical_postplace": "LYE",                                                     +
                      |     "postal_region_code": null,                                                      +
                      |     "postal_region_path": null,                                                      +
                      |     "physical_region_code": "1121",                                                  +
                      |     "physical_region_path": "11.21",                                                 +
                      |     "postal_address_part1": null,                                                    +
                      |     "postal_address_part2": null,                                                    +
                      |     "postal_address_part3": null,                                                    +
                      |     "postal_country_iso_2": null,                                                    +
                      |     "physical_address_part1": "Vestlyvegen 219",                                     +
                      |     "physical_address_part2": null,                                                  +
                      |     "physical_address_part3": null,                                                  +
                      |     "physical_country_iso_2": "NO",                                                  +
                      |     "activity_category_paths": [                                                     +
                      |         "H.49.4.1.0"                                                                 +
                      |     ],                                                                               +
                      |     "included_enterprise_count": null,                                               +
                      |     "included_legal_unit_count": 1,                                                  +
                      |     "included_establishment_count": 1,                                               +
                      |     "primary_activity_category_code": "49.410",                                      +
                      |     "primary_activity_category_path": "H.49.4.1.0",                                  +
                      |     "secondary_activity_category_code": null,                                        +
                      |     "secondary_activity_category_path": null                                         +
                      | }
stats                 | {                                                                                    +
                      | }
stats_summary         | {                                                                                    +
                      |     "turnover": {                                                                    +
                      |         "max": 3000000,                                                              +
                      |         "min": 3000000,                                                              +
                      |         "sum": 3000000,                                                              +
                      |         "mean": 3000000.00,                                                          +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0.00,                                                              +
                      |         "variance": 0.00,                                                            +
                      |         "sum_sq_diff": 0.00,                                                         +
                      |         "coefficient_of_variation_pct": 0.00                                         +
                      |     },                                                                               +
                      |     "employees": {                                                                   +
                      |         "max": 3,                                                                    +
                      |         "min": 3,                                                                    +
                      |         "sum": 3,                                                                    +
                      |         "mean": 3.00,                                                                +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0.00,                                                              +
                      |         "variance": 0.00,                                                            +
                      |         "sum_sq_diff": 0.00,                                                         +
                      |         "coefficient_of_variation_pct": 0.00                                         +
                      |     }                                                                                +
                      | }
-[ RECORD 6 ]---------+--------------------------------------------------------------------------------------
valid_from            | 2013-01-01
valid_to              | 2015-12-31
valid_until           | 2016-01-01
unit_type             | enterprise
external_idents       | {"tax_ident": "921835809"}
statistical_unit_data | {                                                                                    +
                      |     "name": "KRAN & SPESIALLØFT AS",                                                 +
                      |     "search": "'as':3 'kran':1 'spesialløft':2",                                     +
                      |     "domestic": true,                                                                +
                      |     "landline": null,                                                                +
                      |     "tag_paths": [                                                                   +
                      |     ],                                                                               +
                      |     "birth_date": "2013-01-01",                                                      +
                      |     "death_date": null,                                                              +
                      |     "fax_number": null,                                                              +
                      |     "sector_code": "2100",                                                           +
                      |     "sector_name": "Private aksjeselskaper mv.",                                     +
                      |     "sector_path": "innl.a_ikke_fin.2100",                                           +
                      |     "status_code": "active",                                                         +
                      |     "valid_until": "2016-01-01",                                                     +
                      |     "web_address": null,                                                             +
                      |     "phone_number": null,                                                            +
                      |     "email_address": null,                                                           +
                      |     "invalid_codes": null,                                                           +
                      |     "mobile_number": null,                                                           +
                      |     "has_legal_unit": true,                                                          +
                      |     "unit_size_code": null,                                                          +
                      |     "legal_form_code": "AS",                                                         +
                      |     "legal_form_name": "Aksjeselskap",                                               +
                      |     "postal_altitude": null,                                                         +
                      |     "postal_latitude": null,                                                         +
                      |     "postal_postcode": null,                                                         +
                      |     "postal_longitude": null,                                                        +
                      |     "postal_postplace": null,                                                        +
                      |     "data_source_codes": [                                                           +
                      |         "brreg",                                                                     +
                      |         "skatt"                                                                      +
                      |     ],                                                                               +
                      |     "last_edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",+
                      |     "physical_altitude": null,                                                       +
                      |     "physical_latitude": null,                                                       +
                      |     "physical_postcode": "4347",                                                     +
                      |     "used_for_counting": true,                                                       +
                      |     "physical_longitude": null,                                                      +
                      |     "physical_postplace": "LYE",                                                     +
                      |     "postal_region_code": null,                                                      +
                      |     "postal_region_path": null,                                                      +
                      |     "physical_region_code": "1121",                                                  +
                      |     "physical_region_path": "11.21",                                                 +
                      |     "postal_address_part1": null,                                                    +
                      |     "postal_address_part2": null,                                                    +
                      |     "postal_address_part3": null,                                                    +
                      |     "postal_country_iso_2": null,                                                    +
                      |     "physical_address_part1": "Vestlyvegen 219",                                     +
                      |     "physical_address_part2": null,                                                  +
                      |     "physical_address_part3": null,                                                  +
                      |     "physical_country_iso_2": "NO",                                                  +
                      |     "activity_category_paths": [                                                     +
                      |         "H.49.4.1.0"                                                                 +
                      |     ],                                                                               +
                      |     "included_enterprise_count": 1,                                                  +
                      |     "included_legal_unit_count": 1,                                                  +
                      |     "included_establishment_count": 1,                                               +
                      |     "primary_activity_category_code": "49.410",                                      +
                      |     "primary_activity_category_path": "H.49.4.1.0",                                  +
                      |     "secondary_activity_category_code": null,                                        +
                      |     "secondary_activity_category_path": null                                         +
                      | }
stats                 | 
stats_summary         | {                                                                                    +
                      |     "turnover": {                                                                    +
                      |         "max": 3000000,                                                              +
                      |         "min": 3000000,                                                              +
                      |         "sum": 3000000,                                                              +
                      |         "mean": 3000000.00,                                                          +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0.00,                                                              +
                      |         "variance": 0.00,                                                            +
                      |         "sum_sq_diff": 0.00,                                                         +
                      |         "coefficient_of_variation_pct": 0.00                                         +
                      |     },                                                                               +
                      |     "employees": {                                                                   +
                      |         "max": 3,                                                                    +
                      |         "min": 3,                                                                    +
                      |         "sum": 3,                                                                    +
                      |         "mean": 3.00,                                                                +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0.00,                                                              +
                      |         "variance": 0.00,                                                            +
                      |         "sum_sq_diff": 0.00,                                                         +
                      |         "coefficient_of_variation_pct": 0.00                                         +
                      |     }                                                                                +
                      | }
-[ RECORD 7 ]---------+--------------------------------------------------------------------------------------
valid_from            | 2016-01-01
valid_to              | 2018-12-31
valid_until           | 2019-01-01
unit_type             | establishment
external_idents       | {"tax_ident": "895406732"}
statistical_unit_data | {                                                                                    +
                      |     "name": "KRAN & SPESIALLØFT AS",                                                 +
                      |     "search": "'as':3 'kran':1 'spesialløft':2",                                     +
                      |     "domestic": true,                                                                +
                      |     "landline": null,                                                                +
                      |     "tag_paths": [                                                                   +
                      |     ],                                                                               +
                      |     "birth_date": "2010-01-01",                                                      +
                      |     "death_date": null,                                                              +
                      |     "fax_number": null,                                                              +
                      |     "sector_code": null,                                                             +
                      |     "sector_name": null,                                                             +
                      |     "sector_path": null,                                                             +
                      |     "status_code": "active",                                                         +
                      |     "valid_until": "2019-01-01",                                                     +
                      |     "web_address": null,                                                             +
                      |     "phone_number": null,                                                            +
                      |     "email_address": null,                                                           +
                      |     "invalid_codes": null,                                                           +
                      |     "mobile_number": null,                                                           +
                      |     "has_legal_unit": true,                                                          +
                      |     "unit_size_code": "sml",                                                         +
                      |     "legal_form_code": null,                                                         +
                      |     "legal_form_name": null,                                                         +
                      |     "postal_altitude": null,                                                         +
                      |     "postal_latitude": null,                                                         +
                      |     "postal_postcode": null,                                                         +
                      |     "postal_longitude": null,                                                        +
                      |     "postal_postplace": null,                                                        +
                      |     "data_source_codes": [                                                           +
                      |         "brreg"                                                                      +
                      |     ],                                                                               +
                      |     "last_edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",+
                      |     "physical_altitude": null,                                                       +
                      |     "physical_latitude": null,                                                       +
                      |     "physical_postcode": "4347",                                                     +
                      |     "used_for_counting": true,                                                       +
                      |     "physical_longitude": null,                                                      +
                      |     "physical_postplace": "LYE",                                                     +
                      |     "postal_region_code": null,                                                      +
                      |     "postal_region_path": null,                                                      +
                      |     "physical_region_code": "1121",                                                  +
                      |     "physical_region_path": "11.21",                                                 +
                      |     "postal_address_part1": null,                                                    +
                      |     "postal_address_part2": null,                                                    +
                      |     "postal_address_part3": null,                                                    +
                      |     "postal_country_iso_2": null,                                                    +
                      |     "physical_address_part1": "Vestlyvegen 219",                                     +
                      |     "physical_address_part2": null,                                                  +
                      |     "physical_address_part3": null,                                                  +
                      |     "physical_country_iso_2": "NO",                                                  +
                      |     "activity_category_paths": [                                                     +
                      |         "H.49.4.1.0"                                                                 +
                      |     ],                                                                               +
                      |     "included_enterprise_count": null,                                               +
                      |     "included_legal_unit_count": null,                                               +
                      |     "included_establishment_count": 1,                                               +
                      |     "primary_activity_category_code": "49.410",                                      +
                      |     "primary_activity_category_path": "H.49.4.1.0",                                  +
                      |     "secondary_activity_category_code": null,                                        +
                      |     "secondary_activity_category_path": null                                         +
                      | }
stats                 | {                                                                                    +
                      |     "turnover": 12000000,                                                            +
                      |     "employees": 9                                                                   +
                      | }
stats_summary         | {                                                                                    +
                      |     "turnover": {                                                                    +
                      |         "max": 12000000,                                                             +
                      |         "min": 12000000,                                                             +
                      |         "sum": 12000000,                                                             +
                      |         "mean": 12000000,                                                            +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0,                                                                 +
                      |         "variance": 0,                                                               +
                      |         "sum_sq_diff": 0,                                                            +
                      |         "coefficient_of_variation_pct": 0                                            +
                      |     },                                                                               +
                      |     "employees": {                                                                   +
                      |         "max": 9,                                                                    +
                      |         "min": 9,                                                                    +
                      |         "sum": 9,                                                                    +
                      |         "mean": 9,                                                                   +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0,                                                                 +
                      |         "variance": 0,                                                               +
                      |         "sum_sq_diff": 0,                                                            +
                      |         "coefficient_of_variation_pct": 0                                            +
                      |     }                                                                                +
                      | }
-[ RECORD 8 ]---------+--------------------------------------------------------------------------------------
valid_from            | 2016-01-01
valid_to              | 2018-12-31
valid_until           | 2019-01-01
unit_type             | legal_unit
external_idents       | {"tax_ident": "921835809"}
statistical_unit_data | {                                                                                    +
                      |     "name": "KRAN & SPESIALLØFT AS",                                                 +
                      |     "search": "'as':3 'kran':1 'spesialløft':2",                                     +
                      |     "domestic": true,                                                                +
                      |     "landline": null,                                                                +
                      |     "tag_paths": [                                                                   +
                      |     ],                                                                               +
                      |     "birth_date": "2013-01-01",                                                      +
                      |     "death_date": null,                                                              +
                      |     "fax_number": null,                                                              +
                      |     "sector_code": "2100",                                                           +
                      |     "sector_name": "Private aksjeselskaper mv.",                                     +
                      |     "sector_path": "innl.a_ikke_fin.2100",                                           +
                      |     "status_code": "active",                                                         +
                      |     "valid_until": "2019-01-01",                                                     +
                      |     "web_address": null,                                                             +
                      |     "phone_number": null,                                                            +
                      |     "email_address": null,                                                           +
                      |     "invalid_codes": null,                                                           +
                      |     "mobile_number": null,                                                           +
                      |     "has_legal_unit": true,                                                          +
                      |     "unit_size_code": null,                                                          +
                      |     "legal_form_code": "AS",                                                         +
                      |     "legal_form_name": "Aksjeselskap",                                               +
                      |     "postal_altitude": null,                                                         +
                      |     "postal_latitude": null,                                                         +
                      |     "postal_postcode": null,                                                         +
                      |     "postal_longitude": null,                                                        +
                      |     "postal_postplace": null,                                                        +
                      |     "data_source_codes": [                                                           +
                      |         "brreg",                                                                     +
                      |         "skatt"                                                                      +
                      |     ],                                                                               +
                      |     "last_edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",+
                      |     "physical_altitude": null,                                                       +
                      |     "physical_latitude": null,                                                       +
                      |     "physical_postcode": "4347",                                                     +
                      |     "used_for_counting": true,                                                       +
                      |     "physical_longitude": null,                                                      +
                      |     "physical_postplace": "LYE",                                                     +
                      |     "postal_region_code": null,                                                      +
                      |     "postal_region_path": null,                                                      +
                      |     "physical_region_code": "1121",                                                  +
                      |     "physical_region_path": "11.21",                                                 +
                      |     "postal_address_part1": null,                                                    +
                      |     "postal_address_part2": null,                                                    +
                      |     "postal_address_part3": null,                                                    +
                      |     "postal_country_iso_2": null,                                                    +
                      |     "physical_address_part1": "Vestlyvegen 219",                                     +
                      |     "physical_address_part2": null,                                                  +
                      |     "physical_address_part3": null,                                                  +
                      |     "physical_country_iso_2": "NO",                                                  +
                      |     "activity_category_paths": [                                                     +
                      |         "H.49.4.1.0"                                                                 +
                      |     ],                                                                               +
                      |     "included_enterprise_count": null,                                               +
                      |     "included_legal_unit_count": 1,                                                  +
                      |     "included_establishment_count": 1,                                               +
                      |     "primary_activity_category_code": "49.410",                                      +
                      |     "primary_activity_category_path": "H.49.4.1.0",                                  +
                      |     "secondary_activity_category_code": null,                                        +
                      |     "secondary_activity_category_path": null                                         +
                      | }
stats                 | {                                                                                    +
                      | }
stats_summary         | {                                                                                    +
                      |     "turnover": {                                                                    +
                      |         "max": 12000000,                                                             +
                      |         "min": 12000000,                                                             +
                      |         "sum": 12000000,                                                             +
                      |         "mean": 12000000.00,                                                         +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0.00,                                                              +
                      |         "variance": 0.00,                                                            +
                      |         "sum_sq_diff": 0.00,                                                         +
                      |         "coefficient_of_variation_pct": 0.00                                         +
                      |     },                                                                               +
                      |     "employees": {                                                                   +
                      |         "max": 9,                                                                    +
                      |         "min": 9,                                                                    +
                      |         "sum": 9,                                                                    +
                      |         "mean": 9.00,                                                                +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0.00,                                                              +
                      |         "variance": 0.00,                                                            +
                      |         "sum_sq_diff": 0.00,                                                         +
                      |         "coefficient_of_variation_pct": 0.00                                         +
                      |     }                                                                                +
                      | }
-[ RECORD 9 ]---------+--------------------------------------------------------------------------------------
valid_from            | 2016-01-01
valid_to              | 2018-12-31
valid_until           | 2019-01-01
unit_type             | enterprise
external_idents       | {"tax_ident": "921835809"}
statistical_unit_data | {                                                                                    +
                      |     "name": "KRAN & SPESIALLØFT AS",                                                 +
                      |     "search": "'as':3 'kran':1 'spesialløft':2",                                     +
                      |     "domestic": true,                                                                +
                      |     "landline": null,                                                                +
                      |     "tag_paths": [                                                                   +
                      |     ],                                                                               +
                      |     "birth_date": "2013-01-01",                                                      +
                      |     "death_date": null,                                                              +
                      |     "fax_number": null,                                                              +
                      |     "sector_code": "2100",                                                           +
                      |     "sector_name": "Private aksjeselskaper mv.",                                     +
                      |     "sector_path": "innl.a_ikke_fin.2100",                                           +
                      |     "status_code": "active",                                                         +
                      |     "valid_until": "2019-01-01",                                                     +
                      |     "web_address": null,                                                             +
                      |     "phone_number": null,                                                            +
                      |     "email_address": null,                                                           +
                      |     "invalid_codes": null,                                                           +
                      |     "mobile_number": null,                                                           +
                      |     "has_legal_unit": true,                                                          +
                      |     "unit_size_code": null,                                                          +
                      |     "legal_form_code": "AS",                                                         +
                      |     "legal_form_name": "Aksjeselskap",                                               +
                      |     "postal_altitude": null,                                                         +
                      |     "postal_latitude": null,                                                         +
                      |     "postal_postcode": null,                                                         +
                      |     "postal_longitude": null,                                                        +
                      |     "postal_postplace": null,                                                        +
                      |     "data_source_codes": [                                                           +
                      |         "brreg",                                                                     +
                      |         "skatt"                                                                      +
                      |     ],                                                                               +
                      |     "last_edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",+
                      |     "physical_altitude": null,                                                       +
                      |     "physical_latitude": null,                                                       +
                      |     "physical_postcode": "4347",                                                     +
                      |     "used_for_counting": true,                                                       +
                      |     "physical_longitude": null,                                                      +
                      |     "physical_postplace": "LYE",                                                     +
                      |     "postal_region_code": null,                                                      +
                      |     "postal_region_path": null,                                                      +
                      |     "physical_region_code": "1121",                                                  +
                      |     "physical_region_path": "11.21",                                                 +
                      |     "postal_address_part1": null,                                                    +
                      |     "postal_address_part2": null,                                                    +
                      |     "postal_address_part3": null,                                                    +
                      |     "postal_country_iso_2": null,                                                    +
                      |     "physical_address_part1": "Vestlyvegen 219",                                     +
                      |     "physical_address_part2": null,                                                  +
                      |     "physical_address_part3": null,                                                  +
                      |     "physical_country_iso_2": "NO",                                                  +
                      |     "activity_category_paths": [                                                     +
                      |         "H.49.4.1.0"                                                                 +
                      |     ],                                                                               +
                      |     "included_enterprise_count": 1,                                                  +
                      |     "included_legal_unit_count": 1,                                                  +
                      |     "included_establishment_count": 1,                                               +
                      |     "primary_activity_category_code": "49.410",                                      +
                      |     "primary_activity_category_path": "H.49.4.1.0",                                  +
                      |     "secondary_activity_category_code": null,                                        +
                      |     "secondary_activity_category_path": null                                         +
                      | }
stats                 | 
stats_summary         | {                                                                                    +
                      |     "turnover": {                                                                    +
                      |         "max": 12000000,                                                             +
                      |         "min": 12000000,                                                             +
                      |         "sum": 12000000,                                                             +
                      |         "mean": 12000000.00,                                                         +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0.00,                                                              +
                      |         "variance": 0.00,                                                            +
                      |         "sum_sq_diff": 0.00,                                                         +
                      |         "coefficient_of_variation_pct": 0.00                                         +
                      |     },                                                                               +
                      |     "employees": {                                                                   +
                      |         "max": 9,                                                                    +
                      |         "min": 9,                                                                    +
                      |         "sum": 9,                                                                    +
                      |         "mean": 9.00,                                                                +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0.00,                                                              +
                      |         "variance": 0.00,                                                            +
                      |         "sum_sq_diff": 0.00,                                                         +
                      |         "coefficient_of_variation_pct": 0.00                                         +
                      |     }                                                                                +
                      | }
-[ RECORD 10 ]--------+--------------------------------------------------------------------------------------
valid_from            | 2019-01-01
valid_to              | 2019-02-28
valid_until           | 2019-03-01
unit_type             | establishment
external_idents       | {"tax_ident": "895406732"}
statistical_unit_data | {                                                                                    +
                      |     "name": "KRAN & SPESIALLØFT AS",                                                 +
                      |     "search": "'as':3 'kran':1 'spesialløft':2",                                     +
                      |     "domestic": true,                                                                +
                      |     "landline": null,                                                                +
                      |     "tag_paths": [                                                                   +
                      |     ],                                                                               +
                      |     "birth_date": "2010-01-01",                                                      +
                      |     "death_date": null,                                                              +
                      |     "fax_number": null,                                                              +
                      |     "sector_code": null,                                                             +
                      |     "sector_name": null,                                                             +
                      |     "sector_path": null,                                                             +
                      |     "status_code": "active",                                                         +
                      |     "valid_until": "2019-03-01",                                                     +
                      |     "web_address": null,                                                             +
                      |     "phone_number": null,                                                            +
                      |     "email_address": null,                                                           +
                      |     "invalid_codes": null,                                                           +
                      |     "mobile_number": null,                                                           +
                      |     "has_legal_unit": true,                                                          +
                      |     "unit_size_code": "med",                                                         +
                      |     "legal_form_code": null,                                                         +
                      |     "legal_form_name": null,                                                         +
                      |     "postal_altitude": null,                                                         +
                      |     "postal_latitude": null,                                                         +
                      |     "postal_postcode": null,                                                         +
                      |     "postal_longitude": null,                                                        +
                      |     "postal_postplace": null,                                                        +
                      |     "data_source_codes": [                                                           +
                      |         "brreg"                                                                      +
                      |     ],                                                                               +
                      |     "last_edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",+
                      |     "physical_altitude": null,                                                       +
                      |     "physical_latitude": null,                                                       +
                      |     "physical_postcode": "4347",                                                     +
                      |     "used_for_counting": true,                                                       +
                      |     "physical_longitude": null,                                                      +
                      |     "physical_postplace": "LYE",                                                     +
                      |     "postal_region_code": null,                                                      +
                      |     "postal_region_path": null,                                                      +
                      |     "physical_region_code": "1121",                                                  +
                      |     "physical_region_path": "11.21",                                                 +
                      |     "postal_address_part1": null,                                                    +
                      |     "postal_address_part2": null,                                                    +
                      |     "postal_address_part3": null,                                                    +
                      |     "postal_country_iso_2": null,                                                    +
                      |     "physical_address_part1": "Vestlyvegen 219",                                     +
                      |     "physical_address_part2": null,                                                  +
                      |     "physical_address_part3": null,                                                  +
                      |     "physical_country_iso_2": "NO",                                                  +
                      |     "activity_category_paths": [                                                     +
                      |         "H.49.4.1.0"                                                                 +
                      |     ],                                                                               +
                      |     "included_enterprise_count": null,                                               +
                      |     "included_legal_unit_count": null,                                               +
                      |     "included_establishment_count": 1,                                               +
                      |     "primary_activity_category_code": "49.410",                                      +
                      |     "primary_activity_category_path": "H.49.4.1.0",                                  +
                      |     "secondary_activity_category_code": null,                                        +
                      |     "secondary_activity_category_path": null                                         +
                      | }
stats                 | {                                                                                    +
                      |     "turnover": 60000000,                                                            +
                      |     "employees": 25                                                                  +
                      | }
stats_summary         | {                                                                                    +
                      |     "turnover": {                                                                    +
                      |         "max": 60000000,                                                             +
                      |         "min": 60000000,                                                             +
                      |         "sum": 60000000,                                                             +
                      |         "mean": 60000000,                                                            +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0,                                                                 +
                      |         "variance": 0,                                                               +
                      |         "sum_sq_diff": 0,                                                            +
                      |         "coefficient_of_variation_pct": 0                                            +
                      |     },                                                                               +
                      |     "employees": {                                                                   +
                      |         "max": 25,                                                                   +
                      |         "min": 25,                                                                   +
                      |         "sum": 25,                                                                   +
                      |         "mean": 25,                                                                  +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0,                                                                 +
                      |         "variance": 0,                                                               +
                      |         "sum_sq_diff": 0,                                                            +
                      |         "coefficient_of_variation_pct": 0                                            +
                      |     }                                                                                +
                      | }
-[ RECORD 11 ]--------+--------------------------------------------------------------------------------------
valid_from            | 2019-01-01
valid_to              | 2019-02-28
valid_until           | 2019-03-01
unit_type             | legal_unit
external_idents       | {"tax_ident": "921835809"}
statistical_unit_data | {                                                                                    +
                      |     "name": "KRAN & SPESIALLØFT AS",                                                 +
                      |     "search": "'as':3 'kran':1 'spesialløft':2",                                     +
                      |     "domestic": true,                                                                +
                      |     "landline": null,                                                                +
                      |     "tag_paths": [                                                                   +
                      |     ],                                                                               +
                      |     "birth_date": "2013-01-01",                                                      +
                      |     "death_date": null,                                                              +
                      |     "fax_number": null,                                                              +
                      |     "sector_code": "2100",                                                           +
                      |     "sector_name": "Private aksjeselskaper mv.",                                     +
                      |     "sector_path": "innl.a_ikke_fin.2100",                                           +
                      |     "status_code": "active",                                                         +
                      |     "valid_until": "2019-03-01",                                                     +
                      |     "web_address": null,                                                             +
                      |     "phone_number": null,                                                            +
                      |     "email_address": null,                                                           +
                      |     "invalid_codes": null,                                                           +
                      |     "mobile_number": null,                                                           +
                      |     "has_legal_unit": true,                                                          +
                      |     "unit_size_code": null,                                                          +
                      |     "legal_form_code": "AS",                                                         +
                      |     "legal_form_name": "Aksjeselskap",                                               +
                      |     "postal_altitude": null,                                                         +
                      |     "postal_latitude": null,                                                         +
                      |     "postal_postcode": null,                                                         +
                      |     "postal_longitude": null,                                                        +
                      |     "postal_postplace": null,                                                        +
                      |     "data_source_codes": [                                                           +
                      |         "brreg",                                                                     +
                      |         "skatt"                                                                      +
                      |     ],                                                                               +
                      |     "last_edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",+
                      |     "physical_altitude": null,                                                       +
                      |     "physical_latitude": null,                                                       +
                      |     "physical_postcode": "4347",                                                     +
                      |     "used_for_counting": true,                                                       +
                      |     "physical_longitude": null,                                                      +
                      |     "physical_postplace": "LYE",                                                     +
                      |     "postal_region_code": null,                                                      +
                      |     "postal_region_path": null,                                                      +
                      |     "physical_region_code": "1121",                                                  +
                      |     "physical_region_path": "11.21",                                                 +
                      |     "postal_address_part1": null,                                                    +
                      |     "postal_address_part2": null,                                                    +
                      |     "postal_address_part3": null,                                                    +
                      |     "postal_country_iso_2": null,                                                    +
                      |     "physical_address_part1": "Vestlyvegen 219",                                     +
                      |     "physical_address_part2": null,                                                  +
                      |     "physical_address_part3": null,                                                  +
                      |     "physical_country_iso_2": "NO",                                                  +
                      |     "activity_category_paths": [                                                     +
                      |         "H.49.4.1.0"                                                                 +
                      |     ],                                                                               +
                      |     "included_enterprise_count": null,                                               +
                      |     "included_legal_unit_count": 1,                                                  +
                      |     "included_establishment_count": 1,                                               +
                      |     "primary_activity_category_code": "49.410",                                      +
                      |     "primary_activity_category_path": "H.49.4.1.0",                                  +
                      |     "secondary_activity_category_code": null,                                        +
                      |     "secondary_activity_category_path": null                                         +
                      | }
stats                 | {                                                                                    +
                      | }
stats_summary         | {                                                                                    +
                      |     "turnover": {                                                                    +
                      |         "max": 60000000,                                                             +
                      |         "min": 60000000,                                                             +
                      |         "sum": 60000000,                                                             +
                      |         "mean": 60000000.00,                                                         +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0.00,                                                              +
                      |         "variance": 0.00,                                                            +
                      |         "sum_sq_diff": 0.00,                                                         +
                      |         "coefficient_of_variation_pct": 0.00                                         +
                      |     },                                                                               +
                      |     "employees": {                                                                   +
                      |         "max": 25,                                                                   +
                      |         "min": 25,                                                                   +
                      |         "sum": 25,                                                                   +
                      |         "mean": 25.00,                                                               +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0.00,                                                              +
                      |         "variance": 0.00,                                                            +
                      |         "sum_sq_diff": 0.00,                                                         +
                      |         "coefficient_of_variation_pct": 0.00                                         +
                      |     }                                                                                +
                      | }
-[ RECORD 12 ]--------+--------------------------------------------------------------------------------------
valid_from            | 2019-01-01
valid_to              | 2019-02-28
valid_until           | 2019-03-01
unit_type             | enterprise
external_idents       | {"tax_ident": "921835809"}
statistical_unit_data | {                                                                                    +
                      |     "name": "KRAN & SPESIALLØFT AS",                                                 +
                      |     "search": "'as':3 'kran':1 'spesialløft':2",                                     +
                      |     "domestic": true,                                                                +
                      |     "landline": null,                                                                +
                      |     "tag_paths": [                                                                   +
                      |     ],                                                                               +
                      |     "birth_date": "2013-01-01",                                                      +
                      |     "death_date": null,                                                              +
                      |     "fax_number": null,                                                              +
                      |     "sector_code": "2100",                                                           +
                      |     "sector_name": "Private aksjeselskaper mv.",                                     +
                      |     "sector_path": "innl.a_ikke_fin.2100",                                           +
                      |     "status_code": "active",                                                         +
                      |     "valid_until": "2019-03-01",                                                     +
                      |     "web_address": null,                                                             +
                      |     "phone_number": null,                                                            +
                      |     "email_address": null,                                                           +
                      |     "invalid_codes": null,                                                           +
                      |     "mobile_number": null,                                                           +
                      |     "has_legal_unit": true,                                                          +
                      |     "unit_size_code": null,                                                          +
                      |     "legal_form_code": "AS",                                                         +
                      |     "legal_form_name": "Aksjeselskap",                                               +
                      |     "postal_altitude": null,                                                         +
                      |     "postal_latitude": null,                                                         +
                      |     "postal_postcode": null,                                                         +
                      |     "postal_longitude": null,                                                        +
                      |     "postal_postplace": null,                                                        +
                      |     "data_source_codes": [                                                           +
                      |         "brreg",                                                                     +
                      |         "skatt"                                                                      +
                      |     ],                                                                               +
                      |     "last_edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",+
                      |     "physical_altitude": null,                                                       +
                      |     "physical_latitude": null,                                                       +
                      |     "physical_postcode": "4347",                                                     +
                      |     "used_for_counting": true,                                                       +
                      |     "physical_longitude": null,                                                      +
                      |     "physical_postplace": "LYE",                                                     +
                      |     "postal_region_code": null,                                                      +
                      |     "postal_region_path": null,                                                      +
                      |     "physical_region_code": "1121",                                                  +
                      |     "physical_region_path": "11.21",                                                 +
                      |     "postal_address_part1": null,                                                    +
                      |     "postal_address_part2": null,                                                    +
                      |     "postal_address_part3": null,                                                    +
                      |     "postal_country_iso_2": null,                                                    +
                      |     "physical_address_part1": "Vestlyvegen 219",                                     +
                      |     "physical_address_part2": null,                                                  +
                      |     "physical_address_part3": null,                                                  +
                      |     "physical_country_iso_2": "NO",                                                  +
                      |     "activity_category_paths": [                                                     +
                      |         "H.49.4.1.0"                                                                 +
                      |     ],                                                                               +
                      |     "included_enterprise_count": 1,                                                  +
                      |     "included_legal_unit_count": 1,                                                  +
                      |     "included_establishment_count": 1,                                               +
                      |     "primary_activity_category_code": "49.410",                                      +
                      |     "primary_activity_category_path": "H.49.4.1.0",                                  +
                      |     "secondary_activity_category_code": null,                                        +
                      |     "secondary_activity_category_path": null                                         +
                      | }
stats                 | 
stats_summary         | {                                                                                    +
                      |     "turnover": {                                                                    +
                      |         "max": 60000000,                                                             +
                      |         "min": 60000000,                                                             +
                      |         "sum": 60000000,                                                             +
                      |         "mean": 60000000.00,                                                         +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0.00,                                                              +
                      |         "variance": 0.00,                                                            +
                      |         "sum_sq_diff": 0.00,                                                         +
                      |         "coefficient_of_variation_pct": 0.00                                         +
                      |     },                                                                               +
                      |     "employees": {                                                                   +
                      |         "max": 25,                                                                   +
                      |         "min": 25,                                                                   +
                      |         "sum": 25,                                                                   +
                      |         "mean": 25.00,                                                               +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0.00,                                                              +
                      |         "variance": 0.00,                                                            +
                      |         "sum_sq_diff": 0.00,                                                         +
                      |         "coefficient_of_variation_pct": 0.00                                         +
                      |     }                                                                                +
                      | }
-[ RECORD 13 ]--------+--------------------------------------------------------------------------------------
valid_from            | 2019-03-01
valid_to              | 2019-04-30
valid_until           | 2019-05-01
unit_type             | establishment
external_idents       | {"tax_ident": "895406732"}
statistical_unit_data | {                                                                                    +
                      |     "name": "KRAN & SPESIALLØFT AS",                                                 +
                      |     "search": "'as':3 'kran':1 'spesialløft':2",                                     +
                      |     "domestic": true,                                                                +
                      |     "landline": null,                                                                +
                      |     "tag_paths": [                                                                   +
                      |     ],                                                                               +
                      |     "birth_date": "2010-01-01",                                                      +
                      |     "death_date": null,                                                              +
                      |     "fax_number": null,                                                              +
                      |     "sector_code": null,                                                             +
                      |     "sector_name": null,                                                             +
                      |     "sector_path": null,                                                             +
                      |     "status_code": "active",                                                         +
                      |     "valid_until": "2019-05-01",                                                     +
                      |     "web_address": null,                                                             +
                      |     "phone_number": null,                                                            +
                      |     "email_address": null,                                                           +
                      |     "invalid_codes": null,                                                           +
                      |     "mobile_number": null,                                                           +
                      |     "has_legal_unit": true,                                                          +
                      |     "unit_size_code": "med",                                                         +
                      |     "legal_form_code": null,                                                         +
                      |     "legal_form_name": null,                                                         +
                      |     "postal_altitude": null,                                                         +
                      |     "postal_latitude": null,                                                         +
                      |     "postal_postcode": null,                                                         +
                      |     "postal_longitude": null,                                                        +
                      |     "postal_postplace": null,                                                        +
                      |     "data_source_codes": [                                                           +
                      |         "brreg"                                                                      +
                      |     ],                                                                               +
                      |     "last_edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",+
                      |     "physical_altitude": null,                                                       +
                      |     "physical_latitude": null,                                                       +
                      |     "physical_postcode": "4347",                                                     +
                      |     "used_for_counting": true,                                                       +
                      |     "physical_longitude": null,                                                      +
                      |     "physical_postplace": "LYE",                                                     +
                      |     "postal_region_code": null,                                                      +
                      |     "postal_region_path": null,                                                      +
                      |     "physical_region_code": "1121",                                                  +
                      |     "physical_region_path": "11.21",                                                 +
                      |     "postal_address_part1": null,                                                    +
                      |     "postal_address_part2": null,                                                    +
                      |     "postal_address_part3": null,                                                    +
                      |     "postal_country_iso_2": null,                                                    +
                      |     "physical_address_part1": "Vestlyvegen 219",                                     +
                      |     "physical_address_part2": null,                                                  +
                      |     "physical_address_part3": null,                                                  +
                      |     "physical_country_iso_2": "NO",                                                  +
                      |     "activity_category_paths": [                                                     +
                      |         "H.49.4.1.0"                                                                 +
                      |     ],                                                                               +
                      |     "included_enterprise_count": null,                                               +
                      |     "included_legal_unit_count": null,                                               +
                      |     "included_establishment_count": 1,                                               +
                      |     "primary_activity_category_code": "49.410",                                      +
                      |     "primary_activity_category_path": "H.49.4.1.0",                                  +
                      |     "secondary_activity_category_code": null,                                        +
                      |     "secondary_activity_category_path": null                                         +
                      | }
stats                 | {                                                                                    +
                      |     "turnover": 60000000,                                                            +
                      |     "employees": 30                                                                  +
                      | }
stats_summary         | {                                                                                    +
                      |     "turnover": {                                                                    +
                      |         "max": 60000000,                                                             +
                      |         "min": 60000000,                                                             +
                      |         "sum": 60000000,                                                             +
                      |         "mean": 60000000,                                                            +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0,                                                                 +
                      |         "variance": 0,                                                               +
                      |         "sum_sq_diff": 0,                                                            +
                      |         "coefficient_of_variation_pct": 0                                            +
                      |     },                                                                               +
                      |     "employees": {                                                                   +
                      |         "max": 30,                                                                   +
                      |         "min": 30,                                                                   +
                      |         "sum": 30,                                                                   +
                      |         "mean": 30,                                                                  +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0,                                                                 +
                      |         "variance": 0,                                                               +
                      |         "sum_sq_diff": 0,                                                            +
                      |         "coefficient_of_variation_pct": 0                                            +
                      |     }                                                                                +
                      | }
-[ RECORD 14 ]--------+--------------------------------------------------------------------------------------
valid_from            | 2019-03-01
valid_to              | 2019-04-30
valid_until           | 2019-05-01
unit_type             | legal_unit
external_idents       | {"tax_ident": "921835809"}
statistical_unit_data | {                                                                                    +
                      |     "name": "KRAN & SPESIALLØFT AS",                                                 +
                      |     "search": "'as':3 'kran':1 'spesialløft':2",                                     +
                      |     "domestic": true,                                                                +
                      |     "landline": null,                                                                +
                      |     "tag_paths": [                                                                   +
                      |     ],                                                                               +
                      |     "birth_date": "2013-01-01",                                                      +
                      |     "death_date": null,                                                              +
                      |     "fax_number": null,                                                              +
                      |     "sector_code": "2100",                                                           +
                      |     "sector_name": "Private aksjeselskaper mv.",                                     +
                      |     "sector_path": "innl.a_ikke_fin.2100",                                           +
                      |     "status_code": "active",                                                         +
                      |     "valid_until": "2019-05-01",                                                     +
                      |     "web_address": null,                                                             +
                      |     "phone_number": null,                                                            +
                      |     "email_address": null,                                                           +
                      |     "invalid_codes": null,                                                           +
                      |     "mobile_number": null,                                                           +
                      |     "has_legal_unit": true,                                                          +
                      |     "unit_size_code": null,                                                          +
                      |     "legal_form_code": "AS",                                                         +
                      |     "legal_form_name": "Aksjeselskap",                                               +
                      |     "postal_altitude": null,                                                         +
                      |     "postal_latitude": null,                                                         +
                      |     "postal_postcode": null,                                                         +
                      |     "postal_longitude": null,                                                        +
                      |     "postal_postplace": null,                                                        +
                      |     "data_source_codes": [                                                           +
                      |         "brreg",                                                                     +
                      |         "skatt"                                                                      +
                      |     ],                                                                               +
                      |     "last_edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",+
                      |     "physical_altitude": null,                                                       +
                      |     "physical_latitude": null,                                                       +
                      |     "physical_postcode": "4347",                                                     +
                      |     "used_for_counting": true,                                                       +
                      |     "physical_longitude": null,                                                      +
                      |     "physical_postplace": "LYE",                                                     +
                      |     "postal_region_code": null,                                                      +
                      |     "postal_region_path": null,                                                      +
                      |     "physical_region_code": "1121",                                                  +
                      |     "physical_region_path": "11.21",                                                 +
                      |     "postal_address_part1": null,                                                    +
                      |     "postal_address_part2": null,                                                    +
                      |     "postal_address_part3": null,                                                    +
                      |     "postal_country_iso_2": null,                                                    +
                      |     "physical_address_part1": "Vestlyvegen 219",                                     +
                      |     "physical_address_part2": null,                                                  +
                      |     "physical_address_part3": null,                                                  +
                      |     "physical_country_iso_2": "NO",                                                  +
                      |     "activity_category_paths": [                                                     +
                      |         "H.49.4.1.0"                                                                 +
                      |     ],                                                                               +
                      |     "included_enterprise_count": null,                                               +
                      |     "included_legal_unit_count": 1,                                                  +
                      |     "included_establishment_count": 1,                                               +
                      |     "primary_activity_category_code": "49.410",                                      +
                      |     "primary_activity_category_path": "H.49.4.1.0",                                  +
                      |     "secondary_activity_category_code": null,                                        +
                      |     "secondary_activity_category_path": null                                         +
                      | }
stats                 | {                                                                                    +
                      | }
stats_summary         | {                                                                                    +
                      |     "turnover": {                                                                    +
                      |         "max": 60000000,                                                             +
                      |         "min": 60000000,                                                             +
                      |         "sum": 60000000,                                                             +
                      |         "mean": 60000000.00,                                                         +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0.00,                                                              +
                      |         "variance": 0.00,                                                            +
                      |         "sum_sq_diff": 0.00,                                                         +
                      |         "coefficient_of_variation_pct": 0.00                                         +
                      |     },                                                                               +
                      |     "employees": {                                                                   +
                      |         "max": 30,                                                                   +
                      |         "min": 30,                                                                   +
                      |         "sum": 30,                                                                   +
                      |         "mean": 30.00,                                                               +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0.00,                                                              +
                      |         "variance": 0.00,                                                            +
                      |         "sum_sq_diff": 0.00,                                                         +
                      |         "coefficient_of_variation_pct": 0.00                                         +
                      |     }                                                                                +
                      | }
-[ RECORD 15 ]--------+--------------------------------------------------------------------------------------
valid_from            | 2019-03-01
valid_to              | 2019-04-30
valid_until           | 2019-05-01
unit_type             | enterprise
external_idents       | {"tax_ident": "921835809"}
statistical_unit_data | {                                                                                    +
                      |     "name": "KRAN & SPESIALLØFT AS",                                                 +
                      |     "search": "'as':3 'kran':1 'spesialløft':2",                                     +
                      |     "domestic": true,                                                                +
                      |     "landline": null,                                                                +
                      |     "tag_paths": [                                                                   +
                      |     ],                                                                               +
                      |     "birth_date": "2013-01-01",                                                      +
                      |     "death_date": null,                                                              +
                      |     "fax_number": null,                                                              +
                      |     "sector_code": "2100",                                                           +
                      |     "sector_name": "Private aksjeselskaper mv.",                                     +
                      |     "sector_path": "innl.a_ikke_fin.2100",                                           +
                      |     "status_code": "active",                                                         +
                      |     "valid_until": "2019-05-01",                                                     +
                      |     "web_address": null,                                                             +
                      |     "phone_number": null,                                                            +
                      |     "email_address": null,                                                           +
                      |     "invalid_codes": null,                                                           +
                      |     "mobile_number": null,                                                           +
                      |     "has_legal_unit": true,                                                          +
                      |     "unit_size_code": null,                                                          +
                      |     "legal_form_code": "AS",                                                         +
                      |     "legal_form_name": "Aksjeselskap",                                               +
                      |     "postal_altitude": null,                                                         +
                      |     "postal_latitude": null,                                                         +
                      |     "postal_postcode": null,                                                         +
                      |     "postal_longitude": null,                                                        +
                      |     "postal_postplace": null,                                                        +
                      |     "data_source_codes": [                                                           +
                      |         "brreg",                                                                     +
                      |         "skatt"                                                                      +
                      |     ],                                                                               +
                      |     "last_edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",+
                      |     "physical_altitude": null,                                                       +
                      |     "physical_latitude": null,                                                       +
                      |     "physical_postcode": "4347",                                                     +
                      |     "used_for_counting": true,                                                       +
                      |     "physical_longitude": null,                                                      +
                      |     "physical_postplace": "LYE",                                                     +
                      |     "postal_region_code": null,                                                      +
                      |     "postal_region_path": null,                                                      +
                      |     "physical_region_code": "1121",                                                  +
                      |     "physical_region_path": "11.21",                                                 +
                      |     "postal_address_part1": null,                                                    +
                      |     "postal_address_part2": null,                                                    +
                      |     "postal_address_part3": null,                                                    +
                      |     "postal_country_iso_2": null,                                                    +
                      |     "physical_address_part1": "Vestlyvegen 219",                                     +
                      |     "physical_address_part2": null,                                                  +
                      |     "physical_address_part3": null,                                                  +
                      |     "physical_country_iso_2": "NO",                                                  +
                      |     "activity_category_paths": [                                                     +
                      |         "H.49.4.1.0"                                                                 +
                      |     ],                                                                               +
                      |     "included_enterprise_count": 1,                                                  +
                      |     "included_legal_unit_count": 1,                                                  +
                      |     "included_establishment_count": 1,                                               +
                      |     "primary_activity_category_code": "49.410",                                      +
                      |     "primary_activity_category_path": "H.49.4.1.0",                                  +
                      |     "secondary_activity_category_code": null,                                        +
                      |     "secondary_activity_category_path": null                                         +
                      | }
stats                 | 
stats_summary         | {                                                                                    +
                      |     "turnover": {                                                                    +
                      |         "max": 60000000,                                                             +
                      |         "min": 60000000,                                                             +
                      |         "sum": 60000000,                                                             +
                      |         "mean": 60000000.00,                                                         +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0.00,                                                              +
                      |         "variance": 0.00,                                                            +
                      |         "sum_sq_diff": 0.00,                                                         +
                      |         "coefficient_of_variation_pct": 0.00                                         +
                      |     },                                                                               +
                      |     "employees": {                                                                   +
                      |         "max": 30,                                                                   +
                      |         "min": 30,                                                                   +
                      |         "sum": 30,                                                                   +
                      |         "mean": 30.00,                                                               +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0.00,                                                              +
                      |         "variance": 0.00,                                                            +
                      |         "sum_sq_diff": 0.00,                                                         +
                      |         "coefficient_of_variation_pct": 0.00                                         +
                      |     }                                                                                +
                      | }
-[ RECORD 16 ]--------+--------------------------------------------------------------------------------------
valid_from            | 2019-05-01
valid_to              | 2019-06-30
valid_until           | 2019-07-01
unit_type             | establishment
external_idents       | {"tax_ident": "895406732"}
statistical_unit_data | {                                                                                    +
                      |     "name": "KRAN & SPESIALLØFT AS",                                                 +
                      |     "search": "'as':3 'kran':1 'spesialløft':2",                                     +
                      |     "domestic": true,                                                                +
                      |     "landline": null,                                                                +
                      |     "tag_paths": [                                                                   +
                      |     ],                                                                               +
                      |     "birth_date": "2010-01-01",                                                      +
                      |     "death_date": null,                                                              +
                      |     "fax_number": null,                                                              +
                      |     "sector_code": null,                                                             +
                      |     "sector_name": null,                                                             +
                      |     "sector_path": null,                                                             +
                      |     "status_code": "active",                                                         +
                      |     "valid_until": "2019-07-01",                                                     +
                      |     "web_address": null,                                                             +
                      |     "phone_number": null,                                                            +
                      |     "email_address": null,                                                           +
                      |     "invalid_codes": null,                                                           +
                      |     "mobile_number": null,                                                           +
                      |     "has_legal_unit": true,                                                          +
                      |     "unit_size_code": "med",                                                         +
                      |     "legal_form_code": null,                                                         +
                      |     "legal_form_name": null,                                                         +
                      |     "postal_altitude": null,                                                         +
                      |     "postal_latitude": null,                                                         +
                      |     "postal_postcode": null,                                                         +
                      |     "postal_longitude": null,                                                        +
                      |     "postal_postplace": null,                                                        +
                      |     "data_source_codes": [                                                           +
                      |         "brreg"                                                                      +
                      |     ],                                                                               +
                      |     "last_edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",+
                      |     "physical_altitude": null,                                                       +
                      |     "physical_latitude": null,                                                       +
                      |     "physical_postcode": "4347",                                                     +
                      |     "used_for_counting": true,                                                       +
                      |     "physical_longitude": null,                                                      +
                      |     "physical_postplace": "LYE",                                                     +
                      |     "postal_region_code": null,                                                      +
                      |     "postal_region_path": null,                                                      +
                      |     "physical_region_code": "1121",                                                  +
                      |     "physical_region_path": "11.21",                                                 +
                      |     "postal_address_part1": null,                                                    +
                      |     "postal_address_part2": null,                                                    +
                      |     "postal_address_part3": null,                                                    +
                      |     "postal_country_iso_2": null,                                                    +
                      |     "physical_address_part1": "Vestlyvegen 219",                                     +
                      |     "physical_address_part2": null,                                                  +
                      |     "physical_address_part3": null,                                                  +
                      |     "physical_country_iso_2": "NO",                                                  +
                      |     "activity_category_paths": [                                                     +
                      |         "H.49.4.1.0"                                                                 +
                      |     ],                                                                               +
                      |     "included_enterprise_count": null,                                               +
                      |     "included_legal_unit_count": null,                                               +
                      |     "included_establishment_count": 1,                                               +
                      |     "primary_activity_category_code": "49.410",                                      +
                      |     "primary_activity_category_path": "H.49.4.1.0",                                  +
                      |     "secondary_activity_category_code": null,                                        +
                      |     "secondary_activity_category_path": null                                         +
                      | }
stats                 | {                                                                                    +
                      |     "turnover": 60000000,                                                            +
                      |     "employees": 35                                                                  +
                      | }
stats_summary         | {                                                                                    +
                      |     "turnover": {                                                                    +
                      |         "max": 60000000,                                                             +
                      |         "min": 60000000,                                                             +
                      |         "sum": 60000000,                                                             +
                      |         "mean": 60000000,                                                            +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0,                                                                 +
                      |         "variance": 0,                                                               +
                      |         "sum_sq_diff": 0,                                                            +
                      |         "coefficient_of_variation_pct": 0                                            +
                      |     },                                                                               +
                      |     "employees": {                                                                   +
                      |         "max": 35,                                                                   +
                      |         "min": 35,                                                                   +
                      |         "sum": 35,                                                                   +
                      |         "mean": 35,                                                                  +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0,                                                                 +
                      |         "variance": 0,                                                               +
                      |         "sum_sq_diff": 0,                                                            +
                      |         "coefficient_of_variation_pct": 0                                            +
                      |     }                                                                                +
                      | }
-[ RECORD 17 ]--------+--------------------------------------------------------------------------------------
valid_from            | 2019-05-01
valid_to              | 2019-06-30
valid_until           | 2019-07-01
unit_type             | legal_unit
external_idents       | {"tax_ident": "921835809"}
statistical_unit_data | {                                                                                    +
                      |     "name": "KRAN & SPESIALLØFT AS",                                                 +
                      |     "search": "'as':3 'kran':1 'spesialløft':2",                                     +
                      |     "domestic": true,                                                                +
                      |     "landline": null,                                                                +
                      |     "tag_paths": [                                                                   +
                      |     ],                                                                               +
                      |     "birth_date": "2013-01-01",                                                      +
                      |     "death_date": null,                                                              +
                      |     "fax_number": null,                                                              +
                      |     "sector_code": "2100",                                                           +
                      |     "sector_name": "Private aksjeselskaper mv.",                                     +
                      |     "sector_path": "innl.a_ikke_fin.2100",                                           +
                      |     "status_code": "active",                                                         +
                      |     "valid_until": "2019-07-01",                                                     +
                      |     "web_address": null,                                                             +
                      |     "phone_number": null,                                                            +
                      |     "email_address": null,                                                           +
                      |     "invalid_codes": null,                                                           +
                      |     "mobile_number": null,                                                           +
                      |     "has_legal_unit": true,                                                          +
                      |     "unit_size_code": null,                                                          +
                      |     "legal_form_code": "AS",                                                         +
                      |     "legal_form_name": "Aksjeselskap",                                               +
                      |     "postal_altitude": null,                                                         +
                      |     "postal_latitude": null,                                                         +
                      |     "postal_postcode": null,                                                         +
                      |     "postal_longitude": null,                                                        +
                      |     "postal_postplace": null,                                                        +
                      |     "data_source_codes": [                                                           +
                      |         "brreg",                                                                     +
                      |         "skatt"                                                                      +
                      |     ],                                                                               +
                      |     "last_edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",+
                      |     "physical_altitude": null,                                                       +
                      |     "physical_latitude": null,                                                       +
                      |     "physical_postcode": "4347",                                                     +
                      |     "used_for_counting": true,                                                       +
                      |     "physical_longitude": null,                                                      +
                      |     "physical_postplace": "LYE",                                                     +
                      |     "postal_region_code": null,                                                      +
                      |     "postal_region_path": null,                                                      +
                      |     "physical_region_code": "1121",                                                  +
                      |     "physical_region_path": "11.21",                                                 +
                      |     "postal_address_part1": null,                                                    +
                      |     "postal_address_part2": null,                                                    +
                      |     "postal_address_part3": null,                                                    +
                      |     "postal_country_iso_2": null,                                                    +
                      |     "physical_address_part1": "Vestlyvegen 219",                                     +
                      |     "physical_address_part2": null,                                                  +
                      |     "physical_address_part3": null,                                                  +
                      |     "physical_country_iso_2": "NO",                                                  +
                      |     "activity_category_paths": [                                                     +
                      |         "H.49.4.1.0"                                                                 +
                      |     ],                                                                               +
                      |     "included_enterprise_count": null,                                               +
                      |     "included_legal_unit_count": 1,                                                  +
                      |     "included_establishment_count": 1,                                               +
                      |     "primary_activity_category_code": "49.410",                                      +
                      |     "primary_activity_category_path": "H.49.4.1.0",                                  +
                      |     "secondary_activity_category_code": null,                                        +
                      |     "secondary_activity_category_path": null                                         +
                      | }
stats                 | {                                                                                    +
                      | }
stats_summary         | {                                                                                    +
                      |     "turnover": {                                                                    +
                      |         "max": 60000000,                                                             +
                      |         "min": 60000000,                                                             +
                      |         "sum": 60000000,                                                             +
                      |         "mean": 60000000.00,                                                         +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0.00,                                                              +
                      |         "variance": 0.00,                                                            +
                      |         "sum_sq_diff": 0.00,                                                         +
                      |         "coefficient_of_variation_pct": 0.00                                         +
                      |     },                                                                               +
                      |     "employees": {                                                                   +
                      |         "max": 35,                                                                   +
                      |         "min": 35,                                                                   +
                      |         "sum": 35,                                                                   +
                      |         "mean": 35.00,                                                               +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0.00,                                                              +
                      |         "variance": 0.00,                                                            +
                      |         "sum_sq_diff": 0.00,                                                         +
                      |         "coefficient_of_variation_pct": 0.00                                         +
                      |     }                                                                                +
                      | }
-[ RECORD 18 ]--------+--------------------------------------------------------------------------------------
valid_from            | 2019-05-01
valid_to              | 2019-06-30
valid_until           | 2019-07-01
unit_type             | enterprise
external_idents       | {"tax_ident": "921835809"}
statistical_unit_data | {                                                                                    +
                      |     "name": "KRAN & SPESIALLØFT AS",                                                 +
                      |     "search": "'as':3 'kran':1 'spesialløft':2",                                     +
                      |     "domestic": true,                                                                +
                      |     "landline": null,                                                                +
                      |     "tag_paths": [                                                                   +
                      |     ],                                                                               +
                      |     "birth_date": "2013-01-01",                                                      +
                      |     "death_date": null,                                                              +
                      |     "fax_number": null,                                                              +
                      |     "sector_code": "2100",                                                           +
                      |     "sector_name": "Private aksjeselskaper mv.",                                     +
                      |     "sector_path": "innl.a_ikke_fin.2100",                                           +
                      |     "status_code": "active",                                                         +
                      |     "valid_until": "2019-07-01",                                                     +
                      |     "web_address": null,                                                             +
                      |     "phone_number": null,                                                            +
                      |     "email_address": null,                                                           +
                      |     "invalid_codes": null,                                                           +
                      |     "mobile_number": null,                                                           +
                      |     "has_legal_unit": true,                                                          +
                      |     "unit_size_code": null,                                                          +
                      |     "legal_form_code": "AS",                                                         +
                      |     "legal_form_name": "Aksjeselskap",                                               +
                      |     "postal_altitude": null,                                                         +
                      |     "postal_latitude": null,                                                         +
                      |     "postal_postcode": null,                                                         +
                      |     "postal_longitude": null,                                                        +
                      |     "postal_postplace": null,                                                        +
                      |     "data_source_codes": [                                                           +
                      |         "brreg",                                                                     +
                      |         "skatt"                                                                      +
                      |     ],                                                                               +
                      |     "last_edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",+
                      |     "physical_altitude": null,                                                       +
                      |     "physical_latitude": null,                                                       +
                      |     "physical_postcode": "4347",                                                     +
                      |     "used_for_counting": true,                                                       +
                      |     "physical_longitude": null,                                                      +
                      |     "physical_postplace": "LYE",                                                     +
                      |     "postal_region_code": null,                                                      +
                      |     "postal_region_path": null,                                                      +
                      |     "physical_region_code": "1121",                                                  +
                      |     "physical_region_path": "11.21",                                                 +
                      |     "postal_address_part1": null,                                                    +
                      |     "postal_address_part2": null,                                                    +
                      |     "postal_address_part3": null,                                                    +
                      |     "postal_country_iso_2": null,                                                    +
                      |     "physical_address_part1": "Vestlyvegen 219",                                     +
                      |     "physical_address_part2": null,                                                  +
                      |     "physical_address_part3": null,                                                  +
                      |     "physical_country_iso_2": "NO",                                                  +
                      |     "activity_category_paths": [                                                     +
                      |         "H.49.4.1.0"                                                                 +
                      |     ],                                                                               +
                      |     "included_enterprise_count": 1,                                                  +
                      |     "included_legal_unit_count": 1,                                                  +
                      |     "included_establishment_count": 1,                                               +
                      |     "primary_activity_category_code": "49.410",                                      +
                      |     "primary_activity_category_path": "H.49.4.1.0",                                  +
                      |     "secondary_activity_category_code": null,                                        +
                      |     "secondary_activity_category_path": null                                         +
                      | }
stats                 | 
stats_summary         | {                                                                                    +
                      |     "turnover": {                                                                    +
                      |         "max": 60000000,                                                             +
                      |         "min": 60000000,                                                             +
                      |         "sum": 60000000,                                                             +
                      |         "mean": 60000000.00,                                                         +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0.00,                                                              +
                      |         "variance": 0.00,                                                            +
                      |         "sum_sq_diff": 0.00,                                                         +
                      |         "coefficient_of_variation_pct": 0.00                                         +
                      |     },                                                                               +
                      |     "employees": {                                                                   +
                      |         "max": 35,                                                                   +
                      |         "min": 35,                                                                   +
                      |         "sum": 35,                                                                   +
                      |         "mean": 35.00,                                                               +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0.00,                                                              +
                      |         "variance": 0.00,                                                            +
                      |         "sum_sq_diff": 0.00,                                                         +
                      |         "coefficient_of_variation_pct": 0.00                                         +
                      |     }                                                                                +
                      | }
-[ RECORD 19 ]--------+--------------------------------------------------------------------------------------
valid_from            | 2019-07-01
valid_to              | 2019-08-31
valid_until           | 2019-09-01
unit_type             | establishment
external_idents       | {"tax_ident": "895406732"}
statistical_unit_data | {                                                                                    +
                      |     "name": "KRAN & SPESIALLØFT AS",                                                 +
                      |     "search": "'as':3 'kran':1 'spesialløft':2",                                     +
                      |     "domestic": true,                                                                +
                      |     "landline": null,                                                                +
                      |     "tag_paths": [                                                                   +
                      |     ],                                                                               +
                      |     "birth_date": "2010-01-01",                                                      +
                      |     "death_date": null,                                                              +
                      |     "fax_number": null,                                                              +
                      |     "sector_code": null,                                                             +
                      |     "sector_name": null,                                                             +
                      |     "sector_path": null,                                                             +
                      |     "status_code": "active",                                                         +
                      |     "valid_until": "2019-09-01",                                                     +
                      |     "web_address": null,                                                             +
                      |     "phone_number": null,                                                            +
                      |     "email_address": null,                                                           +
                      |     "invalid_codes": null,                                                           +
                      |     "mobile_number": null,                                                           +
                      |     "has_legal_unit": true,                                                          +
                      |     "unit_size_code": "med",                                                         +
                      |     "legal_form_code": null,                                                         +
                      |     "legal_form_name": null,                                                         +
                      |     "postal_altitude": null,                                                         +
                      |     "postal_latitude": null,                                                         +
                      |     "postal_postcode": null,                                                         +
                      |     "postal_longitude": null,                                                        +
                      |     "postal_postplace": null,                                                        +
                      |     "data_source_codes": [                                                           +
                      |         "brreg"                                                                      +
                      |     ],                                                                               +
                      |     "last_edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",+
                      |     "physical_altitude": null,                                                       +
                      |     "physical_latitude": null,                                                       +
                      |     "physical_postcode": "4347",                                                     +
                      |     "used_for_counting": true,                                                       +
                      |     "physical_longitude": null,                                                      +
                      |     "physical_postplace": "LYE",                                                     +
                      |     "postal_region_code": null,                                                      +
                      |     "postal_region_path": null,                                                      +
                      |     "physical_region_code": "1121",                                                  +
                      |     "physical_region_path": "11.21",                                                 +
                      |     "postal_address_part1": null,                                                    +
                      |     "postal_address_part2": null,                                                    +
                      |     "postal_address_part3": null,                                                    +
                      |     "postal_country_iso_2": null,                                                    +
                      |     "physical_address_part1": "Vestlyvegen 219",                                     +
                      |     "physical_address_part2": null,                                                  +
                      |     "physical_address_part3": null,                                                  +
                      |     "physical_country_iso_2": "NO",                                                  +
                      |     "activity_category_paths": [                                                     +
                      |         "H.49.4.1.0"                                                                 +
                      |     ],                                                                               +
                      |     "included_enterprise_count": null,                                               +
                      |     "included_legal_unit_count": null,                                               +
                      |     "included_establishment_count": 1,                                               +
                      |     "primary_activity_category_code": "49.410",                                      +
                      |     "primary_activity_category_path": "H.49.4.1.0",                                  +
                      |     "secondary_activity_category_code": null,                                        +
                      |     "secondary_activity_category_path": null                                         +
                      | }
stats                 | {                                                                                    +
                      |     "turnover": 60000000,                                                            +
                      |     "employees": 40                                                                  +
                      | }
stats_summary         | {                                                                                    +
                      |     "turnover": {                                                                    +
                      |         "max": 60000000,                                                             +
                      |         "min": 60000000,                                                             +
                      |         "sum": 60000000,                                                             +
                      |         "mean": 60000000,                                                            +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0,                                                                 +
                      |         "variance": 0,                                                               +
                      |         "sum_sq_diff": 0,                                                            +
                      |         "coefficient_of_variation_pct": 0                                            +
                      |     },                                                                               +
                      |     "employees": {                                                                   +
                      |         "max": 40,                                                                   +
                      |         "min": 40,                                                                   +
                      |         "sum": 40,                                                                   +
                      |         "mean": 40,                                                                  +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0,                                                                 +
                      |         "variance": 0,                                                               +
                      |         "sum_sq_diff": 0,                                                            +
                      |         "coefficient_of_variation_pct": 0                                            +
                      |     }                                                                                +
                      | }
-[ RECORD 20 ]--------+--------------------------------------------------------------------------------------
valid_from            | 2019-07-01
valid_to              | 2019-08-31
valid_until           | 2019-09-01
unit_type             | legal_unit
external_idents       | {"tax_ident": "921835809"}
statistical_unit_data | {                                                                                    +
                      |     "name": "KRAN & SPESIALLØFT AS",                                                 +
                      |     "search": "'as':3 'kran':1 'spesialløft':2",                                     +
                      |     "domestic": true,                                                                +
                      |     "landline": null,                                                                +
                      |     "tag_paths": [                                                                   +
                      |     ],                                                                               +
                      |     "birth_date": "2013-01-01",                                                      +
                      |     "death_date": null,                                                              +
                      |     "fax_number": null,                                                              +
                      |     "sector_code": "2100",                                                           +
                      |     "sector_name": "Private aksjeselskaper mv.",                                     +
                      |     "sector_path": "innl.a_ikke_fin.2100",                                           +
                      |     "status_code": "active",                                                         +
                      |     "valid_until": "2019-09-01",                                                     +
                      |     "web_address": null,                                                             +
                      |     "phone_number": null,                                                            +
                      |     "email_address": null,                                                           +
                      |     "invalid_codes": null,                                                           +
                      |     "mobile_number": null,                                                           +
                      |     "has_legal_unit": true,                                                          +
                      |     "unit_size_code": null,                                                          +
                      |     "legal_form_code": "AS",                                                         +
                      |     "legal_form_name": "Aksjeselskap",                                               +
                      |     "postal_altitude": null,                                                         +
                      |     "postal_latitude": null,                                                         +
                      |     "postal_postcode": null,                                                         +
                      |     "postal_longitude": null,                                                        +
                      |     "postal_postplace": null,                                                        +
                      |     "data_source_codes": [                                                           +
                      |         "brreg",                                                                     +
                      |         "skatt"                                                                      +
                      |     ],                                                                               +
                      |     "last_edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",+
                      |     "physical_altitude": null,                                                       +
                      |     "physical_latitude": null,                                                       +
                      |     "physical_postcode": "4347",                                                     +
                      |     "used_for_counting": true,                                                       +
                      |     "physical_longitude": null,                                                      +
                      |     "physical_postplace": "LYE",                                                     +
                      |     "postal_region_code": null,                                                      +
                      |     "postal_region_path": null,                                                      +
                      |     "physical_region_code": "1121",                                                  +
                      |     "physical_region_path": "11.21",                                                 +
                      |     "postal_address_part1": null,                                                    +
                      |     "postal_address_part2": null,                                                    +
                      |     "postal_address_part3": null,                                                    +
                      |     "postal_country_iso_2": null,                                                    +
                      |     "physical_address_part1": "Vestlyvegen 219",                                     +
                      |     "physical_address_part2": null,                                                  +
                      |     "physical_address_part3": null,                                                  +
                      |     "physical_country_iso_2": "NO",                                                  +
                      |     "activity_category_paths": [                                                     +
                      |         "H.49.4.1.0"                                                                 +
                      |     ],                                                                               +
                      |     "included_enterprise_count": null,                                               +
                      |     "included_legal_unit_count": 1,                                                  +
                      |     "included_establishment_count": 1,                                               +
                      |     "primary_activity_category_code": "49.410",                                      +
                      |     "primary_activity_category_path": "H.49.4.1.0",                                  +
                      |     "secondary_activity_category_code": null,                                        +
                      |     "secondary_activity_category_path": null                                         +
                      | }
stats                 | {                                                                                    +
                      | }
stats_summary         | {                                                                                    +
                      |     "turnover": {                                                                    +
                      |         "max": 60000000,                                                             +
                      |         "min": 60000000,                                                             +
                      |         "sum": 60000000,                                                             +
                      |         "mean": 60000000.00,                                                         +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0.00,                                                              +
                      |         "variance": 0.00,                                                            +
                      |         "sum_sq_diff": 0.00,                                                         +
                      |         "coefficient_of_variation_pct": 0.00                                         +
                      |     },                                                                               +
                      |     "employees": {                                                                   +
                      |         "max": 40,                                                                   +
                      |         "min": 40,                                                                   +
                      |         "sum": 40,                                                                   +
                      |         "mean": 40.00,                                                               +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0.00,                                                              +
                      |         "variance": 0.00,                                                            +
                      |         "sum_sq_diff": 0.00,                                                         +
                      |         "coefficient_of_variation_pct": 0.00                                         +
                      |     }                                                                                +
                      | }
-[ RECORD 21 ]--------+--------------------------------------------------------------------------------------
valid_from            | 2019-07-01
valid_to              | 2019-08-31
valid_until           | 2019-09-01
unit_type             | enterprise
external_idents       | {"tax_ident": "921835809"}
statistical_unit_data | {                                                                                    +
                      |     "name": "KRAN & SPESIALLØFT AS",                                                 +
                      |     "search": "'as':3 'kran':1 'spesialløft':2",                                     +
                      |     "domestic": true,                                                                +
                      |     "landline": null,                                                                +
                      |     "tag_paths": [                                                                   +
                      |     ],                                                                               +
                      |     "birth_date": "2013-01-01",                                                      +
                      |     "death_date": null,                                                              +
                      |     "fax_number": null,                                                              +
                      |     "sector_code": "2100",                                                           +
                      |     "sector_name": "Private aksjeselskaper mv.",                                     +
                      |     "sector_path": "innl.a_ikke_fin.2100",                                           +
                      |     "status_code": "active",                                                         +
                      |     "valid_until": "2019-09-01",                                                     +
                      |     "web_address": null,                                                             +
                      |     "phone_number": null,                                                            +
                      |     "email_address": null,                                                           +
                      |     "invalid_codes": null,                                                           +
                      |     "mobile_number": null,                                                           +
                      |     "has_legal_unit": true,                                                          +
                      |     "unit_size_code": null,                                                          +
                      |     "legal_form_code": "AS",                                                         +
                      |     "legal_form_name": "Aksjeselskap",                                               +
                      |     "postal_altitude": null,                                                         +
                      |     "postal_latitude": null,                                                         +
                      |     "postal_postcode": null,                                                         +
                      |     "postal_longitude": null,                                                        +
                      |     "postal_postplace": null,                                                        +
                      |     "data_source_codes": [                                                           +
                      |         "brreg",                                                                     +
                      |         "skatt"                                                                      +
                      |     ],                                                                               +
                      |     "last_edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",+
                      |     "physical_altitude": null,                                                       +
                      |     "physical_latitude": null,                                                       +
                      |     "physical_postcode": "4347",                                                     +
                      |     "used_for_counting": true,                                                       +
                      |     "physical_longitude": null,                                                      +
                      |     "physical_postplace": "LYE",                                                     +
                      |     "postal_region_code": null,                                                      +
                      |     "postal_region_path": null,                                                      +
                      |     "physical_region_code": "1121",                                                  +
                      |     "physical_region_path": "11.21",                                                 +
                      |     "postal_address_part1": null,                                                    +
                      |     "postal_address_part2": null,                                                    +
                      |     "postal_address_part3": null,                                                    +
                      |     "postal_country_iso_2": null,                                                    +
                      |     "physical_address_part1": "Vestlyvegen 219",                                     +
                      |     "physical_address_part2": null,                                                  +
                      |     "physical_address_part3": null,                                                  +
                      |     "physical_country_iso_2": "NO",                                                  +
                      |     "activity_category_paths": [                                                     +
                      |         "H.49.4.1.0"                                                                 +
                      |     ],                                                                               +
                      |     "included_enterprise_count": 1,                                                  +
                      |     "included_legal_unit_count": 1,                                                  +
                      |     "included_establishment_count": 1,                                               +
                      |     "primary_activity_category_code": "49.410",                                      +
                      |     "primary_activity_category_path": "H.49.4.1.0",                                  +
                      |     "secondary_activity_category_code": null,                                        +
                      |     "secondary_activity_category_path": null                                         +
                      | }
stats                 | 
stats_summary         | {                                                                                    +
                      |     "turnover": {                                                                    +
                      |         "max": 60000000,                                                             +
                      |         "min": 60000000,                                                             +
                      |         "sum": 60000000,                                                             +
                      |         "mean": 60000000.00,                                                         +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0.00,                                                              +
                      |         "variance": 0.00,                                                            +
                      |         "sum_sq_diff": 0.00,                                                         +
                      |         "coefficient_of_variation_pct": 0.00                                         +
                      |     },                                                                               +
                      |     "employees": {                                                                   +
                      |         "max": 40,                                                                   +
                      |         "min": 40,                                                                   +
                      |         "sum": 40,                                                                   +
                      |         "mean": 40.00,                                                               +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0.00,                                                              +
                      |         "variance": 0.00,                                                            +
                      |         "sum_sq_diff": 0.00,                                                         +
                      |         "coefficient_of_variation_pct": 0.00                                         +
                      |     }                                                                                +
                      | }
-[ RECORD 22 ]--------+--------------------------------------------------------------------------------------
valid_from            | 2019-09-01
valid_to              | 2019-10-31
valid_until           | 2019-11-01
unit_type             | establishment
external_idents       | {"tax_ident": "895406732"}
statistical_unit_data | {                                                                                    +
                      |     "name": "KRAN & SPESIALLØFT AS",                                                 +
                      |     "search": "'as':3 'kran':1 'spesialløft':2",                                     +
                      |     "domestic": true,                                                                +
                      |     "landline": null,                                                                +
                      |     "tag_paths": [                                                                   +
                      |     ],                                                                               +
                      |     "birth_date": "2010-01-01",                                                      +
                      |     "death_date": null,                                                              +
                      |     "fax_number": null,                                                              +
                      |     "sector_code": null,                                                             +
                      |     "sector_name": null,                                                             +
                      |     "sector_path": null,                                                             +
                      |     "status_code": "active",                                                         +
                      |     "valid_until": "2019-11-01",                                                     +
                      |     "web_address": null,                                                             +
                      |     "phone_number": null,                                                            +
                      |     "email_address": null,                                                           +
                      |     "invalid_codes": null,                                                           +
                      |     "mobile_number": null,                                                           +
                      |     "has_legal_unit": true,                                                          +
                      |     "unit_size_code": "med",                                                         +
                      |     "legal_form_code": null,                                                         +
                      |     "legal_form_name": null,                                                         +
                      |     "postal_altitude": null,                                                         +
                      |     "postal_latitude": null,                                                         +
                      |     "postal_postcode": null,                                                         +
                      |     "postal_longitude": null,                                                        +
                      |     "postal_postplace": null,                                                        +
                      |     "data_source_codes": [                                                           +
                      |         "brreg"                                                                      +
                      |     ],                                                                               +
                      |     "last_edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",+
                      |     "physical_altitude": null,                                                       +
                      |     "physical_latitude": null,                                                       +
                      |     "physical_postcode": "4347",                                                     +
                      |     "used_for_counting": true,                                                       +
                      |     "physical_longitude": null,                                                      +
                      |     "physical_postplace": "LYE",                                                     +
                      |     "postal_region_code": null,                                                      +
                      |     "postal_region_path": null,                                                      +
                      |     "physical_region_code": "1121",                                                  +
                      |     "physical_region_path": "11.21",                                                 +
                      |     "postal_address_part1": null,                                                    +
                      |     "postal_address_part2": null,                                                    +
                      |     "postal_address_part3": null,                                                    +
                      |     "postal_country_iso_2": null,                                                    +
                      |     "physical_address_part1": "Vestlyvegen 219",                                     +
                      |     "physical_address_part2": null,                                                  +
                      |     "physical_address_part3": null,                                                  +
                      |     "physical_country_iso_2": "NO",                                                  +
                      |     "activity_category_paths": [                                                     +
                      |         "H.49.4.1.0"                                                                 +
                      |     ],                                                                               +
                      |     "included_enterprise_count": null,                                               +
                      |     "included_legal_unit_count": null,                                               +
                      |     "included_establishment_count": 1,                                               +
                      |     "primary_activity_category_code": "49.410",                                      +
                      |     "primary_activity_category_path": "H.49.4.1.0",                                  +
                      |     "secondary_activity_category_code": null,                                        +
                      |     "secondary_activity_category_path": null                                         +
                      | }
stats                 | {                                                                                    +
                      |     "turnover": 60000000,                                                            +
                      |     "employees": 50                                                                  +
                      | }
stats_summary         | {                                                                                    +
                      |     "turnover": {                                                                    +
                      |         "max": 60000000,                                                             +
                      |         "min": 60000000,                                                             +
                      |         "sum": 60000000,                                                             +
                      |         "mean": 60000000,                                                            +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0,                                                                 +
                      |         "variance": 0,                                                               +
                      |         "sum_sq_diff": 0,                                                            +
                      |         "coefficient_of_variation_pct": 0                                            +
                      |     },                                                                               +
                      |     "employees": {                                                                   +
                      |         "max": 50,                                                                   +
                      |         "min": 50,                                                                   +
                      |         "sum": 50,                                                                   +
                      |         "mean": 50,                                                                  +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0,                                                                 +
                      |         "variance": 0,                                                               +
                      |         "sum_sq_diff": 0,                                                            +
                      |         "coefficient_of_variation_pct": 0                                            +
                      |     }                                                                                +
                      | }
-[ RECORD 23 ]--------+--------------------------------------------------------------------------------------
valid_from            | 2019-09-01
valid_to              | 2019-10-31
valid_until           | 2019-11-01
unit_type             | legal_unit
external_idents       | {"tax_ident": "921835809"}
statistical_unit_data | {                                                                                    +
                      |     "name": "KRAN & SPESIALLØFT AS",                                                 +
                      |     "search": "'as':3 'kran':1 'spesialløft':2",                                     +
                      |     "domestic": true,                                                                +
                      |     "landline": null,                                                                +
                      |     "tag_paths": [                                                                   +
                      |     ],                                                                               +
                      |     "birth_date": "2013-01-01",                                                      +
                      |     "death_date": null,                                                              +
                      |     "fax_number": null,                                                              +
                      |     "sector_code": "2100",                                                           +
                      |     "sector_name": "Private aksjeselskaper mv.",                                     +
                      |     "sector_path": "innl.a_ikke_fin.2100",                                           +
                      |     "status_code": "active",                                                         +
                      |     "valid_until": "2019-11-01",                                                     +
                      |     "web_address": null,                                                             +
                      |     "phone_number": null,                                                            +
                      |     "email_address": null,                                                           +
                      |     "invalid_codes": null,                                                           +
                      |     "mobile_number": null,                                                           +
                      |     "has_legal_unit": true,                                                          +
                      |     "unit_size_code": null,                                                          +
                      |     "legal_form_code": "AS",                                                         +
                      |     "legal_form_name": "Aksjeselskap",                                               +
                      |     "postal_altitude": null,                                                         +
                      |     "postal_latitude": null,                                                         +
                      |     "postal_postcode": null,                                                         +
                      |     "postal_longitude": null,                                                        +
                      |     "postal_postplace": null,                                                        +
                      |     "data_source_codes": [                                                           +
                      |         "brreg",                                                                     +
                      |         "skatt"                                                                      +
                      |     ],                                                                               +
                      |     "last_edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",+
                      |     "physical_altitude": null,                                                       +
                      |     "physical_latitude": null,                                                       +
                      |     "physical_postcode": "4347",                                                     +
                      |     "used_for_counting": true,                                                       +
                      |     "physical_longitude": null,                                                      +
                      |     "physical_postplace": "LYE",                                                     +
                      |     "postal_region_code": null,                                                      +
                      |     "postal_region_path": null,                                                      +
                      |     "physical_region_code": "1121",                                                  +
                      |     "physical_region_path": "11.21",                                                 +
                      |     "postal_address_part1": null,                                                    +
                      |     "postal_address_part2": null,                                                    +
                      |     "postal_address_part3": null,                                                    +
                      |     "postal_country_iso_2": null,                                                    +
                      |     "physical_address_part1": "Vestlyvegen 219",                                     +
                      |     "physical_address_part2": null,                                                  +
                      |     "physical_address_part3": null,                                                  +
                      |     "physical_country_iso_2": "NO",                                                  +
                      |     "activity_category_paths": [                                                     +
                      |         "H.49.4.1.0"                                                                 +
                      |     ],                                                                               +
                      |     "included_enterprise_count": null,                                               +
                      |     "included_legal_unit_count": 1,                                                  +
                      |     "included_establishment_count": 1,                                               +
                      |     "primary_activity_category_code": "49.410",                                      +
                      |     "primary_activity_category_path": "H.49.4.1.0",                                  +
                      |     "secondary_activity_category_code": null,                                        +
                      |     "secondary_activity_category_path": null                                         +
                      | }
stats                 | {                                                                                    +
                      | }
stats_summary         | {                                                                                    +
                      |     "turnover": {                                                                    +
                      |         "max": 60000000,                                                             +
                      |         "min": 60000000,                                                             +
                      |         "sum": 60000000,                                                             +
                      |         "mean": 60000000.00,                                                         +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0.00,                                                              +
                      |         "variance": 0.00,                                                            +
                      |         "sum_sq_diff": 0.00,                                                         +
                      |         "coefficient_of_variation_pct": 0.00                                         +
                      |     },                                                                               +
                      |     "employees": {                                                                   +
                      |         "max": 50,                                                                   +
                      |         "min": 50,                                                                   +
                      |         "sum": 50,                                                                   +
                      |         "mean": 50.00,                                                               +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0.00,                                                              +
                      |         "variance": 0.00,                                                            +
                      |         "sum_sq_diff": 0.00,                                                         +
                      |         "coefficient_of_variation_pct": 0.00                                         +
                      |     }                                                                                +
                      | }
-[ RECORD 24 ]--------+--------------------------------------------------------------------------------------
valid_from            | 2019-09-01
valid_to              | 2019-10-31
valid_until           | 2019-11-01
unit_type             | enterprise
external_idents       | {"tax_ident": "921835809"}
statistical_unit_data | {                                                                                    +
                      |     "name": "KRAN & SPESIALLØFT AS",                                                 +
                      |     "search": "'as':3 'kran':1 'spesialløft':2",                                     +
                      |     "domestic": true,                                                                +
                      |     "landline": null,                                                                +
                      |     "tag_paths": [                                                                   +
                      |     ],                                                                               +
                      |     "birth_date": "2013-01-01",                                                      +
                      |     "death_date": null,                                                              +
                      |     "fax_number": null,                                                              +
                      |     "sector_code": "2100",                                                           +
                      |     "sector_name": "Private aksjeselskaper mv.",                                     +
                      |     "sector_path": "innl.a_ikke_fin.2100",                                           +
                      |     "status_code": "active",                                                         +
                      |     "valid_until": "2019-11-01",                                                     +
                      |     "web_address": null,                                                             +
                      |     "phone_number": null,                                                            +
                      |     "email_address": null,                                                           +
                      |     "invalid_codes": null,                                                           +
                      |     "mobile_number": null,                                                           +
                      |     "has_legal_unit": true,                                                          +
                      |     "unit_size_code": null,                                                          +
                      |     "legal_form_code": "AS",                                                         +
                      |     "legal_form_name": "Aksjeselskap",                                               +
                      |     "postal_altitude": null,                                                         +
                      |     "postal_latitude": null,                                                         +
                      |     "postal_postcode": null,                                                         +
                      |     "postal_longitude": null,                                                        +
                      |     "postal_postplace": null,                                                        +
                      |     "data_source_codes": [                                                           +
                      |         "brreg",                                                                     +
                      |         "skatt"                                                                      +
                      |     ],                                                                               +
                      |     "last_edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",+
                      |     "physical_altitude": null,                                                       +
                      |     "physical_latitude": null,                                                       +
                      |     "physical_postcode": "4347",                                                     +
                      |     "used_for_counting": true,                                                       +
                      |     "physical_longitude": null,                                                      +
                      |     "physical_postplace": "LYE",                                                     +
                      |     "postal_region_code": null,                                                      +
                      |     "postal_region_path": null,                                                      +
                      |     "physical_region_code": "1121",                                                  +
                      |     "physical_region_path": "11.21",                                                 +
                      |     "postal_address_part1": null,                                                    +
                      |     "postal_address_part2": null,                                                    +
                      |     "postal_address_part3": null,                                                    +
                      |     "postal_country_iso_2": null,                                                    +
                      |     "physical_address_part1": "Vestlyvegen 219",                                     +
                      |     "physical_address_part2": null,                                                  +
                      |     "physical_address_part3": null,                                                  +
                      |     "physical_country_iso_2": "NO",                                                  +
                      |     "activity_category_paths": [                                                     +
                      |         "H.49.4.1.0"                                                                 +
                      |     ],                                                                               +
                      |     "included_enterprise_count": 1,                                                  +
                      |     "included_legal_unit_count": 1,                                                  +
                      |     "included_establishment_count": 1,                                               +
                      |     "primary_activity_category_code": "49.410",                                      +
                      |     "primary_activity_category_path": "H.49.4.1.0",                                  +
                      |     "secondary_activity_category_code": null,                                        +
                      |     "secondary_activity_category_path": null                                         +
                      | }
stats                 | 
stats_summary         | {                                                                                    +
                      |     "turnover": {                                                                    +
                      |         "max": 60000000,                                                             +
                      |         "min": 60000000,                                                             +
                      |         "sum": 60000000,                                                             +
                      |         "mean": 60000000.00,                                                         +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0.00,                                                              +
                      |         "variance": 0.00,                                                            +
                      |         "sum_sq_diff": 0.00,                                                         +
                      |         "coefficient_of_variation_pct": 0.00                                         +
                      |     },                                                                               +
                      |     "employees": {                                                                   +
                      |         "max": 50,                                                                   +
                      |         "min": 50,                                                                   +
                      |         "sum": 50,                                                                   +
                      |         "mean": 50.00,                                                               +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0.00,                                                              +
                      |         "variance": 0.00,                                                            +
                      |         "sum_sq_diff": 0.00,                                                         +
                      |         "coefficient_of_variation_pct": 0.00                                         +
                      |     }                                                                                +
                      | }
-[ RECORD 25 ]--------+--------------------------------------------------------------------------------------
valid_from            | 2019-11-01
valid_to              | 2019-12-31
valid_until           | 2020-01-01
unit_type             | establishment
external_idents       | {"tax_ident": "895406732"}
statistical_unit_data | {                                                                                    +
                      |     "name": "KRAN & SPESIALLØFT AS",                                                 +
                      |     "search": "'as':3 'kran':1 'spesialløft':2",                                     +
                      |     "domestic": true,                                                                +
                      |     "landline": null,                                                                +
                      |     "tag_paths": [                                                                   +
                      |     ],                                                                               +
                      |     "birth_date": "2010-01-01",                                                      +
                      |     "death_date": null,                                                              +
                      |     "fax_number": null,                                                              +
                      |     "sector_code": null,                                                             +
                      |     "sector_name": null,                                                             +
                      |     "sector_path": null,                                                             +
                      |     "status_code": "active",                                                         +
                      |     "valid_until": "2020-01-01",                                                     +
                      |     "web_address": null,                                                             +
                      |     "phone_number": null,                                                            +
                      |     "email_address": null,                                                           +
                      |     "invalid_codes": null,                                                           +
                      |     "mobile_number": null,                                                           +
                      |     "has_legal_unit": true,                                                          +
                      |     "unit_size_code": "med",                                                         +
                      |     "legal_form_code": null,                                                         +
                      |     "legal_form_name": null,                                                         +
                      |     "postal_altitude": null,                                                         +
                      |     "postal_latitude": null,                                                         +
                      |     "postal_postcode": null,                                                         +
                      |     "postal_longitude": null,                                                        +
                      |     "postal_postplace": null,                                                        +
                      |     "data_source_codes": [                                                           +
                      |         "brreg"                                                                      +
                      |     ],                                                                               +
                      |     "last_edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",+
                      |     "physical_altitude": null,                                                       +
                      |     "physical_latitude": null,                                                       +
                      |     "physical_postcode": "4347",                                                     +
                      |     "used_for_counting": true,                                                       +
                      |     "physical_longitude": null,                                                      +
                      |     "physical_postplace": "LYE",                                                     +
                      |     "postal_region_code": null,                                                      +
                      |     "postal_region_path": null,                                                      +
                      |     "physical_region_code": "1121",                                                  +
                      |     "physical_region_path": "11.21",                                                 +
                      |     "postal_address_part1": null,                                                    +
                      |     "postal_address_part2": null,                                                    +
                      |     "postal_address_part3": null,                                                    +
                      |     "postal_country_iso_2": null,                                                    +
                      |     "physical_address_part1": "Vestlyvegen 219",                                     +
                      |     "physical_address_part2": null,                                                  +
                      |     "physical_address_part3": null,                                                  +
                      |     "physical_country_iso_2": "NO",                                                  +
                      |     "activity_category_paths": [                                                     +
                      |         "H.49.4.1.0"                                                                 +
                      |     ],                                                                               +
                      |     "included_enterprise_count": null,                                               +
                      |     "included_legal_unit_count": null,                                               +
                      |     "included_establishment_count": 1,                                               +
                      |     "primary_activity_category_code": "49.410",                                      +
                      |     "primary_activity_category_path": "H.49.4.1.0",                                  +
                      |     "secondary_activity_category_code": null,                                        +
                      |     "secondary_activity_category_path": null                                         +
                      | }
stats                 | {                                                                                    +
                      |     "turnover": 60000000,                                                            +
                      |     "employees": 40                                                                  +
                      | }
stats_summary         | {                                                                                    +
                      |     "turnover": {                                                                    +
                      |         "max": 60000000,                                                             +
                      |         "min": 60000000,                                                             +
                      |         "sum": 60000000,                                                             +
                      |         "mean": 60000000,                                                            +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0,                                                                 +
                      |         "variance": 0,                                                               +
                      |         "sum_sq_diff": 0,                                                            +
                      |         "coefficient_of_variation_pct": 0                                            +
                      |     },                                                                               +
                      |     "employees": {                                                                   +
                      |         "max": 40,                                                                   +
                      |         "min": 40,                                                                   +
                      |         "sum": 40,                                                                   +
                      |         "mean": 40,                                                                  +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0,                                                                 +
                      |         "variance": 0,                                                               +
                      |         "sum_sq_diff": 0,                                                            +
                      |         "coefficient_of_variation_pct": 0                                            +
                      |     }                                                                                +
                      | }
-[ RECORD 26 ]--------+--------------------------------------------------------------------------------------
valid_from            | 2019-11-01
valid_to              | 2019-12-31
valid_until           | 2020-01-01
unit_type             | legal_unit
external_idents       | {"tax_ident": "921835809"}
statistical_unit_data | {                                                                                    +
                      |     "name": "KRAN & SPESIALLØFT AS",                                                 +
                      |     "search": "'as':3 'kran':1 'spesialløft':2",                                     +
                      |     "domestic": true,                                                                +
                      |     "landline": null,                                                                +
                      |     "tag_paths": [                                                                   +
                      |     ],                                                                               +
                      |     "birth_date": "2013-01-01",                                                      +
                      |     "death_date": null,                                                              +
                      |     "fax_number": null,                                                              +
                      |     "sector_code": "2100",                                                           +
                      |     "sector_name": "Private aksjeselskaper mv.",                                     +
                      |     "sector_path": "innl.a_ikke_fin.2100",                                           +
                      |     "status_code": "active",                                                         +
                      |     "valid_until": "2020-01-01",                                                     +
                      |     "web_address": null,                                                             +
                      |     "phone_number": null,                                                            +
                      |     "email_address": null,                                                           +
                      |     "invalid_codes": null,                                                           +
                      |     "mobile_number": null,                                                           +
                      |     "has_legal_unit": true,                                                          +
                      |     "unit_size_code": null,                                                          +
                      |     "legal_form_code": "AS",                                                         +
                      |     "legal_form_name": "Aksjeselskap",                                               +
                      |     "postal_altitude": null,                                                         +
                      |     "postal_latitude": null,                                                         +
                      |     "postal_postcode": null,                                                         +
                      |     "postal_longitude": null,                                                        +
                      |     "postal_postplace": null,                                                        +
                      |     "data_source_codes": [                                                           +
                      |         "brreg",                                                                     +
                      |         "skatt"                                                                      +
                      |     ],                                                                               +
                      |     "last_edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",+
                      |     "physical_altitude": null,                                                       +
                      |     "physical_latitude": null,                                                       +
                      |     "physical_postcode": "4347",                                                     +
                      |     "used_for_counting": true,                                                       +
                      |     "physical_longitude": null,                                                      +
                      |     "physical_postplace": "LYE",                                                     +
                      |     "postal_region_code": null,                                                      +
                      |     "postal_region_path": null,                                                      +
                      |     "physical_region_code": "1121",                                                  +
                      |     "physical_region_path": "11.21",                                                 +
                      |     "postal_address_part1": null,                                                    +
                      |     "postal_address_part2": null,                                                    +
                      |     "postal_address_part3": null,                                                    +
                      |     "postal_country_iso_2": null,                                                    +
                      |     "physical_address_part1": "Vestlyvegen 219",                                     +
                      |     "physical_address_part2": null,                                                  +
                      |     "physical_address_part3": null,                                                  +
                      |     "physical_country_iso_2": "NO",                                                  +
                      |     "activity_category_paths": [                                                     +
                      |         "H.49.4.1.0"                                                                 +
                      |     ],                                                                               +
                      |     "included_enterprise_count": null,                                               +
                      |     "included_legal_unit_count": 1,                                                  +
                      |     "included_establishment_count": 1,                                               +
                      |     "primary_activity_category_code": "49.410",                                      +
                      |     "primary_activity_category_path": "H.49.4.1.0",                                  +
                      |     "secondary_activity_category_code": null,                                        +
                      |     "secondary_activity_category_path": null                                         +
                      | }
stats                 | {                                                                                    +
                      | }
stats_summary         | {                                                                                    +
                      |     "turnover": {                                                                    +
                      |         "max": 60000000,                                                             +
                      |         "min": 60000000,                                                             +
                      |         "sum": 60000000,                                                             +
                      |         "mean": 60000000.00,                                                         +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0.00,                                                              +
                      |         "variance": 0.00,                                                            +
                      |         "sum_sq_diff": 0.00,                                                         +
                      |         "coefficient_of_variation_pct": 0.00                                         +
                      |     },                                                                               +
                      |     "employees": {                                                                   +
                      |         "max": 40,                                                                   +
                      |         "min": 40,                                                                   +
                      |         "sum": 40,                                                                   +
                      |         "mean": 40.00,                                                               +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0.00,                                                              +
                      |         "variance": 0.00,                                                            +
                      |         "sum_sq_diff": 0.00,                                                         +
                      |         "coefficient_of_variation_pct": 0.00                                         +
                      |     }                                                                                +
                      | }
-[ RECORD 27 ]--------+--------------------------------------------------------------------------------------
valid_from            | 2019-11-01
valid_to              | 2019-12-31
valid_until           | 2020-01-01
unit_type             | enterprise
external_idents       | {"tax_ident": "921835809"}
statistical_unit_data | {                                                                                    +
                      |     "name": "KRAN & SPESIALLØFT AS",                                                 +
                      |     "search": "'as':3 'kran':1 'spesialløft':2",                                     +
                      |     "domestic": true,                                                                +
                      |     "landline": null,                                                                +
                      |     "tag_paths": [                                                                   +
                      |     ],                                                                               +
                      |     "birth_date": "2013-01-01",                                                      +
                      |     "death_date": null,                                                              +
                      |     "fax_number": null,                                                              +
                      |     "sector_code": "2100",                                                           +
                      |     "sector_name": "Private aksjeselskaper mv.",                                     +
                      |     "sector_path": "innl.a_ikke_fin.2100",                                           +
                      |     "status_code": "active",                                                         +
                      |     "valid_until": "2020-01-01",                                                     +
                      |     "web_address": null,                                                             +
                      |     "phone_number": null,                                                            +
                      |     "email_address": null,                                                           +
                      |     "invalid_codes": null,                                                           +
                      |     "mobile_number": null,                                                           +
                      |     "has_legal_unit": true,                                                          +
                      |     "unit_size_code": null,                                                          +
                      |     "legal_form_code": "AS",                                                         +
                      |     "legal_form_name": "Aksjeselskap",                                               +
                      |     "postal_altitude": null,                                                         +
                      |     "postal_latitude": null,                                                         +
                      |     "postal_postcode": null,                                                         +
                      |     "postal_longitude": null,                                                        +
                      |     "postal_postplace": null,                                                        +
                      |     "data_source_codes": [                                                           +
                      |         "brreg",                                                                     +
                      |         "skatt"                                                                      +
                      |     ],                                                                               +
                      |     "last_edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",+
                      |     "physical_altitude": null,                                                       +
                      |     "physical_latitude": null,                                                       +
                      |     "physical_postcode": "4347",                                                     +
                      |     "used_for_counting": true,                                                       +
                      |     "physical_longitude": null,                                                      +
                      |     "physical_postplace": "LYE",                                                     +
                      |     "postal_region_code": null,                                                      +
                      |     "postal_region_path": null,                                                      +
                      |     "physical_region_code": "1121",                                                  +
                      |     "physical_region_path": "11.21",                                                 +
                      |     "postal_address_part1": null,                                                    +
                      |     "postal_address_part2": null,                                                    +
                      |     "postal_address_part3": null,                                                    +
                      |     "postal_country_iso_2": null,                                                    +
                      |     "physical_address_part1": "Vestlyvegen 219",                                     +
                      |     "physical_address_part2": null,                                                  +
                      |     "physical_address_part3": null,                                                  +
                      |     "physical_country_iso_2": "NO",                                                  +
                      |     "activity_category_paths": [                                                     +
                      |         "H.49.4.1.0"                                                                 +
                      |     ],                                                                               +
                      |     "included_enterprise_count": 1,                                                  +
                      |     "included_legal_unit_count": 1,                                                  +
                      |     "included_establishment_count": 1,                                               +
                      |     "primary_activity_category_code": "49.410",                                      +
                      |     "primary_activity_category_path": "H.49.4.1.0",                                  +
                      |     "secondary_activity_category_code": null,                                        +
                      |     "secondary_activity_category_path": null                                         +
                      | }
stats                 | 
stats_summary         | {                                                                                    +
                      |     "turnover": {                                                                    +
                      |         "max": 60000000,                                                             +
                      |         "min": 60000000,                                                             +
                      |         "sum": 60000000,                                                             +
                      |         "mean": 60000000.00,                                                         +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0.00,                                                              +
                      |         "variance": 0.00,                                                            +
                      |         "sum_sq_diff": 0.00,                                                         +
                      |         "coefficient_of_variation_pct": 0.00                                         +
                      |     },                                                                               +
                      |     "employees": {                                                                   +
                      |         "max": 40,                                                                   +
                      |         "min": 40,                                                                   +
                      |         "sum": 40,                                                                   +
                      |         "mean": 40.00,                                                               +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0.00,                                                              +
                      |         "variance": 0.00,                                                            +
                      |         "sum_sq_diff": 0.00,                                                         +
                      |         "coefficient_of_variation_pct": 0.00                                         +
                      |     }                                                                                +
                      | }
-[ RECORD 28 ]--------+--------------------------------------------------------------------------------------
valid_from            | 2020-01-01
valid_to              | infinity
valid_until           | infinity
unit_type             | establishment
external_idents       | {"tax_ident": "895406732"}
statistical_unit_data | {                                                                                    +
                      |     "name": "KRAN & SPESIALLØFT AS",                                                 +
                      |     "search": "'as':3 'kran':1 'spesialløft':2",                                     +
                      |     "domestic": true,                                                                +
                      |     "landline": null,                                                                +
                      |     "tag_paths": [                                                                   +
                      |     ],                                                                               +
                      |     "birth_date": "2010-01-01",                                                      +
                      |     "death_date": null,                                                              +
                      |     "fax_number": null,                                                              +
                      |     "sector_code": null,                                                             +
                      |     "sector_name": null,                                                             +
                      |     "sector_path": null,                                                             +
                      |     "status_code": "active",                                                         +
                      |     "valid_until": "infinity",                                                       +
                      |     "web_address": null,                                                             +
                      |     "phone_number": null,                                                            +
                      |     "email_address": null,                                                           +
                      |     "invalid_codes": null,                                                           +
                      |     "mobile_number": null,                                                           +
                      |     "has_legal_unit": true,                                                          +
                      |     "unit_size_code": "lrg",                                                         +
                      |     "legal_form_code": null,                                                         +
                      |     "legal_form_name": null,                                                         +
                      |     "postal_altitude": null,                                                         +
                      |     "postal_latitude": null,                                                         +
                      |     "postal_postcode": null,                                                         +
                      |     "postal_longitude": null,                                                        +
                      |     "postal_postplace": null,                                                        +
                      |     "data_source_codes": [                                                           +
                      |         "brreg"                                                                      +
                      |     ],                                                                               +
                      |     "last_edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",+
                      |     "physical_altitude": null,                                                       +
                      |     "physical_latitude": null,                                                       +
                      |     "physical_postcode": "4347",                                                     +
                      |     "used_for_counting": true,                                                       +
                      |     "physical_longitude": null,                                                      +
                      |     "physical_postplace": "LYE",                                                     +
                      |     "postal_region_code": null,                                                      +
                      |     "postal_region_path": null,                                                      +
                      |     "physical_region_code": "1121",                                                  +
                      |     "physical_region_path": "11.21",                                                 +
                      |     "postal_address_part1": null,                                                    +
                      |     "postal_address_part2": null,                                                    +
                      |     "postal_address_part3": null,                                                    +
                      |     "postal_country_iso_2": null,                                                    +
                      |     "physical_address_part1": "Vestlyvegen 219",                                     +
                      |     "physical_address_part2": null,                                                  +
                      |     "physical_address_part3": null,                                                  +
                      |     "physical_country_iso_2": "NO",                                                  +
                      |     "activity_category_paths": [                                                     +
                      |         "H.49.4.1.0"                                                                 +
                      |     ],                                                                               +
                      |     "included_enterprise_count": null,                                               +
                      |     "included_legal_unit_count": null,                                               +
                      |     "included_establishment_count": 1,                                               +
                      |     "primary_activity_category_code": "49.410",                                      +
                      |     "primary_activity_category_path": "H.49.4.1.0",                                  +
                      |     "secondary_activity_category_code": null,                                        +
                      |     "secondary_activity_category_path": null                                         +
                      | }
stats                 | {                                                                                    +
                      |     "turnover": 70000000,                                                            +
                      |     "employees": 45                                                                  +
                      | }
stats_summary         | {                                                                                    +
                      |     "turnover": {                                                                    +
                      |         "max": 70000000,                                                             +
                      |         "min": 70000000,                                                             +
                      |         "sum": 70000000,                                                             +
                      |         "mean": 70000000,                                                            +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0,                                                                 +
                      |         "variance": 0,                                                               +
                      |         "sum_sq_diff": 0,                                                            +
                      |         "coefficient_of_variation_pct": 0                                            +
                      |     },                                                                               +
                      |     "employees": {                                                                   +
                      |         "max": 45,                                                                   +
                      |         "min": 45,                                                                   +
                      |         "sum": 45,                                                                   +
                      |         "mean": 45,                                                                  +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0,                                                                 +
                      |         "variance": 0,                                                               +
                      |         "sum_sq_diff": 0,                                                            +
                      |         "coefficient_of_variation_pct": 0                                            +
                      |     }                                                                                +
                      | }
-[ RECORD 29 ]--------+--------------------------------------------------------------------------------------
valid_from            | 2020-01-01
valid_to              | infinity
valid_until           | infinity
unit_type             | legal_unit
external_idents       | {"tax_ident": "921835809"}
statistical_unit_data | {                                                                                    +
                      |     "name": "KRAN & SPESIALLØFT AS",                                                 +
                      |     "search": "'as':3 'kran':1 'spesialløft':2",                                     +
                      |     "domestic": true,                                                                +
                      |     "landline": null,                                                                +
                      |     "tag_paths": [                                                                   +
                      |     ],                                                                               +
                      |     "birth_date": "2013-01-01",                                                      +
                      |     "death_date": null,                                                              +
                      |     "fax_number": null,                                                              +
                      |     "sector_code": "2100",                                                           +
                      |     "sector_name": "Private aksjeselskaper mv.",                                     +
                      |     "sector_path": "innl.a_ikke_fin.2100",                                           +
                      |     "status_code": "active",                                                         +
                      |     "valid_until": "infinity",                                                       +
                      |     "web_address": null,                                                             +
                      |     "phone_number": null,                                                            +
                      |     "email_address": null,                                                           +
                      |     "invalid_codes": null,                                                           +
                      |     "mobile_number": null,                                                           +
                      |     "has_legal_unit": true,                                                          +
                      |     "unit_size_code": null,                                                          +
                      |     "legal_form_code": "AS",                                                         +
                      |     "legal_form_name": "Aksjeselskap",                                               +
                      |     "postal_altitude": null,                                                         +
                      |     "postal_latitude": null,                                                         +
                      |     "postal_postcode": null,                                                         +
                      |     "postal_longitude": null,                                                        +
                      |     "postal_postplace": null,                                                        +
                      |     "data_source_codes": [                                                           +
                      |         "brreg",                                                                     +
                      |         "skatt"                                                                      +
                      |     ],                                                                               +
                      |     "last_edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",+
                      |     "physical_altitude": null,                                                       +
                      |     "physical_latitude": null,                                                       +
                      |     "physical_postcode": "4347",                                                     +
                      |     "used_for_counting": true,                                                       +
                      |     "physical_longitude": null,                                                      +
                      |     "physical_postplace": "LYE",                                                     +
                      |     "postal_region_code": null,                                                      +
                      |     "postal_region_path": null,                                                      +
                      |     "physical_region_code": "1121",                                                  +
                      |     "physical_region_path": "11.21",                                                 +
                      |     "postal_address_part1": null,                                                    +
                      |     "postal_address_part2": null,                                                    +
                      |     "postal_address_part3": null,                                                    +
                      |     "postal_country_iso_2": null,                                                    +
                      |     "physical_address_part1": "Vestlyvegen 219",                                     +
                      |     "physical_address_part2": null,                                                  +
                      |     "physical_address_part3": null,                                                  +
                      |     "physical_country_iso_2": "NO",                                                  +
                      |     "activity_category_paths": [                                                     +
                      |         "H.49.4.1.0"                                                                 +
                      |     ],                                                                               +
                      |     "included_enterprise_count": null,                                               +
                      |     "included_legal_unit_count": 1,                                                  +
                      |     "included_establishment_count": 1,                                               +
                      |     "primary_activity_category_code": "49.410",                                      +
                      |     "primary_activity_category_path": "H.49.4.1.0",                                  +
                      |     "secondary_activity_category_code": null,                                        +
                      |     "secondary_activity_category_path": null                                         +
                      | }
stats                 | {                                                                                    +
                      | }
stats_summary         | {                                                                                    +
                      |     "turnover": {                                                                    +
                      |         "max": 70000000,                                                             +
                      |         "min": 70000000,                                                             +
                      |         "sum": 70000000,                                                             +
                      |         "mean": 70000000.00,                                                         +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0.00,                                                              +
                      |         "variance": 0.00,                                                            +
                      |         "sum_sq_diff": 0.00,                                                         +
                      |         "coefficient_of_variation_pct": 0.00                                         +
                      |     },                                                                               +
                      |     "employees": {                                                                   +
                      |         "max": 45,                                                                   +
                      |         "min": 45,                                                                   +
                      |         "sum": 45,                                                                   +
                      |         "mean": 45.00,                                                               +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0.00,                                                              +
                      |         "variance": 0.00,                                                            +
                      |         "sum_sq_diff": 0.00,                                                         +
                      |         "coefficient_of_variation_pct": 0.00                                         +
                      |     }                                                                                +
                      | }
-[ RECORD 30 ]--------+--------------------------------------------------------------------------------------
valid_from            | 2020-01-01
valid_to              | infinity
valid_until           | infinity
unit_type             | enterprise
external_idents       | {"tax_ident": "921835809"}
statistical_unit_data | {                                                                                    +
                      |     "name": "KRAN & SPESIALLØFT AS",                                                 +
                      |     "search": "'as':3 'kran':1 'spesialløft':2",                                     +
                      |     "domestic": true,                                                                +
                      |     "landline": null,                                                                +
                      |     "tag_paths": [                                                                   +
                      |     ],                                                                               +
                      |     "birth_date": "2013-01-01",                                                      +
                      |     "death_date": null,                                                              +
                      |     "fax_number": null,                                                              +
                      |     "sector_code": "2100",                                                           +
                      |     "sector_name": "Private aksjeselskaper mv.",                                     +
                      |     "sector_path": "innl.a_ikke_fin.2100",                                           +
                      |     "status_code": "active",                                                         +
                      |     "valid_until": "infinity",                                                       +
                      |     "web_address": null,                                                             +
                      |     "phone_number": null,                                                            +
                      |     "email_address": null,                                                           +
                      |     "invalid_codes": null,                                                           +
                      |     "mobile_number": null,                                                           +
                      |     "has_legal_unit": true,                                                          +
                      |     "unit_size_code": null,                                                          +
                      |     "legal_form_code": "AS",                                                         +
                      |     "legal_form_name": "Aksjeselskap",                                               +
                      |     "postal_altitude": null,                                                         +
                      |     "postal_latitude": null,                                                         +
                      |     "postal_postcode": null,                                                         +
                      |     "postal_longitude": null,                                                        +
                      |     "postal_postplace": null,                                                        +
                      |     "data_source_codes": [                                                           +
                      |         "brreg",                                                                     +
                      |         "skatt"                                                                      +
                      |     ],                                                                               +
                      |     "last_edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",+
                      |     "physical_altitude": null,                                                       +
                      |     "physical_latitude": null,                                                       +
                      |     "physical_postcode": "4347",                                                     +
                      |     "used_for_counting": true,                                                       +
                      |     "physical_longitude": null,                                                      +
                      |     "physical_postplace": "LYE",                                                     +
                      |     "postal_region_code": null,                                                      +
                      |     "postal_region_path": null,                                                      +
                      |     "physical_region_code": "1121",                                                  +
                      |     "physical_region_path": "11.21",                                                 +
                      |     "postal_address_part1": null,                                                    +
                      |     "postal_address_part2": null,                                                    +
                      |     "postal_address_part3": null,                                                    +
                      |     "postal_country_iso_2": null,                                                    +
                      |     "physical_address_part1": "Vestlyvegen 219",                                     +
                      |     "physical_address_part2": null,                                                  +
                      |     "physical_address_part3": null,                                                  +
                      |     "physical_country_iso_2": "NO",                                                  +
                      |     "activity_category_paths": [                                                     +
                      |         "H.49.4.1.0"                                                                 +
                      |     ],                                                                               +
                      |     "included_enterprise_count": 1,                                                  +
                      |     "included_legal_unit_count": 1,                                                  +
                      |     "included_establishment_count": 1,                                               +
                      |     "primary_activity_category_code": "49.410",                                      +
                      |     "primary_activity_category_path": "H.49.4.1.0",                                  +
                      |     "secondary_activity_category_code": null,                                        +
                      |     "secondary_activity_category_path": null                                         +
                      | }
stats                 | 
stats_summary         | {                                                                                    +
                      |     "turnover": {                                                                    +
                      |         "max": 70000000,                                                             +
                      |         "min": 70000000,                                                             +
                      |         "sum": 70000000,                                                             +
                      |         "mean": 70000000.00,                                                         +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0.00,                                                              +
                      |         "variance": 0.00,                                                            +
                      |         "sum_sq_diff": 0.00,                                                         +
                      |         "coefficient_of_variation_pct": 0.00                                         +
                      |     },                                                                               +
                      |     "employees": {                                                                   +
                      |         "max": 45,                                                                   +
                      |         "min": 45,                                                                   +
                      |         "sum": 45,                                                                   +
                      |         "mean": 45.00,                                                               +
                      |         "type": "number",                                                            +
                      |         "count": 1,                                                                  +
                      |         "stddev": 0.00,                                                              +
                      |         "variance": 0.00,                                                            +
                      |         "sum_sq_diff": 0.00,                                                         +
                      |         "coefficient_of_variation_pct": 0.00                                         +
                      |     }                                                                                +
                      | }

\echo "Checking statistical_unit totals"
"Checking statistical_unit totals"
SELECT unit_type
     , COUNT(DISTINCT unit_id) AS distinct_unit_count
     , jsonb_agg(DISTINCT invalid_codes) FILTER (WHERE invalid_codes IS NOT NULL) AS invalid_codes
     , jsonb_pretty(jsonb_stats_summary_merge_agg(stats_summary)) AS stats_summary
 FROM statistical_unit
 GROUP BY unit_type;
-[ RECORD 1 ]-------+----------------------------------------------
unit_type           | establishment
distinct_unit_count | 1
invalid_codes       | 
stats_summary       | {                                            +
                    |     "turnover": {                            +
                    |         "max": 70000000,                     +
                    |         "min": 1500000,                      +
                    |         "sum": 446500000,                    +
                    |         "mean": 44650000.00,                 +
                    |         "type": "number",                    +
                    |         "count": 10,                         +
                    |         "stddev": 27323219.67,               +
                    |         "variance": 746558333333333.33,      +
                    |         "sum_sq_diff": 6719025000000000.00,  +
                    |         "coefficient_of_variation_pct": 61.19+
                    |     },                                       +
                    |     "employees": {                           +
                    |         "max": 50,                           +
                    |         "min": 1,                            +
                    |         "sum": 278,                          +
                    |         "mean": 27.80,                       +
                    |         "type": "number",                    +
                    |         "count": 10,                         +
                    |         "stddev": 17.76,                     +
                    |         "variance": 315.29,                  +
                    |         "sum_sq_diff": 2837.60,              +
                    |         "coefficient_of_variation_pct": 63.87+
                    |     }                                        +
                    | }
-[ RECORD 2 ]-------+----------------------------------------------
unit_type           | legal_unit
distinct_unit_count | 2
invalid_codes       | 
stats_summary       | {                                            +
                    |     "turnover": {                            +
                    |         "max": 70000000,                     +
                    |         "min": 1500000,                      +
                    |         "sum": 446500000,                    +
                    |         "mean": 44650000.00,                 +
                    |         "type": "number",                    +
                    |         "count": 10,                         +
                    |         "stddev": 27323219.67,               +
                    |         "variance": 746558333333333.33,      +
                    |         "sum_sq_diff": 6719025000000000.00,  +
                    |         "coefficient_of_variation_pct": 61.19+
                    |     },                                       +
                    |     "employees": {                           +
                    |         "max": 50,                           +
                    |         "min": 1,                            +
                    |         "sum": 278,                          +
                    |         "mean": 27.80,                       +
                    |         "type": "number",                    +
                    |         "count": 10,                         +
                    |         "stddev": 17.76,                     +
                    |         "variance": 315.29,                  +
                    |         "sum_sq_diff": 2837.60,              +
                    |         "coefficient_of_variation_pct": 63.87+
                    |     }                                        +
                    | }
-[ RECORD 3 ]-------+----------------------------------------------
unit_type           | enterprise
distinct_unit_count | 2
invalid_codes       | 
stats_summary       | {                                            +
                    |     "turnover": {                            +
                    |         "max": 70000000,                     +
                    |         "min": 1500000,                      +
                    |         "sum": 446500000,                    +
                    |         "mean": 44650000.00,                 +
                    |         "type": "number",                    +
                    |         "count": 10,                         +
                    |         "stddev": 27323219.67,               +
                    |         "variance": 746558333333333.33,      +
                    |         "sum_sq_diff": 6719025000000000.00,  +
                    |         "coefficient_of_variation_pct": 61.19+
                    |     },                                       +
                    |     "employees": {                           +
                    |         "max": 50,                           +
                    |         "min": 1,                            +
                    |         "sum": 278,                          +
                    |         "mean": 27.80,                       +
                    |         "type": "number",                    +
                    |         "count": 10,                         +
                    |         "stddev": 17.76,                     +
                    |         "variance": 315.29,                  +
                    |         "sum_sq_diff": 2837.60,              +
                    |         "coefficient_of_variation_pct": 63.87+
                    |     }                                        +
                    | }

\x
\echo "Test over the years"
"Test over the years"
\echo "Verify the generation of ranges for all periods"
"Verify the generation of ranges for all periods"
SELECT * FROM public.get_statistical_history_periods()
-- Only list previous years, so the test is stable over time.
WHERE year <= 2024;
 resolution | year | month | prev_stop  | curr_start | curr_stop  
------------+------+-------+------------+------------+------------
 year       | 2010 |       | 2009-12-31 | 2010-01-01 | 2010-12-31
 year       | 2011 |       | 2010-12-31 | 2011-01-01 | 2011-12-31
 year       | 2012 |       | 2011-12-31 | 2012-01-01 | 2012-12-31
 year       | 2013 |       | 2012-12-31 | 2013-01-01 | 2013-12-31
 year       | 2014 |       | 2013-12-31 | 2014-01-01 | 2014-12-31
 year       | 2015 |       | 2014-12-31 | 2015-01-01 | 2015-12-31
 year       | 2016 |       | 2015-12-31 | 2016-01-01 | 2016-12-31
 year       | 2017 |       | 2016-12-31 | 2017-01-01 | 2017-12-31
 year       | 2018 |       | 2017-12-31 | 2018-01-01 | 2018-12-31
 year       | 2019 |       | 2018-12-31 | 2019-01-01 | 2019-12-31
 year       | 2020 |       | 2019-12-31 | 2020-01-01 | 2020-12-31
 year       | 2021 |       | 2020-12-31 | 2021-01-01 | 2021-12-31
 year       | 2022 |       | 2021-12-31 | 2022-01-01 | 2022-12-31
 year       | 2023 |       | 2022-12-31 | 2023-01-01 | 2023-12-31
 year       | 2024 |       | 2023-12-31 | 2024-01-01 | 2024-12-31
 year-month | 2010 |     1 | 2009-12-31 | 2010-01-01 | 2010-01-31
 year-month | 2010 |     2 | 2010-01-31 | 2010-02-01 | 2010-02-28
 year-month | 2010 |     3 | 2010-02-28 | 2010-03-01 | 2010-03-31
 year-month | 2010 |     4 | 2010-03-31 | 2010-04-01 | 2010-04-30
 year-month | 2010 |     5 | 2010-04-30 | 2010-05-01 | 2010-05-31
 year-month | 2010 |     6 | 2010-05-31 | 2010-06-01 | 2010-06-30
 year-month | 2010 |     7 | 2010-06-30 | 2010-07-01 | 2010-07-31
 year-month | 2010 |     8 | 2010-07-31 | 2010-08-01 | 2010-08-31
 year-month | 2010 |     9 | 2010-08-31 | 2010-09-01 | 2010-09-30
 year-month | 2010 |    10 | 2010-09-30 | 2010-10-01 | 2010-10-31
 year-month | 2010 |    11 | 2010-10-31 | 2010-11-01 | 2010-11-30
 year-month | 2010 |    12 | 2010-11-30 | 2010-12-01 | 2010-12-31
 year-month | 2011 |     1 | 2010-12-31 | 2011-01-01 | 2011-01-31
 year-month | 2011 |     2 | 2011-01-31 | 2011-02-01 | 2011-02-28
 year-month | 2011 |     3 | 2011-02-28 | 2011-03-01 | 2011-03-31
 year-month | 2011 |     4 | 2011-03-31 | 2011-04-01 | 2011-04-30
 year-month | 2011 |     5 | 2011-04-30 | 2011-05-01 | 2011-05-31
 year-month | 2011 |     6 | 2011-05-31 | 2011-06-01 | 2011-06-30
 year-month | 2011 |     7 | 2011-06-30 | 2011-07-01 | 2011-07-31
 year-month | 2011 |     8 | 2011-07-31 | 2011-08-01 | 2011-08-31
 year-month | 2011 |     9 | 2011-08-31 | 2011-09-01 | 2011-09-30
 year-month | 2011 |    10 | 2011-09-30 | 2011-10-01 | 2011-10-31
 year-month | 2011 |    11 | 2011-10-31 | 2011-11-01 | 2011-11-30
 year-month | 2011 |    12 | 2011-11-30 | 2011-12-01 | 2011-12-31
 year-month | 2012 |     1 | 2011-12-31 | 2012-01-01 | 2012-01-31
 year-month | 2012 |     2 | 2012-01-31 | 2012-02-01 | 2012-02-29
 year-month | 2012 |     3 | 2012-02-29 | 2012-03-01 | 2012-03-31
 year-month | 2012 |     4 | 2012-03-31 | 2012-04-01 | 2012-04-30
 year-month | 2012 |     5 | 2012-04-30 | 2012-05-01 | 2012-05-31
 year-month | 2012 |     6 | 2012-05-31 | 2012-06-01 | 2012-06-30
 year-month | 2012 |     7 | 2012-06-30 | 2012-07-01 | 2012-07-31
 year-month | 2012 |     8 | 2012-07-31 | 2012-08-01 | 2012-08-31
 year-month | 2012 |     9 | 2012-08-31 | 2012-09-01 | 2012-09-30
 year-month | 2012 |    10 | 2012-09-30 | 2012-10-01 | 2012-10-31
 year-month | 2012 |    11 | 2012-10-31 | 2012-11-01 | 2012-11-30
 year-month | 2012 |    12 | 2012-11-30 | 2012-12-01 | 2012-12-31
 year-month | 2013 |     1 | 2012-12-31 | 2013-01-01 | 2013-01-31
 year-month | 2013 |     2 | 2013-01-31 | 2013-02-01 | 2013-02-28
 year-month | 2013 |     3 | 2013-02-28 | 2013-03-01 | 2013-03-31
 year-month | 2013 |     4 | 2013-03-31 | 2013-04-01 | 2013-04-30
 year-month | 2013 |     5 | 2013-04-30 | 2013-05-01 | 2013-05-31
 year-month | 2013 |     6 | 2013-05-31 | 2013-06-01 | 2013-06-30
 year-month | 2013 |     7 | 2013-06-30 | 2013-07-01 | 2013-07-31
 year-month | 2013 |     8 | 2013-07-31 | 2013-08-01 | 2013-08-31
 year-month | 2013 |     9 | 2013-08-31 | 2013-09-01 | 2013-09-30
 year-month | 2013 |    10 | 2013-09-30 | 2013-10-01 | 2013-10-31
 year-month | 2013 |    11 | 2013-10-31 | 2013-11-01 | 2013-11-30
 year-month | 2013 |    12 | 2013-11-30 | 2013-12-01 | 2013-12-31
 year-month | 2014 |     1 | 2013-12-31 | 2014-01-01 | 2014-01-31
 year-month | 2014 |     2 | 2014-01-31 | 2014-02-01 | 2014-02-28
 year-month | 2014 |     3 | 2014-02-28 | 2014-03-01 | 2014-03-31
 year-month | 2014 |     4 | 2014-03-31 | 2014-04-01 | 2014-04-30
 year-month | 2014 |     5 | 2014-04-30 | 2014-05-01 | 2014-05-31
 year-month | 2014 |     6 | 2014-05-31 | 2014-06-01 | 2014-06-30
 year-month | 2014 |     7 | 2014-06-30 | 2014-07-01 | 2014-07-31
 year-month | 2014 |     8 | 2014-07-31 | 2014-08-01 | 2014-08-31
 year-month | 2014 |     9 | 2014-08-31 | 2014-09-01 | 2014-09-30
 year-month | 2014 |    10 | 2014-09-30 | 2014-10-01 | 2014-10-31
 year-month | 2014 |    11 | 2014-10-31 | 2014-11-01 | 2014-11-30
 year-month | 2014 |    12 | 2014-11-30 | 2014-12-01 | 2014-12-31
 year-month | 2015 |     1 | 2014-12-31 | 2015-01-01 | 2015-01-31
 year-month | 2015 |     2 | 2015-01-31 | 2015-02-01 | 2015-02-28
 year-month | 2015 |     3 | 2015-02-28 | 2015-03-01 | 2015-03-31
 year-month | 2015 |     4 | 2015-03-31 | 2015-04-01 | 2015-04-30
 year-month | 2015 |     5 | 2015-04-30 | 2015-05-01 | 2015-05-31
 year-month | 2015 |     6 | 2015-05-31 | 2015-06-01 | 2015-06-30
 year-month | 2015 |     7 | 2015-06-30 | 2015-07-01 | 2015-07-31
 year-month | 2015 |     8 | 2015-07-31 | 2015-08-01 | 2015-08-31
 year-month | 2015 |     9 | 2015-08-31 | 2015-09-01 | 2015-09-30
 year-month | 2015 |    10 | 2015-09-30 | 2015-10-01 | 2015-10-31
 year-month | 2015 |    11 | 2015-10-31 | 2015-11-01 | 2015-11-30
 year-month | 2015 |    12 | 2015-11-30 | 2015-12-01 | 2015-12-31
 year-month | 2016 |     1 | 2015-12-31 | 2016-01-01 | 2016-01-31
 year-month | 2016 |     2 | 2016-01-31 | 2016-02-01 | 2016-02-29
 year-month | 2016 |     3 | 2016-02-29 | 2016-03-01 | 2016-03-31
 year-month | 2016 |     4 | 2016-03-31 | 2016-04-01 | 2016-04-30
 year-month | 2016 |     5 | 2016-04-30 | 2016-05-01 | 2016-05-31
 year-month | 2016 |     6 | 2016-05-31 | 2016-06-01 | 2016-06-30
 year-month | 2016 |     7 | 2016-06-30 | 2016-07-01 | 2016-07-31
 year-month | 2016 |     8 | 2016-07-31 | 2016-08-01 | 2016-08-31
 year-month | 2016 |     9 | 2016-08-31 | 2016-09-01 | 2016-09-30
 year-month | 2016 |    10 | 2016-09-30 | 2016-10-01 | 2016-10-31
 year-month | 2016 |    11 | 2016-10-31 | 2016-11-01 | 2016-11-30
 year-month | 2016 |    12 | 2016-11-30 | 2016-12-01 | 2016-12-31
 year-month | 2017 |     1 | 2016-12-31 | 2017-01-01 | 2017-01-31
 year-month | 2017 |     2 | 2017-01-31 | 2017-02-01 | 2017-02-28
 year-month | 2017 |     3 | 2017-02-28 | 2017-03-01 | 2017-03-31
 year-month | 2017 |     4 | 2017-03-31 | 2017-04-01 | 2017-04-30
 year-month | 2017 |     5 | 2017-04-30 | 2017-05-01 | 2017-05-31
 year-month | 2017 |     6 | 2017-05-31 | 2017-06-01 | 2017-06-30
 year-month | 2017 |     7 | 2017-06-30 | 2017-07-01 | 2017-07-31
 year-month | 2017 |     8 | 2017-07-31 | 2017-08-01 | 2017-08-31
 year-month | 2017 |     9 | 2017-08-31 | 2017-09-01 | 2017-09-30
 year-month | 2017 |    10 | 2017-09-30 | 2017-10-01 | 2017-10-31
 year-month | 2017 |    11 | 2017-10-31 | 2017-11-01 | 2017-11-30
 year-month | 2017 |    12 | 2017-11-30 | 2017-12-01 | 2017-12-31
 year-month | 2018 |     1 | 2017-12-31 | 2018-01-01 | 2018-01-31
 year-month | 2018 |     2 | 2018-01-31 | 2018-02-01 | 2018-02-28
 year-month | 2018 |     3 | 2018-02-28 | 2018-03-01 | 2018-03-31
 year-month | 2018 |     4 | 2018-03-31 | 2018-04-01 | 2018-04-30
 year-month | 2018 |     5 | 2018-04-30 | 2018-05-01 | 2018-05-31
 year-month | 2018 |     6 | 2018-05-31 | 2018-06-01 | 2018-06-30
 year-month | 2018 |     7 | 2018-06-30 | 2018-07-01 | 2018-07-31
 year-month | 2018 |     8 | 2018-07-31 | 2018-08-01 | 2018-08-31
 year-month | 2018 |     9 | 2018-08-31 | 2018-09-01 | 2018-09-30
 year-month | 2018 |    10 | 2018-09-30 | 2018-10-01 | 2018-10-31
 year-month | 2018 |    11 | 2018-10-31 | 2018-11-01 | 2018-11-30
 year-month | 2018 |    12 | 2018-11-30 | 2018-12-01 | 2018-12-31
 year-month | 2019 |     1 | 2018-12-31 | 2019-01-01 | 2019-01-31
 year-month | 2019 |     2 | 2019-01-31 | 2019-02-01 | 2019-02-28
 year-month | 2019 |     3 | 2019-02-28 | 2019-03-01 | 2019-03-31
 year-month | 2019 |     4 | 2019-03-31 | 2019-04-01 | 2019-04-30
 year-month | 2019 |     5 | 2019-04-30 | 2019-05-01 | 2019-05-31
 year-month | 2019 |     6 | 2019-05-31 | 2019-06-01 | 2019-06-30
 year-month | 2019 |     7 | 2019-06-30 | 2019-07-01 | 2019-07-31
 year-month | 2019 |     8 | 2019-07-31 | 2019-08-01 | 2019-08-31
 year-month | 2019 |     9 | 2019-08-31 | 2019-09-01 | 2019-09-30
 year-month | 2019 |    10 | 2019-09-30 | 2019-10-01 | 2019-10-31
 year-month | 2019 |    11 | 2019-10-31 | 2019-11-01 | 2019-11-30
 year-month | 2019 |    12 | 2019-11-30 | 2019-12-01 | 2019-12-31
 year-month | 2020 |     1 | 2019-12-31 | 2020-01-01 | 2020-01-31
 year-month | 2020 |     2 | 2020-01-31 | 2020-02-01 | 2020-02-29
 year-month | 2020 |     3 | 2020-02-29 | 2020-03-01 | 2020-03-31
 year-month | 2020 |     4 | 2020-03-31 | 2020-04-01 | 2020-04-30
 year-month | 2020 |     5 | 2020-04-30 | 2020-05-01 | 2020-05-31
 year-month | 2020 |     6 | 2020-05-31 | 2020-06-01 | 2020-06-30
 year-month | 2020 |     7 | 2020-06-30 | 2020-07-01 | 2020-07-31
 year-month | 2020 |     8 | 2020-07-31 | 2020-08-01 | 2020-08-31
 year-month | 2020 |     9 | 2020-08-31 | 2020-09-01 | 2020-09-30
 year-month | 2020 |    10 | 2020-09-30 | 2020-10-01 | 2020-10-31
 year-month | 2020 |    11 | 2020-10-31 | 2020-11-01 | 2020-11-30
 year-month | 2020 |    12 | 2020-11-30 | 2020-12-01 | 2020-12-31
 year-month | 2021 |     1 | 2020-12-31 | 2021-01-01 | 2021-01-31
 year-month | 2021 |     2 | 2021-01-31 | 2021-02-01 | 2021-02-28
 year-month | 2021 |     3 | 2021-02-28 | 2021-03-01 | 2021-03-31
 year-month | 2021 |     4 | 2021-03-31 | 2021-04-01 | 2021-04-30
 year-month | 2021 |     5 | 2021-04-30 | 2021-05-01 | 2021-05-31
 year-month | 2021 |     6 | 2021-05-31 | 2021-06-01 | 2021-06-30
 year-month | 2021 |     7 | 2021-06-30 | 2021-07-01 | 2021-07-31
 year-month | 2021 |     8 | 2021-07-31 | 2021-08-01 | 2021-08-31
 year-month | 2021 |     9 | 2021-08-31 | 2021-09-01 | 2021-09-30
 year-month | 2021 |    10 | 2021-09-30 | 2021-10-01 | 2021-10-31
 year-month | 2021 |    11 | 2021-10-31 | 2021-11-01 | 2021-11-30
 year-month | 2021 |    12 | 2021-11-30 | 2021-12-01 | 2021-12-31
 year-month | 2022 |     1 | 2021-12-31 | 2022-01-01 | 2022-01-31
 year-month | 2022 |     2 | 2022-01-31 | 2022-02-01 | 2022-02-28
 year-month | 2022 |     3 | 2022-02-28 | 2022-03-01 | 2022-03-31
 year-month | 2022 |     4 | 2022-03-31 | 2022-04-01 | 2022-04-30
 year-month | 2022 |     5 | 2022-04-30 | 2022-05-01 | 2022-05-31
 year-month | 2022 |     6 | 2022-05-31 | 2022-06-01 | 2022-06-30
 year-month | 2022 |     7 | 2022-06-30 | 2022-07-01 | 2022-07-31
 year-month | 2022 |     8 | 2022-07-31 | 2022-08-01 | 2022-08-31
 year-month | 2022 |     9 | 2022-08-31 | 2022-09-01 | 2022-09-30
 year-month | 2022 |    10 | 2022-09-30 | 2022-10-01 | 2022-10-31
 year-month | 2022 |    11 | 2022-10-31 | 2022-11-01 | 2022-11-30
 year-month | 2022 |    12 | 2022-11-30 | 2022-12-01 | 2022-12-31
 year-month | 2023 |     1 | 2022-12-31 | 2023-01-01 | 2023-01-31
 year-month | 2023 |     2 | 2023-01-31 | 2023-02-01 | 2023-02-28
 year-month | 2023 |     3 | 2023-02-28 | 2023-03-01 | 2023-03-31
 year-month | 2023 |     4 | 2023-03-31 | 2023-04-01 | 2023-04-30
 year-month | 2023 |     5 | 2023-04-30 | 2023-05-01 | 2023-05-31
 year-month | 2023 |     6 | 2023-05-31 | 2023-06-01 | 2023-06-30
 year-month | 2023 |     7 | 2023-06-30 | 2023-07-01 | 2023-07-31
 year-month | 2023 |     8 | 2023-07-31 | 2023-08-01 | 2023-08-31
 year-month | 2023 |     9 | 2023-08-31 | 2023-09-01 | 2023-09-30
 year-month | 2023 |    10 | 2023-09-30 | 2023-10-01 | 2023-10-31
 year-month | 2023 |    11 | 2023-10-31 | 2023-11-01 | 2023-11-30
 year-month | 2023 |    12 | 2023-11-30 | 2023-12-01 | 2023-12-31
 year-month | 2024 |     1 | 2023-12-31 | 2024-01-01 | 2024-01-31
 year-month | 2024 |     2 | 2024-01-31 | 2024-02-01 | 2024-02-29
 year-month | 2024 |     3 | 2024-02-29 | 2024-03-01 | 2024-03-31
 year-month | 2024 |     4 | 2024-03-31 | 2024-04-01 | 2024-04-30
 year-month | 2024 |     5 | 2024-04-30 | 2024-05-01 | 2024-05-31
 year-month | 2024 |     6 | 2024-05-31 | 2024-06-01 | 2024-06-30
 year-month | 2024 |     7 | 2024-06-30 | 2024-07-01 | 2024-07-31
 year-month | 2024 |     8 | 2024-07-31 | 2024-08-01 | 2024-08-31
 year-month | 2024 |     9 | 2024-08-31 | 2024-09-01 | 2024-09-30
 year-month | 2024 |    10 | 2024-09-30 | 2024-10-01 | 2024-10-31
 year-month | 2024 |    11 | 2024-10-31 | 2024-11-01 | 2024-11-30
 year-month | 2024 |    12 | 2024-11-30 | 2024-12-01 | 2024-12-31
(195 rows)

\echo "Test yearly data"
"Test yearly data"
SELECT year
     , unit_type
     , exists_count
     , exists_change
     , exists_added_count
     , exists_removed_count
     , countable_count
     , countable_change
     , countable_added_count
     , countable_removed_count
FROM public.statistical_history
WHERE resolution = 'year'
  AND year <= 2024
ORDER BY year,unit_type;
 year |   unit_type   | exists_count | exists_change | exists_added_count | exists_removed_count | countable_count | countable_change | countable_added_count | countable_removed_count 
------+---------------+--------------+---------------+--------------------+----------------------+-----------------+------------------+-----------------------+-------------------------
 2010 | establishment |            1 |             1 |                  1 |                    0 |               1 |                1 |                     1 |                       0
 2010 | legal_unit    |            1 |             1 |                  1 |                    0 |               1 |                1 |                     1 |                       0
 2010 | enterprise    |            1 |             1 |                  1 |                    0 |               1 |                1 |                     1 |                       0
 2011 | establishment |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2011 | legal_unit    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2011 | enterprise    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2012 | establishment |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2012 | legal_unit    |            0 |            -1 |                  0 |                    1 |               0 |               -1 |                     0 |                       1
 2012 | enterprise    |            0 |            -1 |                  0 |                    1 |               0 |               -1 |                     0 |                       1
 2013 | establishment |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2013 | legal_unit    |            1 |             1 |                  1 |                    0 |               1 |                1 |                     1 |                       0
 2013 | enterprise    |            1 |             1 |                  1 |                    0 |               1 |                1 |                     1 |                       0
 2014 | establishment |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2014 | legal_unit    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2014 | enterprise    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2015 | establishment |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2015 | legal_unit    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2015 | enterprise    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2016 | establishment |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2016 | legal_unit    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2016 | enterprise    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2017 | establishment |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2017 | legal_unit    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2017 | enterprise    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2018 | establishment |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2018 | legal_unit    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2018 | enterprise    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 | establishment |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 | legal_unit    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 | enterprise    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2020 | establishment |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2020 | legal_unit    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2020 | enterprise    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2021 | establishment |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2021 | legal_unit    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2021 | enterprise    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2022 | establishment |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2022 | legal_unit    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2022 | enterprise    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2023 | establishment |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2023 | legal_unit    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2023 | enterprise    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2024 | establishment |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2024 | legal_unit    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2024 | enterprise    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
(45 rows)

SELECT year
     , unit_type
     , countable_count as count
     , births
     , deaths
     , primary_activity_category_change_count
     , secondary_activity_category_change_count
     , sector_change_count
     , legal_form_change_count
     , physical_region_change_count
     , physical_country_change_count
FROM public.statistical_history
WHERE resolution = 'year'
  AND year <= 2024
ORDER BY year,unit_type;
 year |   unit_type   | count | births | deaths | primary_activity_category_change_count | secondary_activity_category_change_count | sector_change_count | legal_form_change_count | physical_region_change_count | physical_country_change_count 
------+---------------+-------+--------+--------+----------------------------------------+------------------------------------------+---------------------+-------------------------+------------------------------+-------------------------------
 2010 | establishment |     1 |      1 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2010 | legal_unit    |     1 |      1 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2010 | enterprise    |     1 |      1 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2011 | establishment |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2011 | legal_unit    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2011 | enterprise    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2012 | establishment |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2012 | legal_unit    |     0 |      0 |      1 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2012 | enterprise    |     0 |      0 |      1 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2013 | establishment |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2013 | legal_unit    |     1 |      1 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2013 | enterprise    |     1 |      1 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2014 | establishment |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2014 | legal_unit    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2014 | enterprise    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2015 | establishment |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2015 | legal_unit    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2015 | enterprise    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2016 | establishment |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2016 | legal_unit    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2016 | enterprise    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2017 | establishment |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2017 | legal_unit    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2017 | enterprise    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2018 | establishment |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2018 | legal_unit    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2018 | enterprise    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 | establishment |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 | legal_unit    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 | enterprise    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2020 | establishment |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2020 | legal_unit    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2020 | enterprise    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2021 | establishment |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2021 | legal_unit    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2021 | enterprise    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2022 | establishment |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2022 | legal_unit    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2022 | enterprise    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2023 | establishment |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2023 | legal_unit    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2023 | enterprise    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2024 | establishment |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2024 | legal_unit    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2024 | enterprise    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
(45 rows)

\echo "Test yearly stats"
"Test yearly stats"
SELECT year
     , unit_type
     , jsonb_pretty(stats_summary) AS stats_summary
FROM public.statistical_history
WHERE resolution = 'year'
  AND year <= 2024
ORDER BY year,unit_type;
 year |   unit_type   |                stats_summary                 
------+---------------+----------------------------------------------
 2010 | establishment | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 1500000,                     +
      |               |         "min": 1500000,                     +
      |               |         "sum": 1500000,                     +
      |               |         "mean": 1500000.00,                 +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 1,                           +
      |               |         "min": 1,                           +
      |               |         "sum": 1,                           +
      |               |         "mean": 1.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2010 | legal_unit    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 1500000,                     +
      |               |         "min": 1500000,                     +
      |               |         "sum": 1500000,                     +
      |               |         "mean": 1500000.00,                 +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 1,                           +
      |               |         "min": 1,                           +
      |               |         "sum": 1,                           +
      |               |         "mean": 1.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2010 | enterprise    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 1500000,                     +
      |               |         "min": 1500000,                     +
      |               |         "sum": 1500000,                     +
      |               |         "mean": 1500000.00,                 +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 1,                           +
      |               |         "min": 1,                           +
      |               |         "sum": 1,                           +
      |               |         "mean": 1.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2011 | establishment | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 1500000,                     +
      |               |         "min": 1500000,                     +
      |               |         "sum": 1500000,                     +
      |               |         "mean": 1500000.00,                 +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 1,                           +
      |               |         "min": 1,                           +
      |               |         "sum": 1,                           +
      |               |         "mean": 1.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2011 | legal_unit    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 1500000,                     +
      |               |         "min": 1500000,                     +
      |               |         "sum": 1500000,                     +
      |               |         "mean": 1500000.00,                 +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 1,                           +
      |               |         "min": 1,                           +
      |               |         "sum": 1,                           +
      |               |         "mean": 1.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2011 | enterprise    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 1500000,                     +
      |               |         "min": 1500000,                     +
      |               |         "sum": 1500000,                     +
      |               |         "mean": 1500000.00,                 +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 1,                           +
      |               |         "min": 1,                           +
      |               |         "sum": 1,                           +
      |               |         "mean": 1.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2012 | establishment | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 1500000,                     +
      |               |         "min": 1500000,                     +
      |               |         "sum": 1500000,                     +
      |               |         "mean": 1500000.00,                 +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 1,                           +
      |               |         "min": 1,                           +
      |               |         "sum": 1,                           +
      |               |         "mean": 1.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2012 | legal_unit    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 1500000,                     +
      |               |         "min": 1500000,                     +
      |               |         "sum": 1500000,                     +
      |               |         "mean": 1500000.00,                 +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 1,                           +
      |               |         "min": 1,                           +
      |               |         "sum": 1,                           +
      |               |         "mean": 1.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2012 | enterprise    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 1500000,                     +
      |               |         "min": 1500000,                     +
      |               |         "sum": 1500000,                     +
      |               |         "mean": 1500000.00,                 +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 1,                           +
      |               |         "min": 1,                           +
      |               |         "sum": 1,                           +
      |               |         "mean": 1.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2013 | establishment | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 3000000,                     +
      |               |         "min": 3000000,                     +
      |               |         "sum": 3000000,                     +
      |               |         "mean": 3000000.00,                 +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 3,                           +
      |               |         "min": 3,                           +
      |               |         "sum": 3,                           +
      |               |         "mean": 3.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2013 | legal_unit    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 3000000,                     +
      |               |         "min": 3000000,                     +
      |               |         "sum": 3000000,                     +
      |               |         "mean": 3000000.00,                 +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 3,                           +
      |               |         "min": 3,                           +
      |               |         "sum": 3,                           +
      |               |         "mean": 3.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2013 | enterprise    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 3000000,                     +
      |               |         "min": 3000000,                     +
      |               |         "sum": 3000000,                     +
      |               |         "mean": 3000000.00,                 +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 3,                           +
      |               |         "min": 3,                           +
      |               |         "sum": 3,                           +
      |               |         "mean": 3.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2014 | establishment | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 3000000,                     +
      |               |         "min": 3000000,                     +
      |               |         "sum": 3000000,                     +
      |               |         "mean": 3000000.00,                 +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 3,                           +
      |               |         "min": 3,                           +
      |               |         "sum": 3,                           +
      |               |         "mean": 3.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2014 | legal_unit    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 3000000,                     +
      |               |         "min": 3000000,                     +
      |               |         "sum": 3000000,                     +
      |               |         "mean": 3000000.00,                 +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 3,                           +
      |               |         "min": 3,                           +
      |               |         "sum": 3,                           +
      |               |         "mean": 3.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2014 | enterprise    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 3000000,                     +
      |               |         "min": 3000000,                     +
      |               |         "sum": 3000000,                     +
      |               |         "mean": 3000000.00,                 +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 3,                           +
      |               |         "min": 3,                           +
      |               |         "sum": 3,                           +
      |               |         "mean": 3.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2015 | establishment | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 3000000,                     +
      |               |         "min": 3000000,                     +
      |               |         "sum": 3000000,                     +
      |               |         "mean": 3000000.00,                 +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 3,                           +
      |               |         "min": 3,                           +
      |               |         "sum": 3,                           +
      |               |         "mean": 3.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2015 | legal_unit    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 3000000,                     +
      |               |         "min": 3000000,                     +
      |               |         "sum": 3000000,                     +
      |               |         "mean": 3000000.00,                 +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 3,                           +
      |               |         "min": 3,                           +
      |               |         "sum": 3,                           +
      |               |         "mean": 3.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2015 | enterprise    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 3000000,                     +
      |               |         "min": 3000000,                     +
      |               |         "sum": 3000000,                     +
      |               |         "mean": 3000000.00,                 +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 3,                           +
      |               |         "min": 3,                           +
      |               |         "sum": 3,                           +
      |               |         "mean": 3.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2016 | establishment | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 12000000,                    +
      |               |         "min": 12000000,                    +
      |               |         "sum": 12000000,                    +
      |               |         "mean": 12000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 9,                           +
      |               |         "min": 9,                           +
      |               |         "sum": 9,                           +
      |               |         "mean": 9.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2016 | legal_unit    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 12000000,                    +
      |               |         "min": 12000000,                    +
      |               |         "sum": 12000000,                    +
      |               |         "mean": 12000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 9,                           +
      |               |         "min": 9,                           +
      |               |         "sum": 9,                           +
      |               |         "mean": 9.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2016 | enterprise    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 12000000,                    +
      |               |         "min": 12000000,                    +
      |               |         "sum": 12000000,                    +
      |               |         "mean": 12000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 9,                           +
      |               |         "min": 9,                           +
      |               |         "sum": 9,                           +
      |               |         "mean": 9.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2017 | establishment | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 12000000,                    +
      |               |         "min": 12000000,                    +
      |               |         "sum": 12000000,                    +
      |               |         "mean": 12000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 9,                           +
      |               |         "min": 9,                           +
      |               |         "sum": 9,                           +
      |               |         "mean": 9.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2017 | legal_unit    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 12000000,                    +
      |               |         "min": 12000000,                    +
      |               |         "sum": 12000000,                    +
      |               |         "mean": 12000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 9,                           +
      |               |         "min": 9,                           +
      |               |         "sum": 9,                           +
      |               |         "mean": 9.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2017 | enterprise    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 12000000,                    +
      |               |         "min": 12000000,                    +
      |               |         "sum": 12000000,                    +
      |               |         "mean": 12000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 9,                           +
      |               |         "min": 9,                           +
      |               |         "sum": 9,                           +
      |               |         "mean": 9.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2018 | establishment | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 12000000,                    +
      |               |         "min": 12000000,                    +
      |               |         "sum": 12000000,                    +
      |               |         "mean": 12000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 9,                           +
      |               |         "min": 9,                           +
      |               |         "sum": 9,                           +
      |               |         "mean": 9.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2018 | legal_unit    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 12000000,                    +
      |               |         "min": 12000000,                    +
      |               |         "sum": 12000000,                    +
      |               |         "mean": 12000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 9,                           +
      |               |         "min": 9,                           +
      |               |         "sum": 9,                           +
      |               |         "mean": 9.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2018 | enterprise    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 12000000,                    +
      |               |         "min": 12000000,                    +
      |               |         "sum": 12000000,                    +
      |               |         "mean": 12000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 9,                           +
      |               |         "min": 9,                           +
      |               |         "sum": 9,                           +
      |               |         "mean": 9.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2019 | establishment | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 60000000,                    +
      |               |         "min": 60000000,                    +
      |               |         "sum": 60000000,                    +
      |               |         "mean": 60000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 40,                          +
      |               |         "min": 40,                          +
      |               |         "sum": 40,                          +
      |               |         "mean": 40.00,                      +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2019 | legal_unit    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 60000000,                    +
      |               |         "min": 60000000,                    +
      |               |         "sum": 60000000,                    +
      |               |         "mean": 60000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 40,                          +
      |               |         "min": 40,                          +
      |               |         "sum": 40,                          +
      |               |         "mean": 40.00,                      +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2019 | enterprise    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 60000000,                    +
      |               |         "min": 60000000,                    +
      |               |         "sum": 60000000,                    +
      |               |         "mean": 60000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 40,                          +
      |               |         "min": 40,                          +
      |               |         "sum": 40,                          +
      |               |         "mean": 40.00,                      +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2020 | establishment | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 70000000,                    +
      |               |         "min": 70000000,                    +
      |               |         "sum": 70000000,                    +
      |               |         "mean": 70000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 45,                          +
      |               |         "min": 45,                          +
      |               |         "sum": 45,                          +
      |               |         "mean": 45.00,                      +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2020 | legal_unit    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 70000000,                    +
      |               |         "min": 70000000,                    +
      |               |         "sum": 70000000,                    +
      |               |         "mean": 70000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 45,                          +
      |               |         "min": 45,                          +
      |               |         "sum": 45,                          +
      |               |         "mean": 45.00,                      +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2020 | enterprise    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 70000000,                    +
      |               |         "min": 70000000,                    +
      |               |         "sum": 70000000,                    +
      |               |         "mean": 70000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 45,                          +
      |               |         "min": 45,                          +
      |               |         "sum": 45,                          +
      |               |         "mean": 45.00,                      +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2021 | establishment | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 70000000,                    +
      |               |         "min": 70000000,                    +
      |               |         "sum": 70000000,                    +
      |               |         "mean": 70000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 45,                          +
      |               |         "min": 45,                          +
      |               |         "sum": 45,                          +
      |               |         "mean": 45.00,                      +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2021 | legal_unit    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 70000000,                    +
      |               |         "min": 70000000,                    +
      |               |         "sum": 70000000,                    +
      |               |         "mean": 70000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 45,                          +
      |               |         "min": 45,                          +
      |               |         "sum": 45,                          +
      |               |         "mean": 45.00,                      +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2021 | enterprise    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 70000000,                    +
      |               |         "min": 70000000,                    +
      |               |         "sum": 70000000,                    +
      |               |         "mean": 70000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 45,                          +
      |               |         "min": 45,                          +
      |               |         "sum": 45,                          +
      |               |         "mean": 45.00,                      +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2022 | establishment | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 70000000,                    +
      |               |         "min": 70000000,                    +
      |               |         "sum": 70000000,                    +
      |               |         "mean": 70000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 45,                          +
      |               |         "min": 45,                          +
      |               |         "sum": 45,                          +
      |               |         "mean": 45.00,                      +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2022 | legal_unit    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 70000000,                    +
      |               |         "min": 70000000,                    +
      |               |         "sum": 70000000,                    +
      |               |         "mean": 70000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 45,                          +
      |               |         "min": 45,                          +
      |               |         "sum": 45,                          +
      |               |         "mean": 45.00,                      +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2022 | enterprise    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 70000000,                    +
      |               |         "min": 70000000,                    +
      |               |         "sum": 70000000,                    +
      |               |         "mean": 70000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 45,                          +
      |               |         "min": 45,                          +
      |               |         "sum": 45,                          +
      |               |         "mean": 45.00,                      +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2023 | establishment | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 70000000,                    +
      |               |         "min": 70000000,                    +
      |               |         "sum": 70000000,                    +
      |               |         "mean": 70000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 45,                          +
      |               |         "min": 45,                          +
      |               |         "sum": 45,                          +
      |               |         "mean": 45.00,                      +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2023 | legal_unit    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 70000000,                    +
      |               |         "min": 70000000,                    +
      |               |         "sum": 70000000,                    +
      |               |         "mean": 70000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 45,                          +
      |               |         "min": 45,                          +
      |               |         "sum": 45,                          +
      |               |         "mean": 45.00,                      +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2023 | enterprise    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 70000000,                    +
      |               |         "min": 70000000,                    +
      |               |         "sum": 70000000,                    +
      |               |         "mean": 70000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 45,                          +
      |               |         "min": 45,                          +
      |               |         "sum": 45,                          +
      |               |         "mean": 45.00,                      +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2024 | establishment | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 70000000,                    +
      |               |         "min": 70000000,                    +
      |               |         "sum": 70000000,                    +
      |               |         "mean": 70000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 45,                          +
      |               |         "min": 45,                          +
      |               |         "sum": 45,                          +
      |               |         "mean": 45.00,                      +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2024 | legal_unit    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 70000000,                    +
      |               |         "min": 70000000,                    +
      |               |         "sum": 70000000,                    +
      |               |         "mean": 70000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 45,                          +
      |               |         "min": 45,                          +
      |               |         "sum": 45,                          +
      |               |         "mean": 45.00,                      +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2024 | enterprise    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 70000000,                    +
      |               |         "min": 70000000,                    +
      |               |         "sum": 70000000,                    +
      |               |         "mean": 70000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 45,                          +
      |               |         "min": 45,                          +
      |               |         "sum": 45,                          +
      |               |         "mean": 45.00,                      +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
(45 rows)

\echo "Test monthly data for 2019"
"Test monthly data for 2019"
SELECT year, month
     , unit_type
     , exists_count
     , exists_change
     , exists_added_count
     , exists_removed_count
     , countable_count
     , countable_change
     , countable_added_count
     , countable_removed_count
FROM public.statistical_history
WHERE resolution = 'year-month' AND year = 2019
ORDER BY year,month,unit_type;
 year | month |   unit_type   | exists_count | exists_change | exists_added_count | exists_removed_count | countable_count | countable_change | countable_added_count | countable_removed_count 
------+-------+---------------+--------------+---------------+--------------------+----------------------+-----------------+------------------+-----------------------+-------------------------
 2019 |     1 | establishment |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     1 | legal_unit    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     1 | enterprise    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     2 | establishment |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     2 | legal_unit    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     2 | enterprise    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     3 | establishment |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     3 | legal_unit    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     3 | enterprise    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     4 | establishment |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     4 | legal_unit    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     4 | enterprise    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     5 | establishment |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     5 | legal_unit    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     5 | enterprise    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     6 | establishment |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     6 | legal_unit    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     6 | enterprise    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     7 | establishment |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     7 | legal_unit    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     7 | enterprise    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     8 | establishment |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     8 | legal_unit    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     8 | enterprise    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     9 | establishment |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     9 | legal_unit    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     9 | enterprise    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |    10 | establishment |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |    10 | legal_unit    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |    10 | enterprise    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |    11 | establishment |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |    11 | legal_unit    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |    11 | enterprise    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |    12 | establishment |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |    12 | legal_unit    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |    12 | enterprise    |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
(36 rows)

\echo "Test monthly data for 2019"
"Test monthly data for 2019"
SELECT year, month
     , unit_type
     , countable_count AS count
     , births
     , deaths
     , primary_activity_category_change_count
     , secondary_activity_category_change_count
     , sector_change_count
     , legal_form_change_count
     , physical_region_change_count
     , physical_country_change_count
FROM public.statistical_history
WHERE resolution = 'year-month' AND year = 2019
ORDER BY year,month,unit_type;
 year | month |   unit_type   | count | births | deaths | primary_activity_category_change_count | secondary_activity_category_change_count | sector_change_count | legal_form_change_count | physical_region_change_count | physical_country_change_count 
------+-------+---------------+-------+--------+--------+----------------------------------------+------------------------------------------+---------------------+-------------------------+------------------------------+-------------------------------
 2019 |     1 | establishment |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     1 | legal_unit    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     1 | enterprise    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     2 | establishment |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     2 | legal_unit    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     2 | enterprise    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     3 | establishment |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     3 | legal_unit    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     3 | enterprise    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     4 | establishment |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     4 | legal_unit    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     4 | enterprise    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     5 | establishment |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     5 | legal_unit    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     5 | enterprise    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     6 | establishment |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     6 | legal_unit    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     6 | enterprise    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     7 | establishment |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     7 | legal_unit    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     7 | enterprise    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     8 | establishment |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     8 | legal_unit    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     8 | enterprise    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     9 | establishment |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     9 | legal_unit    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     9 | enterprise    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |    10 | establishment |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |    10 | legal_unit    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |    10 | enterprise    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |    11 | establishment |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |    11 | legal_unit    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |    11 | enterprise    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |    12 | establishment |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |    12 | legal_unit    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |    12 | enterprise    |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
(36 rows)

\echo "Test monthly stats for 2019"
"Test monthly stats for 2019"
SELECT year, month
     , unit_type
     , jsonb_pretty(stats_summary) AS stats_summary
FROM public.statistical_history
WHERE resolution = 'year-month' AND year = 2019
ORDER BY year,month,unit_type;
 year | month |   unit_type   |                stats_summary                 
------+-------+---------------+----------------------------------------------
 2019 |     1 | establishment | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 25,                          +
      |       |               |         "min": 25,                          +
      |       |               |         "sum": 25,                          +
      |       |               |         "mean": 25.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     1 | legal_unit    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 25,                          +
      |       |               |         "min": 25,                          +
      |       |               |         "sum": 25,                          +
      |       |               |         "mean": 25.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     1 | enterprise    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 25,                          +
      |       |               |         "min": 25,                          +
      |       |               |         "sum": 25,                          +
      |       |               |         "mean": 25.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     2 | establishment | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 25,                          +
      |       |               |         "min": 25,                          +
      |       |               |         "sum": 25,                          +
      |       |               |         "mean": 25.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     2 | legal_unit    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 25,                          +
      |       |               |         "min": 25,                          +
      |       |               |         "sum": 25,                          +
      |       |               |         "mean": 25.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     2 | enterprise    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 25,                          +
      |       |               |         "min": 25,                          +
      |       |               |         "sum": 25,                          +
      |       |               |         "mean": 25.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     3 | establishment | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 30,                          +
      |       |               |         "min": 30,                          +
      |       |               |         "sum": 30,                          +
      |       |               |         "mean": 30.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     3 | legal_unit    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 30,                          +
      |       |               |         "min": 30,                          +
      |       |               |         "sum": 30,                          +
      |       |               |         "mean": 30.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     3 | enterprise    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 30,                          +
      |       |               |         "min": 30,                          +
      |       |               |         "sum": 30,                          +
      |       |               |         "mean": 30.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     4 | establishment | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 30,                          +
      |       |               |         "min": 30,                          +
      |       |               |         "sum": 30,                          +
      |       |               |         "mean": 30.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     4 | legal_unit    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 30,                          +
      |       |               |         "min": 30,                          +
      |       |               |         "sum": 30,                          +
      |       |               |         "mean": 30.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     4 | enterprise    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 30,                          +
      |       |               |         "min": 30,                          +
      |       |               |         "sum": 30,                          +
      |       |               |         "mean": 30.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     5 | establishment | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 35,                          +
      |       |               |         "min": 35,                          +
      |       |               |         "sum": 35,                          +
      |       |               |         "mean": 35.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     5 | legal_unit    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 35,                          +
      |       |               |         "min": 35,                          +
      |       |               |         "sum": 35,                          +
      |       |               |         "mean": 35.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     5 | enterprise    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 35,                          +
      |       |               |         "min": 35,                          +
      |       |               |         "sum": 35,                          +
      |       |               |         "mean": 35.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     6 | establishment | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 35,                          +
      |       |               |         "min": 35,                          +
      |       |               |         "sum": 35,                          +
      |       |               |         "mean": 35.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     6 | legal_unit    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 35,                          +
      |       |               |         "min": 35,                          +
      |       |               |         "sum": 35,                          +
      |       |               |         "mean": 35.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     6 | enterprise    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 35,                          +
      |       |               |         "min": 35,                          +
      |       |               |         "sum": 35,                          +
      |       |               |         "mean": 35.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     7 | establishment | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 40,                          +
      |       |               |         "min": 40,                          +
      |       |               |         "sum": 40,                          +
      |       |               |         "mean": 40.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     7 | legal_unit    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 40,                          +
      |       |               |         "min": 40,                          +
      |       |               |         "sum": 40,                          +
      |       |               |         "mean": 40.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     7 | enterprise    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 40,                          +
      |       |               |         "min": 40,                          +
      |       |               |         "sum": 40,                          +
      |       |               |         "mean": 40.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     8 | establishment | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 40,                          +
      |       |               |         "min": 40,                          +
      |       |               |         "sum": 40,                          +
      |       |               |         "mean": 40.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     8 | legal_unit    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 40,                          +
      |       |               |         "min": 40,                          +
      |       |               |         "sum": 40,                          +
      |       |               |         "mean": 40.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     8 | enterprise    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 40,                          +
      |       |               |         "min": 40,                          +
      |       |               |         "sum": 40,                          +
      |       |               |         "mean": 40.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     9 | establishment | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 50,                          +
      |       |               |         "min": 50,                          +
      |       |               |         "sum": 50,                          +
      |       |               |         "mean": 50.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     9 | legal_unit    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 50,                          +
      |       |               |         "min": 50,                          +
      |       |               |         "sum": 50,                          +
      |       |               |         "mean": 50.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     9 | enterprise    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 50,                          +
      |       |               |         "min": 50,                          +
      |       |               |         "sum": 50,                          +
      |       |               |         "mean": 50.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |    10 | establishment | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 50,                          +
      |       |               |         "min": 50,                          +
      |       |               |         "sum": 50,                          +
      |       |               |         "mean": 50.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |    10 | legal_unit    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 50,                          +
      |       |               |         "min": 50,                          +
      |       |               |         "sum": 50,                          +
      |       |               |         "mean": 50.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |    10 | enterprise    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 50,                          +
      |       |               |         "min": 50,                          +
      |       |               |         "sum": 50,                          +
      |       |               |         "mean": 50.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |    11 | establishment | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 40,                          +
      |       |               |         "min": 40,                          +
      |       |               |         "sum": 40,                          +
      |       |               |         "mean": 40.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |    11 | legal_unit    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 40,                          +
      |       |               |         "min": 40,                          +
      |       |               |         "sum": 40,                          +
      |       |               |         "mean": 40.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |    11 | enterprise    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 40,                          +
      |       |               |         "min": 40,                          +
      |       |               |         "sum": 40,                          +
      |       |               |         "mean": 40.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |    12 | establishment | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 40,                          +
      |       |               |         "min": 40,                          +
      |       |               |         "sum": 40,                          +
      |       |               |         "mean": 40.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |    12 | legal_unit    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 40,                          +
      |       |               |         "min": 40,                          +
      |       |               |         "sum": 40,                          +
      |       |               |         "mean": 40.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |    12 | enterprise    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 40,                          +
      |       |               |         "min": 40,                          +
      |       |               |         "sum": 40,                          +
      |       |               |         "mean": 40.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
(36 rows)

\x
\echo "Inspect facet summary table"
"Inspect facet summary table"
SELECT valid_from
     , valid_to
     , unit_type
     , physical_region_path
     , primary_activity_category_path
     , sector_path
     , count
     , jsonb_pretty(stats_summary) AS stats_summary
  FROM public.statistical_unit_facet
  ORDER BY valid_from, valid_to, unit_type
;
-[ RECORD 1 ]------------------+---------------------------------------------
valid_from                     | 2010-01-01
valid_to                       | 2012-12-31
unit_type                      | establishment
physical_region_path           | 11.21
primary_activity_category_path | H.49.4.1.0
sector_path                    | 
count                          | 1
stats_summary                  | {                                           +
                               |     "turnover": {                           +
                               |         "max": 1500000,                     +
                               |         "min": 1500000,                     +
                               |         "sum": 1500000,                     +
                               |         "mean": 1500000.00,                 +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     },                                      +
                               |     "employees": {                          +
                               |         "max": 1,                           +
                               |         "min": 1,                           +
                               |         "sum": 1,                           +
                               |         "mean": 1.00,                       +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     }                                       +
                               | }
-[ RECORD 2 ]------------------+---------------------------------------------
valid_from                     | 2010-01-01
valid_to                       | 2012-12-31
unit_type                      | legal_unit
physical_region_path           | 11.21
primary_activity_category_path | H.49.4.1.0
sector_path                    | innl.a_ikke_fin.2100
count                          | 1
stats_summary                  | {                                           +
                               |     "turnover": {                           +
                               |         "max": 1500000,                     +
                               |         "min": 1500000,                     +
                               |         "sum": 1500000,                     +
                               |         "mean": 1500000.00,                 +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     },                                      +
                               |     "employees": {                          +
                               |         "max": 1,                           +
                               |         "min": 1,                           +
                               |         "sum": 1,                           +
                               |         "mean": 1.00,                       +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     }                                       +
                               | }
-[ RECORD 3 ]------------------+---------------------------------------------
valid_from                     | 2010-01-01
valid_to                       | 2012-12-31
unit_type                      | enterprise
physical_region_path           | 11.21
primary_activity_category_path | H.49.4.1.0
sector_path                    | innl.a_ikke_fin.2100
count                          | 1
stats_summary                  | {                                           +
                               |     "turnover": {                           +
                               |         "max": 1500000,                     +
                               |         "min": 1500000,                     +
                               |         "sum": 1500000,                     +
                               |         "mean": 1500000.00,                 +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     },                                      +
                               |     "employees": {                          +
                               |         "max": 1,                           +
                               |         "min": 1,                           +
                               |         "sum": 1,                           +
                               |         "mean": 1.00,                       +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     }                                       +
                               | }
-[ RECORD 4 ]------------------+---------------------------------------------
valid_from                     | 2013-01-01
valid_to                       | 2015-12-31
unit_type                      | establishment
physical_region_path           | 11.21
primary_activity_category_path | H.49.4.1.0
sector_path                    | 
count                          | 1
stats_summary                  | {                                           +
                               |     "turnover": {                           +
                               |         "max": 3000000,                     +
                               |         "min": 3000000,                     +
                               |         "sum": 3000000,                     +
                               |         "mean": 3000000.00,                 +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     },                                      +
                               |     "employees": {                          +
                               |         "max": 3,                           +
                               |         "min": 3,                           +
                               |         "sum": 3,                           +
                               |         "mean": 3.00,                       +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     }                                       +
                               | }
-[ RECORD 5 ]------------------+---------------------------------------------
valid_from                     | 2013-01-01
valid_to                       | 2015-12-31
unit_type                      | legal_unit
physical_region_path           | 11.21
primary_activity_category_path | H.49.4.1.0
sector_path                    | innl.a_ikke_fin.2100
count                          | 1
stats_summary                  | {                                           +
                               |     "turnover": {                           +
                               |         "max": 3000000,                     +
                               |         "min": 3000000,                     +
                               |         "sum": 3000000,                     +
                               |         "mean": 3000000.00,                 +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     },                                      +
                               |     "employees": {                          +
                               |         "max": 3,                           +
                               |         "min": 3,                           +
                               |         "sum": 3,                           +
                               |         "mean": 3.00,                       +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     }                                       +
                               | }
-[ RECORD 6 ]------------------+---------------------------------------------
valid_from                     | 2013-01-01
valid_to                       | 2015-12-31
unit_type                      | enterprise
physical_region_path           | 11.21
primary_activity_category_path | H.49.4.1.0
sector_path                    | innl.a_ikke_fin.2100
count                          | 1
stats_summary                  | {                                           +
                               |     "turnover": {                           +
                               |         "max": 3000000,                     +
                               |         "min": 3000000,                     +
                               |         "sum": 3000000,                     +
                               |         "mean": 3000000.00,                 +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     },                                      +
                               |     "employees": {                          +
                               |         "max": 3,                           +
                               |         "min": 3,                           +
                               |         "sum": 3,                           +
                               |         "mean": 3.00,                       +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     }                                       +
                               | }
-[ RECORD 7 ]------------------+---------------------------------------------
valid_from                     | 2016-01-01
valid_to                       | 2018-12-31
unit_type                      | establishment
physical_region_path           | 11.21
primary_activity_category_path | H.49.4.1.0
sector_path                    | 
count                          | 1
stats_summary                  | {                                           +
                               |     "turnover": {                           +
                               |         "max": 12000000,                    +
                               |         "min": 12000000,                    +
                               |         "sum": 12000000,                    +
                               |         "mean": 12000000.00,                +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     },                                      +
                               |     "employees": {                          +
                               |         "max": 9,                           +
                               |         "min": 9,                           +
                               |         "sum": 9,                           +
                               |         "mean": 9.00,                       +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     }                                       +
                               | }
-[ RECORD 8 ]------------------+---------------------------------------------
valid_from                     | 2016-01-01
valid_to                       | 2018-12-31
unit_type                      | legal_unit
physical_region_path           | 11.21
primary_activity_category_path | H.49.4.1.0
sector_path                    | innl.a_ikke_fin.2100
count                          | 1
stats_summary                  | {                                           +
                               |     "turnover": {                           +
                               |         "max": 12000000,                    +
                               |         "min": 12000000,                    +
                               |         "sum": 12000000,                    +
                               |         "mean": 12000000.00,                +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     },                                      +
                               |     "employees": {                          +
                               |         "max": 9,                           +
                               |         "min": 9,                           +
                               |         "sum": 9,                           +
                               |         "mean": 9.00,                       +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     }                                       +
                               | }
-[ RECORD 9 ]------------------+---------------------------------------------
valid_from                     | 2016-01-01
valid_to                       | 2018-12-31
unit_type                      | enterprise
physical_region_path           | 11.21
primary_activity_category_path | H.49.4.1.0
sector_path                    | innl.a_ikke_fin.2100
count                          | 1
stats_summary                  | {                                           +
                               |     "turnover": {                           +
                               |         "max": 12000000,                    +
                               |         "min": 12000000,                    +
                               |         "sum": 12000000,                    +
                               |         "mean": 12000000.00,                +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     },                                      +
                               |     "employees": {                          +
                               |         "max": 9,                           +
                               |         "min": 9,                           +
                               |         "sum": 9,                           +
                               |         "mean": 9.00,                       +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     }                                       +
                               | }
-[ RECORD 10 ]-----------------+---------------------------------------------
valid_from                     | 2019-01-01
valid_to                       | 2019-02-28
unit_type                      | establishment
physical_region_path           | 11.21
primary_activity_category_path | H.49.4.1.0
sector_path                    | 
count                          | 1
stats_summary                  | {                                           +
                               |     "turnover": {                           +
                               |         "max": 60000000,                    +
                               |         "min": 60000000,                    +
                               |         "sum": 60000000,                    +
                               |         "mean": 60000000.00,                +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     },                                      +
                               |     "employees": {                          +
                               |         "max": 25,                          +
                               |         "min": 25,                          +
                               |         "sum": 25,                          +
                               |         "mean": 25.00,                      +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     }                                       +
                               | }
-[ RECORD 11 ]-----------------+---------------------------------------------
valid_from                     | 2019-01-01
valid_to                       | 2019-02-28
unit_type                      | legal_unit
physical_region_path           | 11.21
primary_activity_category_path | H.49.4.1.0
sector_path                    | innl.a_ikke_fin.2100
count                          | 1
stats_summary                  | {                                           +
                               |     "turnover": {                           +
                               |         "max": 60000000,                    +
                               |         "min": 60000000,                    +
                               |         "sum": 60000000,                    +
                               |         "mean": 60000000.00,                +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     },                                      +
                               |     "employees": {                          +
                               |         "max": 25,                          +
                               |         "min": 25,                          +
                               |         "sum": 25,                          +
                               |         "mean": 25.00,                      +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     }                                       +
                               | }
-[ RECORD 12 ]-----------------+---------------------------------------------
valid_from                     | 2019-01-01
valid_to                       | 2019-02-28
unit_type                      | enterprise
physical_region_path           | 11.21
primary_activity_category_path | H.49.4.1.0
sector_path                    | innl.a_ikke_fin.2100
count                          | 1
stats_summary                  | {                                           +
                               |     "turnover": {                           +
                               |         "max": 60000000,                    +
                               |         "min": 60000000,                    +
                               |         "sum": 60000000,                    +
                               |         "mean": 60000000.00,                +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     },                                      +
                               |     "employees": {                          +
                               |         "max": 25,                          +
                               |         "min": 25,                          +
                               |         "sum": 25,                          +
                               |         "mean": 25.00,                      +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     }                                       +
                               | }
-[ RECORD 13 ]-----------------+---------------------------------------------
valid_from                     | 2019-03-01
valid_to                       | 2019-04-30
unit_type                      | establishment
physical_region_path           | 11.21
primary_activity_category_path | H.49.4.1.0
sector_path                    | 
count                          | 1
stats_summary                  | {                                           +
                               |     "turnover": {                           +
                               |         "max": 60000000,                    +
                               |         "min": 60000000,                    +
                               |         "sum": 60000000,                    +
                               |         "mean": 60000000.00,                +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     },                                      +
                               |     "employees": {                          +
                               |         "max": 30,                          +
                               |         "min": 30,                          +
                               |         "sum": 30,                          +
                               |         "mean": 30.00,                      +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     }                                       +
                               | }
-[ RECORD 14 ]-----------------+---------------------------------------------
valid_from                     | 2019-03-01
valid_to                       | 2019-04-30
unit_type                      | legal_unit
physical_region_path           | 11.21
primary_activity_category_path | H.49.4.1.0
sector_path                    | innl.a_ikke_fin.2100
count                          | 1
stats_summary                  | {                                           +
                               |     "turnover": {                           +
                               |         "max": 60000000,                    +
                               |         "min": 60000000,                    +
                               |         "sum": 60000000,                    +
                               |         "mean": 60000000.00,                +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     },                                      +
                               |     "employees": {                          +
                               |         "max": 30,                          +
                               |         "min": 30,                          +
                               |         "sum": 30,                          +
                               |         "mean": 30.00,                      +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     }                                       +
                               | }
-[ RECORD 15 ]-----------------+---------------------------------------------
valid_from                     | 2019-03-01
valid_to                       | 2019-04-30
unit_type                      | enterprise
physical_region_path           | 11.21
primary_activity_category_path | H.49.4.1.0
sector_path                    | innl.a_ikke_fin.2100
count                          | 1
stats_summary                  | {                                           +
                               |     "turnover": {                           +
                               |         "max": 60000000,                    +
                               |         "min": 60000000,                    +
                               |         "sum": 60000000,                    +
                               |         "mean": 60000000.00,                +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     },                                      +
                               |     "employees": {                          +
                               |         "max": 30,                          +
                               |         "min": 30,                          +
                               |         "sum": 30,                          +
                               |         "mean": 30.00,                      +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     }                                       +
                               | }
-[ RECORD 16 ]-----------------+---------------------------------------------
valid_from                     | 2019-05-01
valid_to                       | 2019-06-30
unit_type                      | establishment
physical_region_path           | 11.21
primary_activity_category_path | H.49.4.1.0
sector_path                    | 
count                          | 1
stats_summary                  | {                                           +
                               |     "turnover": {                           +
                               |         "max": 60000000,                    +
                               |         "min": 60000000,                    +
                               |         "sum": 60000000,                    +
                               |         "mean": 60000000.00,                +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     },                                      +
                               |     "employees": {                          +
                               |         "max": 35,                          +
                               |         "min": 35,                          +
                               |         "sum": 35,                          +
                               |         "mean": 35.00,                      +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     }                                       +
                               | }
-[ RECORD 17 ]-----------------+---------------------------------------------
valid_from                     | 2019-05-01
valid_to                       | 2019-06-30
unit_type                      | legal_unit
physical_region_path           | 11.21
primary_activity_category_path | H.49.4.1.0
sector_path                    | innl.a_ikke_fin.2100
count                          | 1
stats_summary                  | {                                           +
                               |     "turnover": {                           +
                               |         "max": 60000000,                    +
                               |         "min": 60000000,                    +
                               |         "sum": 60000000,                    +
                               |         "mean": 60000000.00,                +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     },                                      +
                               |     "employees": {                          +
                               |         "max": 35,                          +
                               |         "min": 35,                          +
                               |         "sum": 35,                          +
                               |         "mean": 35.00,                      +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     }                                       +
                               | }
-[ RECORD 18 ]-----------------+---------------------------------------------
valid_from                     | 2019-05-01
valid_to                       | 2019-06-30
unit_type                      | enterprise
physical_region_path           | 11.21
primary_activity_category_path | H.49.4.1.0
sector_path                    | innl.a_ikke_fin.2100
count                          | 1
stats_summary                  | {                                           +
                               |     "turnover": {                           +
                               |         "max": 60000000,                    +
                               |         "min": 60000000,                    +
                               |         "sum": 60000000,                    +
                               |         "mean": 60000000.00,                +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     },                                      +
                               |     "employees": {                          +
                               |         "max": 35,                          +
                               |         "min": 35,                          +
                               |         "sum": 35,                          +
                               |         "mean": 35.00,                      +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     }                                       +
                               | }
-[ RECORD 19 ]-----------------+---------------------------------------------
valid_from                     | 2019-07-01
valid_to                       | 2019-08-31
unit_type                      | establishment
physical_region_path           | 11.21
primary_activity_category_path | H.49.4.1.0
sector_path                    | 
count                          | 1
stats_summary                  | {                                           +
                               |     "turnover": {                           +
                               |         "max": 60000000,                    +
                               |         "min": 60000000,                    +
                               |         "sum": 60000000,                    +
                               |         "mean": 60000000.00,                +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     },                                      +
                               |     "employees": {                          +
                               |         "max": 40,                          +
                               |         "min": 40,                          +
                               |         "sum": 40,                          +
                               |         "mean": 40.00,                      +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     }                                       +
                               | }
-[ RECORD 20 ]-----------------+---------------------------------------------
valid_from                     | 2019-07-01
valid_to                       | 2019-08-31
unit_type                      | legal_unit
physical_region_path           | 11.21
primary_activity_category_path | H.49.4.1.0
sector_path                    | innl.a_ikke_fin.2100
count                          | 1
stats_summary                  | {                                           +
                               |     "turnover": {                           +
                               |         "max": 60000000,                    +
                               |         "min": 60000000,                    +
                               |         "sum": 60000000,                    +
                               |         "mean": 60000000.00,                +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     },                                      +
                               |     "employees": {                          +
                               |         "max": 40,                          +
                               |         "min": 40,                          +
                               |         "sum": 40,                          +
                               |         "mean": 40.00,                      +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     }                                       +
                               | }
-[ RECORD 21 ]-----------------+---------------------------------------------
valid_from                     | 2019-07-01
valid_to                       | 2019-08-31
unit_type                      | enterprise
physical_region_path           | 11.21
primary_activity_category_path | H.49.4.1.0
sector_path                    | innl.a_ikke_fin.2100
count                          | 1
stats_summary                  | {                                           +
                               |     "turnover": {                           +
                               |         "max": 60000000,                    +
                               |         "min": 60000000,                    +
                               |         "sum": 60000000,                    +
                               |         "mean": 60000000.00,                +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     },                                      +
                               |     "employees": {                          +
                               |         "max": 40,                          +
                               |         "min": 40,                          +
                               |         "sum": 40,                          +
                               |         "mean": 40.00,                      +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     }                                       +
                               | }
-[ RECORD 22 ]-----------------+---------------------------------------------
valid_from                     | 2019-09-01
valid_to                       | 2019-10-31
unit_type                      | establishment
physical_region_path           | 11.21
primary_activity_category_path | H.49.4.1.0
sector_path                    | 
count                          | 1
stats_summary                  | {                                           +
                               |     "turnover": {                           +
                               |         "max": 60000000,                    +
                               |         "min": 60000000,                    +
                               |         "sum": 60000000,                    +
                               |         "mean": 60000000.00,                +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     },                                      +
                               |     "employees": {                          +
                               |         "max": 50,                          +
                               |         "min": 50,                          +
                               |         "sum": 50,                          +
                               |         "mean": 50.00,                      +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     }                                       +
                               | }
-[ RECORD 23 ]-----------------+---------------------------------------------
valid_from                     | 2019-09-01
valid_to                       | 2019-10-31
unit_type                      | legal_unit
physical_region_path           | 11.21
primary_activity_category_path | H.49.4.1.0
sector_path                    | innl.a_ikke_fin.2100
count                          | 1
stats_summary                  | {                                           +
                               |     "turnover": {                           +
                               |         "max": 60000000,                    +
                               |         "min": 60000000,                    +
                               |         "sum": 60000000,                    +
                               |         "mean": 60000000.00,                +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     },                                      +
                               |     "employees": {                          +
                               |         "max": 50,                          +
                               |         "min": 50,                          +
                               |         "sum": 50,                          +
                               |         "mean": 50.00,                      +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     }                                       +
                               | }
-[ RECORD 24 ]-----------------+---------------------------------------------
valid_from                     | 2019-09-01
valid_to                       | 2019-10-31
unit_type                      | enterprise
physical_region_path           | 11.21
primary_activity_category_path | H.49.4.1.0
sector_path                    | innl.a_ikke_fin.2100
count                          | 1
stats_summary                  | {                                           +
                               |     "turnover": {                           +
                               |         "max": 60000000,                    +
                               |         "min": 60000000,                    +
                               |         "sum": 60000000,                    +
                               |         "mean": 60000000.00,                +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     },                                      +
                               |     "employees": {                          +
                               |         "max": 50,                          +
                               |         "min": 50,                          +
                               |         "sum": 50,                          +
                               |         "mean": 50.00,                      +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     }                                       +
                               | }
-[ RECORD 25 ]-----------------+---------------------------------------------
valid_from                     | 2019-11-01
valid_to                       | 2019-12-31
unit_type                      | establishment
physical_region_path           | 11.21
primary_activity_category_path | H.49.4.1.0
sector_path                    | 
count                          | 1
stats_summary                  | {                                           +
                               |     "turnover": {                           +
                               |         "max": 60000000,                    +
                               |         "min": 60000000,                    +
                               |         "sum": 60000000,                    +
                               |         "mean": 60000000.00,                +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     },                                      +
                               |     "employees": {                          +
                               |         "max": 40,                          +
                               |         "min": 40,                          +
                               |         "sum": 40,                          +
                               |         "mean": 40.00,                      +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     }                                       +
                               | }
-[ RECORD 26 ]-----------------+---------------------------------------------
valid_from                     | 2019-11-01
valid_to                       | 2019-12-31
unit_type                      | legal_unit
physical_region_path           | 11.21
primary_activity_category_path | H.49.4.1.0
sector_path                    | innl.a_ikke_fin.2100
count                          | 1
stats_summary                  | {                                           +
                               |     "turnover": {                           +
                               |         "max": 60000000,                    +
                               |         "min": 60000000,                    +
                               |         "sum": 60000000,                    +
                               |         "mean": 60000000.00,                +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     },                                      +
                               |     "employees": {                          +
                               |         "max": 40,                          +
                               |         "min": 40,                          +
                               |         "sum": 40,                          +
                               |         "mean": 40.00,                      +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     }                                       +
                               | }
-[ RECORD 27 ]-----------------+---------------------------------------------
valid_from                     | 2019-11-01
valid_to                       | 2019-12-31
unit_type                      | enterprise
physical_region_path           | 11.21
primary_activity_category_path | H.49.4.1.0
sector_path                    | innl.a_ikke_fin.2100
count                          | 1
stats_summary                  | {                                           +
                               |     "turnover": {                           +
                               |         "max": 60000000,                    +
                               |         "min": 60000000,                    +
                               |         "sum": 60000000,                    +
                               |         "mean": 60000000.00,                +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     },                                      +
                               |     "employees": {                          +
                               |         "max": 40,                          +
                               |         "min": 40,                          +
                               |         "sum": 40,                          +
                               |         "mean": 40.00,                      +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     }                                       +
                               | }
-[ RECORD 28 ]-----------------+---------------------------------------------
valid_from                     | 2020-01-01
valid_to                       | infinity
unit_type                      | establishment
physical_region_path           | 11.21
primary_activity_category_path | H.49.4.1.0
sector_path                    | 
count                          | 1
stats_summary                  | {                                           +
                               |     "turnover": {                           +
                               |         "max": 70000000,                    +
                               |         "min": 70000000,                    +
                               |         "sum": 70000000,                    +
                               |         "mean": 70000000.00,                +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     },                                      +
                               |     "employees": {                          +
                               |         "max": 45,                          +
                               |         "min": 45,                          +
                               |         "sum": 45,                          +
                               |         "mean": 45.00,                      +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     }                                       +
                               | }
-[ RECORD 29 ]-----------------+---------------------------------------------
valid_from                     | 2020-01-01
valid_to                       | infinity
unit_type                      | legal_unit
physical_region_path           | 11.21
primary_activity_category_path | H.49.4.1.0
sector_path                    | innl.a_ikke_fin.2100
count                          | 1
stats_summary                  | {                                           +
                               |     "turnover": {                           +
                               |         "max": 70000000,                    +
                               |         "min": 70000000,                    +
                               |         "sum": 70000000,                    +
                               |         "mean": 70000000.00,                +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     },                                      +
                               |     "employees": {                          +
                               |         "max": 45,                          +
                               |         "min": 45,                          +
                               |         "sum": 45,                          +
                               |         "mean": 45.00,                      +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     }                                       +
                               | }
-[ RECORD 30 ]-----------------+---------------------------------------------
valid_from                     | 2020-01-01
valid_to                       | infinity
unit_type                      | enterprise
physical_region_path           | 11.21
primary_activity_category_path | H.49.4.1.0
sector_path                    | innl.a_ikke_fin.2100
count                          | 1
stats_summary                  | {                                           +
                               |     "turnover": {                           +
                               |         "max": 70000000,                    +
                               |         "min": 70000000,                    +
                               |         "sum": 70000000,                    +
                               |         "mean": 70000000.00,                +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     },                                      +
                               |     "employees": {                          +
                               |         "max": 45,                          +
                               |         "min": 45,                          +
                               |         "sum": 45,                          +
                               |         "mean": 45.00,                      +
                               |         "type": "number",                   +
                               |         "count": 1,                         +
                               |         "stddev": 0.00,                     +
                               |         "variance": 0.00,                   +
                               |         "sum_sq_diff": 0.00,                +
                               |         "coefficient_of_variation_pct": 0.00+
                               |     }                                       +
                               | }

\x
\echo "Test yearly facet data"
"Test yearly facet data"
SELECT year
     , unit_type
     , primary_activity_category_path
     , secondary_activity_category_path
     , sector_path
     , physical_region_path
     , exists_count
     , exists_change
     , exists_added_count
     , exists_removed_count
     , countable_count
     , countable_change
     , countable_added_count
     , countable_removed_count
FROM public.statistical_history_facet
WHERE resolution = 'year'
  AND year <= 2024
ORDER BY year,unit_type;
 year |   unit_type   | primary_activity_category_path | secondary_activity_category_path |     sector_path      | physical_region_path | exists_count | exists_change | exists_added_count | exists_removed_count | countable_count | countable_change | countable_added_count | countable_removed_count 
------+---------------+--------------------------------+----------------------------------+----------------------+----------------------+--------------+---------------+--------------------+----------------------+-----------------+------------------+-----------------------+-------------------------
 2010 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |            1 |             1 |                  1 |                    0 |               1 |                1 |                     1 |                       0
 2010 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             1 |                  1 |                    0 |               1 |                1 |                     1 |                       0
 2010 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             1 |                  1 |                    0 |               1 |                1 |                     1 |                       0
 2011 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2011 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2011 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2012 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2012 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            0 |            -1 |                  0 |                    1 |               0 |               -1 |                     0 |                       1
 2012 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            0 |            -1 |                  0 |                    1 |               0 |               -1 |                     0 |                       1
 2013 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2013 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             1 |                  1 |                    0 |               1 |                1 |                     1 |                       0
 2013 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             1 |                  1 |                    0 |               1 |                1 |                     1 |                       0
 2014 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2014 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2014 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2015 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2015 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2015 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2016 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2016 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2016 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2017 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2017 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2017 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2018 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2018 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2018 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2020 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2020 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2020 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2021 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2021 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2021 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2022 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2022 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2022 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2023 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2023 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2023 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2024 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2024 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2024 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
(45 rows)

\echo "Test yearly facet data"
"Test yearly facet data"
SELECT year
     , unit_type
     , primary_activity_category_path
     , secondary_activity_category_path
     , sector_path
     , physical_region_path
     , countable_count AS count
     , births
     , deaths
     , primary_activity_category_change_count
     , secondary_activity_category_change_count
     , sector_change_count
     , legal_form_change_count
     , physical_region_change_count
     , physical_country_change_count
FROM public.statistical_history_facet
WHERE resolution = 'year'
  AND year <= 2024
ORDER BY year,unit_type;
 year |   unit_type   | primary_activity_category_path | secondary_activity_category_path |     sector_path      | physical_region_path | count | births | deaths | primary_activity_category_change_count | secondary_activity_category_change_count | sector_change_count | legal_form_change_count | physical_region_change_count | physical_country_change_count 
------+---------------+--------------------------------+----------------------------------+----------------------+----------------------+-------+--------+--------+----------------------------------------+------------------------------------------+---------------------+-------------------------+------------------------------+-------------------------------
 2010 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |     1 |      1 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2010 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      1 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2010 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      1 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2011 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2011 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2011 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2012 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2012 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     0 |      0 |      1 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2012 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     0 |      0 |      1 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2013 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2013 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      1 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2013 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      1 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2014 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2014 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2014 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2015 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2015 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2015 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2016 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2016 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2016 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2017 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2017 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2017 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2018 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2018 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2018 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2020 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2020 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2020 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2021 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2021 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2021 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2022 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2022 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2022 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2023 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2023 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2023 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2024 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2024 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2024 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
(45 rows)

\echo "Test yearly facet stats"
"Test yearly facet stats"
SELECT year
     , unit_type
     , jsonb_pretty(stats_summary) AS stats_summary
FROM public.statistical_history_facet
WHERE resolution = 'year'
  AND year <= 2024
ORDER BY year,unit_type;
 year |   unit_type   |                stats_summary                 
------+---------------+----------------------------------------------
 2010 | establishment | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 1500000,                     +
      |               |         "min": 1500000,                     +
      |               |         "sum": 1500000,                     +
      |               |         "mean": 1500000.00,                 +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 1,                           +
      |               |         "min": 1,                           +
      |               |         "sum": 1,                           +
      |               |         "mean": 1.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2010 | legal_unit    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 1500000,                     +
      |               |         "min": 1500000,                     +
      |               |         "sum": 1500000,                     +
      |               |         "mean": 1500000.00,                 +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 1,                           +
      |               |         "min": 1,                           +
      |               |         "sum": 1,                           +
      |               |         "mean": 1.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2010 | enterprise    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 1500000,                     +
      |               |         "min": 1500000,                     +
      |               |         "sum": 1500000,                     +
      |               |         "mean": 1500000.00,                 +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 1,                           +
      |               |         "min": 1,                           +
      |               |         "sum": 1,                           +
      |               |         "mean": 1.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2011 | establishment | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 1500000,                     +
      |               |         "min": 1500000,                     +
      |               |         "sum": 1500000,                     +
      |               |         "mean": 1500000.00,                 +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 1,                           +
      |               |         "min": 1,                           +
      |               |         "sum": 1,                           +
      |               |         "mean": 1.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2011 | legal_unit    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 1500000,                     +
      |               |         "min": 1500000,                     +
      |               |         "sum": 1500000,                     +
      |               |         "mean": 1500000.00,                 +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 1,                           +
      |               |         "min": 1,                           +
      |               |         "sum": 1,                           +
      |               |         "mean": 1.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2011 | enterprise    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 1500000,                     +
      |               |         "min": 1500000,                     +
      |               |         "sum": 1500000,                     +
      |               |         "mean": 1500000.00,                 +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 1,                           +
      |               |         "min": 1,                           +
      |               |         "sum": 1,                           +
      |               |         "mean": 1.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2012 | establishment | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 1500000,                     +
      |               |         "min": 1500000,                     +
      |               |         "sum": 1500000,                     +
      |               |         "mean": 1500000.00,                 +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 1,                           +
      |               |         "min": 1,                           +
      |               |         "sum": 1,                           +
      |               |         "mean": 1.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2012 | legal_unit    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 1500000,                     +
      |               |         "min": 1500000,                     +
      |               |         "sum": 1500000,                     +
      |               |         "mean": 1500000.00,                 +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 1,                           +
      |               |         "min": 1,                           +
      |               |         "sum": 1,                           +
      |               |         "mean": 1.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2012 | enterprise    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 1500000,                     +
      |               |         "min": 1500000,                     +
      |               |         "sum": 1500000,                     +
      |               |         "mean": 1500000.00,                 +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 1,                           +
      |               |         "min": 1,                           +
      |               |         "sum": 1,                           +
      |               |         "mean": 1.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2013 | establishment | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 3000000,                     +
      |               |         "min": 3000000,                     +
      |               |         "sum": 3000000,                     +
      |               |         "mean": 3000000.00,                 +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 3,                           +
      |               |         "min": 3,                           +
      |               |         "sum": 3,                           +
      |               |         "mean": 3.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2013 | legal_unit    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 3000000,                     +
      |               |         "min": 3000000,                     +
      |               |         "sum": 3000000,                     +
      |               |         "mean": 3000000.00,                 +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 3,                           +
      |               |         "min": 3,                           +
      |               |         "sum": 3,                           +
      |               |         "mean": 3.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2013 | enterprise    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 3000000,                     +
      |               |         "min": 3000000,                     +
      |               |         "sum": 3000000,                     +
      |               |         "mean": 3000000.00,                 +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 3,                           +
      |               |         "min": 3,                           +
      |               |         "sum": 3,                           +
      |               |         "mean": 3.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2014 | establishment | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 3000000,                     +
      |               |         "min": 3000000,                     +
      |               |         "sum": 3000000,                     +
      |               |         "mean": 3000000.00,                 +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 3,                           +
      |               |         "min": 3,                           +
      |               |         "sum": 3,                           +
      |               |         "mean": 3.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2014 | legal_unit    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 3000000,                     +
      |               |         "min": 3000000,                     +
      |               |         "sum": 3000000,                     +
      |               |         "mean": 3000000.00,                 +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 3,                           +
      |               |         "min": 3,                           +
      |               |         "sum": 3,                           +
      |               |         "mean": 3.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2014 | enterprise    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 3000000,                     +
      |               |         "min": 3000000,                     +
      |               |         "sum": 3000000,                     +
      |               |         "mean": 3000000.00,                 +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 3,                           +
      |               |         "min": 3,                           +
      |               |         "sum": 3,                           +
      |               |         "mean": 3.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2015 | establishment | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 3000000,                     +
      |               |         "min": 3000000,                     +
      |               |         "sum": 3000000,                     +
      |               |         "mean": 3000000.00,                 +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 3,                           +
      |               |         "min": 3,                           +
      |               |         "sum": 3,                           +
      |               |         "mean": 3.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2015 | legal_unit    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 3000000,                     +
      |               |         "min": 3000000,                     +
      |               |         "sum": 3000000,                     +
      |               |         "mean": 3000000.00,                 +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 3,                           +
      |               |         "min": 3,                           +
      |               |         "sum": 3,                           +
      |               |         "mean": 3.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2015 | enterprise    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 3000000,                     +
      |               |         "min": 3000000,                     +
      |               |         "sum": 3000000,                     +
      |               |         "mean": 3000000.00,                 +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 3,                           +
      |               |         "min": 3,                           +
      |               |         "sum": 3,                           +
      |               |         "mean": 3.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2016 | establishment | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 12000000,                    +
      |               |         "min": 12000000,                    +
      |               |         "sum": 12000000,                    +
      |               |         "mean": 12000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 9,                           +
      |               |         "min": 9,                           +
      |               |         "sum": 9,                           +
      |               |         "mean": 9.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2016 | legal_unit    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 12000000,                    +
      |               |         "min": 12000000,                    +
      |               |         "sum": 12000000,                    +
      |               |         "mean": 12000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 9,                           +
      |               |         "min": 9,                           +
      |               |         "sum": 9,                           +
      |               |         "mean": 9.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2016 | enterprise    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 12000000,                    +
      |               |         "min": 12000000,                    +
      |               |         "sum": 12000000,                    +
      |               |         "mean": 12000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 9,                           +
      |               |         "min": 9,                           +
      |               |         "sum": 9,                           +
      |               |         "mean": 9.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2017 | establishment | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 12000000,                    +
      |               |         "min": 12000000,                    +
      |               |         "sum": 12000000,                    +
      |               |         "mean": 12000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 9,                           +
      |               |         "min": 9,                           +
      |               |         "sum": 9,                           +
      |               |         "mean": 9.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2017 | legal_unit    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 12000000,                    +
      |               |         "min": 12000000,                    +
      |               |         "sum": 12000000,                    +
      |               |         "mean": 12000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 9,                           +
      |               |         "min": 9,                           +
      |               |         "sum": 9,                           +
      |               |         "mean": 9.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2017 | enterprise    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 12000000,                    +
      |               |         "min": 12000000,                    +
      |               |         "sum": 12000000,                    +
      |               |         "mean": 12000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 9,                           +
      |               |         "min": 9,                           +
      |               |         "sum": 9,                           +
      |               |         "mean": 9.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2018 | establishment | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 12000000,                    +
      |               |         "min": 12000000,                    +
      |               |         "sum": 12000000,                    +
      |               |         "mean": 12000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 9,                           +
      |               |         "min": 9,                           +
      |               |         "sum": 9,                           +
      |               |         "mean": 9.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2018 | legal_unit    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 12000000,                    +
      |               |         "min": 12000000,                    +
      |               |         "sum": 12000000,                    +
      |               |         "mean": 12000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 9,                           +
      |               |         "min": 9,                           +
      |               |         "sum": 9,                           +
      |               |         "mean": 9.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2018 | enterprise    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 12000000,                    +
      |               |         "min": 12000000,                    +
      |               |         "sum": 12000000,                    +
      |               |         "mean": 12000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 9,                           +
      |               |         "min": 9,                           +
      |               |         "sum": 9,                           +
      |               |         "mean": 9.00,                       +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2019 | establishment | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 60000000,                    +
      |               |         "min": 60000000,                    +
      |               |         "sum": 60000000,                    +
      |               |         "mean": 60000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 40,                          +
      |               |         "min": 40,                          +
      |               |         "sum": 40,                          +
      |               |         "mean": 40.00,                      +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2019 | legal_unit    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 60000000,                    +
      |               |         "min": 60000000,                    +
      |               |         "sum": 60000000,                    +
      |               |         "mean": 60000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 40,                          +
      |               |         "min": 40,                          +
      |               |         "sum": 40,                          +
      |               |         "mean": 40.00,                      +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2019 | enterprise    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 60000000,                    +
      |               |         "min": 60000000,                    +
      |               |         "sum": 60000000,                    +
      |               |         "mean": 60000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 40,                          +
      |               |         "min": 40,                          +
      |               |         "sum": 40,                          +
      |               |         "mean": 40.00,                      +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2020 | establishment | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 70000000,                    +
      |               |         "min": 70000000,                    +
      |               |         "sum": 70000000,                    +
      |               |         "mean": 70000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 45,                          +
      |               |         "min": 45,                          +
      |               |         "sum": 45,                          +
      |               |         "mean": 45.00,                      +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2020 | legal_unit    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 70000000,                    +
      |               |         "min": 70000000,                    +
      |               |         "sum": 70000000,                    +
      |               |         "mean": 70000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 45,                          +
      |               |         "min": 45,                          +
      |               |         "sum": 45,                          +
      |               |         "mean": 45.00,                      +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2020 | enterprise    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 70000000,                    +
      |               |         "min": 70000000,                    +
      |               |         "sum": 70000000,                    +
      |               |         "mean": 70000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 45,                          +
      |               |         "min": 45,                          +
      |               |         "sum": 45,                          +
      |               |         "mean": 45.00,                      +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2021 | establishment | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 70000000,                    +
      |               |         "min": 70000000,                    +
      |               |         "sum": 70000000,                    +
      |               |         "mean": 70000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 45,                          +
      |               |         "min": 45,                          +
      |               |         "sum": 45,                          +
      |               |         "mean": 45.00,                      +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2021 | legal_unit    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 70000000,                    +
      |               |         "min": 70000000,                    +
      |               |         "sum": 70000000,                    +
      |               |         "mean": 70000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 45,                          +
      |               |         "min": 45,                          +
      |               |         "sum": 45,                          +
      |               |         "mean": 45.00,                      +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2021 | enterprise    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 70000000,                    +
      |               |         "min": 70000000,                    +
      |               |         "sum": 70000000,                    +
      |               |         "mean": 70000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 45,                          +
      |               |         "min": 45,                          +
      |               |         "sum": 45,                          +
      |               |         "mean": 45.00,                      +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2022 | establishment | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 70000000,                    +
      |               |         "min": 70000000,                    +
      |               |         "sum": 70000000,                    +
      |               |         "mean": 70000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 45,                          +
      |               |         "min": 45,                          +
      |               |         "sum": 45,                          +
      |               |         "mean": 45.00,                      +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2022 | legal_unit    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 70000000,                    +
      |               |         "min": 70000000,                    +
      |               |         "sum": 70000000,                    +
      |               |         "mean": 70000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 45,                          +
      |               |         "min": 45,                          +
      |               |         "sum": 45,                          +
      |               |         "mean": 45.00,                      +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2022 | enterprise    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 70000000,                    +
      |               |         "min": 70000000,                    +
      |               |         "sum": 70000000,                    +
      |               |         "mean": 70000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 45,                          +
      |               |         "min": 45,                          +
      |               |         "sum": 45,                          +
      |               |         "mean": 45.00,                      +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2023 | establishment | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 70000000,                    +
      |               |         "min": 70000000,                    +
      |               |         "sum": 70000000,                    +
      |               |         "mean": 70000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 45,                          +
      |               |         "min": 45,                          +
      |               |         "sum": 45,                          +
      |               |         "mean": 45.00,                      +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2023 | legal_unit    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 70000000,                    +
      |               |         "min": 70000000,                    +
      |               |         "sum": 70000000,                    +
      |               |         "mean": 70000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 45,                          +
      |               |         "min": 45,                          +
      |               |         "sum": 45,                          +
      |               |         "mean": 45.00,                      +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2023 | enterprise    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 70000000,                    +
      |               |         "min": 70000000,                    +
      |               |         "sum": 70000000,                    +
      |               |         "mean": 70000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 45,                          +
      |               |         "min": 45,                          +
      |               |         "sum": 45,                          +
      |               |         "mean": 45.00,                      +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2024 | establishment | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 70000000,                    +
      |               |         "min": 70000000,                    +
      |               |         "sum": 70000000,                    +
      |               |         "mean": 70000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 45,                          +
      |               |         "min": 45,                          +
      |               |         "sum": 45,                          +
      |               |         "mean": 45.00,                      +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2024 | legal_unit    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 70000000,                    +
      |               |         "min": 70000000,                    +
      |               |         "sum": 70000000,                    +
      |               |         "mean": 70000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 45,                          +
      |               |         "min": 45,                          +
      |               |         "sum": 45,                          +
      |               |         "mean": 45.00,                      +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
 2024 | enterprise    | {                                           +
      |               |     "turnover": {                           +
      |               |         "max": 70000000,                    +
      |               |         "min": 70000000,                    +
      |               |         "sum": 70000000,                    +
      |               |         "mean": 70000000.00,                +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     },                                      +
      |               |     "employees": {                          +
      |               |         "max": 45,                          +
      |               |         "min": 45,                          +
      |               |         "sum": 45,                          +
      |               |         "mean": 45.00,                      +
      |               |         "type": "number",                   +
      |               |         "count": 1,                         +
      |               |         "stddev": 0.00,                     +
      |               |         "variance": 0.00,                   +
      |               |         "sum_sq_diff": 0.00,                +
      |               |         "coefficient_of_variation_pct": 0.00+
      |               |     }                                       +
      |               | }
(45 rows)

\echo "Test monthly facet data for 2019"
"Test monthly facet data for 2019"
SELECT year, month
     , unit_type
     , primary_activity_category_path
     , secondary_activity_category_path
     , sector_path
     , physical_region_path
     , exists_count
     , exists_change
     , exists_added_count
     , exists_removed_count
     , countable_count
     , countable_change
     , countable_added_count
     , countable_removed_count
FROM public.statistical_history_facet
WHERE resolution = 'year-month' AND year = 2019
ORDER BY year,month,unit_type;
 year | month |   unit_type   | primary_activity_category_path | secondary_activity_category_path |     sector_path      | physical_region_path | exists_count | exists_change | exists_added_count | exists_removed_count | countable_count | countable_change | countable_added_count | countable_removed_count 
------+-------+---------------+--------------------------------+----------------------------------+----------------------+----------------------+--------------+---------------+--------------------+----------------------+-----------------+------------------+-----------------------+-------------------------
 2019 |     1 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     1 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     1 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     2 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     2 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     2 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     3 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     3 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     3 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     4 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     4 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     4 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     5 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     5 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     5 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     6 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     6 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     6 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     7 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     7 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     7 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     8 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     8 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     8 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     9 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     9 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |     9 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |    10 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |    10 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |    10 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |    11 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |    11 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |    11 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |    12 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |    12 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
 2019 |    12 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |            1 |             0 |                  0 |                    0 |               1 |                0 |                     0 |                       0
(36 rows)

\echo "Test monthly facet data for 2019"
"Test monthly facet data for 2019"
SELECT year, month
     , unit_type
     , primary_activity_category_path
     , secondary_activity_category_path
     , sector_path
     , physical_region_path
     , countable_count AS count
     , births
     , deaths
     , primary_activity_category_change_count
     , secondary_activity_category_change_count
     , sector_change_count
     , legal_form_change_count
     , physical_region_change_count
     , physical_country_change_count
FROM public.statistical_history_facet
WHERE resolution = 'year-month' AND year = 2019
ORDER BY year,month,unit_type;
 year | month |   unit_type   | primary_activity_category_path | secondary_activity_category_path |     sector_path      | physical_region_path | count | births | deaths | primary_activity_category_change_count | secondary_activity_category_change_count | sector_change_count | legal_form_change_count | physical_region_change_count | physical_country_change_count 
------+-------+---------------+--------------------------------+----------------------------------+----------------------+----------------------+-------+--------+--------+----------------------------------------+------------------------------------------+---------------------+-------------------------+------------------------------+-------------------------------
 2019 |     1 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     1 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     1 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     2 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     2 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     2 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     3 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     3 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     3 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     4 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     4 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     4 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     5 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     5 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     5 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     6 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     6 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     6 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     7 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     7 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     7 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     8 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     8 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     8 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     9 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     9 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |     9 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |    10 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |    10 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |    10 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |    11 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |    11 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |    11 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |    12 | establishment | H.49.4.1.0                     |                                  |                      | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |    12 | legal_unit    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
 2019 |    12 | enterprise    | H.49.4.1.0                     |                                  | innl.a_ikke_fin.2100 | 11.21                |     1 |      0 |      0 |                                      0 |                                        0 |                   0 |                       0 |                            0 |                             0
(36 rows)

\echo "Test monthly facet data"
"Test monthly facet data"
SELECT year, month
     , unit_type
     , jsonb_pretty(stats_summary) AS stats_summary
FROM public.statistical_history_facet
WHERE resolution = 'year-month' AND year = 2019
ORDER BY year,month,unit_type;
 year | month |   unit_type   |                stats_summary                 
------+-------+---------------+----------------------------------------------
 2019 |     1 | establishment | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 25,                          +
      |       |               |         "min": 25,                          +
      |       |               |         "sum": 25,                          +
      |       |               |         "mean": 25.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     1 | legal_unit    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 25,                          +
      |       |               |         "min": 25,                          +
      |       |               |         "sum": 25,                          +
      |       |               |         "mean": 25.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     1 | enterprise    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 25,                          +
      |       |               |         "min": 25,                          +
      |       |               |         "sum": 25,                          +
      |       |               |         "mean": 25.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     2 | establishment | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 25,                          +
      |       |               |         "min": 25,                          +
      |       |               |         "sum": 25,                          +
      |       |               |         "mean": 25.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     2 | legal_unit    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 25,                          +
      |       |               |         "min": 25,                          +
      |       |               |         "sum": 25,                          +
      |       |               |         "mean": 25.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     2 | enterprise    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 25,                          +
      |       |               |         "min": 25,                          +
      |       |               |         "sum": 25,                          +
      |       |               |         "mean": 25.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     3 | establishment | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 30,                          +
      |       |               |         "min": 30,                          +
      |       |               |         "sum": 30,                          +
      |       |               |         "mean": 30.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     3 | legal_unit    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 30,                          +
      |       |               |         "min": 30,                          +
      |       |               |         "sum": 30,                          +
      |       |               |         "mean": 30.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     3 | enterprise    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 30,                          +
      |       |               |         "min": 30,                          +
      |       |               |         "sum": 30,                          +
      |       |               |         "mean": 30.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     4 | establishment | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 30,                          +
      |       |               |         "min": 30,                          +
      |       |               |         "sum": 30,                          +
      |       |               |         "mean": 30.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     4 | legal_unit    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 30,                          +
      |       |               |         "min": 30,                          +
      |       |               |         "sum": 30,                          +
      |       |               |         "mean": 30.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     4 | enterprise    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 30,                          +
      |       |               |         "min": 30,                          +
      |       |               |         "sum": 30,                          +
      |       |               |         "mean": 30.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     5 | establishment | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 35,                          +
      |       |               |         "min": 35,                          +
      |       |               |         "sum": 35,                          +
      |       |               |         "mean": 35.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     5 | legal_unit    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 35,                          +
      |       |               |         "min": 35,                          +
      |       |               |         "sum": 35,                          +
      |       |               |         "mean": 35.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     5 | enterprise    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 35,                          +
      |       |               |         "min": 35,                          +
      |       |               |         "sum": 35,                          +
      |       |               |         "mean": 35.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     6 | establishment | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 35,                          +
      |       |               |         "min": 35,                          +
      |       |               |         "sum": 35,                          +
      |       |               |         "mean": 35.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     6 | legal_unit    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 35,                          +
      |       |               |         "min": 35,                          +
      |       |               |         "sum": 35,                          +
      |       |               |         "mean": 35.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     6 | enterprise    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 35,                          +
      |       |               |         "min": 35,                          +
      |       |               |         "sum": 35,                          +
      |       |               |         "mean": 35.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     7 | establishment | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 40,                          +
      |       |               |         "min": 40,                          +
      |       |               |         "sum": 40,                          +
      |       |               |         "mean": 40.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     7 | legal_unit    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 40,                          +
      |       |               |         "min": 40,                          +
      |       |               |         "sum": 40,                          +
      |       |               |         "mean": 40.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     7 | enterprise    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 40,                          +
      |       |               |         "min": 40,                          +
      |       |               |         "sum": 40,                          +
      |       |               |         "mean": 40.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     8 | establishment | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 40,                          +
      |       |               |         "min": 40,                          +
      |       |               |         "sum": 40,                          +
      |       |               |         "mean": 40.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     8 | legal_unit    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 40,                          +
      |       |               |         "min": 40,                          +
      |       |               |         "sum": 40,                          +
      |       |               |         "mean": 40.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     8 | enterprise    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 40,                          +
      |       |               |         "min": 40,                          +
      |       |               |         "sum": 40,                          +
      |       |               |         "mean": 40.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     9 | establishment | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 50,                          +
      |       |               |         "min": 50,                          +
      |       |               |         "sum": 50,                          +
      |       |               |         "mean": 50.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     9 | legal_unit    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 50,                          +
      |       |               |         "min": 50,                          +
      |       |               |         "sum": 50,                          +
      |       |               |         "mean": 50.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |     9 | enterprise    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 50,                          +
      |       |               |         "min": 50,                          +
      |       |               |         "sum": 50,                          +
      |       |               |         "mean": 50.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |    10 | establishment | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 50,                          +
      |       |               |         "min": 50,                          +
      |       |               |         "sum": 50,                          +
      |       |               |         "mean": 50.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |    10 | legal_unit    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 50,                          +
      |       |               |         "min": 50,                          +
      |       |               |         "sum": 50,                          +
      |       |               |         "mean": 50.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |    10 | enterprise    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 50,                          +
      |       |               |         "min": 50,                          +
      |       |               |         "sum": 50,                          +
      |       |               |         "mean": 50.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |    11 | establishment | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 40,                          +
      |       |               |         "min": 40,                          +
      |       |               |         "sum": 40,                          +
      |       |               |         "mean": 40.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |    11 | legal_unit    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 40,                          +
      |       |               |         "min": 40,                          +
      |       |               |         "sum": 40,                          +
      |       |               |         "mean": 40.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |    11 | enterprise    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 40,                          +
      |       |               |         "min": 40,                          +
      |       |               |         "sum": 40,                          +
      |       |               |         "mean": 40.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |    12 | establishment | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 40,                          +
      |       |               |         "min": 40,                          +
      |       |               |         "sum": 40,                          +
      |       |               |         "mean": 40.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |    12 | legal_unit    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 40,                          +
      |       |               |         "min": 40,                          +
      |       |               |         "sum": 40,                          +
      |       |               |         "mean": 40.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
 2019 |    12 | enterprise    | {                                           +
      |       |               |     "turnover": {                           +
      |       |               |         "max": 60000000,                    +
      |       |               |         "min": 60000000,                    +
      |       |               |         "sum": 60000000,                    +
      |       |               |         "mean": 60000000.00,                +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     },                                      +
      |       |               |     "employees": {                          +
      |       |               |         "max": 40,                          +
      |       |               |         "min": 40,                          +
      |       |               |         "sum": 40,                          +
      |       |               |         "mean": 40.00,                      +
      |       |               |         "type": "number",                   +
      |       |               |         "count": 1,                         +
      |       |               |         "stddev": 0.00,                     +
      |       |               |         "variance": 0.00,                   +
      |       |               |         "sum_sq_diff": 0.00,                +
      |       |               |         "coefficient_of_variation_pct": 0.00+
      |       |               |     }                                       +
      |       |               | }
(36 rows)

\a
\echo "Test yearly drilldown - enterprise"
"Test yearly drilldown - enterprise"
SELECT jsonb_pretty(
     public.remove_ephemeral_data_from_hierarchy(
     public.statistical_history_drilldown(
          unit_type := 'enterprise'::public.statistical_unit_type,
          resolution := 'year'::public.history_resolution,
          year := NULL::INTEGER,
          region_path := NULL::public.ltree,
          activity_category_path := NULL::public.ltree,
          sector_path := NULL::public.ltree,
          legal_form_id := NULL::INTEGER,
          country_id := NULL::INTEGER,
          year_min := 2010,
          year_max := 2024
     ))) AS statistical_history_drilldown;
statistical_history_drilldown
{
    "stats": [
        {
            "year": 2010,
            "month": null,
            "births": 1,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 1,
            "stats_summary": {
                "turnover": {
                    "max": 1500000,
                    "min": 1500000,
                    "sum": 1500000,
                    "mean": 1500000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 1,
                    "min": 1,
                    "sum": 1,
                    "mean": 1.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 1,
            "name_change_count": 0,
            "exists_added_count": 1,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 1,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2011,
            "month": null,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 1500000,
                    "min": 1500000,
                    "sum": 1500000,
                    "mean": 1500000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 1,
                    "min": 1,
                    "sum": 1,
                    "mean": 1.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2012,
            "month": null,
            "births": 0,
            "deaths": 1,
            "exists_count": 0,
            "exists_change": -1,
            "stats_summary": {
                "turnover": {
                    "max": 1500000,
                    "min": 1500000,
                    "sum": 1500000,
                    "mean": 1500000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 1,
                    "min": 1,
                    "sum": 1,
                    "mean": 1.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 0,
            "countable_change": -1,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 1,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 1,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2013,
            "month": null,
            "births": 1,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 1,
            "stats_summary": {
                "turnover": {
                    "max": 3000000,
                    "min": 3000000,
                    "sum": 3000000,
                    "mean": 3000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 3,
                    "min": 3,
                    "sum": 3,
                    "mean": 3.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 1,
            "name_change_count": 0,
            "exists_added_count": 1,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 1,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2014,
            "month": null,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 3000000,
                    "min": 3000000,
                    "sum": 3000000,
                    "mean": 3000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 3,
                    "min": 3,
                    "sum": 3,
                    "mean": 3.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2015,
            "month": null,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 3000000,
                    "min": 3000000,
                    "sum": 3000000,
                    "mean": 3000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 3,
                    "min": 3,
                    "sum": 3,
                    "mean": 3.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2016,
            "month": null,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 12000000,
                    "min": 12000000,
                    "sum": 12000000,
                    "mean": 12000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 9,
                    "min": 9,
                    "sum": 9,
                    "mean": 9.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2017,
            "month": null,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 12000000,
                    "min": 12000000,
                    "sum": 12000000,
                    "mean": 12000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 9,
                    "min": 9,
                    "sum": 9,
                    "mean": 9.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2018,
            "month": null,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 12000000,
                    "min": 12000000,
                    "sum": 12000000,
                    "mean": 12000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 9,
                    "min": 9,
                    "sum": 9,
                    "mean": 9.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2019,
            "month": null,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 60000000,
                    "min": 60000000,
                    "sum": 60000000,
                    "mean": 60000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 40,
                    "min": 40,
                    "sum": 40,
                    "mean": 40.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2020,
            "month": null,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 70000000,
                    "min": 70000000,
                    "sum": 70000000,
                    "mean": 70000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 45,
                    "min": 45,
                    "sum": 45,
                    "mean": 45.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2021,
            "month": null,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 70000000,
                    "min": 70000000,
                    "sum": 70000000,
                    "mean": 70000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 45,
                    "min": 45,
                    "sum": 45,
                    "mean": 45.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2022,
            "month": null,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 70000000,
                    "min": 70000000,
                    "sum": 70000000,
                    "mean": 70000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 45,
                    "min": 45,
                    "sum": 45,
                    "mean": 45.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2023,
            "month": null,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 70000000,
                    "min": 70000000,
                    "sum": 70000000,
                    "mean": 70000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 45,
                    "min": 45,
                    "sum": 45,
                    "mean": 45.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2024,
            "month": null,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 70000000,
                    "min": 70000000,
                    "sum": 70000000,
                    "mean": 70000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 45,
                    "min": 45,
                    "sum": 45,
                    "mean": 45.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        }
    ],
    "filter": {
        "type": "year",
        "year": null,
        "unit_type": "enterprise",
        "region_path": null,
        "sector_path": null,
        "activity_category_path": null
    },
    "available": {
        "region": [
            {
                "code": "11",
                "name": "Rogaland",
                "path": "11",
                "count": 14,
                "label": "11",
                "has_children": true
            }
        ],
        "sector": [
            {
                "code": null,
                "name": "Innenlandske sektorer",
                "path": "innl",
                "count": 14,
                "label": "innl",
                "has_children": true
            }
        ],
        "status": [
            {
                "code": "active",
                "name": "Active",
                "count": 14,
                "has_children": false
            }
        ],
        "country": [
            {
                "name": "Norway",
                "count": 14,
                "iso_2": "NO",
                "has_children": false
            }
        ],
        "legal_form": [
            {
                "code": "AS",
                "name": "Aksjeselskap",
                "count": 12,
                "has_children": false
            },
            {
                "code": "ENK",
                "name": "Enkeltpersonforetak",
                "count": 2,
                "has_children": false
            }
        ],
        "activity_category": [
            {
                "code": "",
                "name": "Transport og lagring",
                "path": "H",
                "count": 14,
                "label": "H",
                "has_children": true
            }
        ]
    },
    "unit_type": "enterprise",
    "breadcrumb": {
        "region": null,
        "sector": null,
        "status": null,
        "country": null,
        "legal_form": null,
        "activity_category": null
    }
}
(1 row)
\echo "Test yearly drilldown - legal_unit"
"Test yearly drilldown - legal_unit"
SELECT jsonb_pretty(
     public.remove_ephemeral_data_from_hierarchy(
     public.statistical_history_drilldown(
          unit_type := 'legal_unit'::public.statistical_unit_type,
          resolution := 'year'::public.history_resolution,
          year := NULL::INTEGER,
          region_path := NULL::public.ltree,
          activity_category_path := NULL::public.ltree,
          sector_path := NULL::public.ltree,
          legal_form_id := NULL::INTEGER,
          country_id := NULL::INTEGER,
          year_min := 2010,
          year_max := 2024
     ))) AS statistical_history_drilldown;
statistical_history_drilldown
{
    "stats": [
        {
            "year": 2010,
            "month": null,
            "births": 1,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 1,
            "stats_summary": {
                "turnover": {
                    "max": 1500000,
                    "min": 1500000,
                    "sum": 1500000,
                    "mean": 1500000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 1,
                    "min": 1,
                    "sum": 1,
                    "mean": 1.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 1,
            "name_change_count": 0,
            "exists_added_count": 1,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 1,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2011,
            "month": null,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 1500000,
                    "min": 1500000,
                    "sum": 1500000,
                    "mean": 1500000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 1,
                    "min": 1,
                    "sum": 1,
                    "mean": 1.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2012,
            "month": null,
            "births": 0,
            "deaths": 1,
            "exists_count": 0,
            "exists_change": -1,
            "stats_summary": {
                "turnover": {
                    "max": 1500000,
                    "min": 1500000,
                    "sum": 1500000,
                    "mean": 1500000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 1,
                    "min": 1,
                    "sum": 1,
                    "mean": 1.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 0,
            "countable_change": -1,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 1,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 1,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2013,
            "month": null,
            "births": 1,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 1,
            "stats_summary": {
                "turnover": {
                    "max": 3000000,
                    "min": 3000000,
                    "sum": 3000000,
                    "mean": 3000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 3,
                    "min": 3,
                    "sum": 3,
                    "mean": 3.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 1,
            "name_change_count": 0,
            "exists_added_count": 1,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 1,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2014,
            "month": null,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 3000000,
                    "min": 3000000,
                    "sum": 3000000,
                    "mean": 3000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 3,
                    "min": 3,
                    "sum": 3,
                    "mean": 3.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2015,
            "month": null,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 3000000,
                    "min": 3000000,
                    "sum": 3000000,
                    "mean": 3000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 3,
                    "min": 3,
                    "sum": 3,
                    "mean": 3.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2016,
            "month": null,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 12000000,
                    "min": 12000000,
                    "sum": 12000000,
                    "mean": 12000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 9,
                    "min": 9,
                    "sum": 9,
                    "mean": 9.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2017,
            "month": null,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 12000000,
                    "min": 12000000,
                    "sum": 12000000,
                    "mean": 12000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 9,
                    "min": 9,
                    "sum": 9,
                    "mean": 9.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2018,
            "month": null,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 12000000,
                    "min": 12000000,
                    "sum": 12000000,
                    "mean": 12000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 9,
                    "min": 9,
                    "sum": 9,
                    "mean": 9.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2019,
            "month": null,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 60000000,
                    "min": 60000000,
                    "sum": 60000000,
                    "mean": 60000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 40,
                    "min": 40,
                    "sum": 40,
                    "mean": 40.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2020,
            "month": null,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 70000000,
                    "min": 70000000,
                    "sum": 70000000,
                    "mean": 70000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 45,
                    "min": 45,
                    "sum": 45,
                    "mean": 45.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2021,
            "month": null,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 70000000,
                    "min": 70000000,
                    "sum": 70000000,
                    "mean": 70000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 45,
                    "min": 45,
                    "sum": 45,
                    "mean": 45.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2022,
            "month": null,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 70000000,
                    "min": 70000000,
                    "sum": 70000000,
                    "mean": 70000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 45,
                    "min": 45,
                    "sum": 45,
                    "mean": 45.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2023,
            "month": null,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 70000000,
                    "min": 70000000,
                    "sum": 70000000,
                    "mean": 70000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 45,
                    "min": 45,
                    "sum": 45,
                    "mean": 45.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2024,
            "month": null,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 70000000,
                    "min": 70000000,
                    "sum": 70000000,
                    "mean": 70000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 45,
                    "min": 45,
                    "sum": 45,
                    "mean": 45.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        }
    ],
    "filter": {
        "type": "year",
        "year": null,
        "unit_type": "legal_unit",
        "region_path": null,
        "sector_path": null,
        "activity_category_path": null
    },
    "available": {
        "region": [
            {
                "code": "11",
                "name": "Rogaland",
                "path": "11",
                "count": 14,
                "label": "11",
                "has_children": true
            }
        ],
        "sector": [
            {
                "code": null,
                "name": "Innenlandske sektorer",
                "path": "innl",
                "count": 14,
                "label": "innl",
                "has_children": true
            }
        ],
        "status": [
            {
                "code": "active",
                "name": "Active",
                "count": 14,
                "has_children": false
            }
        ],
        "country": [
            {
                "name": "Norway",
                "count": 14,
                "iso_2": "NO",
                "has_children": false
            }
        ],
        "legal_form": [
            {
                "code": "AS",
                "name": "Aksjeselskap",
                "count": 12,
                "has_children": false
            },
            {
                "code": "ENK",
                "name": "Enkeltpersonforetak",
                "count": 2,
                "has_children": false
            }
        ],
        "activity_category": [
            {
                "code": "",
                "name": "Transport og lagring",
                "path": "H",
                "count": 14,
                "label": "H",
                "has_children": true
            }
        ]
    },
    "unit_type": "legal_unit",
    "breadcrumb": {
        "region": null,
        "sector": null,
        "status": null,
        "country": null,
        "legal_form": null,
        "activity_category": null
    }
}
(1 row)
\echo "Test yearly drilldown - establishment"
"Test yearly drilldown - establishment"
SELECT jsonb_pretty(
     public.remove_ephemeral_data_from_hierarchy(
     public.statistical_history_drilldown(
          unit_type := 'establishment'::public.statistical_unit_type,
          resolution := 'year'::public.history_resolution,
          year := NULL::INTEGER,
          region_path := NULL::public.ltree,
          activity_category_path := NULL::public.ltree,
          sector_path := NULL::public.ltree,
          legal_form_id := NULL::INTEGER,
          country_id := NULL::INTEGER,
          year_min := 2010,
          year_max := 2024
     ))) AS statistical_history_drilldown;
statistical_history_drilldown
{
    "stats": [
        {
            "year": 2010,
            "month": null,
            "births": 1,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 1,
            "stats_summary": {
                "turnover": {
                    "max": 1500000,
                    "min": 1500000,
                    "sum": 1500000,
                    "mean": 1500000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 1,
                    "min": 1,
                    "sum": 1,
                    "mean": 1.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 1,
            "name_change_count": 0,
            "exists_added_count": 1,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 1,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2011,
            "month": null,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 1500000,
                    "min": 1500000,
                    "sum": 1500000,
                    "mean": 1500000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 1,
                    "min": 1,
                    "sum": 1,
                    "mean": 1.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2012,
            "month": null,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 1500000,
                    "min": 1500000,
                    "sum": 1500000,
                    "mean": 1500000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 1,
                    "min": 1,
                    "sum": 1,
                    "mean": 1.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2013,
            "month": null,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 3000000,
                    "min": 3000000,
                    "sum": 3000000,
                    "mean": 3000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 3,
                    "min": 3,
                    "sum": 3,
                    "mean": 3.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 1,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2014,
            "month": null,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 3000000,
                    "min": 3000000,
                    "sum": 3000000,
                    "mean": 3000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 3,
                    "min": 3,
                    "sum": 3,
                    "mean": 3.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2015,
            "month": null,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 3000000,
                    "min": 3000000,
                    "sum": 3000000,
                    "mean": 3000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 3,
                    "min": 3,
                    "sum": 3,
                    "mean": 3.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2016,
            "month": null,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 12000000,
                    "min": 12000000,
                    "sum": 12000000,
                    "mean": 12000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 9,
                    "min": 9,
                    "sum": 9,
                    "mean": 9.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 1,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2017,
            "month": null,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 12000000,
                    "min": 12000000,
                    "sum": 12000000,
                    "mean": 12000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 9,
                    "min": 9,
                    "sum": 9,
                    "mean": 9.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2018,
            "month": null,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 12000000,
                    "min": 12000000,
                    "sum": 12000000,
                    "mean": 12000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 9,
                    "min": 9,
                    "sum": 9,
                    "mean": 9.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2019,
            "month": null,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 60000000,
                    "min": 60000000,
                    "sum": 60000000,
                    "mean": 60000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 40,
                    "min": 40,
                    "sum": 40,
                    "mean": 40.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 1,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2020,
            "month": null,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 70000000,
                    "min": 70000000,
                    "sum": 70000000,
                    "mean": 70000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 45,
                    "min": 45,
                    "sum": 45,
                    "mean": 45.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 1,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2021,
            "month": null,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 70000000,
                    "min": 70000000,
                    "sum": 70000000,
                    "mean": 70000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 45,
                    "min": 45,
                    "sum": 45,
                    "mean": 45.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2022,
            "month": null,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 70000000,
                    "min": 70000000,
                    "sum": 70000000,
                    "mean": 70000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 45,
                    "min": 45,
                    "sum": 45,
                    "mean": 45.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2023,
            "month": null,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 70000000,
                    "min": 70000000,
                    "sum": 70000000,
                    "mean": 70000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 45,
                    "min": 45,
                    "sum": 45,
                    "mean": 45.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2024,
            "month": null,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 70000000,
                    "min": 70000000,
                    "sum": 70000000,
                    "mean": 70000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 45,
                    "min": 45,
                    "sum": 45,
                    "mean": 45.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        }
    ],
    "filter": {
        "type": "year",
        "year": null,
        "unit_type": "establishment",
        "region_path": null,
        "sector_path": null,
        "activity_category_path": null
    },
    "available": {
        "region": [
            {
                "code": "11",
                "name": "Rogaland",
                "path": "11",
                "count": 15,
                "label": "11",
                "has_children": true
            }
        ],
        "sector": null,
        "status": [
            {
                "code": "active",
                "name": "Active",
                "count": 15,
                "has_children": false
            }
        ],
        "country": [
            {
                "name": "Norway",
                "count": 15,
                "iso_2": "NO",
                "has_children": false
            }
        ],
        "legal_form": null,
        "activity_category": [
            {
                "code": "",
                "name": "Transport og lagring",
                "path": "H",
                "count": 15,
                "label": "H",
                "has_children": true
            }
        ]
    },
    "unit_type": "establishment",
    "breadcrumb": {
        "region": null,
        "sector": null,
        "status": null,
        "country": null,
        "legal_form": null,
        "activity_category": null
    }
}
(1 row)
\echo "Test yearly drilldown - enterprise - with all filters as top level"
"Test yearly drilldown - enterprise - with all filters as top level"
SELECT jsonb_pretty(
     public.remove_ephemeral_data_from_hierarchy(
     public.statistical_history_drilldown(
          unit_type := 'enterprise'::public.statistical_unit_type,
          resolution := 'year'::public.history_resolution,
          year := 2019,
          region_path := '11'::public.ltree,
          activity_category_path := 'H'::public.ltree,
          sector_path := 'innl'::public.ltree,
          legal_form_id := (SELECT id FROM public.legal_form WHERE code = 'AS'),
          country_id := (SELECT id FROM public.country WHERE iso_2 = 'NO'),
          year_min := 2010,
          year_max := 2024
     ))) AS statistical_history_drilldown;
statistical_history_drilldown
{
    "stats": [
        {
            "year": 2019,
            "month": null,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 60000000,
                    "min": 60000000,
                    "sum": 60000000,
                    "mean": 60000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 40,
                    "min": 40,
                    "sum": 40,
                    "mean": 40.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        }
    ],
    "filter": {
        "type": "year",
        "year": 2019,
        "unit_type": "enterprise",
        "region_path": "11",
        "sector_path": "innl",
        "activity_category_path": "H"
    },
    "available": {
        "region": [
            {
                "code": "1121",
                "name": "Time",
                "path": "11.21",
                "count": 1,
                "label": "1121",
                "has_children": false
            }
        ],
        "sector": [
            {
                "code": null,
                "name": "Ikke-finansielle foretak",
                "path": "innl.a_ikke_fin",
                "count": 1,
                "label": "innla_ikke_fin",
                "has_children": true
            }
        ],
        "status": [
            {
                "code": "active",
                "name": "Active",
                "count": 1,
                "has_children": false
            }
        ],
        "country": null,
        "legal_form": null,
        "activity_category": [
            {
                "code": "49",
                "name": "Landtransport og rørtransport",
                "path": "H.49",
                "count": 1,
                "label": "H49",
                "has_children": true
            }
        ]
    },
    "unit_type": "enterprise",
    "breadcrumb": {
        "region": [
            {
                "code": "11",
                "name": "Rogaland",
                "path": "11",
                "label": "11"
            }
        ],
        "sector": [
            {
                "code": null,
                "name": "Innenlandske sektorer",
                "path": "innl",
                "label": "innl"
            }
        ],
        "status": null,
        "country": [
            {
                "name": "Norway",
                "iso_2": "NO"
            }
        ],
        "legal_form": [
            {
                "code": "AS",
                "name": "Aksjeselskap"
            }
        ],
        "activity_category": [
            {
                "code": "",
                "name": "Transport og lagring",
                "path": "H",
                "label": "H"
            }
        ]
    }
}
(1 row)
\echo "Test yearly drilldown - enterprise - with all filters as bottom level"
"Test yearly drilldown - enterprise - with all filters as bottom level"
SELECT jsonb_pretty(
     public.remove_ephemeral_data_from_hierarchy(
     public.statistical_history_drilldown(
          unit_type := 'enterprise'::public.statistical_unit_type,
          resolution := 'year'::public.history_resolution,
          year := 2019,
          region_path := '11.21'::public.ltree,
          activity_category_path := 'H.49.4.1.0'::public.ltree,
          sector_path := 'innl.a_ikke_fin.2100'::public.ltree,
          legal_form_id := (SELECT id FROM public.legal_form WHERE code = 'AS'),
          country_id := (SELECT id FROM public.country WHERE iso_2 = 'NO'),
          year_min := 2010,
          year_max := 2024
     ))) AS statistical_history_drilldown;
statistical_history_drilldown
{
    "stats": [
        {
            "year": 2019,
            "month": null,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 60000000,
                    "min": 60000000,
                    "sum": 60000000,
                    "mean": 60000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 40,
                    "min": 40,
                    "sum": 40,
                    "mean": 40.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        }
    ],
    "filter": {
        "type": "year",
        "year": 2019,
        "unit_type": "enterprise",
        "region_path": "11.21",
        "sector_path": "innl.a_ikke_fin.2100",
        "activity_category_path": "H.49.4.1.0"
    },
    "available": {
        "region": null,
        "sector": null,
        "status": [
            {
                "code": "active",
                "name": "Active",
                "count": 1,
                "has_children": false
            }
        ],
        "country": null,
        "legal_form": null,
        "activity_category": null
    },
    "unit_type": "enterprise",
    "breadcrumb": {
        "region": [
            {
                "code": "11",
                "name": "Rogaland",
                "path": "11",
                "label": "11"
            },
            {
                "code": "1121",
                "name": "Time",
                "path": "11.21",
                "label": "1121"
            }
        ],
        "sector": [
            {
                "code": null,
                "name": "Innenlandske sektorer",
                "path": "innl",
                "label": "innl"
            },
            {
                "code": null,
                "name": "Ikke-finansielle foretak",
                "path": "innl.a_ikke_fin",
                "label": "innla_ikke_fin"
            },
            {
                "code": "2100",
                "name": "Private aksjeselskaper mv.",
                "path": "innl.a_ikke_fin.2100",
                "label": "innla_ikke_fin2100"
            }
        ],
        "status": null,
        "country": [
            {
                "name": "Norway",
                "iso_2": "NO"
            }
        ],
        "legal_form": [
            {
                "code": "AS",
                "name": "Aksjeselskap"
            }
        ],
        "activity_category": [
            {
                "code": "",
                "name": "Transport og lagring",
                "path": "H",
                "label": "H"
            },
            {
                "code": "49",
                "name": "Landtransport og rørtransport",
                "path": "H.49",
                "label": "H49"
            },
            {
                "code": "49.4",
                "name": "Godstransport på vei, herunder flyttetransport",
                "path": "H.49.4",
                "label": "H494"
            },
            {
                "code": "49.41",
                "name": "Godstransport på vei",
                "path": "H.49.4.1",
                "label": "H4941"
            },
            {
                "code": "49.410",
                "name": "Godstransport på vei",
                "path": "H.49.4.1.0",
                "label": "H49410"
            }
        ]
    }
}
(1 row)
\echo "Test monthly drilldown"
"Test monthly drilldown"
SELECT jsonb_pretty(
     public.remove_ephemeral_data_from_hierarchy(
     public.statistical_history_drilldown(
          unit_type := 'enterprise'::public.statistical_unit_type,
          resolution := 'year-month'::public.history_resolution,
          year := 2019,
          region_path := NULL::public.ltree,
          activity_category_path := NULL::public.ltree,
          sector_path := NULL::public.ltree,
          legal_form_id := NULL::INTEGER,
          country_id := NULL::INTEGER,
          year_min := 2010,
          year_max := 2024
     ))) AS statistical_history_drilldown;
statistical_history_drilldown
{
    "stats": [
        {
            "year": 2019,
            "month": 1,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 60000000,
                    "min": 60000000,
                    "sum": 60000000,
                    "mean": 60000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 25,
                    "min": 25,
                    "sum": 25,
                    "mean": 25.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2019,
            "month": 2,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 60000000,
                    "min": 60000000,
                    "sum": 60000000,
                    "mean": 60000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 25,
                    "min": 25,
                    "sum": 25,
                    "mean": 25.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2019,
            "month": 3,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 60000000,
                    "min": 60000000,
                    "sum": 60000000,
                    "mean": 60000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 30,
                    "min": 30,
                    "sum": 30,
                    "mean": 30.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2019,
            "month": 4,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 60000000,
                    "min": 60000000,
                    "sum": 60000000,
                    "mean": 60000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 30,
                    "min": 30,
                    "sum": 30,
                    "mean": 30.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2019,
            "month": 5,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 60000000,
                    "min": 60000000,
                    "sum": 60000000,
                    "mean": 60000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 35,
                    "min": 35,
                    "sum": 35,
                    "mean": 35.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2019,
            "month": 6,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 60000000,
                    "min": 60000000,
                    "sum": 60000000,
                    "mean": 60000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 35,
                    "min": 35,
                    "sum": 35,
                    "mean": 35.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2019,
            "month": 7,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 60000000,
                    "min": 60000000,
                    "sum": 60000000,
                    "mean": 60000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 40,
                    "min": 40,
                    "sum": 40,
                    "mean": 40.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2019,
            "month": 8,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 60000000,
                    "min": 60000000,
                    "sum": 60000000,
                    "mean": 60000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 40,
                    "min": 40,
                    "sum": 40,
                    "mean": 40.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2019,
            "month": 9,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 60000000,
                    "min": 60000000,
                    "sum": 60000000,
                    "mean": 60000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 50,
                    "min": 50,
                    "sum": 50,
                    "mean": 50.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2019,
            "month": 10,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 60000000,
                    "min": 60000000,
                    "sum": 60000000,
                    "mean": 60000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 50,
                    "min": 50,
                    "sum": 50,
                    "mean": 50.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2019,
            "month": 11,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 60000000,
                    "min": 60000000,
                    "sum": 60000000,
                    "mean": 60000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 40,
                    "min": 40,
                    "sum": 40,
                    "mean": 40.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        },
        {
            "year": 2019,
            "month": 12,
            "births": 0,
            "deaths": 0,
            "exists_count": 1,
            "exists_change": 0,
            "stats_summary": {
                "turnover": {
                    "max": 60000000,
                    "min": 60000000,
                    "sum": 60000000,
                    "mean": 60000000.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                },
                "employees": {
                    "max": 40,
                    "min": 40,
                    "sum": 40,
                    "mean": 40.00,
                    "type": "number",
                    "count": 1,
                    "stddev": 0.00,
                    "variance": 0.00,
                    "sum_sq_diff": 0.00,
                    "coefficient_of_variation_pct": 0.00
                }
            },
            "countable_count": 1,
            "countable_change": 0,
            "name_change_count": 0,
            "exists_added_count": 0,
            "sector_change_count": 0,
            "status_change_count": 0,
            "exists_removed_count": 0,
            "countable_added_count": 0,
            "unit_size_change_count": 0,
            "countable_removed_count": 0,
            "legal_form_change_count": 0,
            "physical_region_change_count": 0,
            "physical_address_change_count": 0,
            "physical_country_change_count": 0,
            "primary_activity_category_change_count": 0,
            "secondary_activity_category_change_count": 0
        }
    ],
    "filter": {
        "type": "year-month",
        "year": 2019,
        "unit_type": "enterprise",
        "region_path": null,
        "sector_path": null,
        "activity_category_path": null
    },
    "available": {
        "region": [
            {
                "code": "11",
                "name": "Rogaland",
                "path": "11",
                "count": 12,
                "label": "11",
                "has_children": true
            }
        ],
        "sector": [
            {
                "code": null,
                "name": "Innenlandske sektorer",
                "path": "innl",
                "count": 12,
                "label": "innl",
                "has_children": true
            }
        ],
        "status": [
            {
                "code": "active",
                "name": "Active",
                "count": 12,
                "has_children": false
            }
        ],
        "country": [
            {
                "name": "Norway",
                "count": 12,
                "iso_2": "NO",
                "has_children": false
            }
        ],
        "legal_form": [
            {
                "code": "AS",
                "name": "Aksjeselskap",
                "count": 12,
                "has_children": false
            }
        ],
        "activity_category": [
            {
                "code": "",
                "name": "Transport og lagring",
                "path": "H",
                "count": 12,
                "label": "H",
                "has_children": true
            }
        ]
    },
    "unit_type": "enterprise",
    "breadcrumb": {
        "region": null,
        "sector": null,
        "status": null,
        "country": null,
        "legal_form": null,
        "activity_category": null
    }
}
(1 row)
\echo "Test statistical_unit_hierarchy - For a date when it does not exist"
"Test statistical_unit_hierarchy - For a date when it does not exist"
WITH selected_enterprise AS (
     SELECT unit_id FROM public.statistical_unit
     WHERE external_idents ->> 'tax_ident' = '823573673'
       AND unit_type = 'enterprise'
     LIMIT 1
)
SELECT jsonb_pretty(
          public.remove_ephemeral_data_from_hierarchy(
               public.statistical_unit_hierarchy(
                'enterprise',
                (SELECT unit_id FROM selected_enterprise),
                'all',
                '2013-01-01'::DATE
            )
          )
     ) AS statistical_unit_hierarchy;
statistical_unit_hierarchy
{
}
(1 row)
\echo "Test statistical_unit_hierarchy - For a date when it does exist"
"Test statistical_unit_hierarchy - For a date when it does exist"
WITH selected_enterprise AS (
     SELECT unit_id FROM public.statistical_unit
     WHERE external_idents ->> 'tax_ident' = '823573673'
       AND unit_type = 'enterprise'
     LIMIT 1
)
SELECT jsonb_pretty(
          public.remove_ephemeral_data_from_hierarchy(
               public.statistical_unit_hierarchy(
                'enterprise',
                (SELECT unit_id FROM selected_enterprise),
                'all',
                '2010-01-01'::DATE
            )
          )
     ) AS statistical_unit_hierarchy;
statistical_unit_hierarchy
{
    "enterprise": {
        "active": true,
        "legal_unit": [
            {
                "name": "KRANLØFT ENK",
                "sector": {
                    "code": "2100",
                    "name": "Private aksjeselskaper mv.",
                    "path": "innl.a_ikke_fin.2100",
                    "label": "innla_ikke_fin2100",
                    "active": true,
                    "custom": true,
                    "description": "### Notes:\nSektoren omfatter markedsproduserende ikke-finansielle selskaper med begrenset økonomisk ansvar hvor private nasjonale aktører eller utlendinger direkte eller indirekte eier mer enn 50 prosent av innbetalt eierkapital."
                },
                "status": {
                    "code": "active",
                    "name": "Active",
                    "active": true,
                    "custom": false,
                    "priority": 1,
                    "used_for_counting": true,
                    "assigned_by_default": true
                },
                "activity": [
                    {
                        "type": "primary",
                        "valid_to": "2012-12-31",
                        "valid_from": "2010-01-01",
                        "data_source": {
                            "code": "skatt",
                            "name": "Skatteetaten",
                            "active": true,
                            "custom": true
                        },
                        "valid_until": "2013-01-01",
                        "edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",
                        "activity_category": {
                            "code": "49.410",
                            "name": "Godstransport på vei",
                            "path": "H.49.4.1.0",
                            "label": "H49410",
                            "level": 5,
                            "active": true,
                            "custom": true,
                            "description": "### Shortname: Godstransport på vei\n\n### Notes:\nInkluderer også: Omfatter også utleie av lastebiler med sjåfør og godstransport med kjøretøyer som trekkes av dyr eller mennesker Ekskluderer: Transport av tømmer i skogen som ledd i skogsdrift grupperes under: 02.40 Tjenester tilknyttet skogbruk. Lastebiltransport med distribusjon av vann grupperes under: 36.00 Uttak fra kilde, rensing og distribusjon av vann. Avfallstransport som ledd i renovasjonsvirksomhet grupperes under hhv.: 38.11 Innsamling av ikke-farlig avfall og: 38.12 Innsamling av farlig avfall. Drift av godsterminaler grupperes under: 52.211 Drift av gods- og transportsentraler. Pakking for transport grupperes under: 52.291 Spedisjon. Post- og kurervirksomhet grupperes under hhv.: 53.10 Landsdekkende posttjenester og: 53.20 Andre post- og budtjenester",
                            "activity_category_standard": {
                                "code": "nace_v2.1",
                                "name": "NACE 2.1",
                                "obsolete": false,
                                "description": "NACE Version 2 Revision 1",
                                "code_pattern": "dot_after_two_digits"
                            }
                        }
                    }
                ],
                "location": [
                    {
                        "type": "physical",
                        "region": {
                            "code": "1121",
                            "name": "Time",
                            "path": "11.21",
                            "label": "1121",
                            "level": 2,
                            "center_altitude": null,
                            "center_latitude": null,
                            "center_longitude": null
                        },
                        "country": {
                            "name": "Norway",
                            "iso_2": "NO",
                            "iso_3": "NOR",
                            "active": true,
                            "custom": false,
                            "iso_num": "578"
                        },
                        "altitude": null,
                        "latitude": null,
                        "postcode": "4347",
                        "valid_to": "2012-12-31",
                        "longitude": null,
                        "postplace": "LYE",
                        "valid_from": "2010-01-01",
                        "data_source": {
                            "code": "skatt",
                            "name": "Skatteetaten",
                            "active": true,
                            "custom": true
                        },
                        "valid_until": "2013-01-01",
                        "edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",
                        "address_part1": "Vestlyvegen 219",
                        "address_part2": null,
                        "address_part3": null
                    }
                ],
                "valid_to": "2012-12-31",
                "birth_date": "2010-01-01",
                "death_date": "2012-12-31",
                "legal_form": {
                    "code": "ENK",
                    "name": "Enkeltpersonforetak",
                    "active": true,
                    "custom": true
                },
                "short_name": null,
                "valid_from": "2010-01-01",
                "data_source": {
                    "code": "skatt",
                    "name": "Skatteetaten",
                    "active": true,
                    "custom": true
                },
                "valid_until": "2013-01-01",
                "edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",
                "establishment": [
                    {
                        "name": "KRANLØFT ENK",
                        "status": {
                            "code": "active",
                            "name": "Active",
                            "active": true,
                            "custom": false,
                            "priority": 1,
                            "used_for_counting": true,
                            "assigned_by_default": true
                        },
                        "activity": [
                            {
                                "type": "primary",
                                "valid_to": "infinity",
                                "valid_from": "2010-01-01",
                                "data_source": {
                                    "code": "brreg",
                                    "name": "Brønnøysundregistrene",
                                    "active": true,
                                    "custom": true
                                },
                                "valid_until": "infinity",
                                "edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",
                                "activity_category": {
                                    "code": "49.410",
                                    "name": "Godstransport på vei",
                                    "path": "H.49.4.1.0",
                                    "label": "H49410",
                                    "level": 5,
                                    "active": true,
                                    "custom": true,
                                    "description": "### Shortname: Godstransport på vei\n\n### Notes:\nInkluderer også: Omfatter også utleie av lastebiler med sjåfør og godstransport med kjøretøyer som trekkes av dyr eller mennesker Ekskluderer: Transport av tømmer i skogen som ledd i skogsdrift grupperes under: 02.40 Tjenester tilknyttet skogbruk. Lastebiltransport med distribusjon av vann grupperes under: 36.00 Uttak fra kilde, rensing og distribusjon av vann. Avfallstransport som ledd i renovasjonsvirksomhet grupperes under hhv.: 38.11 Innsamling av ikke-farlig avfall og: 38.12 Innsamling av farlig avfall. Drift av godsterminaler grupperes under: 52.211 Drift av gods- og transportsentraler. Pakking for transport grupperes under: 52.291 Spedisjon. Post- og kurervirksomhet grupperes under hhv.: 53.10 Landsdekkende posttjenester og: 53.20 Andre post- og budtjenester",
                                    "activity_category_standard": {
                                        "code": "nace_v2.1",
                                        "name": "NACE 2.1",
                                        "obsolete": false,
                                        "description": "NACE Version 2 Revision 1",
                                        "code_pattern": "dot_after_two_digits"
                                    }
                                }
                            }
                        ],
                        "location": [
                            {
                                "type": "physical",
                                "region": {
                                    "code": "1121",
                                    "name": "Time",
                                    "path": "11.21",
                                    "label": "1121",
                                    "level": 2,
                                    "center_altitude": null,
                                    "center_latitude": null,
                                    "center_longitude": null
                                },
                                "country": {
                                    "name": "Norway",
                                    "iso_2": "NO",
                                    "iso_3": "NOR",
                                    "active": true,
                                    "custom": false,
                                    "iso_num": "578"
                                },
                                "altitude": null,
                                "latitude": null,
                                "postcode": "4347",
                                "valid_to": "infinity",
                                "longitude": null,
                                "postplace": "LYE",
                                "valid_from": "2010-01-01",
                                "data_source": {
                                    "code": "brreg",
                                    "name": "Brønnøysundregistrene",
                                    "active": true,
                                    "custom": true
                                },
                                "valid_until": "infinity",
                                "edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",
                                "address_part1": "Vestlyvegen 219",
                                "address_part2": null,
                                "address_part3": null
                            }
                        ],
                        "valid_to": "2012-12-31",
                        "unit_size": {
                            "code": "tny",
                            "name": "Tiny",
                            "active": true,
                            "custom": false
                        },
                        "birth_date": "2010-01-01",
                        "death_date": null,
                        "short_name": null,
                        "valid_from": "2010-01-01",
                        "data_source": {
                            "code": "brreg",
                            "name": "Brønnøysundregistrene",
                            "active": true,
                            "custom": true
                        },
                        "valid_until": "2013-01-01",
                        "edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",
                        "invalid_codes": null,
                        "stat_for_unit": [
                            {
                                "valid_to": "2012-12-31",
                                "value_int": 1,
                                "valid_from": "2010-01-01",
                                "value_bool": null,
                                "data_source": {
                                    "code": "brreg",
                                    "name": "Brønnøysundregistrene",
                                    "active": true,
                                    "custom": true
                                },
                                "valid_until": "2013-01-01",
                                "value_float": null,
                                "edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",
                                "value_string": null,
                                "stat_definition": {
                                    "code": "employees",
                                    "name": "Employees",
                                    "type": "int",
                                    "archived": false,
                                    "priority": 1,
                                    "frequency": "yearly",
                                    "description": "The number of people receiving an official salary with government reporting."
                                }
                            },
                            {
                                "valid_to": "2012-12-31",
                                "value_int": null,
                                "valid_from": "2010-01-01",
                                "value_bool": null,
                                "data_source": {
                                    "code": "brreg",
                                    "name": "Brønnøysundregistrene",
                                    "active": true,
                                    "custom": true
                                },
                                "valid_until": "2013-01-01",
                                "value_float": 1500000,
                                "edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",
                                "value_string": null,
                                "stat_definition": {
                                    "code": "turnover",
                                    "name": "Turnover",
                                    "type": "float",
                                    "archived": false,
                                    "priority": 2,
                                    "frequency": "yearly",
                                    "description": "The amount (Local Currency)"
                                }
                            }
                        ],
                        "free_econ_zone": null,
                        "external_idents": {
                            "tax_ident": "895406732"
                        },
                        "primary_for_enterprise": null,
                        "primary_for_legal_unit": true
                    }
                ],
                "invalid_codes": null,
                "free_econ_zone": null,
                "external_idents": {
                    "tax_ident": "823573673"
                },
                "primary_for_enterprise": true
            }
        ],
        "short_name": null,
        "edit_comment": "Test data load (03_load_and_verify_history_functions.sql)"
    }
}
(1 row)
WITH selected_legal_unit AS (
     SELECT unit_id FROM public.statistical_unit
     WHERE external_idents ->> 'tax_ident' = '921835809'
        AND unit_type = 'legal_unit'
    LIMIT 1
)
SELECT jsonb_pretty(
          public.remove_ephemeral_data_from_hierarchy(
               public.statistical_unit_hierarchy('legal_unit',(SELECT unit_id FROM selected_legal_unit),'all')
          )
     ) AS statistical_unit_hierarchy;
statistical_unit_hierarchy
{
    "enterprise": {
        "active": true,
        "legal_unit": [
            {
                "name": "KRAN & SPESIALLØFT AS",
                "sector": {
                    "code": "2100",
                    "name": "Private aksjeselskaper mv.",
                    "path": "innl.a_ikke_fin.2100",
                    "label": "innla_ikke_fin2100",
                    "active": true,
                    "custom": true,
                    "description": "### Notes:\nSektoren omfatter markedsproduserende ikke-finansielle selskaper med begrenset økonomisk ansvar hvor private nasjonale aktører eller utlendinger direkte eller indirekte eier mer enn 50 prosent av innbetalt eierkapital."
                },
                "status": {
                    "code": "active",
                    "name": "Active",
                    "active": true,
                    "custom": false,
                    "priority": 1,
                    "used_for_counting": true,
                    "assigned_by_default": true
                },
                "activity": [
                    {
                        "type": "primary",
                        "valid_to": "infinity",
                        "valid_from": "2013-01-01",
                        "data_source": {
                            "code": "skatt",
                            "name": "Skatteetaten",
                            "active": true,
                            "custom": true
                        },
                        "valid_until": "infinity",
                        "edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",
                        "activity_category": {
                            "code": "49.410",
                            "name": "Godstransport på vei",
                            "path": "H.49.4.1.0",
                            "label": "H49410",
                            "level": 5,
                            "active": true,
                            "custom": true,
                            "description": "### Shortname: Godstransport på vei\n\n### Notes:\nInkluderer også: Omfatter også utleie av lastebiler med sjåfør og godstransport med kjøretøyer som trekkes av dyr eller mennesker Ekskluderer: Transport av tømmer i skogen som ledd i skogsdrift grupperes under: 02.40 Tjenester tilknyttet skogbruk. Lastebiltransport med distribusjon av vann grupperes under: 36.00 Uttak fra kilde, rensing og distribusjon av vann. Avfallstransport som ledd i renovasjonsvirksomhet grupperes under hhv.: 38.11 Innsamling av ikke-farlig avfall og: 38.12 Innsamling av farlig avfall. Drift av godsterminaler grupperes under: 52.211 Drift av gods- og transportsentraler. Pakking for transport grupperes under: 52.291 Spedisjon. Post- og kurervirksomhet grupperes under hhv.: 53.10 Landsdekkende posttjenester og: 53.20 Andre post- og budtjenester",
                            "activity_category_standard": {
                                "code": "nace_v2.1",
                                "name": "NACE 2.1",
                                "obsolete": false,
                                "description": "NACE Version 2 Revision 1",
                                "code_pattern": "dot_after_two_digits"
                            }
                        }
                    }
                ],
                "location": [
                    {
                        "type": "physical",
                        "region": {
                            "code": "1121",
                            "name": "Time",
                            "path": "11.21",
                            "label": "1121",
                            "level": 2,
                            "center_altitude": null,
                            "center_latitude": null,
                            "center_longitude": null
                        },
                        "country": {
                            "name": "Norway",
                            "iso_2": "NO",
                            "iso_3": "NOR",
                            "active": true,
                            "custom": false,
                            "iso_num": "578"
                        },
                        "altitude": null,
                        "latitude": null,
                        "postcode": "4347",
                        "valid_to": "infinity",
                        "longitude": null,
                        "postplace": "LYE",
                        "valid_from": "2013-01-01",
                        "data_source": {
                            "code": "skatt",
                            "name": "Skatteetaten",
                            "active": true,
                            "custom": true
                        },
                        "valid_until": "infinity",
                        "edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",
                        "address_part1": "Vestlyvegen 219",
                        "address_part2": null,
                        "address_part3": null
                    }
                ],
                "valid_to": "infinity",
                "birth_date": "2013-01-01",
                "death_date": null,
                "legal_form": {
                    "code": "AS",
                    "name": "Aksjeselskap",
                    "active": true,
                    "custom": true
                },
                "short_name": null,
                "valid_from": "2013-01-01",
                "data_source": {
                    "code": "skatt",
                    "name": "Skatteetaten",
                    "active": true,
                    "custom": true
                },
                "valid_until": "infinity",
                "edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",
                "establishment": [
                    {
                        "name": "KRAN & SPESIALLØFT AS",
                        "status": {
                            "code": "active",
                            "name": "Active",
                            "active": true,
                            "custom": false,
                            "priority": 1,
                            "used_for_counting": true,
                            "assigned_by_default": true
                        },
                        "activity": [
                            {
                                "type": "primary",
                                "valid_to": "infinity",
                                "valid_from": "2010-01-01",
                                "data_source": {
                                    "code": "brreg",
                                    "name": "Brønnøysundregistrene",
                                    "active": true,
                                    "custom": true
                                },
                                "valid_until": "infinity",
                                "edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",
                                "activity_category": {
                                    "code": "49.410",
                                    "name": "Godstransport på vei",
                                    "path": "H.49.4.1.0",
                                    "label": "H49410",
                                    "level": 5,
                                    "active": true,
                                    "custom": true,
                                    "description": "### Shortname: Godstransport på vei\n\n### Notes:\nInkluderer også: Omfatter også utleie av lastebiler med sjåfør og godstransport med kjøretøyer som trekkes av dyr eller mennesker Ekskluderer: Transport av tømmer i skogen som ledd i skogsdrift grupperes under: 02.40 Tjenester tilknyttet skogbruk. Lastebiltransport med distribusjon av vann grupperes under: 36.00 Uttak fra kilde, rensing og distribusjon av vann. Avfallstransport som ledd i renovasjonsvirksomhet grupperes under hhv.: 38.11 Innsamling av ikke-farlig avfall og: 38.12 Innsamling av farlig avfall. Drift av godsterminaler grupperes under: 52.211 Drift av gods- og transportsentraler. Pakking for transport grupperes under: 52.291 Spedisjon. Post- og kurervirksomhet grupperes under hhv.: 53.10 Landsdekkende posttjenester og: 53.20 Andre post- og budtjenester",
                                    "activity_category_standard": {
                                        "code": "nace_v2.1",
                                        "name": "NACE 2.1",
                                        "obsolete": false,
                                        "description": "NACE Version 2 Revision 1",
                                        "code_pattern": "dot_after_two_digits"
                                    }
                                }
                            }
                        ],
                        "location": [
                            {
                                "type": "physical",
                                "region": {
                                    "code": "1121",
                                    "name": "Time",
                                    "path": "11.21",
                                    "label": "1121",
                                    "level": 2,
                                    "center_altitude": null,
                                    "center_latitude": null,
                                    "center_longitude": null
                                },
                                "country": {
                                    "name": "Norway",
                                    "iso_2": "NO",
                                    "iso_3": "NOR",
                                    "active": true,
                                    "custom": false,
                                    "iso_num": "578"
                                },
                                "altitude": null,
                                "latitude": null,
                                "postcode": "4347",
                                "valid_to": "infinity",
                                "longitude": null,
                                "postplace": "LYE",
                                "valid_from": "2010-01-01",
                                "data_source": {
                                    "code": "brreg",
                                    "name": "Brønnøysundregistrene",
                                    "active": true,
                                    "custom": true
                                },
                                "valid_until": "infinity",
                                "edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",
                                "address_part1": "Vestlyvegen 219",
                                "address_part2": null,
                                "address_part3": null
                            }
                        ],
                        "valid_to": "infinity",
                        "unit_size": {
                            "code": "lrg",
                            "name": "Large",
                            "active": true,
                            "custom": false
                        },
                        "birth_date": "2010-01-01",
                        "death_date": null,
                        "short_name": null,
                        "valid_from": "2020-01-01",
                        "data_source": {
                            "code": "brreg",
                            "name": "Brønnøysundregistrene",
                            "active": true,
                            "custom": true
                        },
                        "valid_until": "infinity",
                        "edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",
                        "invalid_codes": null,
                        "stat_for_unit": [
                            {
                                "valid_to": "infinity",
                                "value_int": 45,
                                "valid_from": "2020-01-01",
                                "value_bool": null,
                                "data_source": {
                                    "code": "brreg",
                                    "name": "Brønnøysundregistrene",
                                    "active": true,
                                    "custom": true
                                },
                                "valid_until": "infinity",
                                "value_float": null,
                                "edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",
                                "value_string": null,
                                "stat_definition": {
                                    "code": "employees",
                                    "name": "Employees",
                                    "type": "int",
                                    "archived": false,
                                    "priority": 1,
                                    "frequency": "yearly",
                                    "description": "The number of people receiving an official salary with government reporting."
                                }
                            },
                            {
                                "valid_to": "infinity",
                                "value_int": null,
                                "valid_from": "2020-01-01",
                                "value_bool": null,
                                "data_source": {
                                    "code": "brreg",
                                    "name": "Brønnøysundregistrene",
                                    "active": true,
                                    "custom": true
                                },
                                "valid_until": "infinity",
                                "value_float": 70000000,
                                "edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",
                                "value_string": null,
                                "stat_definition": {
                                    "code": "turnover",
                                    "name": "Turnover",
                                    "type": "float",
                                    "archived": false,
                                    "priority": 2,
                                    "frequency": "yearly",
                                    "description": "The amount (Local Currency)"
                                }
                            }
                        ],
                        "free_econ_zone": null,
                        "external_idents": {
                            "tax_ident": "895406732"
                        },
                        "primary_for_enterprise": null,
                        "primary_for_legal_unit": true
                    }
                ],
                "invalid_codes": null,
                "free_econ_zone": null,
                "external_idents": {
                    "tax_ident": "921835809"
                },
                "primary_for_enterprise": true
            }
        ],
        "short_name": null,
        "edit_comment": "Test data load (03_load_and_verify_history_functions.sql)"
    }
}
(1 row)
WITH selected_establishment AS (
     SELECT unit_id FROM public.statistical_unit
     WHERE external_idents ->> 'tax_ident' = '895406732'
     LIMIT 1
)
SELECT jsonb_pretty(
          public.remove_ephemeral_data_from_hierarchy(
               public.statistical_unit_hierarchy('establishment',(SELECT unit_id FROM selected_establishment),'all')
          )
     ) AS statistical_unit_hierarchy;
statistical_unit_hierarchy
{
    "enterprise": {
        "active": true,
        "legal_unit": [
            {
                "name": "KRAN & SPESIALLØFT AS",
                "sector": {
                    "code": "2100",
                    "name": "Private aksjeselskaper mv.",
                    "path": "innl.a_ikke_fin.2100",
                    "label": "innla_ikke_fin2100",
                    "active": true,
                    "custom": true,
                    "description": "### Notes:\nSektoren omfatter markedsproduserende ikke-finansielle selskaper med begrenset økonomisk ansvar hvor private nasjonale aktører eller utlendinger direkte eller indirekte eier mer enn 50 prosent av innbetalt eierkapital."
                },
                "status": {
                    "code": "active",
                    "name": "Active",
                    "active": true,
                    "custom": false,
                    "priority": 1,
                    "used_for_counting": true,
                    "assigned_by_default": true
                },
                "activity": [
                    {
                        "type": "primary",
                        "valid_to": "infinity",
                        "valid_from": "2013-01-01",
                        "data_source": {
                            "code": "skatt",
                            "name": "Skatteetaten",
                            "active": true,
                            "custom": true
                        },
                        "valid_until": "infinity",
                        "edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",
                        "activity_category": {
                            "code": "49.410",
                            "name": "Godstransport på vei",
                            "path": "H.49.4.1.0",
                            "label": "H49410",
                            "level": 5,
                            "active": true,
                            "custom": true,
                            "description": "### Shortname: Godstransport på vei\n\n### Notes:\nInkluderer også: Omfatter også utleie av lastebiler med sjåfør og godstransport med kjøretøyer som trekkes av dyr eller mennesker Ekskluderer: Transport av tømmer i skogen som ledd i skogsdrift grupperes under: 02.40 Tjenester tilknyttet skogbruk. Lastebiltransport med distribusjon av vann grupperes under: 36.00 Uttak fra kilde, rensing og distribusjon av vann. Avfallstransport som ledd i renovasjonsvirksomhet grupperes under hhv.: 38.11 Innsamling av ikke-farlig avfall og: 38.12 Innsamling av farlig avfall. Drift av godsterminaler grupperes under: 52.211 Drift av gods- og transportsentraler. Pakking for transport grupperes under: 52.291 Spedisjon. Post- og kurervirksomhet grupperes under hhv.: 53.10 Landsdekkende posttjenester og: 53.20 Andre post- og budtjenester",
                            "activity_category_standard": {
                                "code": "nace_v2.1",
                                "name": "NACE 2.1",
                                "obsolete": false,
                                "description": "NACE Version 2 Revision 1",
                                "code_pattern": "dot_after_two_digits"
                            }
                        }
                    }
                ],
                "location": [
                    {
                        "type": "physical",
                        "region": {
                            "code": "1121",
                            "name": "Time",
                            "path": "11.21",
                            "label": "1121",
                            "level": 2,
                            "center_altitude": null,
                            "center_latitude": null,
                            "center_longitude": null
                        },
                        "country": {
                            "name": "Norway",
                            "iso_2": "NO",
                            "iso_3": "NOR",
                            "active": true,
                            "custom": false,
                            "iso_num": "578"
                        },
                        "altitude": null,
                        "latitude": null,
                        "postcode": "4347",
                        "valid_to": "infinity",
                        "longitude": null,
                        "postplace": "LYE",
                        "valid_from": "2013-01-01",
                        "data_source": {
                            "code": "skatt",
                            "name": "Skatteetaten",
                            "active": true,
                            "custom": true
                        },
                        "valid_until": "infinity",
                        "edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",
                        "address_part1": "Vestlyvegen 219",
                        "address_part2": null,
                        "address_part3": null
                    }
                ],
                "valid_to": "infinity",
                "birth_date": "2013-01-01",
                "death_date": null,
                "legal_form": {
                    "code": "AS",
                    "name": "Aksjeselskap",
                    "active": true,
                    "custom": true
                },
                "short_name": null,
                "valid_from": "2013-01-01",
                "data_source": {
                    "code": "skatt",
                    "name": "Skatteetaten",
                    "active": true,
                    "custom": true
                },
                "valid_until": "infinity",
                "edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",
                "establishment": [
                    {
                        "name": "KRAN & SPESIALLØFT AS",
                        "status": {
                            "code": "active",
                            "name": "Active",
                            "active": true,
                            "custom": false,
                            "priority": 1,
                            "used_for_counting": true,
                            "assigned_by_default": true
                        },
                        "activity": [
                            {
                                "type": "primary",
                                "valid_to": "infinity",
                                "valid_from": "2010-01-01",
                                "data_source": {
                                    "code": "brreg",
                                    "name": "Brønnøysundregistrene",
                                    "active": true,
                                    "custom": true
                                },
                                "valid_until": "infinity",
                                "edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",
                                "activity_category": {
                                    "code": "49.410",
                                    "name": "Godstransport på vei",
                                    "path": "H.49.4.1.0",
                                    "label": "H49410",
                                    "level": 5,
                                    "active": true,
                                    "custom": true,
                                    "description": "### Shortname: Godstransport på vei\n\n### Notes:\nInkluderer også: Omfatter også utleie av lastebiler med sjåfør og godstransport med kjøretøyer som trekkes av dyr eller mennesker Ekskluderer: Transport av tømmer i skogen som ledd i skogsdrift grupperes under: 02.40 Tjenester tilknyttet skogbruk. Lastebiltransport med distribusjon av vann grupperes under: 36.00 Uttak fra kilde, rensing og distribusjon av vann. Avfallstransport som ledd i renovasjonsvirksomhet grupperes under hhv.: 38.11 Innsamling av ikke-farlig avfall og: 38.12 Innsamling av farlig avfall. Drift av godsterminaler grupperes under: 52.211 Drift av gods- og transportsentraler. Pakking for transport grupperes under: 52.291 Spedisjon. Post- og kurervirksomhet grupperes under hhv.: 53.10 Landsdekkende posttjenester og: 53.20 Andre post- og budtjenester",
                                    "activity_category_standard": {
                                        "code": "nace_v2.1",
                                        "name": "NACE 2.1",
                                        "obsolete": false,
                                        "description": "NACE Version 2 Revision 1",
                                        "code_pattern": "dot_after_two_digits"
                                    }
                                }
                            }
                        ],
                        "location": [
                            {
                                "type": "physical",
                                "region": {
                                    "code": "1121",
                                    "name": "Time",
                                    "path": "11.21",
                                    "label": "1121",
                                    "level": 2,
                                    "center_altitude": null,
                                    "center_latitude": null,
                                    "center_longitude": null
                                },
                                "country": {
                                    "name": "Norway",
                                    "iso_2": "NO",
                                    "iso_3": "NOR",
                                    "active": true,
                                    "custom": false,
                                    "iso_num": "578"
                                },
                                "altitude": null,
                                "latitude": null,
                                "postcode": "4347",
                                "valid_to": "infinity",
                                "longitude": null,
                                "postplace": "LYE",
                                "valid_from": "2010-01-01",
                                "data_source": {
                                    "code": "brreg",
                                    "name": "Brønnøysundregistrene",
                                    "active": true,
                                    "custom": true
                                },
                                "valid_until": "infinity",
                                "edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",
                                "address_part1": "Vestlyvegen 219",
                                "address_part2": null,
                                "address_part3": null
                            }
                        ],
                        "valid_to": "infinity",
                        "unit_size": {
                            "code": "lrg",
                            "name": "Large",
                            "active": true,
                            "custom": false
                        },
                        "birth_date": "2010-01-01",
                        "death_date": null,
                        "short_name": null,
                        "valid_from": "2020-01-01",
                        "data_source": {
                            "code": "brreg",
                            "name": "Brønnøysundregistrene",
                            "active": true,
                            "custom": true
                        },
                        "valid_until": "infinity",
                        "edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",
                        "invalid_codes": null,
                        "stat_for_unit": [
                            {
                                "valid_to": "infinity",
                                "value_int": 45,
                                "valid_from": "2020-01-01",
                                "value_bool": null,
                                "data_source": {
                                    "code": "brreg",
                                    "name": "Brønnøysundregistrene",
                                    "active": true,
                                    "custom": true
                                },
                                "valid_until": "infinity",
                                "value_float": null,
                                "edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",
                                "value_string": null,
                                "stat_definition": {
                                    "code": "employees",
                                    "name": "Employees",
                                    "type": "int",
                                    "archived": false,
                                    "priority": 1,
                                    "frequency": "yearly",
                                    "description": "The number of people receiving an official salary with government reporting."
                                }
                            },
                            {
                                "valid_to": "infinity",
                                "value_int": null,
                                "valid_from": "2020-01-01",
                                "value_bool": null,
                                "data_source": {
                                    "code": "brreg",
                                    "name": "Brønnøysundregistrene",
                                    "active": true,
                                    "custom": true
                                },
                                "valid_until": "infinity",
                                "value_float": 70000000,
                                "edit_comment": "Test data load (03_load_and_verify_history_functions.sql)",
                                "value_string": null,
                                "stat_definition": {
                                    "code": "turnover",
                                    "name": "Turnover",
                                    "type": "float",
                                    "archived": false,
                                    "priority": 2,
                                    "frequency": "yearly",
                                    "description": "The amount (Local Currency)"
                                }
                            }
                        ],
                        "free_econ_zone": null,
                        "external_idents": {
                            "tax_ident": "895406732"
                        },
                        "primary_for_enterprise": null,
                        "primary_for_legal_unit": true
                    }
                ],
                "invalid_codes": null,
                "free_econ_zone": null,
                "external_idents": {
                    "tax_ident": "921835809"
                },
                "primary_for_enterprise": true
            }
        ],
        "short_name": null,
        "edit_comment": "Test data load (03_load_and_verify_history_functions.sql)"
    }
}
(1 row)
\a
\x
\echo "Check relevant_statistical_units - no hit at that time."
"Check relevant_statistical_units - no hit at that time."
WITH selected_enterprise AS (
     SELECT unit_id FROM public.statistical_unit
     WHERE external_idents ->> 'tax_ident' = '823573673'
       AND unit_type = 'enterprise'
     LIMIT 1
)
SELECT valid_from
     , valid_to
     , valid_until
     , unit_type
     , external_idents
     , jsonb_pretty(stats) AS stats
     , jsonb_pretty(stats_summary) AS stats_summary
  FROM public.relevant_statistical_units(
     'enterprise',
     (SELECT unit_id FROM selected_enterprise),
     '2023-01-01'::DATE
);
(0 rows)

\echo "Check relevant_statistical_units"
"Check relevant_statistical_units"
WITH selected_enterprise AS (
     SELECT unit_id FROM public.statistical_unit
     WHERE external_idents ->> 'tax_ident' = '921835809'
       AND unit_type = 'enterprise'
     LIMIT 1
)
SELECT valid_from
     , valid_to
     , valid_until
     , unit_type
     , external_idents
     , jsonb_pretty(stats) AS stats
     , jsonb_pretty(stats_summary) AS stats_summary
  FROM public.relevant_statistical_units(
     'enterprise',
     (SELECT unit_id FROM selected_enterprise),
     '2023-01-01'::DATE
);
-[ RECORD 1 ]---+---------------------------------------------
valid_from      | 2020-01-01
valid_to        | infinity
valid_until     | infinity
unit_type       | establishment
external_idents | {"tax_ident": "895406732"}
stats           | {                                           +
                |     "turnover": 70000000,                   +
                |     "employees": 45                         +
                | }
stats_summary   | {                                           +
                |     "turnover": {                           +
                |         "max": 70000000,                    +
                |         "min": 70000000,                    +
                |         "sum": 70000000,                    +
                |         "mean": 70000000,                   +
                |         "type": "number",                   +
                |         "count": 1,                         +
                |         "stddev": 0,                        +
                |         "variance": 0,                      +
                |         "sum_sq_diff": 0,                   +
                |         "coefficient_of_variation_pct": 0   +
                |     },                                      +
                |     "employees": {                          +
                |         "max": 45,                          +
                |         "min": 45,                          +
                |         "sum": 45,                          +
                |         "mean": 45,                         +
                |         "type": "number",                   +
                |         "count": 1,                         +
                |         "stddev": 0,                        +
                |         "variance": 0,                      +
                |         "sum_sq_diff": 0,                   +
                |         "coefficient_of_variation_pct": 0   +
                |     }                                       +
                | }
-[ RECORD 2 ]---+---------------------------------------------
valid_from      | 2020-01-01
valid_to        | infinity
valid_until     | infinity
unit_type       | legal_unit
external_idents | {"tax_ident": "921835809"}
stats           | {                                           +
                | }
stats_summary   | {                                           +
                |     "turnover": {                           +
                |         "max": 70000000,                    +
                |         "min": 70000000,                    +
                |         "sum": 70000000,                    +
                |         "mean": 70000000.00,                +
                |         "type": "number",                   +
                |         "count": 1,                         +
                |         "stddev": 0.00,                     +
                |         "variance": 0.00,                   +
                |         "sum_sq_diff": 0.00,                +
                |         "coefficient_of_variation_pct": 0.00+
                |     },                                      +
                |     "employees": {                          +
                |         "max": 45,                          +
                |         "min": 45,                          +
                |         "sum": 45,                          +
                |         "mean": 45.00,                      +
                |         "type": "number",                   +
                |         "count": 1,                         +
                |         "stddev": 0.00,                     +
                |         "variance": 0.00,                   +
                |         "sum_sq_diff": 0.00,                +
                |         "coefficient_of_variation_pct": 0.00+
                |     }                                       +
                | }
-[ RECORD 3 ]---+---------------------------------------------
valid_from      | 2020-01-01
valid_to        | infinity
valid_until     | infinity
unit_type       | enterprise
external_idents | {"tax_ident": "921835809"}
stats           | 
stats_summary   | {                                           +
                |     "turnover": {                           +
                |         "max": 70000000,                    +
                |         "min": 70000000,                    +
                |         "sum": 70000000,                    +
                |         "mean": 70000000.00,                +
                |         "type": "number",                   +
                |         "count": 1,                         +
                |         "stddev": 0.00,                     +
                |         "variance": 0.00,                   +
                |         "sum_sq_diff": 0.00,                +
                |         "coefficient_of_variation_pct": 0.00+
                |     },                                      +
                |     "employees": {                          +
                |         "max": 45,                          +
                |         "min": 45,                          +
                |         "sum": 45,                          +
                |         "mean": 45.00,                      +
                |         "type": "number",                   +
                |         "count": 1,                         +
                |         "stddev": 0.00,                     +
                |         "variance": 0.00,                   +
                |         "sum_sq_diff": 0.00,                +
                |         "coefficient_of_variation_pct": 0.00+
                |     }                                       +
                | }

\x
\echo "Test statistical_unit_history_highcharts"
"Test statistical_unit_history_highcharts"
WITH selected_enterprise AS (
     SELECT unit_id FROM public.statistical_unit
     WHERE external_idents ->> 'tax_ident' = '921835809'
       AND unit_type = 'enterprise'
     ORDER BY valid_from
     LIMIT 1
)
SELECT jsonb_pretty(
    public.remove_ephemeral_data_from_hierarchy(
        public.statistical_unit_history_highcharts(
            (SELECT unit_id FROM selected_enterprise),
            'enterprise'
        )
    )
) AS highcharts_history;
             highcharts_history             
--------------------------------------------
 {                                         +
     "series": [                           +
         {                                 +
             "code": "employees",          +
             "data": [                     +
                 [                         +
                     1356998400000,        +
                     3                     +
                 ],                        +
                 [                         +
                     1451606400000,        +
                     9                     +
                 ],                        +
                 [                         +
                     1546300800000,        +
                     25                    +
                 ],                        +
                 [                         +
                     1551398400000,        +
                     30                    +
                 ],                        +
                 [                         +
                     1556668800000,        +
                     35                    +
                 ],                        +
                 [                         +
                     1561939200000,        +
                     40                    +
                 ],                        +
                 [                         +
                     1567296000000,        +
                     50                    +
                 ],                        +
                 [                         +
                     1572566400000,        +
                     40                    +
                 ],                        +
                 [                         +
                     1577836800000,        +
                     45                    +
                 ]                         +
             ],                            +
             "name": "Employees",          +
             "priority": 1,                +
             "is_current": true            +
         },                                +
         {                                 +
             "code": "turnover",           +
             "data": [                     +
                 [                         +
                     1356998400000,        +
                     3000000               +
                 ],                        +
                 [                         +
                     1451606400000,        +
                     12000000              +
                 ],                        +
                 [                         +
                     1546300800000,        +
                     60000000              +
                 ],                        +
                 [                         +
                     1551398400000,        +
                     60000000              +
                 ],                        +
                 [                         +
                     1556668800000,        +
                     60000000              +
                 ],                        +
                 [                         +
                     1561939200000,        +
                     60000000              +
                 ],                        +
                 [                         +
                     1567296000000,        +
                     60000000              +
                 ],                        +
                 [                         +
                     1572566400000,        +
                     60000000              +
                 ],                        +
                 [                         +
                     1577836800000,        +
                     70000000              +
                 ]                         +
             ],                            +
             "name": "Turnover",           +
             "priority": 2,                +
             "is_current": true            +
         },                                +
         {                                 +
             "code": "establishment_count",+
             "data": [                     +
                 [                         +
                     1356998400000,        +
                     1                     +
                 ],                        +
                 [                         +
                     1451606400000,        +
                     1                     +
                 ],                        +
                 [                         +
                     1546300800000,        +
                     1                     +
                 ],                        +
                 [                         +
                     1551398400000,        +
                     1                     +
                 ],                        +
                 [                         +
                     1556668800000,        +
                     1                     +
                 ],                        +
                 [                         +
                     1561939200000,        +
                     1                     +
                 ],                        +
                 [                         +
                     1567296000000,        +
                     1                     +
                 ],                        +
                 [                         +
                     1572566400000,        +
                     1                     +
                 ],                        +
                 [                         +
                     1577836800000,        +
                     1                     +
                 ]                         +
             ],                            +
             "name": "Establishments",     +
             "priority": 999,              +
             "is_current": true            +
         }                                 +
     ],                                    +
     "unit_name": "KRAN & SPESIALLØFT AS", +
     "unit_type": "enterprise"             +
 }
(1 row)

\x
\echo "Test public.statistical_history_highcharts - year resolution, enterprise"
"Test public.statistical_history_highcharts - year resolution, enterprise"
SELECT jsonb_pretty(public.statistical_history_highcharts('year', 'enterprise'));
-[ RECORD 1 ]+----------------------------------------------------------------
jsonb_pretty | {                                                              +
             |     "series": [                                                +
             |         {                                                      +
             |             "code": "countable_count",                         +
             |             "data": [                                          +
             |                 [                                              +
             |                     1262304000000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1293840000000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1325376000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1356998400000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1388534400000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1420070400000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1451606400000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1483228800000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1514764800000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1577836800000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1609459200000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1640995200000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1672531200000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1704067200000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1735689600000,                             +
             |                     1                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Unit Count"                               +
             |         },                                                     +
             |         {                                                      +
             |             "code": "births",                                  +
             |             "data": [                                          +
             |                 [                                              +
             |                     1262304000000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1293840000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1325376000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1356998400000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1388534400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1420070400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1451606400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1483228800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1514764800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1577836800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1609459200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1640995200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1672531200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1704067200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1735689600000,                             +
             |                     0                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Births"                                   +
             |         },                                                     +
             |         {                                                      +
             |             "code": "deaths",                                  +
             |             "data": [                                          +
             |                 [                                              +
             |                     1262304000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1293840000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1325376000000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1356998400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1388534400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1420070400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1451606400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1483228800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1514764800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1577836800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1609459200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1640995200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1672531200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1704067200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1735689600000,                             +
             |                     0                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Deaths"                                   +
             |         },                                                     +
             |         {                                                      +
             |             "code": "primary_activity_category_change_count",  +
             |             "data": [                                          +
             |                 [                                              +
             |                     1262304000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1293840000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1325376000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1356998400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1388534400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1420070400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1451606400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1483228800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1514764800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1577836800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1609459200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1640995200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1672531200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1704067200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1735689600000,                             +
             |                     0                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Primary Activity Changes"                 +
             |         },                                                     +
             |         {                                                      +
             |             "code": "physical_region_change_count",            +
             |             "data": [                                          +
             |                 [                                              +
             |                     1262304000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1293840000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1325376000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1356998400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1388534400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1420070400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1451606400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1483228800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1514764800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1577836800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1609459200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1640995200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1672531200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1704067200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1735689600000,                             +
             |                     0                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Region Changes"                           +
             |         }                                                      +
             |     ],                                                         +
             |     "unit_type": "enterprise",                                 +
             |     "resolution": "year",                                      +
             |     "filtered_series": [                                       +
             |         "countable_count",                                     +
             |         "births",                                              +
             |         "deaths",                                              +
             |         "primary_activity_category_change_count",              +
             |         "physical_region_change_count"                         +
             |     ],                                                         +
             |     "available_series": [                                      +
             |         {                                                      +
             |             "code": "countable_change",                        +
             |             "name": "Unit Count Change",                       +
             |             "priority": 11                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "countable_added_count",                   +
             |             "name": "Units Added (Countable)",                 +
             |             "priority": 12                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "countable_removed_count",                 +
             |             "name": "Units Removed (Countable)",               +
             |             "priority": 13                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "exists_count",                            +
             |             "name": "Existing Units",                          +
             |             "priority": 14                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "exists_change",                           +
             |             "name": "Existing Units Change",                   +
             |             "priority": 15                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "exists_added_count",                      +
             |             "name": "Units Added (Existence)",                 +
             |             "priority": 16                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "exists_removed_count",                    +
             |             "name": "Units Removed (Existence)",               +
             |             "priority": 17                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "name_change_count",                       +
             |             "name": "Name Changes",                            +
             |             "priority": 40                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "secondary_activity_category_change_count",+
             |             "name": "Secondary Activity Changes",              +
             |             "priority": 60                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "sector_change_count",                     +
             |             "name": "Sector Changes",                          +
             |             "priority": 70                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "legal_form_change_count",                 +
             |             "name": "Legal Form Changes",                      +
             |             "priority": 80                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "physical_country_change_count",           +
             |             "name": "Country Changes",                         +
             |             "priority": 100                                    +
             |         },                                                     +
             |         {                                                      +
             |             "code": "physical_address_change_count",           +
             |             "name": "Physical Address Changes",                +
             |             "priority": 110                                    +
             |         }                                                      +
             |     ]                                                          +
             | }

\echo "Test public.statistical_history_highcharts - year resolution, legal_unit"
"Test public.statistical_history_highcharts - year resolution, legal_unit"
SELECT jsonb_pretty(public.statistical_history_highcharts('year', 'legal_unit'));
-[ RECORD 1 ]+----------------------------------------------------------------
jsonb_pretty | {                                                              +
             |     "series": [                                                +
             |         {                                                      +
             |             "code": "countable_count",                         +
             |             "data": [                                          +
             |                 [                                              +
             |                     1262304000000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1293840000000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1325376000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1356998400000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1388534400000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1420070400000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1451606400000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1483228800000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1514764800000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1577836800000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1609459200000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1640995200000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1672531200000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1704067200000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1735689600000,                             +
             |                     1                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Unit Count"                               +
             |         },                                                     +
             |         {                                                      +
             |             "code": "births",                                  +
             |             "data": [                                          +
             |                 [                                              +
             |                     1262304000000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1293840000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1325376000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1356998400000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1388534400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1420070400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1451606400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1483228800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1514764800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1577836800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1609459200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1640995200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1672531200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1704067200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1735689600000,                             +
             |                     0                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Births"                                   +
             |         },                                                     +
             |         {                                                      +
             |             "code": "deaths",                                  +
             |             "data": [                                          +
             |                 [                                              +
             |                     1262304000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1293840000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1325376000000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1356998400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1388534400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1420070400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1451606400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1483228800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1514764800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1577836800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1609459200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1640995200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1672531200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1704067200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1735689600000,                             +
             |                     0                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Deaths"                                   +
             |         },                                                     +
             |         {                                                      +
             |             "code": "primary_activity_category_change_count",  +
             |             "data": [                                          +
             |                 [                                              +
             |                     1262304000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1293840000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1325376000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1356998400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1388534400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1420070400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1451606400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1483228800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1514764800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1577836800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1609459200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1640995200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1672531200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1704067200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1735689600000,                             +
             |                     0                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Primary Activity Changes"                 +
             |         },                                                     +
             |         {                                                      +
             |             "code": "physical_region_change_count",            +
             |             "data": [                                          +
             |                 [                                              +
             |                     1262304000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1293840000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1325376000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1356998400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1388534400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1420070400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1451606400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1483228800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1514764800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1577836800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1609459200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1640995200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1672531200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1704067200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1735689600000,                             +
             |                     0                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Region Changes"                           +
             |         }                                                      +
             |     ],                                                         +
             |     "unit_type": "legal_unit",                                 +
             |     "resolution": "year",                                      +
             |     "filtered_series": [                                       +
             |         "countable_count",                                     +
             |         "births",                                              +
             |         "deaths",                                              +
             |         "primary_activity_category_change_count",              +
             |         "physical_region_change_count"                         +
             |     ],                                                         +
             |     "available_series": [                                      +
             |         {                                                      +
             |             "code": "countable_change",                        +
             |             "name": "Unit Count Change",                       +
             |             "priority": 11                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "countable_added_count",                   +
             |             "name": "Units Added (Countable)",                 +
             |             "priority": 12                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "countable_removed_count",                 +
             |             "name": "Units Removed (Countable)",               +
             |             "priority": 13                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "exists_count",                            +
             |             "name": "Existing Units",                          +
             |             "priority": 14                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "exists_change",                           +
             |             "name": "Existing Units Change",                   +
             |             "priority": 15                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "exists_added_count",                      +
             |             "name": "Units Added (Existence)",                 +
             |             "priority": 16                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "exists_removed_count",                    +
             |             "name": "Units Removed (Existence)",               +
             |             "priority": 17                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "name_change_count",                       +
             |             "name": "Name Changes",                            +
             |             "priority": 40                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "secondary_activity_category_change_count",+
             |             "name": "Secondary Activity Changes",              +
             |             "priority": 60                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "sector_change_count",                     +
             |             "name": "Sector Changes",                          +
             |             "priority": 70                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "legal_form_change_count",                 +
             |             "name": "Legal Form Changes",                      +
             |             "priority": 80                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "physical_country_change_count",           +
             |             "name": "Country Changes",                         +
             |             "priority": 100                                    +
             |         },                                                     +
             |         {                                                      +
             |             "code": "physical_address_change_count",           +
             |             "name": "Physical Address Changes",                +
             |             "priority": 110                                    +
             |         }                                                      +
             |     ]                                                          +
             | }

\echo "Test public.statistical_history_highcharts - year resolution, establishment"
"Test public.statistical_history_highcharts - year resolution, establishment"
SELECT jsonb_pretty(public.statistical_history_highcharts('year', 'establishment'));
-[ RECORD 1 ]+----------------------------------------------------------------
jsonb_pretty | {                                                              +
             |     "series": [                                                +
             |         {                                                      +
             |             "code": "countable_count",                         +
             |             "data": [                                          +
             |                 [                                              +
             |                     1262304000000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1293840000000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1325376000000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1356998400000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1388534400000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1420070400000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1451606400000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1483228800000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1514764800000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1577836800000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1609459200000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1640995200000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1672531200000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1704067200000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1735689600000,                             +
             |                     1                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Unit Count"                               +
             |         },                                                     +
             |         {                                                      +
             |             "code": "births",                                  +
             |             "data": [                                          +
             |                 [                                              +
             |                     1262304000000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1293840000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1325376000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1356998400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1388534400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1420070400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1451606400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1483228800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1514764800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1577836800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1609459200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1640995200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1672531200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1704067200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1735689600000,                             +
             |                     0                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Births"                                   +
             |         },                                                     +
             |         {                                                      +
             |             "code": "deaths",                                  +
             |             "data": [                                          +
             |                 [                                              +
             |                     1262304000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1293840000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1325376000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1356998400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1388534400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1420070400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1451606400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1483228800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1514764800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1577836800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1609459200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1640995200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1672531200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1704067200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1735689600000,                             +
             |                     0                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Deaths"                                   +
             |         },                                                     +
             |         {                                                      +
             |             "code": "primary_activity_category_change_count",  +
             |             "data": [                                          +
             |                 [                                              +
             |                     1262304000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1293840000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1325376000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1356998400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1388534400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1420070400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1451606400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1483228800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1514764800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1577836800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1609459200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1640995200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1672531200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1704067200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1735689600000,                             +
             |                     0                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Primary Activity Changes"                 +
             |         },                                                     +
             |         {                                                      +
             |             "code": "physical_region_change_count",            +
             |             "data": [                                          +
             |                 [                                              +
             |                     1262304000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1293840000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1325376000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1356998400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1388534400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1420070400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1451606400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1483228800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1514764800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1577836800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1609459200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1640995200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1672531200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1704067200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1735689600000,                             +
             |                     0                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Region Changes"                           +
             |         }                                                      +
             |     ],                                                         +
             |     "unit_type": "establishment",                              +
             |     "resolution": "year",                                      +
             |     "filtered_series": [                                       +
             |         "countable_count",                                     +
             |         "births",                                              +
             |         "deaths",                                              +
             |         "primary_activity_category_change_count",              +
             |         "physical_region_change_count"                         +
             |     ],                                                         +
             |     "available_series": [                                      +
             |         {                                                      +
             |             "code": "countable_change",                        +
             |             "name": "Unit Count Change",                       +
             |             "priority": 11                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "countable_added_count",                   +
             |             "name": "Units Added (Countable)",                 +
             |             "priority": 12                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "countable_removed_count",                 +
             |             "name": "Units Removed (Countable)",               +
             |             "priority": 13                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "exists_count",                            +
             |             "name": "Existing Units",                          +
             |             "priority": 14                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "exists_change",                           +
             |             "name": "Existing Units Change",                   +
             |             "priority": 15                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "exists_added_count",                      +
             |             "name": "Units Added (Existence)",                 +
             |             "priority": 16                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "exists_removed_count",                    +
             |             "name": "Units Removed (Existence)",               +
             |             "priority": 17                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "name_change_count",                       +
             |             "name": "Name Changes",                            +
             |             "priority": 40                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "secondary_activity_category_change_count",+
             |             "name": "Secondary Activity Changes",              +
             |             "priority": 60                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "sector_change_count",                     +
             |             "name": "Sector Changes",                          +
             |             "priority": 70                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "legal_form_change_count",                 +
             |             "name": "Legal Form Changes",                      +
             |             "priority": 80                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "physical_country_change_count",           +
             |             "name": "Country Changes",                         +
             |             "priority": 100                                    +
             |         },                                                     +
             |         {                                                      +
             |             "code": "physical_address_change_count",           +
             |             "name": "Physical Address Changes",                +
             |             "priority": 110                                    +
             |         }                                                      +
             |     ]                                                          +
             | }

\echo "Test public.statistical_history_highcharts - year-month resolution for 2019, enterprise"
"Test public.statistical_history_highcharts - year-month resolution for 2019, enterprise"
SELECT jsonb_pretty(public.statistical_history_highcharts('year-month', 'enterprise', 2019));
-[ RECORD 1 ]+----------------------------------------------------------------
jsonb_pretty | {                                                              +
             |     "year": 2019,                                              +
             |     "series": [                                                +
             |         {                                                      +
             |             "code": "countable_count",                         +
             |             "data": [                                          +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1548979200000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1551398400000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1554076800000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1556668800000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1559347200000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1561939200000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1564617600000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1567296000000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1569888000000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1572566400000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1575158400000,                             +
             |                     1                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Unit Count"                               +
             |         },                                                     +
             |         {                                                      +
             |             "code": "births",                                  +
             |             "data": [                                          +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1548979200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1551398400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1554076800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1556668800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1559347200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1561939200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1564617600000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1567296000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1569888000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1572566400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1575158400000,                             +
             |                     0                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Births"                                   +
             |         },                                                     +
             |         {                                                      +
             |             "code": "deaths",                                  +
             |             "data": [                                          +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1548979200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1551398400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1554076800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1556668800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1559347200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1561939200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1564617600000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1567296000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1569888000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1572566400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1575158400000,                             +
             |                     0                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Deaths"                                   +
             |         },                                                     +
             |         {                                                      +
             |             "code": "primary_activity_category_change_count",  +
             |             "data": [                                          +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1548979200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1551398400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1554076800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1556668800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1559347200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1561939200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1564617600000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1567296000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1569888000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1572566400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1575158400000,                             +
             |                     0                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Primary Activity Changes"                 +
             |         },                                                     +
             |         {                                                      +
             |             "code": "physical_region_change_count",            +
             |             "data": [                                          +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1548979200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1551398400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1554076800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1556668800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1559347200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1561939200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1564617600000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1567296000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1569888000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1572566400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1575158400000,                             +
             |                     0                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Region Changes"                           +
             |         }                                                      +
             |     ],                                                         +
             |     "unit_type": "enterprise",                                 +
             |     "resolution": "year-month",                                +
             |     "filtered_series": [                                       +
             |         "countable_count",                                     +
             |         "births",                                              +
             |         "deaths",                                              +
             |         "primary_activity_category_change_count",              +
             |         "physical_region_change_count"                         +
             |     ],                                                         +
             |     "available_series": [                                      +
             |         {                                                      +
             |             "code": "countable_change",                        +
             |             "name": "Unit Count Change",                       +
             |             "priority": 11                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "countable_added_count",                   +
             |             "name": "Units Added (Countable)",                 +
             |             "priority": 12                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "countable_removed_count",                 +
             |             "name": "Units Removed (Countable)",               +
             |             "priority": 13                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "exists_count",                            +
             |             "name": "Existing Units",                          +
             |             "priority": 14                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "exists_change",                           +
             |             "name": "Existing Units Change",                   +
             |             "priority": 15                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "exists_added_count",                      +
             |             "name": "Units Added (Existence)",                 +
             |             "priority": 16                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "exists_removed_count",                    +
             |             "name": "Units Removed (Existence)",               +
             |             "priority": 17                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "name_change_count",                       +
             |             "name": "Name Changes",                            +
             |             "priority": 40                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "secondary_activity_category_change_count",+
             |             "name": "Secondary Activity Changes",              +
             |             "priority": 60                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "sector_change_count",                     +
             |             "name": "Sector Changes",                          +
             |             "priority": 70                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "legal_form_change_count",                 +
             |             "name": "Legal Form Changes",                      +
             |             "priority": 80                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "physical_country_change_count",           +
             |             "name": "Country Changes",                         +
             |             "priority": 100                                    +
             |         },                                                     +
             |         {                                                      +
             |             "code": "physical_address_change_count",           +
             |             "name": "Physical Address Changes",                +
             |             "priority": 110                                    +
             |         }                                                      +
             |     ]                                                          +
             | }

\echo "Test public.statistical_history_highcharts - year-month resolution for 2019, legal_unit"
"Test public.statistical_history_highcharts - year-month resolution for 2019, legal_unit"
SELECT jsonb_pretty(public.statistical_history_highcharts('year-month', 'legal_unit', 2019));
-[ RECORD 1 ]+----------------------------------------------------------------
jsonb_pretty | {                                                              +
             |     "year": 2019,                                              +
             |     "series": [                                                +
             |         {                                                      +
             |             "code": "countable_count",                         +
             |             "data": [                                          +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1548979200000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1551398400000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1554076800000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1556668800000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1559347200000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1561939200000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1564617600000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1567296000000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1569888000000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1572566400000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1575158400000,                             +
             |                     1                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Unit Count"                               +
             |         },                                                     +
             |         {                                                      +
             |             "code": "births",                                  +
             |             "data": [                                          +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1548979200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1551398400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1554076800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1556668800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1559347200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1561939200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1564617600000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1567296000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1569888000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1572566400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1575158400000,                             +
             |                     0                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Births"                                   +
             |         },                                                     +
             |         {                                                      +
             |             "code": "deaths",                                  +
             |             "data": [                                          +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1548979200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1551398400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1554076800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1556668800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1559347200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1561939200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1564617600000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1567296000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1569888000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1572566400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1575158400000,                             +
             |                     0                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Deaths"                                   +
             |         },                                                     +
             |         {                                                      +
             |             "code": "primary_activity_category_change_count",  +
             |             "data": [                                          +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1548979200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1551398400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1554076800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1556668800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1559347200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1561939200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1564617600000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1567296000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1569888000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1572566400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1575158400000,                             +
             |                     0                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Primary Activity Changes"                 +
             |         },                                                     +
             |         {                                                      +
             |             "code": "physical_region_change_count",            +
             |             "data": [                                          +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1548979200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1551398400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1554076800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1556668800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1559347200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1561939200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1564617600000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1567296000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1569888000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1572566400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1575158400000,                             +
             |                     0                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Region Changes"                           +
             |         }                                                      +
             |     ],                                                         +
             |     "unit_type": "legal_unit",                                 +
             |     "resolution": "year-month",                                +
             |     "filtered_series": [                                       +
             |         "countable_count",                                     +
             |         "births",                                              +
             |         "deaths",                                              +
             |         "primary_activity_category_change_count",              +
             |         "physical_region_change_count"                         +
             |     ],                                                         +
             |     "available_series": [                                      +
             |         {                                                      +
             |             "code": "countable_change",                        +
             |             "name": "Unit Count Change",                       +
             |             "priority": 11                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "countable_added_count",                   +
             |             "name": "Units Added (Countable)",                 +
             |             "priority": 12                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "countable_removed_count",                 +
             |             "name": "Units Removed (Countable)",               +
             |             "priority": 13                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "exists_count",                            +
             |             "name": "Existing Units",                          +
             |             "priority": 14                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "exists_change",                           +
             |             "name": "Existing Units Change",                   +
             |             "priority": 15                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "exists_added_count",                      +
             |             "name": "Units Added (Existence)",                 +
             |             "priority": 16                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "exists_removed_count",                    +
             |             "name": "Units Removed (Existence)",               +
             |             "priority": 17                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "name_change_count",                       +
             |             "name": "Name Changes",                            +
             |             "priority": 40                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "secondary_activity_category_change_count",+
             |             "name": "Secondary Activity Changes",              +
             |             "priority": 60                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "sector_change_count",                     +
             |             "name": "Sector Changes",                          +
             |             "priority": 70                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "legal_form_change_count",                 +
             |             "name": "Legal Form Changes",                      +
             |             "priority": 80                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "physical_country_change_count",           +
             |             "name": "Country Changes",                         +
             |             "priority": 100                                    +
             |         },                                                     +
             |         {                                                      +
             |             "code": "physical_address_change_count",           +
             |             "name": "Physical Address Changes",                +
             |             "priority": 110                                    +
             |         }                                                      +
             |     ]                                                          +
             | }

\echo "Test public.statistical_history_highcharts - year-month resolution for 2019, establishment"
"Test public.statistical_history_highcharts - year-month resolution for 2019, establishment"
SELECT jsonb_pretty(public.statistical_history_highcharts('year-month', 'establishment', 2019));
-[ RECORD 1 ]+----------------------------------------------------------------
jsonb_pretty | {                                                              +
             |     "year": 2019,                                              +
             |     "series": [                                                +
             |         {                                                      +
             |             "code": "countable_count",                         +
             |             "data": [                                          +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1548979200000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1551398400000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1554076800000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1556668800000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1559347200000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1561939200000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1564617600000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1567296000000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1569888000000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1572566400000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1575158400000,                             +
             |                     1                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Unit Count"                               +
             |         },                                                     +
             |         {                                                      +
             |             "code": "births",                                  +
             |             "data": [                                          +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1548979200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1551398400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1554076800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1556668800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1559347200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1561939200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1564617600000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1567296000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1569888000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1572566400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1575158400000,                             +
             |                     0                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Births"                                   +
             |         },                                                     +
             |         {                                                      +
             |             "code": "deaths",                                  +
             |             "data": [                                          +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1548979200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1551398400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1554076800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1556668800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1559347200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1561939200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1564617600000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1567296000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1569888000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1572566400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1575158400000,                             +
             |                     0                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Deaths"                                   +
             |         },                                                     +
             |         {                                                      +
             |             "code": "primary_activity_category_change_count",  +
             |             "data": [                                          +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1548979200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1551398400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1554076800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1556668800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1559347200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1561939200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1564617600000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1567296000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1569888000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1572566400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1575158400000,                             +
             |                     0                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Primary Activity Changes"                 +
             |         },                                                     +
             |         {                                                      +
             |             "code": "physical_region_change_count",            +
             |             "data": [                                          +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1548979200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1551398400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1554076800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1556668800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1559347200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1561939200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1564617600000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1567296000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1569888000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1572566400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1575158400000,                             +
             |                     0                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Region Changes"                           +
             |         }                                                      +
             |     ],                                                         +
             |     "unit_type": "establishment",                              +
             |     "resolution": "year-month",                                +
             |     "filtered_series": [                                       +
             |         "countable_count",                                     +
             |         "births",                                              +
             |         "deaths",                                              +
             |         "primary_activity_category_change_count",              +
             |         "physical_region_change_count"                         +
             |     ],                                                         +
             |     "available_series": [                                      +
             |         {                                                      +
             |             "code": "countable_change",                        +
             |             "name": "Unit Count Change",                       +
             |             "priority": 11                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "countable_added_count",                   +
             |             "name": "Units Added (Countable)",                 +
             |             "priority": 12                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "countable_removed_count",                 +
             |             "name": "Units Removed (Countable)",               +
             |             "priority": 13                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "exists_count",                            +
             |             "name": "Existing Units",                          +
             |             "priority": 14                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "exists_change",                           +
             |             "name": "Existing Units Change",                   +
             |             "priority": 15                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "exists_added_count",                      +
             |             "name": "Units Added (Existence)",                 +
             |             "priority": 16                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "exists_removed_count",                    +
             |             "name": "Units Removed (Existence)",               +
             |             "priority": 17                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "name_change_count",                       +
             |             "name": "Name Changes",                            +
             |             "priority": 40                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "secondary_activity_category_change_count",+
             |             "name": "Secondary Activity Changes",              +
             |             "priority": 60                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "sector_change_count",                     +
             |             "name": "Sector Changes",                          +
             |             "priority": 70                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "legal_form_change_count",                 +
             |             "name": "Legal Form Changes",                      +
             |             "priority": 80                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "physical_country_change_count",           +
             |             "name": "Country Changes",                         +
             |             "priority": 100                                    +
             |         },                                                     +
             |         {                                                      +
             |             "code": "physical_address_change_count",           +
             |             "name": "Physical Address Changes",                +
             |             "priority": 110                                    +
             |         }                                                      +
             |     ]                                                          +
             | }

\echo "Test public.statistical_history_highcharts - no data case (enterprise_group)"
"Test public.statistical_history_highcharts - no data case (enterprise_group)"
SELECT jsonb_pretty(public.statistical_history_highcharts('year', 'enterprise_group'));
-[ RECORD 1 ]+----------------------------------------------------------------
jsonb_pretty | {                                                              +
             |     "series": [                                                +
             |         {                                                      +
             |             "code": "countable_count",                         +
             |             "data": [                                          +
             |             ],                                                 +
             |             "name": "Unit Count"                               +
             |         },                                                     +
             |         {                                                      +
             |             "code": "births",                                  +
             |             "data": [                                          +
             |             ],                                                 +
             |             "name": "Births"                                   +
             |         },                                                     +
             |         {                                                      +
             |             "code": "deaths",                                  +
             |             "data": [                                          +
             |             ],                                                 +
             |             "name": "Deaths"                                   +
             |         },                                                     +
             |         {                                                      +
             |             "code": "primary_activity_category_change_count",  +
             |             "data": [                                          +
             |             ],                                                 +
             |             "name": "Primary Activity Changes"                 +
             |         },                                                     +
             |         {                                                      +
             |             "code": "physical_region_change_count",            +
             |             "data": [                                          +
             |             ],                                                 +
             |             "name": "Region Changes"                           +
             |         }                                                      +
             |     ],                                                         +
             |     "unit_type": "enterprise_group",                           +
             |     "resolution": "year",                                      +
             |     "filtered_series": [                                       +
             |         "countable_count",                                     +
             |         "births",                                              +
             |         "deaths",                                              +
             |         "primary_activity_category_change_count",              +
             |         "physical_region_change_count"                         +
             |     ],                                                         +
             |     "available_series": [                                      +
             |         {                                                      +
             |             "code": "countable_change",                        +
             |             "name": "Unit Count Change",                       +
             |             "priority": 11                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "countable_added_count",                   +
             |             "name": "Units Added (Countable)",                 +
             |             "priority": 12                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "countable_removed_count",                 +
             |             "name": "Units Removed (Countable)",               +
             |             "priority": 13                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "exists_count",                            +
             |             "name": "Existing Units",                          +
             |             "priority": 14                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "exists_change",                           +
             |             "name": "Existing Units Change",                   +
             |             "priority": 15                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "exists_added_count",                      +
             |             "name": "Units Added (Existence)",                 +
             |             "priority": 16                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "exists_removed_count",                    +
             |             "name": "Units Removed (Existence)",               +
             |             "priority": 17                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "name_change_count",                       +
             |             "name": "Name Changes",                            +
             |             "priority": 40                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "secondary_activity_category_change_count",+
             |             "name": "Secondary Activity Changes",              +
             |             "priority": 60                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "sector_change_count",                     +
             |             "name": "Sector Changes",                          +
             |             "priority": 70                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "legal_form_change_count",                 +
             |             "name": "Legal Form Changes",                      +
             |             "priority": 80                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "physical_country_change_count",           +
             |             "name": "Country Changes",                         +
             |             "priority": 100                                    +
             |         },                                                     +
             |         {                                                      +
             |             "code": "physical_address_change_count",           +
             |             "name": "Physical Address Changes",                +
             |             "priority": 110                                    +
             |         }                                                      +
             |     ]                                                          +
             | }

\echo "Test public.statistical_history_highcharts - with custom series filter"
"Test public.statistical_history_highcharts - with custom series filter"
SELECT jsonb_pretty(public.statistical_history_highcharts(
    p_resolution => 'year',
    p_unit_type => 'enterprise',
    p_series_codes => ARRAY['countable_count', 'deaths']
));
-[ RECORD 1 ]+----------------------------------------------------------------
jsonb_pretty | {                                                              +
             |     "series": [                                                +
             |         {                                                      +
             |             "code": "countable_count",                         +
             |             "data": [                                          +
             |                 [                                              +
             |                     1262304000000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1293840000000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1325376000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1356998400000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1388534400000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1420070400000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1451606400000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1483228800000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1514764800000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1577836800000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1609459200000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1640995200000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1672531200000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1704067200000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1735689600000,                             +
             |                     1                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Unit Count"                               +
             |         },                                                     +
             |         {                                                      +
             |             "code": "deaths",                                  +
             |             "data": [                                          +
             |                 [                                              +
             |                     1262304000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1293840000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1325376000000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1356998400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1388534400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1420070400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1451606400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1483228800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1514764800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1577836800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1609459200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1640995200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1672531200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1704067200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1735689600000,                             +
             |                     0                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Deaths"                                   +
             |         }                                                      +
             |     ],                                                         +
             |     "unit_type": "enterprise",                                 +
             |     "resolution": "year",                                      +
             |     "filtered_series": [                                       +
             |         "countable_count",                                     +
             |         "deaths"                                               +
             |     ],                                                         +
             |     "available_series": [                                      +
             |         {                                                      +
             |             "code": "countable_change",                        +
             |             "name": "Unit Count Change",                       +
             |             "priority": 11                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "countable_added_count",                   +
             |             "name": "Units Added (Countable)",                 +
             |             "priority": 12                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "countable_removed_count",                 +
             |             "name": "Units Removed (Countable)",               +
             |             "priority": 13                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "exists_count",                            +
             |             "name": "Existing Units",                          +
             |             "priority": 14                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "exists_change",                           +
             |             "name": "Existing Units Change",                   +
             |             "priority": 15                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "exists_added_count",                      +
             |             "name": "Units Added (Existence)",                 +
             |             "priority": 16                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "exists_removed_count",                    +
             |             "name": "Units Removed (Existence)",               +
             |             "priority": 17                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "births",                                  +
             |             "name": "Births",                                  +
             |             "priority": 20                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "name_change_count",                       +
             |             "name": "Name Changes",                            +
             |             "priority": 40                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "primary_activity_category_change_count",  +
             |             "name": "Primary Activity Changes",                +
             |             "priority": 50                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "secondary_activity_category_change_count",+
             |             "name": "Secondary Activity Changes",              +
             |             "priority": 60                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "sector_change_count",                     +
             |             "name": "Sector Changes",                          +
             |             "priority": 70                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "legal_form_change_count",                 +
             |             "name": "Legal Form Changes",                      +
             |             "priority": 80                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "physical_region_change_count",            +
             |             "name": "Region Changes",                          +
             |             "priority": 90                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "physical_country_change_count",           +
             |             "name": "Country Changes",                         +
             |             "priority": 100                                    +
             |         },                                                     +
             |         {                                                      +
             |             "code": "physical_address_change_count",           +
             |             "name": "Physical Address Changes",                +
             |             "priority": 110                                    +
             |         }                                                      +
             |     ]                                                          +
             | }

\echo "Test public.statistical_history_highcharts - with empty series filter (should use default)"
"Test public.statistical_history_highcharts - with empty series filter (should use default)"
SELECT jsonb_pretty(public.statistical_history_highcharts(
    p_resolution => 'year',
    p_unit_type => 'enterprise',
    p_series_codes => ARRAY[]::text[]
));
-[ RECORD 1 ]+----------------------------------------------------------------
jsonb_pretty | {                                                              +
             |     "series": [                                                +
             |         {                                                      +
             |             "code": "countable_count",                         +
             |             "data": [                                          +
             |                 [                                              +
             |                     1262304000000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1293840000000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1325376000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1356998400000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1388534400000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1420070400000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1451606400000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1483228800000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1514764800000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1577836800000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1609459200000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1640995200000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1672531200000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1704067200000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1735689600000,                             +
             |                     1                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Unit Count"                               +
             |         },                                                     +
             |         {                                                      +
             |             "code": "births",                                  +
             |             "data": [                                          +
             |                 [                                              +
             |                     1262304000000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1293840000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1325376000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1356998400000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1388534400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1420070400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1451606400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1483228800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1514764800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1577836800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1609459200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1640995200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1672531200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1704067200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1735689600000,                             +
             |                     0                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Births"                                   +
             |         },                                                     +
             |         {                                                      +
             |             "code": "deaths",                                  +
             |             "data": [                                          +
             |                 [                                              +
             |                     1262304000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1293840000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1325376000000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1356998400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1388534400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1420070400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1451606400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1483228800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1514764800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1577836800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1609459200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1640995200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1672531200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1704067200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1735689600000,                             +
             |                     0                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Deaths"                                   +
             |         },                                                     +
             |         {                                                      +
             |             "code": "primary_activity_category_change_count",  +
             |             "data": [                                          +
             |                 [                                              +
             |                     1262304000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1293840000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1325376000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1356998400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1388534400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1420070400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1451606400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1483228800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1514764800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1577836800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1609459200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1640995200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1672531200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1704067200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1735689600000,                             +
             |                     0                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Primary Activity Changes"                 +
             |         },                                                     +
             |         {                                                      +
             |             "code": "physical_region_change_count",            +
             |             "data": [                                          +
             |                 [                                              +
             |                     1262304000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1293840000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1325376000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1356998400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1388534400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1420070400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1451606400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1483228800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1514764800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1577836800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1609459200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1640995200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1672531200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1704067200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1735689600000,                             +
             |                     0                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Region Changes"                           +
             |         }                                                      +
             |     ],                                                         +
             |     "unit_type": "enterprise",                                 +
             |     "resolution": "year",                                      +
             |     "filtered_series": [                                       +
             |         "countable_count",                                     +
             |         "births",                                              +
             |         "deaths",                                              +
             |         "primary_activity_category_change_count",              +
             |         "physical_region_change_count"                         +
             |     ],                                                         +
             |     "available_series": [                                      +
             |         {                                                      +
             |             "code": "countable_change",                        +
             |             "name": "Unit Count Change",                       +
             |             "priority": 11                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "countable_added_count",                   +
             |             "name": "Units Added (Countable)",                 +
             |             "priority": 12                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "countable_removed_count",                 +
             |             "name": "Units Removed (Countable)",               +
             |             "priority": 13                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "exists_count",                            +
             |             "name": "Existing Units",                          +
             |             "priority": 14                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "exists_change",                           +
             |             "name": "Existing Units Change",                   +
             |             "priority": 15                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "exists_added_count",                      +
             |             "name": "Units Added (Existence)",                 +
             |             "priority": 16                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "exists_removed_count",                    +
             |             "name": "Units Removed (Existence)",               +
             |             "priority": 17                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "name_change_count",                       +
             |             "name": "Name Changes",                            +
             |             "priority": 40                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "secondary_activity_category_change_count",+
             |             "name": "Secondary Activity Changes",              +
             |             "priority": 60                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "sector_change_count",                     +
             |             "name": "Sector Changes",                          +
             |             "priority": 70                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "legal_form_change_count",                 +
             |             "name": "Legal Form Changes",                      +
             |             "priority": 80                                     +
             |         },                                                     +
             |         {                                                      +
             |             "code": "physical_country_change_count",           +
             |             "name": "Country Changes",                         +
             |             "priority": 100                                    +
             |         },                                                     +
             |         {                                                      +
             |             "code": "physical_address_change_count",           +
             |             "name": "Physical Address Changes",                +
             |             "priority": 110                                    +
             |         }                                                      +
             |     ]                                                          +
             | }

\echo "Test public.statistical_history_highcharts - with all series specified"
"Test public.statistical_history_highcharts - with all series specified"
SELECT jsonb_pretty(public.statistical_history_highcharts(
    p_resolution => 'year',
    p_unit_type => 'enterprise',
    p_series_codes => ARRAY[
        'countable_count',
        'countable_change',
        'countable_added_count',
        'countable_removed_count',
        'exists_count',
        'exists_change',
        'exists_added_count',
        'exists_removed_count',
        'births',
        'deaths',
        'name_change_count',
        'primary_activity_category_change_count',
        'secondary_activity_category_change_count',
        'sector_change_count',
        'legal_form_change_count',
        'physical_region_change_count',
        'physical_country_change_count',
        'physical_address_change_count'
    ]
));
-[ RECORD 1 ]+----------------------------------------------------------------
jsonb_pretty | {                                                              +
             |     "series": [                                                +
             |         {                                                      +
             |             "code": "countable_count",                         +
             |             "data": [                                          +
             |                 [                                              +
             |                     1262304000000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1293840000000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1325376000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1356998400000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1388534400000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1420070400000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1451606400000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1483228800000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1514764800000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1577836800000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1609459200000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1640995200000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1672531200000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1704067200000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1735689600000,                             +
             |                     1                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Unit Count"                               +
             |         },                                                     +
             |         {                                                      +
             |             "code": "countable_change",                        +
             |             "data": [                                          +
             |                 [                                              +
             |                     1262304000000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1293840000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1325376000000,                             +
             |                     -1                                         +
             |                 ],                                             +
             |                 [                                              +
             |                     1356998400000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1388534400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1420070400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1451606400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1483228800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1514764800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1577836800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1609459200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1640995200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1672531200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1704067200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1735689600000,                             +
             |                     0                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Unit Count Change"                        +
             |         },                                                     +
             |         {                                                      +
             |             "code": "countable_added_count",                   +
             |             "data": [                                          +
             |                 [                                              +
             |                     1262304000000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1293840000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1325376000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1356998400000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1388534400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1420070400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1451606400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1483228800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1514764800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1577836800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1609459200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1640995200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1672531200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1704067200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1735689600000,                             +
             |                     0                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Units Added (Countable)"                  +
             |         },                                                     +
             |         {                                                      +
             |             "code": "countable_removed_count",                 +
             |             "data": [                                          +
             |                 [                                              +
             |                     1262304000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1293840000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1325376000000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1356998400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1388534400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1420070400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1451606400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1483228800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1514764800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1577836800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1609459200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1640995200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1672531200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1704067200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1735689600000,                             +
             |                     0                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Units Removed (Countable)"                +
             |         },                                                     +
             |         {                                                      +
             |             "code": "exists_count",                            +
             |             "data": [                                          +
             |                 [                                              +
             |                     1262304000000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1293840000000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1325376000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1356998400000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1388534400000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1420070400000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1451606400000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1483228800000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1514764800000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1577836800000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1609459200000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1640995200000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1672531200000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1704067200000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1735689600000,                             +
             |                     1                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Existing Units"                           +
             |         },                                                     +
             |         {                                                      +
             |             "code": "exists_change",                           +
             |             "data": [                                          +
             |                 [                                              +
             |                     1262304000000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1293840000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1325376000000,                             +
             |                     -1                                         +
             |                 ],                                             +
             |                 [                                              +
             |                     1356998400000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1388534400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1420070400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1451606400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1483228800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1514764800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1577836800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1609459200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1640995200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1672531200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1704067200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1735689600000,                             +
             |                     0                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Existing Units Change"                    +
             |         },                                                     +
             |         {                                                      +
             |             "code": "exists_added_count",                      +
             |             "data": [                                          +
             |                 [                                              +
             |                     1262304000000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1293840000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1325376000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1356998400000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1388534400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1420070400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1451606400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1483228800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1514764800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1577836800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1609459200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1640995200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1672531200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1704067200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1735689600000,                             +
             |                     0                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Units Added (Existence)"                  +
             |         },                                                     +
             |         {                                                      +
             |             "code": "exists_removed_count",                    +
             |             "data": [                                          +
             |                 [                                              +
             |                     1262304000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1293840000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1325376000000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1356998400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1388534400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1420070400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1451606400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1483228800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1514764800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1577836800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1609459200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1640995200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1672531200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1704067200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1735689600000,                             +
             |                     0                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Units Removed (Existence)"                +
             |         },                                                     +
             |         {                                                      +
             |             "code": "births",                                  +
             |             "data": [                                          +
             |                 [                                              +
             |                     1262304000000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1293840000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1325376000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1356998400000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1388534400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1420070400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1451606400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1483228800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1514764800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1577836800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1609459200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1640995200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1672531200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1704067200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1735689600000,                             +
             |                     0                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Births"                                   +
             |         },                                                     +
             |         {                                                      +
             |             "code": "deaths",                                  +
             |             "data": [                                          +
             |                 [                                              +
             |                     1262304000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1293840000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1325376000000,                             +
             |                     1                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1356998400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1388534400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1420070400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1451606400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1483228800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1514764800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1577836800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1609459200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1640995200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1672531200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1704067200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1735689600000,                             +
             |                     0                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Deaths"                                   +
             |         },                                                     +
             |         {                                                      +
             |             "code": "name_change_count",                       +
             |             "data": [                                          +
             |                 [                                              +
             |                     1262304000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1293840000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1325376000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1356998400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1388534400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1420070400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1451606400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1483228800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1514764800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1577836800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1609459200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1640995200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1672531200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1704067200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1735689600000,                             +
             |                     0                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Name Changes"                             +
             |         },                                                     +
             |         {                                                      +
             |             "code": "primary_activity_category_change_count",  +
             |             "data": [                                          +
             |                 [                                              +
             |                     1262304000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1293840000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1325376000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1356998400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1388534400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1420070400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1451606400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1483228800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1514764800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1577836800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1609459200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1640995200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1672531200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1704067200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1735689600000,                             +
             |                     0                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Primary Activity Changes"                 +
             |         },                                                     +
             |         {                                                      +
             |             "code": "secondary_activity_category_change_count",+
             |             "data": [                                          +
             |                 [                                              +
             |                     1262304000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1293840000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1325376000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1356998400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1388534400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1420070400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1451606400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1483228800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1514764800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1577836800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1609459200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1640995200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1672531200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1704067200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1735689600000,                             +
             |                     0                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Secondary Activity Changes"               +
             |         },                                                     +
             |         {                                                      +
             |             "code": "sector_change_count",                     +
             |             "data": [                                          +
             |                 [                                              +
             |                     1262304000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1293840000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1325376000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1356998400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1388534400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1420070400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1451606400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1483228800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1514764800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1577836800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1609459200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1640995200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1672531200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1704067200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1735689600000,                             +
             |                     0                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Sector Changes"                           +
             |         },                                                     +
             |         {                                                      +
             |             "code": "legal_form_change_count",                 +
             |             "data": [                                          +
             |                 [                                              +
             |                     1262304000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1293840000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1325376000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1356998400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1388534400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1420070400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1451606400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1483228800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1514764800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1577836800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1609459200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1640995200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1672531200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1704067200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1735689600000,                             +
             |                     0                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Legal Form Changes"                       +
             |         },                                                     +
             |         {                                                      +
             |             "code": "physical_region_change_count",            +
             |             "data": [                                          +
             |                 [                                              +
             |                     1262304000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1293840000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1325376000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1356998400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1388534400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1420070400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1451606400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1483228800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1514764800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1577836800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1609459200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1640995200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1672531200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1704067200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1735689600000,                             +
             |                     0                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Region Changes"                           +
             |         },                                                     +
             |         {                                                      +
             |             "code": "physical_country_change_count",           +
             |             "data": [                                          +
             |                 [                                              +
             |                     1262304000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1293840000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1325376000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1356998400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1388534400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1420070400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1451606400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1483228800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1514764800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1577836800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1609459200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1640995200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1672531200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1704067200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1735689600000,                             +
             |                     0                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Country Changes"                          +
             |         },                                                     +
             |         {                                                      +
             |             "code": "physical_address_change_count",           +
             |             "data": [                                          +
             |                 [                                              +
             |                     1262304000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1293840000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1325376000000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1356998400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1388534400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1420070400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1451606400000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1483228800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1514764800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1546300800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1577836800000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1609459200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1640995200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1672531200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1704067200000,                             +
             |                     0                                          +
             |                 ],                                             +
             |                 [                                              +
             |                     1735689600000,                             +
             |                     0                                          +
             |                 ]                                              +
             |             ],                                                 +
             |             "name": "Physical Address Changes"                 +
             |         }                                                      +
             |     ],                                                         +
             |     "unit_type": "enterprise",                                 +
             |     "resolution": "year",                                      +
             |     "filtered_series": [                                       +
             |         "countable_count",                                     +
             |         "countable_change",                                    +
             |         "countable_added_count",                               +
             |         "countable_removed_count",                             +
             |         "exists_count",                                        +
             |         "exists_change",                                       +
             |         "exists_added_count",                                  +
             |         "exists_removed_count",                                +
             |         "births",                                              +
             |         "deaths",                                              +
             |         "name_change_count",                                   +
             |         "primary_activity_category_change_count",              +
             |         "secondary_activity_category_change_count",            +
             |         "sector_change_count",                                 +
             |         "legal_form_change_count",                             +
             |         "physical_region_change_count",                        +
             |         "physical_country_change_count",                       +
             |         "physical_address_change_count"                        +
             |     ]                                                          +
             | }

\echo "Test public.statistical_history_highcharts - with an invalid series code"
"Test public.statistical_history_highcharts - with an invalid series code"
SELECT jsonb_pretty(public.statistical_history_highcharts(
    p_resolution => 'year',
    p_unit_type => 'enterprise',
    p_series_codes => ARRAY['countable_count', 'invalid_code', 'deaths']
));
ERROR:  Invalid series code(s) provided: invalid_code
CONTEXT:  PL/pgSQL function statistical_history_highcharts(history_resolution,statistical_unit_type,integer,text[]) line 39 at RAISE
\i test/rollback_unless_persist_is_specified.sql
---------------------------------------------------------------------------
-- Support development loading of the data without rollback using
--   ./devops/manage-statbus.sh psql --variable=PERSIST=true < test/sql/01_load_web_examples.sql
-- Ref. https://stackoverflow.com/a/32597876/1023558
\set PERSIST :PERSIST
-- now PERSIST is set to the string ':PERSIST' if was not already set.
-- Checking it using a CASE statement:
SELECT CASE
  WHEN :'PERSIST'= ':PERSIST'
  THEN 'false'
  ELSE :'PERSIST'
END::BOOL AS "PERSIST" \gset
psql:test/rollback_unless_persist_is_specified.sql:13: ERROR:  current transaction is aborted, commands ignored until end of transaction block
-- < \gset call at end of the query to set variable.
\if :PERSIST
psql:test/rollback_unless_persist_is_specified.sql:16: error: unrecognized value ":PERSIST" for "\if expression": Boolean expected
COMMIT;
\else
ROLLBACK;
\endif
