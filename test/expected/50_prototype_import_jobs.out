BEGIN;
-- Create a function to disable RLS on import tables to support the \copy command.
-- and that requires privileges, make it a security definer, such that it can be
-- called by the user the tests run as.
CREATE PROCEDURE public.disable_rls_on_table(schema_name text, table_name text) LANGUAGE plpgsql SECURITY DEFINER AS $disable_rls_on_table$
BEGIN
  EXECUTE format('ALTER TABLE %I DISABLE ROW LEVEL SECURITY', table_name);
END;
$disable_rls_on_table$;
-- Grant execute permission to authenticated users
GRANT EXECUTE ON PROCEDURE public.disable_rls_on_table TO authenticated;
\i test/setup.sql
SELECT * FROM public.statbus_user_create('test.super@statbus.org', 'super_user'::statbus_role_type, 'Super#123!');
         email          |  password  
------------------------+------------
 test.super@statbus.org | Super#123!
(1 row)

SELECT * FROM public.statbus_user_create('test.regular@statbus.org', 'regular_user'::statbus_role_type, 'Regular#123!');
          email           |   password   
--------------------------+--------------
 test.regular@statbus.org | Regular#123!
(1 row)

SELECT * FROM public.statbus_user_create('test.restricted@statbus.org', 'restricted_user'::statbus_role_type, 'Restricted#123!');
            email            |    password     
-----------------------------+-----------------
 test.restricted@statbus.org | Restricted#123!
(1 row)

\if :{?DEBUG}
SET client_min_messages TO debug1;
\else
SET client_min_messages TO NOTICE;
\endif
-- Display all import definitions with their mappings
SELECT
    id.slug AS import_definition_slug,
    id.name AS import_name,
    it.schema_name AS target_schema_name,
    it.table_name AS data_table_name,
    id.note AS import_note,
    isc.column_name AS source_column,
    itc.column_name AS target_column,
    im.source_expression,
    im.source_value,
    isc.priority AS source_column_priority
FROM public.import_definition id
JOIN public.import_target it ON id.target_id = it.id
LEFT JOIN public.import_mapping im ON id.id = im.definition_id
LEFT JOIN public.import_source_column isc ON im.source_column_id = isc.id
LEFT JOIN public.import_target_column itc ON im.target_column_id = itc.id
ORDER BY id.slug, isc.priority NULLS LAST;
         import_definition_slug          |                    import_name                    | target_schema_name |               data_table_name               |                                        import_note                                        |          source_column           |          target_column           | source_expression | source_value | source_column_priority 
-----------------------------------------+---------------------------------------------------+--------------------+---------------------------------------------+-------------------------------------------------------------------------------------------+----------------------------------+----------------------------------+-------------------+--------------+------------------------
 establishment_for_lu_current_year       | Establishment for Legal Unit - Current Year       | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with validity period set to current year      | tax_ident                        | tax_ident                        |                   |              |                      1
 establishment_for_lu_current_year       | Establishment for Legal Unit - Current Year       | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with validity period set to current year      | stat_ident                       | stat_ident                       |                   |              |                      2
 establishment_for_lu_current_year       | Establishment for Legal Unit - Current Year       | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with validity period set to current year      | legal_unit_tax_ident             | legal_unit_tax_ident             |                   |              |                      3
 establishment_for_lu_current_year       | Establishment for Legal Unit - Current Year       | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with validity period set to current year      | legal_unit_stat_ident            | legal_unit_stat_ident            |                   |              |                      4
 establishment_for_lu_current_year       | Establishment for Legal Unit - Current Year       | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with validity period set to current year      | name                             | name                             |                   |              |                      5
 establishment_for_lu_current_year       | Establishment for Legal Unit - Current Year       | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with validity period set to current year      | birth_date                       | birth_date                       |                   |              |                      6
 establishment_for_lu_current_year       | Establishment for Legal Unit - Current Year       | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with validity period set to current year      | death_date                       | death_date                       |                   |              |                      7
 establishment_for_lu_current_year       | Establishment for Legal Unit - Current Year       | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with validity period set to current year      | physical_address_part1           | physical_address_part1           |                   |              |                      8
 establishment_for_lu_current_year       | Establishment for Legal Unit - Current Year       | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with validity period set to current year      | physical_address_part2           | physical_address_part2           |                   |              |                      9
 establishment_for_lu_current_year       | Establishment for Legal Unit - Current Year       | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with validity period set to current year      | physical_address_part3           | physical_address_part3           |                   |              |                     10
 establishment_for_lu_current_year       | Establishment for Legal Unit - Current Year       | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with validity period set to current year      | physical_postcode                | physical_postcode                |                   |              |                     11
 establishment_for_lu_current_year       | Establishment for Legal Unit - Current Year       | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with validity period set to current year      | physical_postplace               | physical_postplace               |                   |              |                     12
 establishment_for_lu_current_year       | Establishment for Legal Unit - Current Year       | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with validity period set to current year      | physical_latitude                | physical_latitude                |                   |              |                     13
 establishment_for_lu_current_year       | Establishment for Legal Unit - Current Year       | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with validity period set to current year      | physical_longitude               | physical_longitude               |                   |              |                     14
 establishment_for_lu_current_year       | Establishment for Legal Unit - Current Year       | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with validity period set to current year      | physical_altitude                | physical_altitude                |                   |              |                     15
 establishment_for_lu_current_year       | Establishment for Legal Unit - Current Year       | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with validity period set to current year      | physical_region_code             | physical_region_code             |                   |              |                     16
 establishment_for_lu_current_year       | Establishment for Legal Unit - Current Year       | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with validity period set to current year      | physical_region_path             | physical_region_path             |                   |              |                     17
 establishment_for_lu_current_year       | Establishment for Legal Unit - Current Year       | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with validity period set to current year      | physical_country_iso_2           | physical_country_iso_2           |                   |              |                     18
 establishment_for_lu_current_year       | Establishment for Legal Unit - Current Year       | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with validity period set to current year      | postal_address_part1             | postal_address_part1             |                   |              |                     19
 establishment_for_lu_current_year       | Establishment for Legal Unit - Current Year       | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with validity period set to current year      | postal_address_part2             | postal_address_part2             |                   |              |                     20
 establishment_for_lu_current_year       | Establishment for Legal Unit - Current Year       | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with validity period set to current year      | postal_address_part3             | postal_address_part3             |                   |              |                     21
 establishment_for_lu_current_year       | Establishment for Legal Unit - Current Year       | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with validity period set to current year      | postal_postcode                  | postal_postcode                  |                   |              |                     22
 establishment_for_lu_current_year       | Establishment for Legal Unit - Current Year       | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with validity period set to current year      | postal_postplace                 | postal_postplace                 |                   |              |                     23
 establishment_for_lu_current_year       | Establishment for Legal Unit - Current Year       | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with validity period set to current year      | postal_latitude                  | postal_latitude                  |                   |              |                     24
 establishment_for_lu_current_year       | Establishment for Legal Unit - Current Year       | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with validity period set to current year      | postal_longitude                 | postal_longitude                 |                   |              |                     25
 establishment_for_lu_current_year       | Establishment for Legal Unit - Current Year       | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with validity period set to current year      | postal_altitude                  | postal_altitude                  |                   |              |                     26
 establishment_for_lu_current_year       | Establishment for Legal Unit - Current Year       | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with validity period set to current year      | postal_region_code               | postal_region_code               |                   |              |                     27
 establishment_for_lu_current_year       | Establishment for Legal Unit - Current Year       | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with validity period set to current year      | postal_region_path               | postal_region_path               |                   |              |                     28
 establishment_for_lu_current_year       | Establishment for Legal Unit - Current Year       | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with validity period set to current year      | postal_country_iso_2             | postal_country_iso_2             |                   |              |                     29
 establishment_for_lu_current_year       | Establishment for Legal Unit - Current Year       | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with validity period set to current year      | web_address                      | web_address                      |                   |              |                     30
 establishment_for_lu_current_year       | Establishment for Legal Unit - Current Year       | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with validity period set to current year      | email_address                    | email_address                    |                   |              |                     31
 establishment_for_lu_current_year       | Establishment for Legal Unit - Current Year       | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with validity period set to current year      | phone_number                     | phone_number                     |                   |              |                     32
 establishment_for_lu_current_year       | Establishment for Legal Unit - Current Year       | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with validity period set to current year      | landline                         | landline                         |                   |              |                     33
 establishment_for_lu_current_year       | Establishment for Legal Unit - Current Year       | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with validity period set to current year      | mobile_number                    | mobile_number                    |                   |              |                     34
 establishment_for_lu_current_year       | Establishment for Legal Unit - Current Year       | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with validity period set to current year      | fax_number                       | fax_number                       |                   |              |                     35
 establishment_for_lu_current_year       | Establishment for Legal Unit - Current Year       | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with validity period set to current year      | primary_activity_category_code   | primary_activity_category_code   |                   |              |                     36
 establishment_for_lu_current_year       | Establishment for Legal Unit - Current Year       | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with validity period set to current year      | secondary_activity_category_code | secondary_activity_category_code |                   |              |                     37
 establishment_for_lu_current_year       | Establishment for Legal Unit - Current Year       | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with validity period set to current year      | status_code                      | status_code                      |                   |              |                     38
 establishment_for_lu_current_year       | Establishment for Legal Unit - Current Year       | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with validity period set to current year      | data_source_code                 | data_source_code                 |                   |              |                     39
 establishment_for_lu_current_year       | Establishment for Legal Unit - Current Year       | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with validity period set to current year      | employees                        | employees                        |                   |              |                     40
 establishment_for_lu_current_year       | Establishment for Legal Unit - Current Year       | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with validity period set to current year      | turnover                         | turnover                         |                   |              |                     41
 establishment_for_lu_current_year       | Establishment for Legal Unit - Current Year       | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with validity period set to current year      | tag_path                         | tag_path                         |                   |              |                     42
 establishment_for_lu_current_year       | Establishment for Legal Unit - Current Year       | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with validity period set to current year      |                                  | valid_from                       | default           |              |                       
 establishment_for_lu_current_year       | Establishment for Legal Unit - Current Year       | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with validity period set to current year      |                                  | valid_to                         | default           |              |                       
 establishment_for_lu_explicit_dates     | Establishment for Legal Unit - Explicit Dates     | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with explicit valid_from and valid_to columns | valid_from                       | valid_from                       |                   |              |                      1
 establishment_for_lu_explicit_dates     | Establishment for Legal Unit - Explicit Dates     | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with explicit valid_from and valid_to columns | valid_to                         | valid_to                         |                   |              |                      2
 establishment_for_lu_explicit_dates     | Establishment for Legal Unit - Explicit Dates     | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with explicit valid_from and valid_to columns | tax_ident                        | tax_ident                        |                   |              |                      3
 establishment_for_lu_explicit_dates     | Establishment for Legal Unit - Explicit Dates     | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with explicit valid_from and valid_to columns | stat_ident                       | stat_ident                       |                   |              |                      4
 establishment_for_lu_explicit_dates     | Establishment for Legal Unit - Explicit Dates     | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with explicit valid_from and valid_to columns | legal_unit_tax_ident             | legal_unit_tax_ident             |                   |              |                      5
 establishment_for_lu_explicit_dates     | Establishment for Legal Unit - Explicit Dates     | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with explicit valid_from and valid_to columns | legal_unit_stat_ident            | legal_unit_stat_ident            |                   |              |                      6
 establishment_for_lu_explicit_dates     | Establishment for Legal Unit - Explicit Dates     | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with explicit valid_from and valid_to columns | name                             | name                             |                   |              |                      7
 establishment_for_lu_explicit_dates     | Establishment for Legal Unit - Explicit Dates     | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with explicit valid_from and valid_to columns | birth_date                       | birth_date                       |                   |              |                      8
 establishment_for_lu_explicit_dates     | Establishment for Legal Unit - Explicit Dates     | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with explicit valid_from and valid_to columns | death_date                       | death_date                       |                   |              |                      9
 establishment_for_lu_explicit_dates     | Establishment for Legal Unit - Explicit Dates     | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with explicit valid_from and valid_to columns | physical_address_part1           | physical_address_part1           |                   |              |                     10
 establishment_for_lu_explicit_dates     | Establishment for Legal Unit - Explicit Dates     | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with explicit valid_from and valid_to columns | physical_address_part2           | physical_address_part2           |                   |              |                     11
 establishment_for_lu_explicit_dates     | Establishment for Legal Unit - Explicit Dates     | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with explicit valid_from and valid_to columns | physical_address_part3           | physical_address_part3           |                   |              |                     12
 establishment_for_lu_explicit_dates     | Establishment for Legal Unit - Explicit Dates     | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with explicit valid_from and valid_to columns | physical_postcode                | physical_postcode                |                   |              |                     13
 establishment_for_lu_explicit_dates     | Establishment for Legal Unit - Explicit Dates     | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with explicit valid_from and valid_to columns | physical_postplace               | physical_postplace               |                   |              |                     14
 establishment_for_lu_explicit_dates     | Establishment for Legal Unit - Explicit Dates     | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with explicit valid_from and valid_to columns | physical_latitude                | physical_latitude                |                   |              |                     15
 establishment_for_lu_explicit_dates     | Establishment for Legal Unit - Explicit Dates     | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with explicit valid_from and valid_to columns | physical_longitude               | physical_longitude               |                   |              |                     16
 establishment_for_lu_explicit_dates     | Establishment for Legal Unit - Explicit Dates     | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with explicit valid_from and valid_to columns | physical_altitude                | physical_altitude                |                   |              |                     17
 establishment_for_lu_explicit_dates     | Establishment for Legal Unit - Explicit Dates     | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with explicit valid_from and valid_to columns | physical_region_code             | physical_region_code             |                   |              |                     18
 establishment_for_lu_explicit_dates     | Establishment for Legal Unit - Explicit Dates     | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with explicit valid_from and valid_to columns | physical_region_path             | physical_region_path             |                   |              |                     19
 establishment_for_lu_explicit_dates     | Establishment for Legal Unit - Explicit Dates     | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with explicit valid_from and valid_to columns | physical_country_iso_2           | physical_country_iso_2           |                   |              |                     20
 establishment_for_lu_explicit_dates     | Establishment for Legal Unit - Explicit Dates     | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with explicit valid_from and valid_to columns | postal_address_part1             | postal_address_part1             |                   |              |                     21
 establishment_for_lu_explicit_dates     | Establishment for Legal Unit - Explicit Dates     | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with explicit valid_from and valid_to columns | postal_address_part2             | postal_address_part2             |                   |              |                     22
 establishment_for_lu_explicit_dates     | Establishment for Legal Unit - Explicit Dates     | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with explicit valid_from and valid_to columns | postal_address_part3             | postal_address_part3             |                   |              |                     23
 establishment_for_lu_explicit_dates     | Establishment for Legal Unit - Explicit Dates     | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with explicit valid_from and valid_to columns | postal_postcode                  | postal_postcode                  |                   |              |                     24
 establishment_for_lu_explicit_dates     | Establishment for Legal Unit - Explicit Dates     | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with explicit valid_from and valid_to columns | postal_postplace                 | postal_postplace                 |                   |              |                     25
 establishment_for_lu_explicit_dates     | Establishment for Legal Unit - Explicit Dates     | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with explicit valid_from and valid_to columns | postal_latitude                  | postal_latitude                  |                   |              |                     26
 establishment_for_lu_explicit_dates     | Establishment for Legal Unit - Explicit Dates     | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with explicit valid_from and valid_to columns | postal_longitude                 | postal_longitude                 |                   |              |                     27
 establishment_for_lu_explicit_dates     | Establishment for Legal Unit - Explicit Dates     | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with explicit valid_from and valid_to columns | postal_altitude                  | postal_altitude                  |                   |              |                     28
 establishment_for_lu_explicit_dates     | Establishment for Legal Unit - Explicit Dates     | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with explicit valid_from and valid_to columns | postal_region_code               | postal_region_code               |                   |              |                     29
 establishment_for_lu_explicit_dates     | Establishment for Legal Unit - Explicit Dates     | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with explicit valid_from and valid_to columns | postal_region_path               | postal_region_path               |                   |              |                     30
 establishment_for_lu_explicit_dates     | Establishment for Legal Unit - Explicit Dates     | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with explicit valid_from and valid_to columns | postal_country_iso_2             | postal_country_iso_2             |                   |              |                     31
 establishment_for_lu_explicit_dates     | Establishment for Legal Unit - Explicit Dates     | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with explicit valid_from and valid_to columns | web_address                      | web_address                      |                   |              |                     32
 establishment_for_lu_explicit_dates     | Establishment for Legal Unit - Explicit Dates     | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with explicit valid_from and valid_to columns | email_address                    | email_address                    |                   |              |                     33
 establishment_for_lu_explicit_dates     | Establishment for Legal Unit - Explicit Dates     | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with explicit valid_from and valid_to columns | phone_number                     | phone_number                     |                   |              |                     34
 establishment_for_lu_explicit_dates     | Establishment for Legal Unit - Explicit Dates     | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with explicit valid_from and valid_to columns | landline                         | landline                         |                   |              |                     35
 establishment_for_lu_explicit_dates     | Establishment for Legal Unit - Explicit Dates     | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with explicit valid_from and valid_to columns | mobile_number                    | mobile_number                    |                   |              |                     36
 establishment_for_lu_explicit_dates     | Establishment for Legal Unit - Explicit Dates     | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with explicit valid_from and valid_to columns | fax_number                       | fax_number                       |                   |              |                     37
 establishment_for_lu_explicit_dates     | Establishment for Legal Unit - Explicit Dates     | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with explicit valid_from and valid_to columns | primary_activity_category_code   | primary_activity_category_code   |                   |              |                     38
 establishment_for_lu_explicit_dates     | Establishment for Legal Unit - Explicit Dates     | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with explicit valid_from and valid_to columns | secondary_activity_category_code | secondary_activity_category_code |                   |              |                     39
 establishment_for_lu_explicit_dates     | Establishment for Legal Unit - Explicit Dates     | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with explicit valid_from and valid_to columns | status_code                      | status_code                      |                   |              |                     40
 establishment_for_lu_explicit_dates     | Establishment for Legal Unit - Explicit Dates     | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with explicit valid_from and valid_to columns | data_source_code                 | data_source_code                 |                   |              |                     41
 establishment_for_lu_explicit_dates     | Establishment for Legal Unit - Explicit Dates     | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with explicit valid_from and valid_to columns | employees                        | employees                        |                   |              |                     42
 establishment_for_lu_explicit_dates     | Establishment for Legal Unit - Explicit Dates     | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with explicit valid_from and valid_to columns | turnover                         | turnover                         |                   |              |                     43
 establishment_for_lu_explicit_dates     | Establishment for Legal Unit - Explicit Dates     | public             | import_establishment_era_for_legal_unit     | Import establishments linked to legal units with explicit valid_from and valid_to columns | tag_path                         | tag_path                         |                   |              |                     44
 establishment_without_lu_current_year   | Establishment without Legal Unit - Current Year   | public             | import_establishment_era_without_legal_unit | Import standalone establishments with validity period set to current year                 | tax_ident                        | tax_ident                        |                   |              |                      1
 establishment_without_lu_current_year   | Establishment without Legal Unit - Current Year   | public             | import_establishment_era_without_legal_unit | Import standalone establishments with validity period set to current year                 | stat_ident                       | stat_ident                       |                   |              |                      2
 establishment_without_lu_current_year   | Establishment without Legal Unit - Current Year   | public             | import_establishment_era_without_legal_unit | Import standalone establishments with validity period set to current year                 | name                             | name                             |                   |              |                      3
 establishment_without_lu_current_year   | Establishment without Legal Unit - Current Year   | public             | import_establishment_era_without_legal_unit | Import standalone establishments with validity period set to current year                 | birth_date                       | birth_date                       |                   |              |                      4
 establishment_without_lu_current_year   | Establishment without Legal Unit - Current Year   | public             | import_establishment_era_without_legal_unit | Import standalone establishments with validity period set to current year                 | death_date                       | death_date                       |                   |              |                      5
 establishment_without_lu_current_year   | Establishment without Legal Unit - Current Year   | public             | import_establishment_era_without_legal_unit | Import standalone establishments with validity period set to current year                 | physical_address_part1           | physical_address_part1           |                   |              |                      6
 establishment_without_lu_current_year   | Establishment without Legal Unit - Current Year   | public             | import_establishment_era_without_legal_unit | Import standalone establishments with validity period set to current year                 | physical_address_part2           | physical_address_part2           |                   |              |                      7
 establishment_without_lu_current_year   | Establishment without Legal Unit - Current Year   | public             | import_establishment_era_without_legal_unit | Import standalone establishments with validity period set to current year                 | physical_address_part3           | physical_address_part3           |                   |              |                      8
 establishment_without_lu_current_year   | Establishment without Legal Unit - Current Year   | public             | import_establishment_era_without_legal_unit | Import standalone establishments with validity period set to current year                 | physical_postcode                | physical_postcode                |                   |              |                      9
 establishment_without_lu_current_year   | Establishment without Legal Unit - Current Year   | public             | import_establishment_era_without_legal_unit | Import standalone establishments with validity period set to current year                 | physical_postplace               | physical_postplace               |                   |              |                     10
 establishment_without_lu_current_year   | Establishment without Legal Unit - Current Year   | public             | import_establishment_era_without_legal_unit | Import standalone establishments with validity period set to current year                 | physical_latitude                | physical_latitude                |                   |              |                     11
 establishment_without_lu_current_year   | Establishment without Legal Unit - Current Year   | public             | import_establishment_era_without_legal_unit | Import standalone establishments with validity period set to current year                 | physical_longitude               | physical_longitude               |                   |              |                     12
 establishment_without_lu_current_year   | Establishment without Legal Unit - Current Year   | public             | import_establishment_era_without_legal_unit | Import standalone establishments with validity period set to current year                 | physical_altitude                | physical_altitude                |                   |              |                     13
 establishment_without_lu_current_year   | Establishment without Legal Unit - Current Year   | public             | import_establishment_era_without_legal_unit | Import standalone establishments with validity period set to current year                 | physical_region_code             | physical_region_code             |                   |              |                     14
 establishment_without_lu_current_year   | Establishment without Legal Unit - Current Year   | public             | import_establishment_era_without_legal_unit | Import standalone establishments with validity period set to current year                 | physical_region_path             | physical_region_path             |                   |              |                     15
 establishment_without_lu_current_year   | Establishment without Legal Unit - Current Year   | public             | import_establishment_era_without_legal_unit | Import standalone establishments with validity period set to current year                 | physical_country_iso_2           | physical_country_iso_2           |                   |              |                     16
 establishment_without_lu_current_year   | Establishment without Legal Unit - Current Year   | public             | import_establishment_era_without_legal_unit | Import standalone establishments with validity period set to current year                 | postal_address_part1             | postal_address_part1             |                   |              |                     17
 establishment_without_lu_current_year   | Establishment without Legal Unit - Current Year   | public             | import_establishment_era_without_legal_unit | Import standalone establishments with validity period set to current year                 | postal_address_part2             | postal_address_part2             |                   |              |                     18
 establishment_without_lu_current_year   | Establishment without Legal Unit - Current Year   | public             | import_establishment_era_without_legal_unit | Import standalone establishments with validity period set to current year                 | postal_address_part3             | postal_address_part3             |                   |              |                     19
 establishment_without_lu_current_year   | Establishment without Legal Unit - Current Year   | public             | import_establishment_era_without_legal_unit | Import standalone establishments with validity period set to current year                 | postal_postcode                  | postal_postcode                  |                   |              |                     20
 establishment_without_lu_current_year   | Establishment without Legal Unit - Current Year   | public             | import_establishment_era_without_legal_unit | Import standalone establishments with validity period set to current year                 | postal_postplace                 | postal_postplace                 |                   |              |                     21
 establishment_without_lu_current_year   | Establishment without Legal Unit - Current Year   | public             | import_establishment_era_without_legal_unit | Import standalone establishments with validity period set to current year                 | postal_latitude                  | postal_latitude                  |                   |              |                     22
 establishment_without_lu_current_year   | Establishment without Legal Unit - Current Year   | public             | import_establishment_era_without_legal_unit | Import standalone establishments with validity period set to current year                 | postal_longitude                 | postal_longitude                 |                   |              |                     23
 establishment_without_lu_current_year   | Establishment without Legal Unit - Current Year   | public             | import_establishment_era_without_legal_unit | Import standalone establishments with validity period set to current year                 | postal_altitude                  | postal_altitude                  |                   |              |                     24
 establishment_without_lu_current_year   | Establishment without Legal Unit - Current Year   | public             | import_establishment_era_without_legal_unit | Import standalone establishments with validity period set to current year                 | postal_region_code               | postal_region_code               |                   |              |                     25
 establishment_without_lu_current_year   | Establishment without Legal Unit - Current Year   | public             | import_establishment_era_without_legal_unit | Import standalone establishments with validity period set to current year                 | postal_region_path               | postal_region_path               |                   |              |                     26
 establishment_without_lu_current_year   | Establishment without Legal Unit - Current Year   | public             | import_establishment_era_without_legal_unit | Import standalone establishments with validity period set to current year                 | postal_country_iso_2             | postal_country_iso_2             |                   |              |                     27
 establishment_without_lu_current_year   | Establishment without Legal Unit - Current Year   | public             | import_establishment_era_without_legal_unit | Import standalone establishments with validity period set to current year                 | web_address                      | web_address                      |                   |              |                     28
 establishment_without_lu_current_year   | Establishment without Legal Unit - Current Year   | public             | import_establishment_era_without_legal_unit | Import standalone establishments with validity period set to current year                 | email_address                    | email_address                    |                   |              |                     29
 establishment_without_lu_current_year   | Establishment without Legal Unit - Current Year   | public             | import_establishment_era_without_legal_unit | Import standalone establishments with validity period set to current year                 | phone_number                     | phone_number                     |                   |              |                     30
 establishment_without_lu_current_year   | Establishment without Legal Unit - Current Year   | public             | import_establishment_era_without_legal_unit | Import standalone establishments with validity period set to current year                 | landline                         | landline                         |                   |              |                     31
 establishment_without_lu_current_year   | Establishment without Legal Unit - Current Year   | public             | import_establishment_era_without_legal_unit | Import standalone establishments with validity period set to current year                 | mobile_number                    | mobile_number                    |                   |              |                     32
 establishment_without_lu_current_year   | Establishment without Legal Unit - Current Year   | public             | import_establishment_era_without_legal_unit | Import standalone establishments with validity period set to current year                 | fax_number                       | fax_number                       |                   |              |                     33
 establishment_without_lu_current_year   | Establishment without Legal Unit - Current Year   | public             | import_establishment_era_without_legal_unit | Import standalone establishments with validity period set to current year                 | primary_activity_category_code   | primary_activity_category_code   |                   |              |                     34
 establishment_without_lu_current_year   | Establishment without Legal Unit - Current Year   | public             | import_establishment_era_without_legal_unit | Import standalone establishments with validity period set to current year                 | secondary_activity_category_code | secondary_activity_category_code |                   |              |                     35
 establishment_without_lu_current_year   | Establishment without Legal Unit - Current Year   | public             | import_establishment_era_without_legal_unit | Import standalone establishments with validity period set to current year                 | sector_code                      | sector_code                      |                   |              |                     36
 establishment_without_lu_current_year   | Establishment without Legal Unit - Current Year   | public             | import_establishment_era_without_legal_unit | Import standalone establishments with validity period set to current year                 | status_code                      | status_code                      |                   |              |                     37
 establishment_without_lu_current_year   | Establishment without Legal Unit - Current Year   | public             | import_establishment_era_without_legal_unit | Import standalone establishments with validity period set to current year                 | data_source_code                 | data_source_code                 |                   |              |                     38
 establishment_without_lu_current_year   | Establishment without Legal Unit - Current Year   | public             | import_establishment_era_without_legal_unit | Import standalone establishments with validity period set to current year                 | employees                        | employees                        |                   |              |                     39
 establishment_without_lu_current_year   | Establishment without Legal Unit - Current Year   | public             | import_establishment_era_without_legal_unit | Import standalone establishments with validity period set to current year                 | turnover                         | turnover                         |                   |              |                     40
 establishment_without_lu_current_year   | Establishment without Legal Unit - Current Year   | public             | import_establishment_era_without_legal_unit | Import standalone establishments with validity period set to current year                 | tag_path                         | tag_path                         |                   |              |                     41
 establishment_without_lu_current_year   | Establishment without Legal Unit - Current Year   | public             | import_establishment_era_without_legal_unit | Import standalone establishments with validity period set to current year                 |                                  | valid_to                         | default           |              |                       
 establishment_without_lu_current_year   | Establishment without Legal Unit - Current Year   | public             | import_establishment_era_without_legal_unit | Import standalone establishments with validity period set to current year                 |                                  | valid_from                       | default           |              |                       
 establishment_without_lu_explicit_dates | Establishment without Legal Unit - Explicit Dates | public             | import_establishment_era_without_legal_unit | Import standalone establishments with explicit valid_from and valid_to columns            | valid_from                       | valid_from                       |                   |              |                      1
 establishment_without_lu_explicit_dates | Establishment without Legal Unit - Explicit Dates | public             | import_establishment_era_without_legal_unit | Import standalone establishments with explicit valid_from and valid_to columns            | valid_to                         | valid_to                         |                   |              |                      2
 establishment_without_lu_explicit_dates | Establishment without Legal Unit - Explicit Dates | public             | import_establishment_era_without_legal_unit | Import standalone establishments with explicit valid_from and valid_to columns            | tax_ident                        | tax_ident                        |                   |              |                      3
 establishment_without_lu_explicit_dates | Establishment without Legal Unit - Explicit Dates | public             | import_establishment_era_without_legal_unit | Import standalone establishments with explicit valid_from and valid_to columns            | stat_ident                       | stat_ident                       |                   |              |                      4
 establishment_without_lu_explicit_dates | Establishment without Legal Unit - Explicit Dates | public             | import_establishment_era_without_legal_unit | Import standalone establishments with explicit valid_from and valid_to columns            | name                             | name                             |                   |              |                      5
 establishment_without_lu_explicit_dates | Establishment without Legal Unit - Explicit Dates | public             | import_establishment_era_without_legal_unit | Import standalone establishments with explicit valid_from and valid_to columns            | birth_date                       | birth_date                       |                   |              |                      6
 establishment_without_lu_explicit_dates | Establishment without Legal Unit - Explicit Dates | public             | import_establishment_era_without_legal_unit | Import standalone establishments with explicit valid_from and valid_to columns            | death_date                       | death_date                       |                   |              |                      7
 establishment_without_lu_explicit_dates | Establishment without Legal Unit - Explicit Dates | public             | import_establishment_era_without_legal_unit | Import standalone establishments with explicit valid_from and valid_to columns            | physical_address_part1           | physical_address_part1           |                   |              |                      8
 establishment_without_lu_explicit_dates | Establishment without Legal Unit - Explicit Dates | public             | import_establishment_era_without_legal_unit | Import standalone establishments with explicit valid_from and valid_to columns            | physical_address_part2           | physical_address_part2           |                   |              |                      9
 establishment_without_lu_explicit_dates | Establishment without Legal Unit - Explicit Dates | public             | import_establishment_era_without_legal_unit | Import standalone establishments with explicit valid_from and valid_to columns            | physical_address_part3           | physical_address_part3           |                   |              |                     10
 establishment_without_lu_explicit_dates | Establishment without Legal Unit - Explicit Dates | public             | import_establishment_era_without_legal_unit | Import standalone establishments with explicit valid_from and valid_to columns            | physical_postcode                | physical_postcode                |                   |              |                     11
 establishment_without_lu_explicit_dates | Establishment without Legal Unit - Explicit Dates | public             | import_establishment_era_without_legal_unit | Import standalone establishments with explicit valid_from and valid_to columns            | physical_postplace               | physical_postplace               |                   |              |                     12
 establishment_without_lu_explicit_dates | Establishment without Legal Unit - Explicit Dates | public             | import_establishment_era_without_legal_unit | Import standalone establishments with explicit valid_from and valid_to columns            | physical_latitude                | physical_latitude                |                   |              |                     13
 establishment_without_lu_explicit_dates | Establishment without Legal Unit - Explicit Dates | public             | import_establishment_era_without_legal_unit | Import standalone establishments with explicit valid_from and valid_to columns            | physical_longitude               | physical_longitude               |                   |              |                     14
 establishment_without_lu_explicit_dates | Establishment without Legal Unit - Explicit Dates | public             | import_establishment_era_without_legal_unit | Import standalone establishments with explicit valid_from and valid_to columns            | physical_altitude                | physical_altitude                |                   |              |                     15
 establishment_without_lu_explicit_dates | Establishment without Legal Unit - Explicit Dates | public             | import_establishment_era_without_legal_unit | Import standalone establishments with explicit valid_from and valid_to columns            | physical_region_code             | physical_region_code             |                   |              |                     16
 establishment_without_lu_explicit_dates | Establishment without Legal Unit - Explicit Dates | public             | import_establishment_era_without_legal_unit | Import standalone establishments with explicit valid_from and valid_to columns            | physical_region_path             | physical_region_path             |                   |              |                     17
 establishment_without_lu_explicit_dates | Establishment without Legal Unit - Explicit Dates | public             | import_establishment_era_without_legal_unit | Import standalone establishments with explicit valid_from and valid_to columns            | physical_country_iso_2           | physical_country_iso_2           |                   |              |                     18
 establishment_without_lu_explicit_dates | Establishment without Legal Unit - Explicit Dates | public             | import_establishment_era_without_legal_unit | Import standalone establishments with explicit valid_from and valid_to columns            | postal_address_part1             | postal_address_part1             |                   |              |                     19
 establishment_without_lu_explicit_dates | Establishment without Legal Unit - Explicit Dates | public             | import_establishment_era_without_legal_unit | Import standalone establishments with explicit valid_from and valid_to columns            | postal_address_part2             | postal_address_part2             |                   |              |                     20
 establishment_without_lu_explicit_dates | Establishment without Legal Unit - Explicit Dates | public             | import_establishment_era_without_legal_unit | Import standalone establishments with explicit valid_from and valid_to columns            | postal_address_part3             | postal_address_part3             |                   |              |                     21
 establishment_without_lu_explicit_dates | Establishment without Legal Unit - Explicit Dates | public             | import_establishment_era_without_legal_unit | Import standalone establishments with explicit valid_from and valid_to columns            | postal_postcode                  | postal_postcode                  |                   |              |                     22
 establishment_without_lu_explicit_dates | Establishment without Legal Unit - Explicit Dates | public             | import_establishment_era_without_legal_unit | Import standalone establishments with explicit valid_from and valid_to columns            | postal_postplace                 | postal_postplace                 |                   |              |                     23
 establishment_without_lu_explicit_dates | Establishment without Legal Unit - Explicit Dates | public             | import_establishment_era_without_legal_unit | Import standalone establishments with explicit valid_from and valid_to columns            | postal_latitude                  | postal_latitude                  |                   |              |                     24
 establishment_without_lu_explicit_dates | Establishment without Legal Unit - Explicit Dates | public             | import_establishment_era_without_legal_unit | Import standalone establishments with explicit valid_from and valid_to columns            | postal_longitude                 | postal_longitude                 |                   |              |                     25
 establishment_without_lu_explicit_dates | Establishment without Legal Unit - Explicit Dates | public             | import_establishment_era_without_legal_unit | Import standalone establishments with explicit valid_from and valid_to columns            | postal_altitude                  | postal_altitude                  |                   |              |                     26
 establishment_without_lu_explicit_dates | Establishment without Legal Unit - Explicit Dates | public             | import_establishment_era_without_legal_unit | Import standalone establishments with explicit valid_from and valid_to columns            | postal_region_code               | postal_region_code               |                   |              |                     27
 establishment_without_lu_explicit_dates | Establishment without Legal Unit - Explicit Dates | public             | import_establishment_era_without_legal_unit | Import standalone establishments with explicit valid_from and valid_to columns            | postal_region_path               | postal_region_path               |                   |              |                     28
 establishment_without_lu_explicit_dates | Establishment without Legal Unit - Explicit Dates | public             | import_establishment_era_without_legal_unit | Import standalone establishments with explicit valid_from and valid_to columns            | postal_country_iso_2             | postal_country_iso_2             |                   |              |                     29
 establishment_without_lu_explicit_dates | Establishment without Legal Unit - Explicit Dates | public             | import_establishment_era_without_legal_unit | Import standalone establishments with explicit valid_from and valid_to columns            | web_address                      | web_address                      |                   |              |                     30
 establishment_without_lu_explicit_dates | Establishment without Legal Unit - Explicit Dates | public             | import_establishment_era_without_legal_unit | Import standalone establishments with explicit valid_from and valid_to columns            | email_address                    | email_address                    |                   |              |                     31
 establishment_without_lu_explicit_dates | Establishment without Legal Unit - Explicit Dates | public             | import_establishment_era_without_legal_unit | Import standalone establishments with explicit valid_from and valid_to columns            | phone_number                     | phone_number                     |                   |              |                     32
 establishment_without_lu_explicit_dates | Establishment without Legal Unit - Explicit Dates | public             | import_establishment_era_without_legal_unit | Import standalone establishments with explicit valid_from and valid_to columns            | landline                         | landline                         |                   |              |                     33
 establishment_without_lu_explicit_dates | Establishment without Legal Unit - Explicit Dates | public             | import_establishment_era_without_legal_unit | Import standalone establishments with explicit valid_from and valid_to columns            | mobile_number                    | mobile_number                    |                   |              |                     34
 establishment_without_lu_explicit_dates | Establishment without Legal Unit - Explicit Dates | public             | import_establishment_era_without_legal_unit | Import standalone establishments with explicit valid_from and valid_to columns            | fax_number                       | fax_number                       |                   |              |                     35
 establishment_without_lu_explicit_dates | Establishment without Legal Unit - Explicit Dates | public             | import_establishment_era_without_legal_unit | Import standalone establishments with explicit valid_from and valid_to columns            | primary_activity_category_code   | primary_activity_category_code   |                   |              |                     36
 establishment_without_lu_explicit_dates | Establishment without Legal Unit - Explicit Dates | public             | import_establishment_era_without_legal_unit | Import standalone establishments with explicit valid_from and valid_to columns            | secondary_activity_category_code | secondary_activity_category_code |                   |              |                     37
 establishment_without_lu_explicit_dates | Establishment without Legal Unit - Explicit Dates | public             | import_establishment_era_without_legal_unit | Import standalone establishments with explicit valid_from and valid_to columns            | sector_code                      | sector_code                      |                   |              |                     38
 establishment_without_lu_explicit_dates | Establishment without Legal Unit - Explicit Dates | public             | import_establishment_era_without_legal_unit | Import standalone establishments with explicit valid_from and valid_to columns            | status_code                      | status_code                      |                   |              |                     39
 establishment_without_lu_explicit_dates | Establishment without Legal Unit - Explicit Dates | public             | import_establishment_era_without_legal_unit | Import standalone establishments with explicit valid_from and valid_to columns            | data_source_code                 | data_source_code                 |                   |              |                     40
 establishment_without_lu_explicit_dates | Establishment without Legal Unit - Explicit Dates | public             | import_establishment_era_without_legal_unit | Import standalone establishments with explicit valid_from and valid_to columns            | employees                        | employees                        |                   |              |                     41
 establishment_without_lu_explicit_dates | Establishment without Legal Unit - Explicit Dates | public             | import_establishment_era_without_legal_unit | Import standalone establishments with explicit valid_from and valid_to columns            | turnover                         | turnover                         |                   |              |                     42
 establishment_without_lu_explicit_dates | Establishment without Legal Unit - Explicit Dates | public             | import_establishment_era_without_legal_unit | Import standalone establishments with explicit valid_from and valid_to columns            | tag_path                         | tag_path                         |                   |              |                     43
 legal_unit_current_year                 | Legal Unit - Current Year                         | public             | import_legal_unit_era                       | Import legal units with validity period set to current year                               | tax_ident                        | tax_ident                        |                   |              |                      1
 legal_unit_current_year                 | Legal Unit - Current Year                         | public             | import_legal_unit_era                       | Import legal units with validity period set to current year                               | stat_ident                       | stat_ident                       |                   |              |                      2
 legal_unit_current_year                 | Legal Unit - Current Year                         | public             | import_legal_unit_era                       | Import legal units with validity period set to current year                               | name                             | name                             |                   |              |                      3
 legal_unit_current_year                 | Legal Unit - Current Year                         | public             | import_legal_unit_era                       | Import legal units with validity period set to current year                               | birth_date                       | birth_date                       |                   |              |                      4
 legal_unit_current_year                 | Legal Unit - Current Year                         | public             | import_legal_unit_era                       | Import legal units with validity period set to current year                               | death_date                       | death_date                       |                   |              |                      5
 legal_unit_current_year                 | Legal Unit - Current Year                         | public             | import_legal_unit_era                       | Import legal units with validity period set to current year                               | physical_address_part1           | physical_address_part1           |                   |              |                      6
 legal_unit_current_year                 | Legal Unit - Current Year                         | public             | import_legal_unit_era                       | Import legal units with validity period set to current year                               | physical_address_part2           | physical_address_part2           |                   |              |                      7
 legal_unit_current_year                 | Legal Unit - Current Year                         | public             | import_legal_unit_era                       | Import legal units with validity period set to current year                               | physical_address_part3           | physical_address_part3           |                   |              |                      8
 legal_unit_current_year                 | Legal Unit - Current Year                         | public             | import_legal_unit_era                       | Import legal units with validity period set to current year                               | physical_postcode                | physical_postcode                |                   |              |                      9
 legal_unit_current_year                 | Legal Unit - Current Year                         | public             | import_legal_unit_era                       | Import legal units with validity period set to current year                               | physical_postplace               | physical_postplace               |                   |              |                     10
 legal_unit_current_year                 | Legal Unit - Current Year                         | public             | import_legal_unit_era                       | Import legal units with validity period set to current year                               | physical_latitude                | physical_latitude                |                   |              |                     11
 legal_unit_current_year                 | Legal Unit - Current Year                         | public             | import_legal_unit_era                       | Import legal units with validity period set to current year                               | physical_longitude               | physical_longitude               |                   |              |                     12
 legal_unit_current_year                 | Legal Unit - Current Year                         | public             | import_legal_unit_era                       | Import legal units with validity period set to current year                               | physical_altitude                | physical_altitude                |                   |              |                     13
 legal_unit_current_year                 | Legal Unit - Current Year                         | public             | import_legal_unit_era                       | Import legal units with validity period set to current year                               | physical_region_code             | physical_region_code             |                   |              |                     14
 legal_unit_current_year                 | Legal Unit - Current Year                         | public             | import_legal_unit_era                       | Import legal units with validity period set to current year                               | physical_region_path             | physical_region_path             |                   |              |                     15
 legal_unit_current_year                 | Legal Unit - Current Year                         | public             | import_legal_unit_era                       | Import legal units with validity period set to current year                               | physical_country_iso_2           | physical_country_iso_2           |                   |              |                     16
 legal_unit_current_year                 | Legal Unit - Current Year                         | public             | import_legal_unit_era                       | Import legal units with validity period set to current year                               | postal_address_part1             | postal_address_part1             |                   |              |                     17
 legal_unit_current_year                 | Legal Unit - Current Year                         | public             | import_legal_unit_era                       | Import legal units with validity period set to current year                               | postal_address_part2             | postal_address_part2             |                   |              |                     18
 legal_unit_current_year                 | Legal Unit - Current Year                         | public             | import_legal_unit_era                       | Import legal units with validity period set to current year                               | postal_address_part3             | postal_address_part3             |                   |              |                     19
 legal_unit_current_year                 | Legal Unit - Current Year                         | public             | import_legal_unit_era                       | Import legal units with validity period set to current year                               | postal_postcode                  | postal_postcode                  |                   |              |                     20
 legal_unit_current_year                 | Legal Unit - Current Year                         | public             | import_legal_unit_era                       | Import legal units with validity period set to current year                               | postal_postplace                 | postal_postplace                 |                   |              |                     21
 legal_unit_current_year                 | Legal Unit - Current Year                         | public             | import_legal_unit_era                       | Import legal units with validity period set to current year                               | postal_latitude                  | postal_latitude                  |                   |              |                     22
 legal_unit_current_year                 | Legal Unit - Current Year                         | public             | import_legal_unit_era                       | Import legal units with validity period set to current year                               | postal_longitude                 | postal_longitude                 |                   |              |                     23
 legal_unit_current_year                 | Legal Unit - Current Year                         | public             | import_legal_unit_era                       | Import legal units with validity period set to current year                               | postal_altitude                  | postal_altitude                  |                   |              |                     24
 legal_unit_current_year                 | Legal Unit - Current Year                         | public             | import_legal_unit_era                       | Import legal units with validity period set to current year                               | postal_region_code               | postal_region_code               |                   |              |                     25
 legal_unit_current_year                 | Legal Unit - Current Year                         | public             | import_legal_unit_era                       | Import legal units with validity period set to current year                               | postal_region_path               | postal_region_path               |                   |              |                     26
 legal_unit_current_year                 | Legal Unit - Current Year                         | public             | import_legal_unit_era                       | Import legal units with validity period set to current year                               | postal_country_iso_2             | postal_country_iso_2             |                   |              |                     27
 legal_unit_current_year                 | Legal Unit - Current Year                         | public             | import_legal_unit_era                       | Import legal units with validity period set to current year                               | web_address                      | web_address                      |                   |              |                     28
 legal_unit_current_year                 | Legal Unit - Current Year                         | public             | import_legal_unit_era                       | Import legal units with validity period set to current year                               | email_address                    | email_address                    |                   |              |                     29
 legal_unit_current_year                 | Legal Unit - Current Year                         | public             | import_legal_unit_era                       | Import legal units with validity period set to current year                               | phone_number                     | phone_number                     |                   |              |                     30
 legal_unit_current_year                 | Legal Unit - Current Year                         | public             | import_legal_unit_era                       | Import legal units with validity period set to current year                               | landline                         | landline                         |                   |              |                     31
 legal_unit_current_year                 | Legal Unit - Current Year                         | public             | import_legal_unit_era                       | Import legal units with validity period set to current year                               | mobile_number                    | mobile_number                    |                   |              |                     32
 legal_unit_current_year                 | Legal Unit - Current Year                         | public             | import_legal_unit_era                       | Import legal units with validity period set to current year                               | fax_number                       | fax_number                       |                   |              |                     33
 legal_unit_current_year                 | Legal Unit - Current Year                         | public             | import_legal_unit_era                       | Import legal units with validity period set to current year                               | primary_activity_category_code   | primary_activity_category_code   |                   |              |                     34
 legal_unit_current_year                 | Legal Unit - Current Year                         | public             | import_legal_unit_era                       | Import legal units with validity period set to current year                               | secondary_activity_category_code | secondary_activity_category_code |                   |              |                     35
 legal_unit_current_year                 | Legal Unit - Current Year                         | public             | import_legal_unit_era                       | Import legal units with validity period set to current year                               | sector_code                      | sector_code                      |                   |              |                     36
 legal_unit_current_year                 | Legal Unit - Current Year                         | public             | import_legal_unit_era                       | Import legal units with validity period set to current year                               | status_code                      | status_code                      |                   |              |                     37
 legal_unit_current_year                 | Legal Unit - Current Year                         | public             | import_legal_unit_era                       | Import legal units with validity period set to current year                               | data_source_code                 | data_source_code                 |                   |              |                     38
 legal_unit_current_year                 | Legal Unit - Current Year                         | public             | import_legal_unit_era                       | Import legal units with validity period set to current year                               | legal_form_code                  | legal_form_code                  |                   |              |                     39
 legal_unit_current_year                 | Legal Unit - Current Year                         | public             | import_legal_unit_era                       | Import legal units with validity period set to current year                               | employees                        | employees                        |                   |              |                     40
 legal_unit_current_year                 | Legal Unit - Current Year                         | public             | import_legal_unit_era                       | Import legal units with validity period set to current year                               | turnover                         | turnover                         |                   |              |                     41
 legal_unit_current_year                 | Legal Unit - Current Year                         | public             | import_legal_unit_era                       | Import legal units with validity period set to current year                               | tag_path                         | tag_path                         |                   |              |                     42
 legal_unit_current_year                 | Legal Unit - Current Year                         | public             | import_legal_unit_era                       | Import legal units with validity period set to current year                               |                                  | valid_to                         | default           |              |                       
 legal_unit_current_year                 | Legal Unit - Current Year                         | public             | import_legal_unit_era                       | Import legal units with validity period set to current year                               |                                  | valid_from                       | default           |              |                       
 legal_unit_explicit_dates               | Legal Unit - Explicit Dates                       | public             | import_legal_unit_era                       | Import legal units with explicit valid_from and valid_to columns                          | valid_from                       | valid_from                       |                   |              |                      1
 legal_unit_explicit_dates               | Legal Unit - Explicit Dates                       | public             | import_legal_unit_era                       | Import legal units with explicit valid_from and valid_to columns                          | valid_to                         | valid_to                         |                   |              |                      2
 legal_unit_explicit_dates               | Legal Unit - Explicit Dates                       | public             | import_legal_unit_era                       | Import legal units with explicit valid_from and valid_to columns                          | tax_ident                        | tax_ident                        |                   |              |                      3
 legal_unit_explicit_dates               | Legal Unit - Explicit Dates                       | public             | import_legal_unit_era                       | Import legal units with explicit valid_from and valid_to columns                          | stat_ident                       | stat_ident                       |                   |              |                      4
 legal_unit_explicit_dates               | Legal Unit - Explicit Dates                       | public             | import_legal_unit_era                       | Import legal units with explicit valid_from and valid_to columns                          | name                             | name                             |                   |              |                      5
 legal_unit_explicit_dates               | Legal Unit - Explicit Dates                       | public             | import_legal_unit_era                       | Import legal units with explicit valid_from and valid_to columns                          | birth_date                       | birth_date                       |                   |              |                      6
 legal_unit_explicit_dates               | Legal Unit - Explicit Dates                       | public             | import_legal_unit_era                       | Import legal units with explicit valid_from and valid_to columns                          | death_date                       | death_date                       |                   |              |                      7
 legal_unit_explicit_dates               | Legal Unit - Explicit Dates                       | public             | import_legal_unit_era                       | Import legal units with explicit valid_from and valid_to columns                          | physical_address_part1           | physical_address_part1           |                   |              |                      8
 legal_unit_explicit_dates               | Legal Unit - Explicit Dates                       | public             | import_legal_unit_era                       | Import legal units with explicit valid_from and valid_to columns                          | physical_address_part2           | physical_address_part2           |                   |              |                      9
 legal_unit_explicit_dates               | Legal Unit - Explicit Dates                       | public             | import_legal_unit_era                       | Import legal units with explicit valid_from and valid_to columns                          | physical_address_part3           | physical_address_part3           |                   |              |                     10
 legal_unit_explicit_dates               | Legal Unit - Explicit Dates                       | public             | import_legal_unit_era                       | Import legal units with explicit valid_from and valid_to columns                          | physical_postcode                | physical_postcode                |                   |              |                     11
 legal_unit_explicit_dates               | Legal Unit - Explicit Dates                       | public             | import_legal_unit_era                       | Import legal units with explicit valid_from and valid_to columns                          | physical_postplace               | physical_postplace               |                   |              |                     12
 legal_unit_explicit_dates               | Legal Unit - Explicit Dates                       | public             | import_legal_unit_era                       | Import legal units with explicit valid_from and valid_to columns                          | physical_latitude                | physical_latitude                |                   |              |                     13
 legal_unit_explicit_dates               | Legal Unit - Explicit Dates                       | public             | import_legal_unit_era                       | Import legal units with explicit valid_from and valid_to columns                          | physical_longitude               | physical_longitude               |                   |              |                     14
 legal_unit_explicit_dates               | Legal Unit - Explicit Dates                       | public             | import_legal_unit_era                       | Import legal units with explicit valid_from and valid_to columns                          | physical_altitude                | physical_altitude                |                   |              |                     15
 legal_unit_explicit_dates               | Legal Unit - Explicit Dates                       | public             | import_legal_unit_era                       | Import legal units with explicit valid_from and valid_to columns                          | physical_region_code             | physical_region_code             |                   |              |                     16
 legal_unit_explicit_dates               | Legal Unit - Explicit Dates                       | public             | import_legal_unit_era                       | Import legal units with explicit valid_from and valid_to columns                          | physical_region_path             | physical_region_path             |                   |              |                     17
 legal_unit_explicit_dates               | Legal Unit - Explicit Dates                       | public             | import_legal_unit_era                       | Import legal units with explicit valid_from and valid_to columns                          | physical_country_iso_2           | physical_country_iso_2           |                   |              |                     18
 legal_unit_explicit_dates               | Legal Unit - Explicit Dates                       | public             | import_legal_unit_era                       | Import legal units with explicit valid_from and valid_to columns                          | postal_address_part1             | postal_address_part1             |                   |              |                     19
 legal_unit_explicit_dates               | Legal Unit - Explicit Dates                       | public             | import_legal_unit_era                       | Import legal units with explicit valid_from and valid_to columns                          | postal_address_part2             | postal_address_part2             |                   |              |                     20
 legal_unit_explicit_dates               | Legal Unit - Explicit Dates                       | public             | import_legal_unit_era                       | Import legal units with explicit valid_from and valid_to columns                          | postal_address_part3             | postal_address_part3             |                   |              |                     21
 legal_unit_explicit_dates               | Legal Unit - Explicit Dates                       | public             | import_legal_unit_era                       | Import legal units with explicit valid_from and valid_to columns                          | postal_postcode                  | postal_postcode                  |                   |              |                     22
 legal_unit_explicit_dates               | Legal Unit - Explicit Dates                       | public             | import_legal_unit_era                       | Import legal units with explicit valid_from and valid_to columns                          | postal_postplace                 | postal_postplace                 |                   |              |                     23
 legal_unit_explicit_dates               | Legal Unit - Explicit Dates                       | public             | import_legal_unit_era                       | Import legal units with explicit valid_from and valid_to columns                          | postal_latitude                  | postal_latitude                  |                   |              |                     24
 legal_unit_explicit_dates               | Legal Unit - Explicit Dates                       | public             | import_legal_unit_era                       | Import legal units with explicit valid_from and valid_to columns                          | postal_longitude                 | postal_longitude                 |                   |              |                     25
 legal_unit_explicit_dates               | Legal Unit - Explicit Dates                       | public             | import_legal_unit_era                       | Import legal units with explicit valid_from and valid_to columns                          | postal_altitude                  | postal_altitude                  |                   |              |                     26
 legal_unit_explicit_dates               | Legal Unit - Explicit Dates                       | public             | import_legal_unit_era                       | Import legal units with explicit valid_from and valid_to columns                          | postal_region_code               | postal_region_code               |                   |              |                     27
 legal_unit_explicit_dates               | Legal Unit - Explicit Dates                       | public             | import_legal_unit_era                       | Import legal units with explicit valid_from and valid_to columns                          | postal_region_path               | postal_region_path               |                   |              |                     28
 legal_unit_explicit_dates               | Legal Unit - Explicit Dates                       | public             | import_legal_unit_era                       | Import legal units with explicit valid_from and valid_to columns                          | postal_country_iso_2             | postal_country_iso_2             |                   |              |                     29
 legal_unit_explicit_dates               | Legal Unit - Explicit Dates                       | public             | import_legal_unit_era                       | Import legal units with explicit valid_from and valid_to columns                          | web_address                      | web_address                      |                   |              |                     30
 legal_unit_explicit_dates               | Legal Unit - Explicit Dates                       | public             | import_legal_unit_era                       | Import legal units with explicit valid_from and valid_to columns                          | email_address                    | email_address                    |                   |              |                     31
 legal_unit_explicit_dates               | Legal Unit - Explicit Dates                       | public             | import_legal_unit_era                       | Import legal units with explicit valid_from and valid_to columns                          | phone_number                     | phone_number                     |                   |              |                     32
 legal_unit_explicit_dates               | Legal Unit - Explicit Dates                       | public             | import_legal_unit_era                       | Import legal units with explicit valid_from and valid_to columns                          | landline                         | landline                         |                   |              |                     33
 legal_unit_explicit_dates               | Legal Unit - Explicit Dates                       | public             | import_legal_unit_era                       | Import legal units with explicit valid_from and valid_to columns                          | mobile_number                    | mobile_number                    |                   |              |                     34
 legal_unit_explicit_dates               | Legal Unit - Explicit Dates                       | public             | import_legal_unit_era                       | Import legal units with explicit valid_from and valid_to columns                          | fax_number                       | fax_number                       |                   |              |                     35
 legal_unit_explicit_dates               | Legal Unit - Explicit Dates                       | public             | import_legal_unit_era                       | Import legal units with explicit valid_from and valid_to columns                          | primary_activity_category_code   | primary_activity_category_code   |                   |              |                     36
 legal_unit_explicit_dates               | Legal Unit - Explicit Dates                       | public             | import_legal_unit_era                       | Import legal units with explicit valid_from and valid_to columns                          | secondary_activity_category_code | secondary_activity_category_code |                   |              |                     37
 legal_unit_explicit_dates               | Legal Unit - Explicit Dates                       | public             | import_legal_unit_era                       | Import legal units with explicit valid_from and valid_to columns                          | sector_code                      | sector_code                      |                   |              |                     38
 legal_unit_explicit_dates               | Legal Unit - Explicit Dates                       | public             | import_legal_unit_era                       | Import legal units with explicit valid_from and valid_to columns                          | status_code                      | status_code                      |                   |              |                     39
 legal_unit_explicit_dates               | Legal Unit - Explicit Dates                       | public             | import_legal_unit_era                       | Import legal units with explicit valid_from and valid_to columns                          | data_source_code                 | data_source_code                 |                   |              |                     40
 legal_unit_explicit_dates               | Legal Unit - Explicit Dates                       | public             | import_legal_unit_era                       | Import legal units with explicit valid_from and valid_to columns                          | legal_form_code                  | legal_form_code                  |                   |              |                     41
 legal_unit_explicit_dates               | Legal Unit - Explicit Dates                       | public             | import_legal_unit_era                       | Import legal units with explicit valid_from and valid_to columns                          | employees                        | employees                        |                   |              |                     42
 legal_unit_explicit_dates               | Legal Unit - Explicit Dates                       | public             | import_legal_unit_era                       | Import legal units with explicit valid_from and valid_to columns                          | turnover                         | turnover                         |                   |              |                     43
 legal_unit_explicit_dates               | Legal Unit - Explicit Dates                       | public             | import_legal_unit_era                       | Import legal units with explicit valid_from and valid_to columns                          | tag_path                         | tag_path                         |                   |              |                     44
(262 rows)

CALL test.set_user_from_email('test.super@statbus.org');
-- Pretend the user has clicked and created an import definition.
WITH it AS (
    SELECT * FROM public.import_target
    WHERE schema_name = 'public'
      AND table_name = 'import_legal_unit_era'
), def AS (
    INSERT INTO public.import_definition
        ( target_id
        , slug
        , name
        , note
        )
    SELECT it.id
        , 'brreg_hovedenhet'
        , 'Import of BRREG Hovedenhet'
        , 'Easy upload of the CSV file found at brreg.'
    FROM it
    RETURNING *
), raw_mapping(source_column_name, source_expression, target_column_name) AS (
VALUES
      (NULL, 'default'::public.import_source_expression, 'valid_from')
      , (NULL, 'default'::public.import_source_expression, 'valid_to')
    , ('organisasjonsnummer', NULL, 'tax_ident')
    , ('navn', NULL, 'name')
    , ('organisasjonsform.kode', NULL, 'legal_form_code')
    , ('organisasjonsform.beskrivelse', NULL, NULL)
    , ('naeringskode1.kode', NULL, 'primary_activity_category_code')
    , ('naeringskode1.beskrivelse', NULL, NULL)
    , ('naeringskode2.kode', NULL, 'secondary_activity_category_code')
    , ('naeringskode2.beskrivelse', NULL, NULL)
    , ('naeringskode3.kode', NULL, NULL)
    , ('naeringskode3.beskrivelse', NULL, NULL)
    , ('hjelpeenhetskode.kode', NULL, NULL)
    , ('hjelpeenhetskode.beskrivelse', NULL, NULL)
    , ('harRegistrertAntallAnsatte', NULL, NULL)
    , ('antallAnsatte', NULL, NULL)
    , ('hjemmeside', NULL, NULL)
    , ('postadresse.adresse', NULL, 'postal_address_part1')
    , ('postadresse.poststed', NULL, 'postal_postplace')
    , ('postadresse.postnummer', NULL, 'postal_postcode')
    , ('postadresse.kommune', NULL, NULL)
    , ('postadresse.kommunenummer', NULL, 'postal_region_code')
    , ('postadresse.land', NULL, NULL)
    , ('postadresse.landkode', NULL, 'postal_country_iso_2')
    , ('forretningsadresse.adresse', NULL, 'physical_address_part1')
    , ('forretningsadresse.poststed', NULL, 'physical_postplace')
    , ('forretningsadresse.postnummer', NULL, 'physical_postcode')
    , ('forretningsadresse.kommune', NULL, NULL)
    , ('forretningsadresse.kommunenummer', NULL, 'physical_region_code')
    , ('forretningsadresse.land', NULL, NULL)
    , ('forretningsadresse.landkode', NULL, 'physical_country_iso_2')
    , ('institusjonellSektorkode.kode', NULL, 'sector_code')
    , ('institusjonellSektorkode.beskrivelse', NULL, NULL)
    , ('sisteInnsendteAarsregnskap', NULL, NULL)
    , ('registreringsdatoenhetsregisteret', NULL, NULL)
    , ('stiftelsesdato', NULL, 'birth_date')
    , ('registrertIMvaRegisteret', NULL, NULL)
    , ('frivilligMvaRegistrertBeskrivelser', NULL, NULL)
    , ('registrertIFrivillighetsregisteret', NULL, NULL)
    , ('registrertIForetaksregisteret', NULL, NULL)
    , ('registrertIStiftelsesregisteret', NULL, NULL)
    , ('konkurs', NULL, NULL)
    , ('konkursdato', NULL, NULL)
    , ('underAvvikling', NULL, NULL)
    , ('underAvviklingDato', NULL, NULL)
    , ('underTvangsavviklingEllerTvangsopplosning', NULL, NULL)
    , ('tvangsopplostPgaManglendeDagligLederDato', NULL, NULL)
    , ('tvangsopplostPgaManglendeRevisorDato', NULL, NULL)
    , ('tvangsopplostPgaManglendeRegnskapDato', NULL, NULL)
    , ('tvangsopplostPgaMangelfulltStyreDato', NULL, NULL)
    , ('tvangsavvikletPgaManglendeSlettingDato', NULL, NULL)
    , ('overordnetEnhet', NULL, NULL)
    , ('maalform', NULL, NULL)
    , ('vedtektsdato', NULL, NULL)
    , ('vedtektsfestetFormaal', NULL, NULL)
    , ('aktivitet', NULL, NULL)
), name_mapping AS (
    SELECT
        ROW_NUMBER() OVER (ORDER BY (SELECT NULL)) as priority,
        source_column_name,
        source_expression,
        target_column_name
    FROM raw_mapping
), inserted_source_column AS (
    INSERT INTO public.import_source_column (definition_id,column_name, priority)
    SELECT def.id, name_mapping.source_column_name, name_mapping.priority
    FROM def, name_mapping
    WHERE source_column_name IS NOT NULL
    ORDER BY priority
   RETURNING *
), mapping AS (
    SELECT def.id
         , isc.id
         , nm.source_expression
         , itc.id
    FROM def
       , name_mapping AS nm
       LEFT JOIN inserted_source_column AS isc
         ON isc.column_name = nm.source_column_name
       LEFT JOIN public.import_target_column AS itc
       ON itc.column_name = nm.target_column_name
       WHERE itc.target_id IS NULL OR itc.target_id = def.target_id
), mapped AS (
  INSERT INTO public.import_mapping
      ( definition_id
      , source_column_id
      , source_expression
      , target_column_id
      )
      SELECT * FROM mapping
  RETURNING *
)
--SELECT * FROM mapped;
SELECT d.slug as definition_slug,
       sc.column_name as source_column,
       m.source_value,
       m.source_expression,
       sc.priority AS source_column_priority,
       tc.column_name AS target_column
FROM mapped m
LEFT JOIN def d ON d.id = m.definition_id
LEFT JOIN inserted_source_column sc ON sc.id = m.source_column_id
LEFT JOIN public.import_target_column tc ON tc.id = m.target_column_id
ORDER BY source_column_priority, target_column;
 definition_slug  |               source_column               | source_value | source_expression | source_column_priority |          target_column           
------------------+-------------------------------------------+--------------+-------------------+------------------------+----------------------------------
 brreg_hovedenhet | organisasjonsnummer                       |              |                   |                      3 | tax_ident
 brreg_hovedenhet | navn                                      |              |                   |                      4 | name
 brreg_hovedenhet | organisasjonsform.kode                    |              |                   |                      5 | legal_form_code
 brreg_hovedenhet | organisasjonsform.beskrivelse             |              |                   |                      6 | 
 brreg_hovedenhet | naeringskode1.kode                        |              |                   |                      7 | primary_activity_category_code
 brreg_hovedenhet | naeringskode1.beskrivelse                 |              |                   |                      8 | 
 brreg_hovedenhet | naeringskode2.kode                        |              |                   |                      9 | secondary_activity_category_code
 brreg_hovedenhet | naeringskode2.beskrivelse                 |              |                   |                     10 | 
 brreg_hovedenhet | naeringskode3.kode                        |              |                   |                     11 | 
 brreg_hovedenhet | naeringskode3.beskrivelse                 |              |                   |                     12 | 
 brreg_hovedenhet | hjelpeenhetskode.kode                     |              |                   |                     13 | 
 brreg_hovedenhet | hjelpeenhetskode.beskrivelse              |              |                   |                     14 | 
 brreg_hovedenhet | harRegistrertAntallAnsatte                |              |                   |                     15 | 
 brreg_hovedenhet | antallAnsatte                             |              |                   |                     16 | 
 brreg_hovedenhet | hjemmeside                                |              |                   |                     17 | 
 brreg_hovedenhet | postadresse.adresse                       |              |                   |                     18 | postal_address_part1
 brreg_hovedenhet | postadresse.poststed                      |              |                   |                     19 | postal_postplace
 brreg_hovedenhet | postadresse.postnummer                    |              |                   |                     20 | postal_postcode
 brreg_hovedenhet | postadresse.kommune                       |              |                   |                     21 | 
 brreg_hovedenhet | postadresse.kommunenummer                 |              |                   |                     22 | postal_region_code
 brreg_hovedenhet | postadresse.land                          |              |                   |                     23 | 
 brreg_hovedenhet | postadresse.landkode                      |              |                   |                     24 | postal_country_iso_2
 brreg_hovedenhet | forretningsadresse.adresse                |              |                   |                     25 | physical_address_part1
 brreg_hovedenhet | forretningsadresse.poststed               |              |                   |                     26 | physical_postplace
 brreg_hovedenhet | forretningsadresse.postnummer             |              |                   |                     27 | physical_postcode
 brreg_hovedenhet | forretningsadresse.kommune                |              |                   |                     28 | 
 brreg_hovedenhet | forretningsadresse.kommunenummer          |              |                   |                     29 | physical_region_code
 brreg_hovedenhet | forretningsadresse.land                   |              |                   |                     30 | 
 brreg_hovedenhet | forretningsadresse.landkode               |              |                   |                     31 | physical_country_iso_2
 brreg_hovedenhet | institusjonellSektorkode.kode             |              |                   |                     32 | sector_code
 brreg_hovedenhet | institusjonellSektorkode.beskrivelse      |              |                   |                     33 | 
 brreg_hovedenhet | sisteInnsendteAarsregnskap                |              |                   |                     34 | 
 brreg_hovedenhet | registreringsdatoenhetsregisteret         |              |                   |                     35 | 
 brreg_hovedenhet | stiftelsesdato                            |              |                   |                     36 | birth_date
 brreg_hovedenhet | registrertIMvaRegisteret                  |              |                   |                     37 | 
 brreg_hovedenhet | frivilligMvaRegistrertBeskrivelser        |              |                   |                     38 | 
 brreg_hovedenhet | registrertIFrivillighetsregisteret        |              |                   |                     39 | 
 brreg_hovedenhet | registrertIForetaksregisteret             |              |                   |                     40 | 
 brreg_hovedenhet | registrertIStiftelsesregisteret           |              |                   |                     41 | 
 brreg_hovedenhet | konkurs                                   |              |                   |                     42 | 
 brreg_hovedenhet | konkursdato                               |              |                   |                     43 | 
 brreg_hovedenhet | underAvvikling                            |              |                   |                     44 | 
 brreg_hovedenhet | underAvviklingDato                        |              |                   |                     45 | 
 brreg_hovedenhet | underTvangsavviklingEllerTvangsopplosning |              |                   |                     46 | 
 brreg_hovedenhet | tvangsopplostPgaManglendeDagligLederDato  |              |                   |                     47 | 
 brreg_hovedenhet | tvangsopplostPgaManglendeRevisorDato      |              |                   |                     48 | 
 brreg_hovedenhet | tvangsopplostPgaManglendeRegnskapDato     |              |                   |                     49 | 
 brreg_hovedenhet | tvangsopplostPgaMangelfulltStyreDato      |              |                   |                     50 | 
 brreg_hovedenhet | tvangsavvikletPgaManglendeSlettingDato    |              |                   |                     51 | 
 brreg_hovedenhet | overordnetEnhet                           |              |                   |                     52 | 
 brreg_hovedenhet | maalform                                  |              |                   |                     53 | 
 brreg_hovedenhet | vedtektsdato                              |              |                   |                     54 | 
 brreg_hovedenhet | vedtektsfestetFormaal                     |              |                   |                     55 | 
 brreg_hovedenhet | aktivitet                                 |              |                   |                     56 | 
 brreg_hovedenhet |                                           |              | default           |                        | valid_from
 brreg_hovedenhet |                                           |              | default           |                        | valid_to
(56 rows)

SELECT d.slug,
       d.name,
       t.table_name as target_table,
       d.note,
       ds.code as data_source,
       d.time_context_ident,
       d.draft,
       d.valid,
       d.validation_error
FROM public.import_definition d
JOIN public.import_target t ON t.id = d.target_id
LEFT JOIN public.data_source ds ON ds.id = d.data_source_id
WHERE d.slug = 'brreg_hovedenhet';
       slug       |            name            |     target_table      |                    note                     | data_source | time_context_ident | draft | valid | validation_error 
------------------+----------------------------+-----------------------+---------------------------------------------+-------------+--------------------+-------+-------+------------------
 brreg_hovedenhet | Import of BRREG Hovedenhet | import_legal_unit_era | Easy upload of the CSV file found at brreg. |             |                    | t     | f     | 
(1 row)

UPDATE public.import_definition
SET draft = false
WHERE draft
  AND slug = 'brreg_hovedenhet';
SELECT d.slug,
       d.name,
       t.table_name as target_table,
       d.note,
       ds.code as data_source,
       d.time_context_ident,
       d.draft,
       d.valid,
       d.validation_error
FROM public.import_definition d
JOIN public.import_target t ON t.id = d.target_id
LEFT JOIN public.data_source ds ON ds.id = d.data_source_id
WHERE d.slug = 'brreg_hovedenhet';
       slug       |            name            |     target_table      |                    note                     | data_source | time_context_ident | draft | valid | validation_error 
------------------+----------------------------+-----------------------+---------------------------------------------+-------------+--------------------+-------+-------+------------------
 brreg_hovedenhet | Import of BRREG Hovedenhet | import_legal_unit_era | Easy upload of the CSV file found at brreg. |             |                    | f     | t     | 
(1 row)

WITH def AS (SELECT id FROM public.import_definition where slug = 'brreg_hovedenhet')
INSERT INTO public.import_job (definition_id,slug,default_valid_from,default_valid_to,description,note)
SELECT  def.id, 'import_job_2015', '2015-01-01'::DATE, 'infinity'::DATE, 'Import Job for BRREG Hovedenhet', 'This job handles the import of BRREG Hovedenhet data.'
FROM def RETURNING slug, description, note, default_valid_from, default_valid_to, upload_table_name, data_table_name, import_information_snapshot_table_name, status;
      slug       |           description           |                         note                          | default_valid_from | default_valid_to |   upload_table_name    |   data_table_name    | import_information_snapshot_table_name |       status       
-----------------+---------------------------------+-------------------------------------------------------+--------------------+------------------+------------------------+----------------------+----------------------------------------+--------------------
 import_job_2015 | Import Job for BRREG Hovedenhet | This job handles the import of BRREG Hovedenhet data. | 01-01-2015         | infinity         | import_job_2015_upload | import_job_2015_data | import_job_2015_import_information     | waiting_for_upload
(1 row)

WITH def AS (SELECT id FROM public.import_definition where slug = 'brreg_hovedenhet')
INSERT INTO public.import_job (definition_id,slug,default_valid_from,default_valid_to,description,note)
SELECT  def.id, 'import_job_2016', '2016-01-01'::DATE, 'infinity'::DATE, 'Import Job for BRREG Hovedenhet', 'This job handles the import of BRREG Hovedenhet data.'
FROM def RETURNING slug, description, note, default_valid_from, default_valid_to, upload_table_name, data_table_name, import_information_snapshot_table_name, status;
      slug       |           description           |                         note                          | default_valid_from | default_valid_to |   upload_table_name    |   data_table_name    | import_information_snapshot_table_name |       status       
-----------------+---------------------------------+-------------------------------------------------------+--------------------+------------------+------------------------+----------------------+----------------------------------------+--------------------
 import_job_2016 | Import Job for BRREG Hovedenhet | This job handles the import of BRREG Hovedenhet data. | 01-01-2016         | infinity         | import_job_2016_upload | import_job_2016_data | import_job_2016_import_information     | waiting_for_upload
(1 row)

WITH def AS (SELECT id FROM public.import_definition where slug = 'brreg_hovedenhet')
INSERT INTO public.import_job (definition_id,slug,default_valid_from,default_valid_to,description,note)
SELECT  def.id, 'import_job_2017', '2017-01-01'::DATE, 'infinity'::DATE, 'Import Job for BRREG Hovedenhet', 'This job handles the import of BRREG Hovedenhet data.'
FROM def RETURNING slug, description, note, default_valid_from, default_valid_to, upload_table_name, data_table_name, import_information_snapshot_table_name, status;
      slug       |           description           |                         note                          | default_valid_from | default_valid_to |   upload_table_name    |   data_table_name    | import_information_snapshot_table_name |       status       
-----------------+---------------------------------+-------------------------------------------------------+--------------------+------------------+------------------------+----------------------+----------------------------------------+--------------------
 import_job_2017 | Import Job for BRREG Hovedenhet | This job handles the import of BRREG Hovedenhet data. | 01-01-2017         | infinity         | import_job_2017_upload | import_job_2017_data | import_job_2017_import_information     | waiting_for_upload
(1 row)

WITH def AS (SELECT id FROM public.import_definition where slug = 'brreg_hovedenhet')
INSERT INTO public.import_job (definition_id,slug,default_valid_from,default_valid_to,description,note)
SELECT  def.id, 'import_job_2018', '2018-01-01'::DATE, 'infinity'::DATE, 'Import Job for BRREG Hovedenhet', 'This job handles the import of BRREG Hovedenhet data.'
FROM def RETURNING slug, description, note, default_valid_from, default_valid_to, upload_table_name, data_table_name, import_information_snapshot_table_name, status;
      slug       |           description           |                         note                          | default_valid_from | default_valid_to |   upload_table_name    |   data_table_name    | import_information_snapshot_table_name |       status       
-----------------+---------------------------------+-------------------------------------------------------+--------------------+------------------+------------------------+----------------------+----------------------------------------+--------------------
 import_job_2018 | Import Job for BRREG Hovedenhet | This job handles the import of BRREG Hovedenhet data. | 01-01-2018         | infinity         | import_job_2018_upload | import_job_2018_data | import_job_2018_import_information     | waiting_for_upload
(1 row)

-- Verify that snapshot tables were created
SELECT slug, import_information_snapshot_table_name
FROM public.import_job
ORDER BY id;
      slug       | import_information_snapshot_table_name 
-----------------+----------------------------------------
 import_job_2015 | import_job_2015_import_information
 import_job_2016 | import_job_2016_import_information
 import_job_2017 | import_job_2017_import_information
 import_job_2018 | import_job_2018_import_information
(4 rows)

-- Verify that the snapshot tables exist in the database
SELECT ij.slug, ij.import_information_snapshot_table_name,
       CASE WHEN EXISTS (
           SELECT 1 FROM pg_tables
           WHERE schemaname = 'public' AND tablename = ij.import_information_snapshot_table_name
       ) THEN 'exists' ELSE 'missing' END AS table_status
FROM public.import_job ij
ORDER BY ij.id;
      slug       | import_information_snapshot_table_name | table_status 
-----------------+----------------------------------------+--------------
 import_job_2015 | import_job_2015_import_information     | exists
 import_job_2016 | import_job_2016_import_information     | exists
 import_job_2017 | import_job_2017_import_information     | exists
 import_job_2018 | import_job_2018_import_information     | exists
(4 rows)

\echo Verify the concrete tables of one import job
Verify the concrete tables of one import job
\d public.import_job_2015_upload
                  Unlogged table "public.import_job_2015_upload"
                  Column                   | Type | Collation | Nullable | Default 
-------------------------------------------+------+-----------+----------+---------
 organisasjonsnummer                       | text |           |          | 
 navn                                      | text |           |          | 
 organisasjonsform.kode                    | text |           |          | 
 organisasjonsform.beskrivelse             | text |           |          | 
 naeringskode1.kode                        | text |           |          | 
 naeringskode1.beskrivelse                 | text |           |          | 
 naeringskode2.kode                        | text |           |          | 
 naeringskode2.beskrivelse                 | text |           |          | 
 naeringskode3.kode                        | text |           |          | 
 naeringskode3.beskrivelse                 | text |           |          | 
 hjelpeenhetskode.kode                     | text |           |          | 
 hjelpeenhetskode.beskrivelse              | text |           |          | 
 harRegistrertAntallAnsatte                | text |           |          | 
 antallAnsatte                             | text |           |          | 
 hjemmeside                                | text |           |          | 
 postadresse.adresse                       | text |           |          | 
 postadresse.poststed                      | text |           |          | 
 postadresse.postnummer                    | text |           |          | 
 postadresse.kommune                       | text |           |          | 
 postadresse.kommunenummer                 | text |           |          | 
 postadresse.land                          | text |           |          | 
 postadresse.landkode                      | text |           |          | 
 forretningsadresse.adresse                | text |           |          | 
 forretningsadresse.poststed               | text |           |          | 
 forretningsadresse.postnummer             | text |           |          | 
 forretningsadresse.kommune                | text |           |          | 
 forretningsadresse.kommunenummer          | text |           |          | 
 forretningsadresse.land                   | text |           |          | 
 forretningsadresse.landkode               | text |           |          | 
 institusjonellSektorkode.kode             | text |           |          | 
 institusjonellSektorkode.beskrivelse      | text |           |          | 
 sisteInnsendteAarsregnskap                | text |           |          | 
 registreringsdatoenhetsregisteret         | text |           |          | 
 stiftelsesdato                            | text |           |          | 
 registrertIMvaRegisteret                  | text |           |          | 
 frivilligMvaRegistrertBeskrivelser        | text |           |          | 
 registrertIFrivillighetsregisteret        | text |           |          | 
 registrertIForetaksregisteret             | text |           |          | 
 registrertIStiftelsesregisteret           | text |           |          | 
 konkurs                                   | text |           |          | 
 konkursdato                               | text |           |          | 
 underAvvikling                            | text |           |          | 
 underAvviklingDato                        | text |           |          | 
 underTvangsavviklingEllerTvangsopplosning | text |           |          | 
 tvangsopplostPgaManglendeDagligLederDato  | text |           |          | 
 tvangsopplostPgaManglendeRevisorDato      | text |           |          | 
 tvangsopplostPgaManglendeRegnskapDato     | text |           |          | 
 tvangsopplostPgaMangelfulltStyreDato      | text |           |          | 
 tvangsavvikletPgaManglendeSlettingDato    | text |           |          | 
 overordnetEnhet                           | text |           |          | 
 maalform                                  | text |           |          | 
 vedtektsdato                              | text |           |          | 
 vedtektsfestetFormaal                     | text |           |          | 
 aktivitet                                 | text |           |          | 
Policies:
    POLICY "import_job_2015_upload_authenticated_read" FOR SELECT
      TO authenticated
      USING (true)
    POLICY "import_job_2015_upload_regular_user_manage"
      TO authenticated
      USING (auth.has_statbus_role(auth.uid(), 'regular_user'::statbus_role_type))
      WITH CHECK (auth.has_statbus_role(auth.uid(), 'regular_user'::statbus_role_type))
    POLICY "import_job_2015_upload_super_user_manage"
      TO authenticated
      USING (auth.has_statbus_role(auth.uid(), 'super_user'::statbus_role_type))
      WITH CHECK (auth.has_statbus_role(auth.uid(), 'super_user'::statbus_role_type))

\d public.import_job_2015_data
                               Unlogged table "public.import_job_2015_data"
              Column              |       Type       | Collation | Nullable |           Default           
----------------------------------+------------------+-----------+----------+-----------------------------
 tax_ident                        | text             |           |          | 
 name                             | text             |           |          | 
 legal_form_code                  | text             |           |          | 
 primary_activity_category_code   | text             |           |          | 
 secondary_activity_category_code | text             |           |          | 
 postal_address_part1             | text             |           |          | 
 postal_postplace                 | text             |           |          | 
 postal_postcode                  | text             |           |          | 
 postal_region_code               | text             |           |          | 
 postal_country_iso_2             | text             |           |          | 
 physical_address_part1           | text             |           |          | 
 physical_postplace               | text             |           |          | 
 physical_postcode                | text             |           |          | 
 physical_region_code             | text             |           |          | 
 physical_country_iso_2           | text             |           |          | 
 sector_code                      | text             |           |          | 
 birth_date                       | text             |           |          | 
 valid_from                       | text             |           |          | 
 valid_to                         | text             |           |          | 
 import_state                     | import_row_state |           | not null | 'pending'::import_row_state
Indexes:
    "import_job_2015_data_import_state_idx" btree (import_state)
    "import_job_2015_data_unique_key" UNIQUE CONSTRAINT, btree (tax_ident)
Policies:
    POLICY "import_job_2015_data_authenticated_read" FOR SELECT
      TO authenticated
      USING (true)
    POLICY "import_job_2015_data_regular_user_manage"
      TO authenticated
      USING (auth.has_statbus_role(auth.uid(), 'regular_user'::statbus_role_type))
      WITH CHECK (auth.has_statbus_role(auth.uid(), 'regular_user'::statbus_role_type))
    POLICY "import_job_2015_data_super_user_manage"
      TO authenticated
      USING (auth.has_statbus_role(auth.uid(), 'super_user'::statbus_role_type))
      WITH CHECK (auth.has_statbus_role(auth.uid(), 'super_user'::statbus_role_type))

\d public.import_job_2015_import_information
             Unlogged table "public.import_job_2015_import_information"
         Column         |           Type           | Collation | Nullable | Default 
------------------------+--------------------------+-----------+----------+---------
 job_id                 | integer                  |           |          | 
 definition_id          | integer                  |           |          | 
 import_job_slug        | character varying        |           |          | 
 import_definition_slug | text                     |           |          | 
 import_name            | text                     |           |          | 
 import_note            | text                     |           |          | 
 target_schema_name     | text                     |           |          | 
 upload_table_name      | text                     |           |          | 
 data_table_name        | text                     |           |          | 
 source_column          | text                     |           |          | 
 source_value           | text                     |           |          | 
 source_expression      | import_source_expression |           |          | 
 target_column          | text                     |           |          | 
 target_type            | text                     |           |          | 
 uniquely_identifying   | boolean                  |           |          | 
 source_column_priority | integer                  |           |          | 
Indexes:
    "import_job_2015_import_information_source_column_priority_idx" btree (source_column_priority)
Policies:
    POLICY "import_job_2015_import_information_authenticated_read" FOR SELECT
      TO authenticated
      USING (true)
    POLICY "import_job_2015_import_information_regular_user_read" FOR SELECT
      TO authenticated
      USING (auth.has_statbus_role(auth.uid(), 'regular_user'::statbus_role_type))
    POLICY "import_job_2015_import_information_super_user_manage"
      TO authenticated
      USING (auth.has_statbus_role(auth.uid(), 'super_user'::statbus_role_type))
      WITH CHECK (auth.has_statbus_role(auth.uid(), 'super_user'::statbus_role_type))

SELECT import_job_slug, import_definition_slug, import_name, import_note, target_schema_name, upload_table_name, data_table_name, source_column, source_value, source_expression, target_column, target_type, uniquely_identifying, source_column_priority
FROM public.import_job_2015_import_information;
 import_job_slug | import_definition_slug |        import_name         |                 import_note                 | target_schema_name |   upload_table_name    |   data_table_name    |               source_column               | source_value | source_expression |          target_column           | target_type | uniquely_identifying | source_column_priority 
-----------------+------------------------+----------------------------+---------------------------------------------+--------------------+------------------------+----------------------+-------------------------------------------+--------------+-------------------+----------------------------------+-------------+----------------------+------------------------
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | organisasjonsnummer                       |              |                   | tax_ident                        | text        | t                    |                      3
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | navn                                      |              |                   | name                             | text        | f                    |                      4
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | organisasjonsform.kode                    |              |                   | legal_form_code                  | text        | f                    |                      5
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | organisasjonsform.beskrivelse             |              |                   |                                  |             |                      |                      6
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | naeringskode1.kode                        |              |                   | primary_activity_category_code   | text        | f                    |                      7
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | naeringskode1.beskrivelse                 |              |                   |                                  |             |                      |                      8
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | naeringskode2.kode                        |              |                   | secondary_activity_category_code | text        | f                    |                      9
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | naeringskode2.beskrivelse                 |              |                   |                                  |             |                      |                     10
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | naeringskode3.kode                        |              |                   |                                  |             |                      |                     11
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | naeringskode3.beskrivelse                 |              |                   |                                  |             |                      |                     12
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | hjelpeenhetskode.kode                     |              |                   |                                  |             |                      |                     13
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | hjelpeenhetskode.beskrivelse              |              |                   |                                  |             |                      |                     14
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | harRegistrertAntallAnsatte                |              |                   |                                  |             |                      |                     15
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | antallAnsatte                             |              |                   |                                  |             |                      |                     16
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | hjemmeside                                |              |                   |                                  |             |                      |                     17
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | postadresse.adresse                       |              |                   | postal_address_part1             | text        | f                    |                     18
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | postadresse.poststed                      |              |                   | postal_postplace                 | text        | f                    |                     19
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | postadresse.postnummer                    |              |                   | postal_postcode                  | text        | f                    |                     20
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | postadresse.kommune                       |              |                   |                                  |             |                      |                     21
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | postadresse.kommunenummer                 |              |                   | postal_region_code               | text        | f                    |                     22
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | postadresse.land                          |              |                   |                                  |             |                      |                     23
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | postadresse.landkode                      |              |                   | postal_country_iso_2             | text        | f                    |                     24
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | forretningsadresse.adresse                |              |                   | physical_address_part1           | text        | f                    |                     25
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | forretningsadresse.poststed               |              |                   | physical_postplace               | text        | f                    |                     26
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | forretningsadresse.postnummer             |              |                   | physical_postcode                | text        | f                    |                     27
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | forretningsadresse.kommune                |              |                   |                                  |             |                      |                     28
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | forretningsadresse.kommunenummer          |              |                   | physical_region_code             | text        | f                    |                     29
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | forretningsadresse.land                   |              |                   |                                  |             |                      |                     30
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | forretningsadresse.landkode               |              |                   | physical_country_iso_2           | text        | f                    |                     31
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | institusjonellSektorkode.kode             |              |                   | sector_code                      | text        | f                    |                     32
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | institusjonellSektorkode.beskrivelse      |              |                   |                                  |             |                      |                     33
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | sisteInnsendteAarsregnskap                |              |                   |                                  |             |                      |                     34
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | registreringsdatoenhetsregisteret         |              |                   |                                  |             |                      |                     35
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | stiftelsesdato                            |              |                   | birth_date                       | text        | f                    |                     36
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | registrertIMvaRegisteret                  |              |                   |                                  |             |                      |                     37
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | frivilligMvaRegistrertBeskrivelser        |              |                   |                                  |             |                      |                     38
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | registrertIFrivillighetsregisteret        |              |                   |                                  |             |                      |                     39
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | registrertIForetaksregisteret             |              |                   |                                  |             |                      |                     40
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | registrertIStiftelsesregisteret           |              |                   |                                  |             |                      |                     41
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | konkurs                                   |              |                   |                                  |             |                      |                     42
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | konkursdato                               |              |                   |                                  |             |                      |                     43
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | underAvvikling                            |              |                   |                                  |             |                      |                     44
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | underAvviklingDato                        |              |                   |                                  |             |                      |                     45
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | underTvangsavviklingEllerTvangsopplosning |              |                   |                                  |             |                      |                     46
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | tvangsopplostPgaManglendeDagligLederDato  |              |                   |                                  |             |                      |                     47
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | tvangsopplostPgaManglendeRevisorDato      |              |                   |                                  |             |                      |                     48
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | tvangsopplostPgaManglendeRegnskapDato     |              |                   |                                  |             |                      |                     49
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | tvangsopplostPgaMangelfulltStyreDato      |              |                   |                                  |             |                      |                     50
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | tvangsavvikletPgaManglendeSlettingDato    |              |                   |                                  |             |                      |                     51
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | overordnetEnhet                           |              |                   |                                  |             |                      |                     52
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | maalform                                  |              |                   |                                  |             |                      |                     53
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | vedtektsdato                              |              |                   |                                  |             |                      |                     54
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | vedtektsfestetFormaal                     |              |                   |                                  |             |                      |                     55
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | aktivitet                                 |              |                   |                                  |             |                      |                     56
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data |                                           |              | default           | valid_from                       | text        | f                    |                       
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data |                                           |              | default           | valid_to                         | text        | f                    |                       
(56 rows)

\echo Review public.import_information for ensure it matches import_job_2015_import_information_snapshot
Review public.import_information for ensure it matches import_job_2015_import_information_snapshot
SELECT import_job_slug, import_definition_slug, import_name, import_note, target_schema_name, upload_table_name, data_table_name, source_column, source_value, source_expression, target_column, target_type, uniquely_identifying, source_column_priority
FROM public.import_information
WHERE import_job_slug = 'import_job_2015';
 import_job_slug | import_definition_slug |        import_name         |                 import_note                 | target_schema_name |   upload_table_name    |   data_table_name    |               source_column               | source_value | source_expression |          target_column           | target_type | uniquely_identifying | source_column_priority 
-----------------+------------------------+----------------------------+---------------------------------------------+--------------------+------------------------+----------------------+-------------------------------------------+--------------+-------------------+----------------------------------+-------------+----------------------+------------------------
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | organisasjonsnummer                       |              |                   | tax_ident                        | text        | t                    |                      3
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | navn                                      |              |                   | name                             | text        | f                    |                      4
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | organisasjonsform.kode                    |              |                   | legal_form_code                  | text        | f                    |                      5
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | organisasjonsform.beskrivelse             |              |                   |                                  |             |                      |                      6
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | naeringskode1.kode                        |              |                   | primary_activity_category_code   | text        | f                    |                      7
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | naeringskode1.beskrivelse                 |              |                   |                                  |             |                      |                      8
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | naeringskode2.kode                        |              |                   | secondary_activity_category_code | text        | f                    |                      9
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | naeringskode2.beskrivelse                 |              |                   |                                  |             |                      |                     10
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | naeringskode3.kode                        |              |                   |                                  |             |                      |                     11
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | naeringskode3.beskrivelse                 |              |                   |                                  |             |                      |                     12
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | hjelpeenhetskode.kode                     |              |                   |                                  |             |                      |                     13
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | hjelpeenhetskode.beskrivelse              |              |                   |                                  |             |                      |                     14
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | harRegistrertAntallAnsatte                |              |                   |                                  |             |                      |                     15
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | antallAnsatte                             |              |                   |                                  |             |                      |                     16
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | hjemmeside                                |              |                   |                                  |             |                      |                     17
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | postadresse.adresse                       |              |                   | postal_address_part1             | text        | f                    |                     18
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | postadresse.poststed                      |              |                   | postal_postplace                 | text        | f                    |                     19
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | postadresse.postnummer                    |              |                   | postal_postcode                  | text        | f                    |                     20
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | postadresse.kommune                       |              |                   |                                  |             |                      |                     21
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | postadresse.kommunenummer                 |              |                   | postal_region_code               | text        | f                    |                     22
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | postadresse.land                          |              |                   |                                  |             |                      |                     23
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | postadresse.landkode                      |              |                   | postal_country_iso_2             | text        | f                    |                     24
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | forretningsadresse.adresse                |              |                   | physical_address_part1           | text        | f                    |                     25
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | forretningsadresse.poststed               |              |                   | physical_postplace               | text        | f                    |                     26
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | forretningsadresse.postnummer             |              |                   | physical_postcode                | text        | f                    |                     27
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | forretningsadresse.kommune                |              |                   |                                  |             |                      |                     28
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | forretningsadresse.kommunenummer          |              |                   | physical_region_code             | text        | f                    |                     29
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | forretningsadresse.land                   |              |                   |                                  |             |                      |                     30
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | forretningsadresse.landkode               |              |                   | physical_country_iso_2           | text        | f                    |                     31
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | institusjonellSektorkode.kode             |              |                   | sector_code                      | text        | f                    |                     32
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | institusjonellSektorkode.beskrivelse      |              |                   |                                  |             |                      |                     33
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | sisteInnsendteAarsregnskap                |              |                   |                                  |             |                      |                     34
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | registreringsdatoenhetsregisteret         |              |                   |                                  |             |                      |                     35
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | stiftelsesdato                            |              |                   | birth_date                       | text        | f                    |                     36
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | registrertIMvaRegisteret                  |              |                   |                                  |             |                      |                     37
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | frivilligMvaRegistrertBeskrivelser        |              |                   |                                  |             |                      |                     38
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | registrertIFrivillighetsregisteret        |              |                   |                                  |             |                      |                     39
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | registrertIForetaksregisteret             |              |                   |                                  |             |                      |                     40
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | registrertIStiftelsesregisteret           |              |                   |                                  |             |                      |                     41
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | konkurs                                   |              |                   |                                  |             |                      |                     42
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | konkursdato                               |              |                   |                                  |             |                      |                     43
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | underAvvikling                            |              |                   |                                  |             |                      |                     44
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | underAvviklingDato                        |              |                   |                                  |             |                      |                     45
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | underTvangsavviklingEllerTvangsopplosning |              |                   |                                  |             |                      |                     46
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | tvangsopplostPgaManglendeDagligLederDato  |              |                   |                                  |             |                      |                     47
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | tvangsopplostPgaManglendeRevisorDato      |              |                   |                                  |             |                      |                     48
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | tvangsopplostPgaManglendeRegnskapDato     |              |                   |                                  |             |                      |                     49
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | tvangsopplostPgaMangelfulltStyreDato      |              |                   |                                  |             |                      |                     50
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | tvangsavvikletPgaManglendeSlettingDato    |              |                   |                                  |             |                      |                     51
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | overordnetEnhet                           |              |                   |                                  |             |                      |                     52
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | maalform                                  |              |                   |                                  |             |                      |                     53
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | vedtektsdato                              |              |                   |                                  |             |                      |                     54
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | vedtektsfestetFormaal                     |              |                   |                                  |             |                      |                     55
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data | aktivitet                                 |              |                   |                                  |             |                      |                     56
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data |                                           |              | default           | valid_from                       | text        | f                    |                       
 import_job_2015 | brreg_hovedenhet       | Import of BRREG Hovedenhet | Easy upload of the CSV file found at brreg. | public             | import_job_2015_upload | import_job_2015_data |                                           |              | default           | valid_to                         | text        | f                    |                       
(56 rows)

-- Disable RLS on import tables to support \copy
CALL public.disable_rls_on_table('public','import_job_2015_upload');
CALL public.disable_rls_on_table('public','import_job_2016_upload');
CALL public.disable_rls_on_table('public','import_job_2017_upload');
CALL public.disable_rls_on_table('public','import_job_2018_upload');
\echo "Setting up Statbus for Norway"
"Setting up Statbus for Norway"
\i samples/norway/getting-started.sql
\i samples/norway/activity_category/activity_category_norway.sql
INSERT INTO settings(activity_category_standard_id,only_one_setting)
SELECT id, true FROM activity_category_standard WHERE code = 'nace_v2.1'
ON CONFLICT (only_one_setting)
DO UPDATE SET
   activity_category_standard_id =(SELECT id FROM activity_category_standard WHERE code = 'nace_v2.1')
   WHERE settings.id = EXCLUDED.id;
;
\copy public.activity_category_available_custom FROM 'samples/norway/activity_category/activity_category_norway.csv' WITH (FORMAT csv, DELIMITER ',', QUOTE '"', HEADER true);
\i samples/norway/regions/norway-regions-2024.sql
\copy public.region_upload(path, name) FROM 'samples/norway/regions/norway-regions-2024.csv' WITH (FORMAT csv, DELIMITER ',', QUOTE '"', HEADER true);
\i samples/norway/sector/sector_norway.sql
\copy public.sector_custom_only FROM 'samples/norway/sector/sector_norway.csv' WITH (FORMAT csv, DELIMITER ',', QUOTE '"', HEADER true);
\i samples/norway/legal_form/legal_form_norway.sql
\copy public.legal_form_custom_only FROM 'samples/norway/legal_form/legal_form_norway.csv' WITH (FORMAT csv, DELIMITER ',', QUOTE '"', HEADER true);
-- Verify user context is set correctly for import jobs
\echo "Verifying user context for import jobs"
"Verifying user context for import jobs"
SELECT slug,
       (SELECT email FROM public.statbus_user_with_email_and_role WHERE id = user_id) AS user_email
FROM public.import_job
WHERE slug = 'import_job_2015';
      slug       |       user_email       
-----------------+------------------------
 import_job_2015 | test.super@statbus.org
(1 row)

\echo "Adding tags for insert into right part of history"
"Adding tags for insert into right part of history"
\i samples/norway/small-history/add-tags.sql
DO $$
DECLARE
    census_id integer;
BEGIN

    -- UPSERT root node "Census"
    INSERT INTO public.tag (path, name, description, type, context_valid_on, context_valid_from, context_valid_to, is_scoped_tag)
    VALUES ('census', 'Census', 'Census data collection', 'custom', NULL, NULL, NULL, false)
    ON CONFLICT (path) DO UPDATE
    SET name = EXCLUDED.name, description = EXCLUDED.description, type = EXCLUDED.type,
        context_valid_on = EXCLUDED.context_valid_on, context_valid_from = EXCLUDED.context_valid_from,
        context_valid_to = EXCLUDED.context_valid_to, is_scoped_tag = EXCLUDED.is_scoped_tag
    RETURNING id INTO census_id;

    -- UPSERT child nodes for each year under "Census"
    INSERT INTO public.tag (path, name, description, parent_id, type, context_valid_on, context_valid_from, context_valid_to, is_scoped_tag)
    VALUES
    ('census.2015', '2015', 'Census data for 2015', census_id, 'custom', '2015-12-31', '2015-01-01', 'infinity', false),
    ('census.2016', '2016', 'Census data for 2016', census_id, 'custom', '2016-12-31', '2016-01-01', 'infinity', false),
    ('census.2017', '2017', 'Census data for 2017', census_id, 'custom', '2017-12-31', '2017-01-01', 'infinity', false),
    ('census.2018', '2018', 'Census data for 2018', census_id, 'custom', '2018-12-31', '2018-01-01', 'infinity', false)
    ON CONFLICT (path) DO UPDATE
    SET name = EXCLUDED.name, description = EXCLUDED.description, parent_id = EXCLUDED.parent_id, type = EXCLUDED.type,
        context_valid_on = EXCLUDED.context_valid_on, context_valid_from = EXCLUDED.context_valid_from,
        context_valid_to = EXCLUDED.context_valid_to, is_scoped_tag = EXCLUDED.is_scoped_tag;

END $$;
\echo "Loading historical units"
"Loading historical units"
\copy public.import_job_2015_upload FROM 'samples/norway/small-history/2015-enheter.csv' WITH CSV HEADER;
UPDATE import_job SET status = 'upload_completed' WHERE slug = 'import_job_2015';
\copy public.import_job_2016_upload FROM 'samples/norway/small-history/2016-enheter.csv' WITH CSV HEADER;
UPDATE import_job SET status = 'upload_completed' WHERE slug = 'import_job_2016';
\copy public.import_job_2017_upload FROM 'samples/norway/small-history/2017-enheter.csv' WITH CSV HEADER;
UPDATE import_job SET status = 'upload_completed' WHERE slug = 'import_job_2017';
\copy public.import_job_2018_upload FROM 'samples/norway/small-history/2018-enheter.csv' WITH CSV HEADER;
UPDATE import_job SET status = 'upload_completed' WHERE slug = 'import_job_2018';
\echo Run worker processing to run import jobs and generate computed data
Run worker processing to run import jobs and generate computed data
SELECT success, count(*) FROM worker.process_tasks() GROUP BY success;
 success | count 
---------+-------
 t       |    27
(1 row)

\echo Getting statistical_units after upload
Getting statistical_units after upload
\x
SELECT valid_after
     , valid_from
     , valid_to
     , unit_type
     , external_idents
     , jsonb_pretty(
          public.remove_ephemeral_data_from_hierarchy(
          to_jsonb(statistical_unit.*)
          -'valid_after'
          -'valid_from'
          -'valid_to'
          -'unit_type'
          -'external_idents'
          -'stats'
          -'stats_summary'
          )
     ) AS statistical_unit_data
     , jsonb_pretty(stats) AS stats
     , jsonb_pretty(stats_summary) AS stats_summary
 FROM public.statistical_unit
 ORDER BY unit_type, unit_id, valid_from, valid_to;
-[ RECORD 1 ]---------+------------------------------------------------------------------------
valid_after           | 12-31-2014
valid_from            | 01-01-2015
valid_to              | 12-31-2015
unit_type             | legal_unit
external_idents       | {"tax_ident": "918420533"}
statistical_unit_data | {                                                                      +
                      |     "name": "BYGGMESTER RICHARD FOSSER MINGE AS",                      +
                      |     "search": "'as':5 'byggmester':1 'fosser':3 'minge':4 'richard':2",+
                      |     "landline": null,                                                  +
                      |     "tag_paths": [                                                     +
                      |     ],                                                                 +
                      |     "birth_date": "2014-01-01",                                        +
                      |     "death_date": null,                                                +
                      |     "fax_number": null,                                                +
                      |     "sector_code": "2100",                                             +
                      |     "sector_name": "Private aksjeselskaper mv.",                       +
                      |     "sector_path": "innl.a_ikke_fin.2100",                             +
                      |     "status_code": "active",                                           +
                      |     "web_address": null,                                               +
                      |     "phone_number": null,                                              +
                      |     "email_address": null,                                             +
                      |     "invalid_codes": null,                                             +
                      |     "mobile_number": null,                                             +
                      |     "has_legal_unit": true,                                            +
                      |     "legal_form_code": "AS",                                           +
                      |     "legal_form_name": "Aksjeselskap",                                 +
                      |     "postal_altitude": null,                                           +
                      |     "postal_latitude": null,                                           +
                      |     "postal_postcode": null,                                           +
                      |     "enterprise_count": null,                                          +
                      |     "legal_unit_count": null,                                          +
                      |     "postal_longitude": null,                                          +
                      |     "postal_postplace": null,                                          +
                      |     "data_source_codes": null,                                         +
                      |     "physical_altitude": null,                                         +
                      |     "physical_latitude": null,                                         +
                      |     "physical_postcode": "1406",                                       +
                      |     "physical_longitude": null,                                        +
                      |     "physical_postplace": "SKI",                                       +
                      |     "postal_region_code": null,                                        +
                      |     "postal_region_path": null,                                        +
                      |     "establishment_count": null,                                       +
                      |     "physical_region_code": "3207",                                    +
                      |     "physical_region_path": "32.07",                                   +
                      |     "postal_address_part1": null,                                      +
                      |     "postal_address_part2": null,                                      +
                      |     "postal_address_part3": null,                                      +
                      |     "postal_country_iso_2": null,                                      +
                      |     "physical_address_part1": "Måsaveien 42",                          +
                      |     "physical_address_part2": null,                                    +
                      |     "physical_address_part3": null,                                    +
                      |     "physical_country_iso_2": "NO",                                    +
                      |     "activity_category_paths": [                                       +
                      |         "F.41.2"                                                       +
                      |     ],                                                                 +
                      |     "include_unit_in_reports": true,                                   +
                      |     "primary_activity_category_code": "41.2",                          +
                      |     "primary_activity_category_path": "F.41.2",                        +
                      |     "secondary_activity_category_code": null,                          +
                      |     "secondary_activity_category_path": null                           +
                      | }
stats                 | {                                                                      +
                      | }
stats_summary         | {                                                                      +
                      | }
-[ RECORD 2 ]---------+------------------------------------------------------------------------
valid_after           | 12-31-2015
valid_from            | 01-01-2016
valid_to              | 12-31-2017
unit_type             | legal_unit
external_idents       | {"tax_ident": "918420533"}
statistical_unit_data | {                                                                      +
                      |     "name": "BYGGMESTER RICHARD FOSSER MINGE AS",                      +
                      |     "search": "'as':5 'byggmester':1 'fosser':3 'minge':4 'richard':2",+
                      |     "landline": null,                                                  +
                      |     "tag_paths": [                                                     +
                      |     ],                                                                 +
                      |     "birth_date": "2014-01-01",                                        +
                      |     "death_date": null,                                                +
                      |     "fax_number": null,                                                +
                      |     "sector_code": "8200",                                             +
                      |     "sector_name": "Personlig næringsdrivende",                        +
                      |     "sector_path": "innl.e_hush.8200",                                 +
                      |     "status_code": "active",                                           +
                      |     "web_address": null,                                               +
                      |     "phone_number": null,                                              +
                      |     "email_address": null,                                             +
                      |     "invalid_codes": null,                                             +
                      |     "mobile_number": null,                                             +
                      |     "has_legal_unit": true,                                            +
                      |     "legal_form_code": "AS",                                           +
                      |     "legal_form_name": "Aksjeselskap",                                 +
                      |     "postal_altitude": null,                                           +
                      |     "postal_latitude": null,                                           +
                      |     "postal_postcode": null,                                           +
                      |     "enterprise_count": null,                                          +
                      |     "legal_unit_count": null,                                          +
                      |     "postal_longitude": null,                                          +
                      |     "postal_postplace": null,                                          +
                      |     "data_source_codes": null,                                         +
                      |     "physical_altitude": null,                                         +
                      |     "physical_latitude": null,                                         +
                      |     "physical_postcode": "1406",                                       +
                      |     "physical_longitude": null,                                        +
                      |     "physical_postplace": "SKI",                                       +
                      |     "postal_region_code": null,                                        +
                      |     "postal_region_path": null,                                        +
                      |     "establishment_count": null,                                       +
                      |     "physical_region_code": "3207",                                    +
                      |     "physical_region_path": "32.07",                                   +
                      |     "postal_address_part1": null,                                      +
                      |     "postal_address_part2": null,                                      +
                      |     "postal_address_part3": null,                                      +
                      |     "postal_country_iso_2": null,                                      +
                      |     "physical_address_part1": "Måsaveien 42",                          +
                      |     "physical_address_part2": null,                                    +
                      |     "physical_address_part3": null,                                    +
                      |     "physical_country_iso_2": "NO",                                    +
                      |     "activity_category_paths": [                                       +
                      |         "F.41.2"                                                       +
                      |     ],                                                                 +
                      |     "include_unit_in_reports": true,                                   +
                      |     "primary_activity_category_code": "41.2",                          +
                      |     "primary_activity_category_path": "F.41.2",                        +
                      |     "secondary_activity_category_code": null,                          +
                      |     "secondary_activity_category_path": null                           +
                      | }
stats                 | {                                                                      +
                      | }
stats_summary         | {                                                                      +
                      | }
-[ RECORD 3 ]---------+------------------------------------------------------------------------
valid_after           | 12-31-2017
valid_from            | 01-01-2018
valid_to              | infinity
unit_type             | legal_unit
external_idents       | {"tax_ident": "918420533"}
statistical_unit_data | {                                                                      +
                      |     "name": "BYGGMESTER RICHARD FOSSER MINGE AS",                      +
                      |     "search": "'as':5 'byggmester':1 'fosser':3 'minge':4 'richard':2",+
                      |     "landline": null,                                                  +
                      |     "tag_paths": [                                                     +
                      |     ],                                                                 +
                      |     "birth_date": "2014-01-01",                                        +
                      |     "death_date": null,                                                +
                      |     "fax_number": null,                                                +
                      |     "sector_code": "8200",                                             +
                      |     "sector_name": "Personlig næringsdrivende",                        +
                      |     "sector_path": "innl.e_hush.8200",                                 +
                      |     "status_code": "active",                                           +
                      |     "web_address": null,                                               +
                      |     "phone_number": null,                                              +
                      |     "email_address": null,                                             +
                      |     "invalid_codes": null,                                             +
                      |     "mobile_number": null,                                             +
                      |     "has_legal_unit": true,                                            +
                      |     "legal_form_code": "AS",                                           +
                      |     "legal_form_name": "Aksjeselskap",                                 +
                      |     "postal_altitude": null,                                           +
                      |     "postal_latitude": null,                                           +
                      |     "postal_postcode": null,                                           +
                      |     "enterprise_count": null,                                          +
                      |     "legal_unit_count": null,                                          +
                      |     "postal_longitude": null,                                          +
                      |     "postal_postplace": null,                                          +
                      |     "data_source_codes": null,                                         +
                      |     "physical_altitude": null,                                         +
                      |     "physical_latitude": null,                                         +
                      |     "physical_postcode": "3114",                                       +
                      |     "physical_longitude": null,                                        +
                      |     "physical_postplace": "TØNSBERG",                                  +
                      |     "postal_region_code": null,                                        +
                      |     "postal_region_path": null,                                        +
                      |     "establishment_count": null,                                       +
                      |     "physical_region_code": "3905",                                    +
                      |     "physical_region_path": "39.05",                                   +
                      |     "postal_address_part1": null,                                      +
                      |     "postal_address_part2": null,                                      +
                      |     "postal_address_part3": null,                                      +
                      |     "postal_country_iso_2": null,                                      +
                      |     "physical_address_part1": "Ingrids vei 29",                        +
                      |     "physical_address_part2": null,                                    +
                      |     "physical_address_part3": null,                                    +
                      |     "physical_country_iso_2": "NO",                                    +
                      |     "activity_category_paths": [                                       +
                      |         "F.41.2"                                                       +
                      |     ],                                                                 +
                      |     "include_unit_in_reports": true,                                   +
                      |     "primary_activity_category_code": "41.2",                          +
                      |     "primary_activity_category_path": "F.41.2",                        +
                      |     "secondary_activity_category_code": null,                          +
                      |     "secondary_activity_category_path": null                           +
                      | }
stats                 | {                                                                      +
                      | }
stats_summary         | {                                                                      +
                      | }
-[ RECORD 4 ]---------+------------------------------------------------------------------------
valid_after           | 12-31-2014
valid_from            | 01-01-2015
valid_to              | 12-31-2015
unit_type             | legal_unit
external_idents       | {"tax_ident": "929267486"}
statistical_unit_data | {                                                                      +
                      |     "name": "REPPE GEIR RYTMISKE TJENESTER",                           +
                      |     "search": "'geir':2 'reppe':1 'rytmiske':3 'tjenester':4",         +
                      |     "landline": null,                                                  +
                      |     "tag_paths": [                                                     +
                      |     ],                                                                 +
                      |     "birth_date": null,                                                +
                      |     "death_date": null,                                                +
                      |     "fax_number": null,                                                +
                      |     "sector_code": "8200",                                             +
                      |     "sector_name": "Personlig næringsdrivende",                        +
                      |     "sector_path": "innl.e_hush.8200",                                 +
                      |     "status_code": "active",                                           +
                      |     "web_address": null,                                               +
                      |     "phone_number": null,                                              +
                      |     "email_address": null,                                             +
                      |     "invalid_codes": null,                                             +
                      |     "mobile_number": null,                                             +
                      |     "has_legal_unit": true,                                            +
                      |     "legal_form_code": "ENK",                                          +
                      |     "legal_form_name": "Enkeltpersonforetak",                          +
                      |     "postal_altitude": null,                                           +
                      |     "postal_latitude": null,                                           +
                      |     "postal_postcode": null,                                           +
                      |     "enterprise_count": null,                                          +
                      |     "legal_unit_count": null,                                          +
                      |     "postal_longitude": null,                                          +
                      |     "postal_postplace": null,                                          +
                      |     "data_source_codes": null,                                         +
                      |     "physical_altitude": null,                                         +
                      |     "physical_latitude": null,                                         +
                      |     "physical_postcode": "2005",                                       +
                      |     "physical_longitude": null,                                        +
                      |     "physical_postplace": "RÆLINGEN",                                  +
                      |     "postal_region_code": null,                                        +
                      |     "postal_region_path": null,                                        +
                      |     "establishment_count": null,                                       +
                      |     "physical_region_code": "3224",                                    +
                      |     "physical_region_path": "32.24",                                   +
                      |     "postal_address_part1": null,                                      +
                      |     "postal_address_part2": null,                                      +
                      |     "postal_address_part3": null,                                      +
                      |     "postal_country_iso_2": null,                                      +
                      |     "physical_address_part1": "Stormyrvegen 9",                        +
                      |     "physical_address_part2": null,                                    +
                      |     "physical_address_part3": null,                                    +
                      |     "physical_country_iso_2": "NO",                                    +
                      |     "activity_category_paths": [                                       +
                      |         "R.90.0.1.1"                                                   +
                      |     ],                                                                 +
                      |     "include_unit_in_reports": true,                                   +
                      |     "primary_activity_category_code": "90.011",                        +
                      |     "primary_activity_category_path": "R.90.0.1.1",                    +
                      |     "secondary_activity_category_code": null,                          +
                      |     "secondary_activity_category_path": null                           +
                      | }
stats                 | {                                                                      +
                      | }
stats_summary         | {                                                                      +
                      | }
-[ RECORD 5 ]---------+------------------------------------------------------------------------
valid_after           | 12-31-2015
valid_from            | 01-01-2016
valid_to              | infinity
unit_type             | legal_unit
external_idents       | {"tax_ident": "929267486"}
statistical_unit_data | {                                                                      +
                      |     "name": "REPPE GEIR RYTMISKE TJENESTER",                           +
                      |     "search": "'geir':2 'reppe':1 'rytmiske':3 'tjenester':4",         +
                      |     "landline": null,                                                  +
                      |     "tag_paths": [                                                     +
                      |     ],                                                                 +
                      |     "birth_date": null,                                                +
                      |     "death_date": null,                                                +
                      |     "fax_number": null,                                                +
                      |     "sector_code": "8200",                                             +
                      |     "sector_name": "Personlig næringsdrivende",                        +
                      |     "sector_path": "innl.e_hush.8200",                                 +
                      |     "status_code": "active",                                           +
                      |     "web_address": null,                                               +
                      |     "phone_number": null,                                              +
                      |     "email_address": null,                                             +
                      |     "invalid_codes": null,                                             +
                      |     "mobile_number": null,                                             +
                      |     "has_legal_unit": true,                                            +
                      |     "legal_form_code": "ENK",                                          +
                      |     "legal_form_name": "Enkeltpersonforetak",                          +
                      |     "postal_altitude": null,                                           +
                      |     "postal_latitude": null,                                           +
                      |     "postal_postcode": null,                                           +
                      |     "enterprise_count": null,                                          +
                      |     "legal_unit_count": null,                                          +
                      |     "postal_longitude": null,                                          +
                      |     "postal_postplace": null,                                          +
                      |     "data_source_codes": null,                                         +
                      |     "physical_altitude": null,                                         +
                      |     "physical_latitude": null,                                         +
                      |     "physical_postcode": "4550",                                       +
                      |     "physical_longitude": null,                                        +
                      |     "physical_postplace": "FARSUND",                                   +
                      |     "postal_region_code": null,                                        +
                      |     "postal_region_path": null,                                        +
                      |     "establishment_count": null,                                       +
                      |     "physical_region_code": "4206",                                    +
                      |     "physical_region_path": "42.06",                                   +
                      |     "postal_address_part1": null,                                      +
                      |     "postal_address_part2": null,                                      +
                      |     "postal_address_part3": null,                                      +
                      |     "postal_country_iso_2": null,                                      +
                      |     "physical_address_part1": "Stormyrvegen 9",                        +
                      |     "physical_address_part2": null,                                    +
                      |     "physical_address_part3": null,                                    +
                      |     "physical_country_iso_2": "NO",                                    +
                      |     "activity_category_paths": [                                       +
                      |         "R.90.0.1.1"                                                   +
                      |     ],                                                                 +
                      |     "include_unit_in_reports": true,                                   +
                      |     "primary_activity_category_code": "90.011",                        +
                      |     "primary_activity_category_path": "R.90.0.1.1",                    +
                      |     "secondary_activity_category_code": null,                          +
                      |     "secondary_activity_category_path": null                           +
                      | }
stats                 | {                                                                      +
                      | }
stats_summary         | {                                                                      +
                      | }
-[ RECORD 6 ]---------+------------------------------------------------------------------------
valid_after           | 12-31-2014
valid_from            | 01-01-2015
valid_to              | 12-31-2015
unit_type             | legal_unit
external_idents       | {"tax_ident": "876278812"}
statistical_unit_data | {                                                                      +
                      |     "name": "BOBILER AS",                                              +
                      |     "search": "'as':2 'bobiler':1",                                    +
                      |     "landline": null,                                                  +
                      |     "tag_paths": [                                                     +
                      |     ],                                                                 +
                      |     "birth_date": "1996-05-01",                                        +
                      |     "death_date": null,                                                +
                      |     "fax_number": null,                                                +
                      |     "sector_code": "2100",                                             +
                      |     "sector_name": "Private aksjeselskaper mv.",                       +
                      |     "sector_path": "innl.a_ikke_fin.2100",                             +
                      |     "status_code": "active",                                           +
                      |     "web_address": null,                                               +
                      |     "phone_number": null,                                              +
                      |     "email_address": null,                                             +
                      |     "invalid_codes": null,                                             +
                      |     "mobile_number": null,                                             +
                      |     "has_legal_unit": true,                                            +
                      |     "legal_form_code": "AS",                                           +
                      |     "legal_form_name": "Aksjeselskap",                                 +
                      |     "postal_altitude": null,                                           +
                      |     "postal_latitude": null,                                           +
                      |     "postal_postcode": "5350",                                         +
                      |     "enterprise_count": null,                                          +
                      |     "legal_unit_count": null,                                          +
                      |     "postal_longitude": null,                                          +
                      |     "postal_postplace": "BRATTHOLMEN",                                 +
                      |     "data_source_codes": null,                                         +
                      |     "physical_altitude": null,                                         +
                      |     "physical_latitude": null,                                         +
                      |     "physical_postcode": "5350",                                       +
                      |     "physical_longitude": null,                                        +
                      |     "physical_postplace": "BRATTHOLMEN",                               +
                      |     "postal_region_code": "4626",                                      +
                      |     "postal_region_path": "46.26",                                     +
                      |     "establishment_count": null,                                       +
                      |     "physical_region_code": "4626",                                    +
                      |     "physical_region_path": "46.26",                                   +
                      |     "postal_address_part1": "Skrubbenesvegen 82",                      +
                      |     "postal_address_part2": null,                                      +
                      |     "postal_address_part3": null,                                      +
                      |     "postal_country_iso_2": "NO",                                      +
                      |     "physical_address_part1": "Brattholmen",                           +
                      |     "physical_address_part2": null,                                    +
                      |     "physical_address_part3": null,                                    +
                      |     "physical_country_iso_2": "NO",                                    +
                      |     "activity_category_paths": [                                       +
                      |         "G.45.1.1.2"                                                   +
                      |     ],                                                                 +
                      |     "include_unit_in_reports": true,                                   +
                      |     "primary_activity_category_code": "45.112",                        +
                      |     "primary_activity_category_path": "G.45.1.1.2",                    +
                      |     "secondary_activity_category_code": null,                          +
                      |     "secondary_activity_category_path": null                           +
                      | }
stats                 | {                                                                      +
                      | }
stats_summary         | {                                                                      +
                      | }
-[ RECORD 7 ]---------+------------------------------------------------------------------------
valid_after           | 12-31-2015
valid_from            | 01-01-2016
valid_to              | infinity
unit_type             | legal_unit
external_idents       | {"tax_ident": "876278812"}
statistical_unit_data | {                                                                      +
                      |     "name": "BOBILER AS",                                              +
                      |     "search": "'as':2 'bobiler':1",                                    +
                      |     "landline": null,                                                  +
                      |     "tag_paths": [                                                     +
                      |     ],                                                                 +
                      |     "birth_date": "1996-01-05",                                        +
                      |     "death_date": null,                                                +
                      |     "fax_number": null,                                                +
                      |     "sector_code": "2100",                                             +
                      |     "sector_name": "Private aksjeselskaper mv.",                       +
                      |     "sector_path": "innl.a_ikke_fin.2100",                             +
                      |     "status_code": "active",                                           +
                      |     "web_address": null,                                               +
                      |     "phone_number": null,                                              +
                      |     "email_address": null,                                             +
                      |     "invalid_codes": null,                                             +
                      |     "mobile_number": null,                                             +
                      |     "has_legal_unit": true,                                            +
                      |     "legal_form_code": "AS",                                           +
                      |     "legal_form_name": "Aksjeselskap",                                 +
                      |     "postal_altitude": null,                                           +
                      |     "postal_latitude": null,                                           +
                      |     "postal_postcode": "5350",                                         +
                      |     "enterprise_count": null,                                          +
                      |     "legal_unit_count": null,                                          +
                      |     "postal_longitude": null,                                          +
                      |     "postal_postplace": "BRATTHOLMEN",                                 +
                      |     "data_source_codes": null,                                         +
                      |     "physical_altitude": null,                                         +
                      |     "physical_latitude": null,                                         +
                      |     "physical_postcode": "5350",                                       +
                      |     "physical_longitude": null,                                        +
                      |     "physical_postplace": "BRATTHOLMEN",                               +
                      |     "postal_region_code": "4626",                                      +
                      |     "postal_region_path": "46.26",                                     +
                      |     "establishment_count": null,                                       +
                      |     "physical_region_code": "4626",                                    +
                      |     "physical_region_path": "46.26",                                   +
                      |     "postal_address_part1": "Skrubbenesvegen 82",                      +
                      |     "postal_address_part2": null,                                      +
                      |     "postal_address_part3": null,                                      +
                      |     "postal_country_iso_2": "NO",                                      +
                      |     "physical_address_part1": "Brattholmen",                           +
                      |     "physical_address_part2": null,                                    +
                      |     "physical_address_part3": null,                                    +
                      |     "physical_country_iso_2": "NO",                                    +
                      |     "activity_category_paths": [                                       +
                      |         "G.45.1.1.2"                                                   +
                      |     ],                                                                 +
                      |     "include_unit_in_reports": true,                                   +
                      |     "primary_activity_category_code": "45.112",                        +
                      |     "primary_activity_category_path": "G.45.1.1.2",                    +
                      |     "secondary_activity_category_code": null,                          +
                      |     "secondary_activity_category_path": null                           +
                      | }
stats                 | {                                                                      +
                      | }
stats_summary         | {                                                                      +
                      | }
-[ RECORD 8 ]---------+------------------------------------------------------------------------
valid_after           | 12-31-2014
valid_from            | 01-01-2015
valid_to              | 12-31-2015
unit_type             | legal_unit
external_idents       | {"tax_ident": "996294552"}
statistical_unit_data | {                                                                      +
                      |     "name": "MYHRE ANLEGG & INDUSTRI AS",                              +
                      |     "search": "'anlegg':2 'as':4 'industri':3 'myhre':1",              +
                      |     "landline": null,                                                  +
                      |     "tag_paths": [                                                     +
                      |     ],                                                                 +
                      |     "birth_date": "2010-03-12",                                        +
                      |     "death_date": null,                                                +
                      |     "fax_number": null,                                                +
                      |     "sector_code": "2100",                                             +
                      |     "sector_name": "Private aksjeselskaper mv.",                       +
                      |     "sector_path": "innl.a_ikke_fin.2100",                             +
                      |     "status_code": "active",                                           +
                      |     "web_address": null,                                               +
                      |     "phone_number": null,                                              +
                      |     "email_address": null,                                             +
                      |     "invalid_codes": null,                                             +
                      |     "mobile_number": null,                                             +
                      |     "has_legal_unit": true,                                            +
                      |     "legal_form_code": "AS",                                           +
                      |     "legal_form_name": "Aksjeselskap",                                 +
                      |     "postal_altitude": null,                                           +
                      |     "postal_latitude": null,                                           +
                      |     "postal_postcode": "3516",                                         +
                      |     "enterprise_count": null,                                          +
                      |     "legal_unit_count": null,                                          +
                      |     "postal_longitude": null,                                          +
                      |     "postal_postplace": "HØNEFOSS",                                    +
                      |     "data_source_codes": null,                                         +
                      |     "physical_altitude": null,                                         +
                      |     "physical_latitude": null,                                         +
                      |     "physical_postcode": "3516",                                       +
                      |     "physical_longitude": null,                                        +
                      |     "physical_postplace": "HØNEFOSS",                                  +
                      |     "postal_region_code": "3305",                                      +
                      |     "postal_region_path": "33.05",                                     +
                      |     "establishment_count": null,                                       +
                      |     "physical_region_code": "3305",                                    +
                      |     "physical_region_path": "33.05",                                   +
                      |     "postal_address_part1": "Pålerudbyen 84",                          +
                      |     "postal_address_part2": null,                                      +
                      |     "postal_address_part3": null,                                      +
                      |     "postal_country_iso_2": "NO",                                      +
                      |     "physical_address_part1": "Hensveien 180",                         +
                      |     "physical_address_part2": null,                                    +
                      |     "physical_address_part3": null,                                    +
                      |     "physical_country_iso_2": "NO",                                    +
                      |     "activity_category_paths": [                                       +
                      |         "H.49.4.1"                                                     +
                      |     ],                                                                 +
                      |     "include_unit_in_reports": true,                                   +
                      |     "primary_activity_category_code": "49.41",                         +
                      |     "primary_activity_category_path": "H.49.4.1",                      +
                      |     "secondary_activity_category_code": null,                          +
                      |     "secondary_activity_category_path": null                           +
                      | }
stats                 | {                                                                      +
                      | }
stats_summary         | {                                                                      +
                      | }
-[ RECORD 9 ]---------+------------------------------------------------------------------------
valid_after           | 12-31-2015
valid_from            | 01-01-2016
valid_to              | 12-31-2017
unit_type             | legal_unit
external_idents       | {"tax_ident": "996294552"}
statistical_unit_data | {                                                                      +
                      |     "name": "MYHRE ANLEGG & INDUSTRI AS",                              +
                      |     "search": "'anlegg':2 'as':4 'industri':3 'myhre':1",              +
                      |     "landline": null,                                                  +
                      |     "tag_paths": [                                                     +
                      |     ],                                                                 +
                      |     "birth_date": "2010-12-03",                                        +
                      |     "death_date": null,                                                +
                      |     "fax_number": null,                                                +
                      |     "sector_code": "2100",                                             +
                      |     "sector_name": "Private aksjeselskaper mv.",                       +
                      |     "sector_path": "innl.a_ikke_fin.2100",                             +
                      |     "status_code": "active",                                           +
                      |     "web_address": null,                                               +
                      |     "phone_number": null,                                              +
                      |     "email_address": null,                                             +
                      |     "invalid_codes": null,                                             +
                      |     "mobile_number": null,                                             +
                      |     "has_legal_unit": true,                                            +
                      |     "legal_form_code": "AS",                                           +
                      |     "legal_form_name": "Aksjeselskap",                                 +
                      |     "postal_altitude": null,                                           +
                      |     "postal_latitude": null,                                           +
                      |     "postal_postcode": "3516",                                         +
                      |     "enterprise_count": null,                                          +
                      |     "legal_unit_count": null,                                          +
                      |     "postal_longitude": null,                                          +
                      |     "postal_postplace": "HØNEFOSS",                                    +
                      |     "data_source_codes": null,                                         +
                      |     "physical_altitude": null,                                         +
                      |     "physical_latitude": null,                                         +
                      |     "physical_postcode": "3516",                                       +
                      |     "physical_longitude": null,                                        +
                      |     "physical_postplace": "HØNEFOSS",                                  +
                      |     "postal_region_code": "3305",                                      +
                      |     "postal_region_path": "33.05",                                     +
                      |     "establishment_count": null,                                       +
                      |     "physical_region_code": "3305",                                    +
                      |     "physical_region_path": "33.05",                                   +
                      |     "postal_address_part1": "Pålerudbyen 84",                          +
                      |     "postal_address_part2": null,                                      +
                      |     "postal_address_part3": null,                                      +
                      |     "postal_country_iso_2": "NO",                                      +
                      |     "physical_address_part1": "Hensveien 180",                         +
                      |     "physical_address_part2": null,                                    +
                      |     "physical_address_part3": null,                                    +
                      |     "physical_country_iso_2": "NO",                                    +
                      |     "activity_category_paths": [                                       +
                      |         "F.41.2"                                                       +
                      |     ],                                                                 +
                      |     "include_unit_in_reports": true,                                   +
                      |     "primary_activity_category_code": "41.2",                          +
                      |     "primary_activity_category_path": "F.41.2",                        +
                      |     "secondary_activity_category_code": null,                          +
                      |     "secondary_activity_category_path": null                           +
                      | }
stats                 | {                                                                      +
                      | }
stats_summary         | {                                                                      +
                      | }
-[ RECORD 10 ]--------+------------------------------------------------------------------------
valid_after           | 12-31-2017
valid_from            | 01-01-2018
valid_to              | infinity
unit_type             | legal_unit
external_idents       | {"tax_ident": "996294552"}
statistical_unit_data | {                                                                      +
                      |     "name": "MYHRE ANLEGG & INDUSTRI AS",                              +
                      |     "search": "'anlegg':2 'as':4 'industri':3 'myhre':1",              +
                      |     "landline": null,                                                  +
                      |     "tag_paths": [                                                     +
                      |     ],                                                                 +
                      |     "birth_date": "2010-12-03",                                        +
                      |     "death_date": null,                                                +
                      |     "fax_number": null,                                                +
                      |     "sector_code": "7000",                                             +
                      |     "sector_name": "Ideelle organisasjoner",                           +
                      |     "sector_path": "innl.d_ideell.7000",                               +
                      |     "status_code": "active",                                           +
                      |     "web_address": null,                                               +
                      |     "phone_number": null,                                              +
                      |     "email_address": null,                                             +
                      |     "invalid_codes": null,                                             +
                      |     "mobile_number": null,                                             +
                      |     "has_legal_unit": true,                                            +
                      |     "legal_form_code": "AS",                                           +
                      |     "legal_form_name": "Aksjeselskap",                                 +
                      |     "postal_altitude": null,                                           +
                      |     "postal_latitude": null,                                           +
                      |     "postal_postcode": "3516",                                         +
                      |     "enterprise_count": null,                                          +
                      |     "legal_unit_count": null,                                          +
                      |     "postal_longitude": null,                                          +
                      |     "postal_postplace": "HØNEFOSS",                                    +
                      |     "data_source_codes": null,                                         +
                      |     "physical_altitude": null,                                         +
                      |     "physical_latitude": null,                                         +
                      |     "physical_postcode": "3516",                                       +
                      |     "physical_longitude": null,                                        +
                      |     "physical_postplace": "HØNEFOSS",                                  +
                      |     "postal_region_code": "3305",                                      +
                      |     "postal_region_path": "33.05",                                     +
                      |     "establishment_count": null,                                       +
                      |     "physical_region_code": "3305",                                    +
                      |     "physical_region_path": "33.05",                                   +
                      |     "postal_address_part1": "Pålerudbyen 84",                          +
                      |     "postal_address_part2": null,                                      +
                      |     "postal_address_part3": null,                                      +
                      |     "postal_country_iso_2": "NO",                                      +
                      |     "physical_address_part1": "Hensveien 180",                         +
                      |     "physical_address_part2": null,                                    +
                      |     "physical_address_part3": null,                                    +
                      |     "physical_country_iso_2": "NO",                                    +
                      |     "activity_category_paths": [                                       +
                      |         "F.41.2"                                                       +
                      |     ],                                                                 +
                      |     "include_unit_in_reports": true,                                   +
                      |     "primary_activity_category_code": "41.2",                          +
                      |     "primary_activity_category_path": "F.41.2",                        +
                      |     "secondary_activity_category_code": null,                          +
                      |     "secondary_activity_category_path": null                           +
                      | }
stats                 | {                                                                      +
                      | }
stats_summary         | {                                                                      +
                      | }
-[ RECORD 11 ]--------+------------------------------------------------------------------------
valid_after           | 12-31-2015
valid_from            | 01-01-2016
valid_to              | 12-31-2016
unit_type             | legal_unit
external_idents       | {"tax_ident": "928554198"}
statistical_unit_data | {                                                                      +
                      |     "name": "ENGEN DETALJHANDEL",                                      +
                      |     "search": "'detaljhandel':2 'engen':1",                            +
                      |     "landline": null,                                                  +
                      |     "tag_paths": [                                                     +
                      |     ],                                                                 +
                      |     "birth_date": null,                                                +
                      |     "death_date": null,                                                +
                      |     "fax_number": null,                                                +
                      |     "sector_code": "8200",                                             +
                      |     "sector_name": "Personlig næringsdrivende",                        +
                      |     "sector_path": "innl.e_hush.8200",                                 +
                      |     "status_code": "active",                                           +
                      |     "web_address": null,                                               +
                      |     "phone_number": null,                                              +
                      |     "email_address": null,                                             +
                      |     "invalid_codes": null,                                             +
                      |     "mobile_number": null,                                             +
                      |     "has_legal_unit": true,                                            +
                      |     "legal_form_code": "ENK",                                          +
                      |     "legal_form_name": "Enkeltpersonforetak",                          +
                      |     "postal_altitude": null,                                           +
                      |     "postal_latitude": null,                                           +
                      |     "postal_postcode": null,                                           +
                      |     "enterprise_count": null,                                          +
                      |     "legal_unit_count": null,                                          +
                      |     "postal_longitude": null,                                          +
                      |     "postal_postplace": null,                                          +
                      |     "data_source_codes": null,                                         +
                      |     "physical_altitude": null,                                         +
                      |     "physical_latitude": null,                                         +
                      |     "physical_postcode": "4550",                                       +
                      |     "physical_longitude": null,                                        +
                      |     "physical_postplace": "FARSUND",                                   +
                      |     "postal_region_code": null,                                        +
                      |     "postal_region_path": null,                                        +
                      |     "establishment_count": null,                                       +
                      |     "physical_region_code": "4206",                                    +
                      |     "physical_region_path": "42.06",                                   +
                      |     "postal_address_part1": null,                                      +
                      |     "postal_address_part2": null,                                      +
                      |     "postal_address_part3": null,                                      +
                      |     "postal_country_iso_2": null,                                      +
                      |     "physical_address_part1": "Lyngdalsveien 810",                     +
                      |     "physical_address_part2": null,                                    +
                      |     "physical_address_part3": null,                                    +
                      |     "physical_country_iso_2": "NO",                                    +
                      |     "activity_category_paths": [                                       +
                      |         "G.47.9.1.2"                                                   +
                      |     ],                                                                 +
                      |     "include_unit_in_reports": true,                                   +
                      |     "primary_activity_category_code": "47.912",                        +
                      |     "primary_activity_category_path": "G.47.9.1.2",                    +
                      |     "secondary_activity_category_code": null,                          +
                      |     "secondary_activity_category_path": null                           +
                      | }
stats                 | {                                                                      +
                      | }
stats_summary         | {                                                                      +
                      | }
-[ RECORD 12 ]--------+------------------------------------------------------------------------
valid_after           | 12-31-2016
valid_from            | 01-01-2017
valid_to              | 12-31-2017
unit_type             | legal_unit
external_idents       | {"tax_ident": "928554198"}
statistical_unit_data | {                                                                      +
                      |     "name": "ENGEN DETALJHANDEL",                                      +
                      |     "search": "'detaljhandel':2 'engen':1",                            +
                      |     "landline": null,                                                  +
                      |     "tag_paths": [                                                     +
                      |     ],                                                                 +
                      |     "birth_date": null,                                                +
                      |     "death_date": null,                                                +
                      |     "fax_number": null,                                                +
                      |     "sector_code": "8200",                                             +
                      |     "sector_name": "Personlig næringsdrivende",                        +
                      |     "sector_path": "innl.e_hush.8200",                                 +
                      |     "status_code": "active",                                           +
                      |     "web_address": null,                                               +
                      |     "phone_number": null,                                              +
                      |     "email_address": null,                                             +
                      |     "invalid_codes": null,                                             +
                      |     "mobile_number": null,                                             +
                      |     "has_legal_unit": true,                                            +
                      |     "legal_form_code": "ENK",                                          +
                      |     "legal_form_name": "Enkeltpersonforetak",                          +
                      |     "postal_altitude": null,                                           +
                      |     "postal_latitude": null,                                           +
                      |     "postal_postcode": null,                                           +
                      |     "enterprise_count": null,                                          +
                      |     "legal_unit_count": null,                                          +
                      |     "postal_longitude": null,                                          +
                      |     "postal_postplace": null,                                          +
                      |     "data_source_codes": null,                                         +
                      |     "physical_altitude": null,                                         +
                      |     "physical_latitude": null,                                         +
                      |     "physical_postcode": "4550",                                       +
                      |     "physical_longitude": null,                                        +
                      |     "physical_postplace": "FARSUND",                                   +
                      |     "postal_region_code": null,                                        +
                      |     "postal_region_path": null,                                        +
                      |     "establishment_count": null,                                       +
                      |     "physical_region_code": "4206",                                    +
                      |     "physical_region_path": "42.06",                                   +
                      |     "postal_address_part1": null,                                      +
                      |     "postal_address_part2": null,                                      +
                      |     "postal_address_part3": null,                                      +
                      |     "postal_country_iso_2": null,                                      +
                      |     "physical_address_part1": "Lyngdalsveien 810",                     +
                      |     "physical_address_part2": null,                                    +
                      |     "physical_address_part3": null,                                    +
                      |     "physical_country_iso_2": "NO",                                    +
                      |     "activity_category_paths": [                                       +
                      |         "L.68.2.0.9"                                                   +
                      |     ],                                                                 +
                      |     "include_unit_in_reports": true,                                   +
                      |     "primary_activity_category_code": "68.209",                        +
                      |     "primary_activity_category_path": "L.68.2.0.9",                    +
                      |     "secondary_activity_category_code": null,                          +
                      |     "secondary_activity_category_path": null                           +
                      | }
stats                 | {                                                                      +
                      | }
stats_summary         | {                                                                      +
                      | }
-[ RECORD 13 ]--------+------------------------------------------------------------------------
valid_after           | 12-31-2017
valid_from            | 01-01-2018
valid_to              | infinity
unit_type             | legal_unit
external_idents       | {"tax_ident": "928554198"}
statistical_unit_data | {                                                                      +
                      |     "name": "ENGEN DETALJHANDEL",                                      +
                      |     "search": "'detaljhandel':2 'engen':1",                            +
                      |     "landline": null,                                                  +
                      |     "tag_paths": [                                                     +
                      |     ],                                                                 +
                      |     "birth_date": null,                                                +
                      |     "death_date": null,                                                +
                      |     "fax_number": null,                                                +
                      |     "sector_code": "8200",                                             +
                      |     "sector_name": "Personlig næringsdrivende",                        +
                      |     "sector_path": "innl.e_hush.8200",                                 +
                      |     "status_code": "active",                                           +
                      |     "web_address": null,                                               +
                      |     "phone_number": null,                                              +
                      |     "email_address": null,                                             +
                      |     "invalid_codes": null,                                             +
                      |     "mobile_number": null,                                             +
                      |     "has_legal_unit": true,                                            +
                      |     "legal_form_code": "AS",                                           +
                      |     "legal_form_name": "Aksjeselskap",                                 +
                      |     "postal_altitude": null,                                           +
                      |     "postal_latitude": null,                                           +
                      |     "postal_postcode": null,                                           +
                      |     "enterprise_count": null,                                          +
                      |     "legal_unit_count": null,                                          +
                      |     "postal_longitude": null,                                          +
                      |     "postal_postplace": null,                                          +
                      |     "data_source_codes": null,                                         +
                      |     "physical_altitude": null,                                         +
                      |     "physical_latitude": null,                                         +
                      |     "physical_postcode": "3014",                                       +
                      |     "physical_longitude": null,                                        +
                      |     "physical_postplace": "DRAMMEN",                                   +
                      |     "postal_region_code": null,                                        +
                      |     "postal_region_path": null,                                        +
                      |     "establishment_count": null,                                       +
                      |     "physical_region_code": "3301",                                    +
                      |     "physical_region_path": "33.01",                                   +
                      |     "postal_address_part1": null,                                      +
                      |     "postal_address_part2": null,                                      +
                      |     "postal_address_part3": null,                                      +
                      |     "postal_country_iso_2": null,                                      +
                      |     "physical_address_part1": "Edvard Stangs gate 33",                 +
                      |     "physical_address_part2": null,                                    +
                      |     "physical_address_part3": null,                                    +
                      |     "physical_country_iso_2": "NO",                                    +
                      |     "activity_category_paths": [                                       +
                      |         "L.68.2.0.9"                                                   +
                      |     ],                                                                 +
                      |     "include_unit_in_reports": true,                                   +
                      |     "primary_activity_category_code": "68.209",                        +
                      |     "primary_activity_category_path": "L.68.2.0.9",                    +
                      |     "secondary_activity_category_code": null,                          +
                      |     "secondary_activity_category_path": null                           +
                      | }
stats                 | {                                                                      +
                      | }
stats_summary         | {                                                                      +
                      | }
-[ RECORD 14 ]--------+------------------------------------------------------------------------
valid_after           | 12-31-2015
valid_from            | 01-01-2016
valid_to              | 12-31-2016
unit_type             | legal_unit
external_idents       | {"tax_ident": "976126637"}
statistical_unit_data | {                                                                      +
                      |     "name": "DONNA CLASSICA AS",                                       +
                      |     "search": "'as':3 'classica':2 'donna':1",                         +
                      |     "landline": null,                                                  +
                      |     "tag_paths": [                                                     +
                      |     ],                                                                 +
                      |     "birth_date": "2015-02-15",                                        +
                      |     "death_date": null,                                                +
                      |     "fax_number": null,                                                +
                      |     "sector_code": "2100",                                             +
                      |     "sector_name": "Private aksjeselskaper mv.",                       +
                      |     "sector_path": "innl.a_ikke_fin.2100",                             +
                      |     "status_code": "active",                                           +
                      |     "web_address": null,                                               +
                      |     "phone_number": null,                                              +
                      |     "email_address": null,                                             +
                      |     "invalid_codes": null,                                             +
                      |     "mobile_number": null,                                             +
                      |     "has_legal_unit": true,                                            +
                      |     "legal_form_code": "AS",                                           +
                      |     "legal_form_name": "Aksjeselskap",                                 +
                      |     "postal_altitude": null,                                           +
                      |     "postal_latitude": null,                                           +
                      |     "postal_postcode": null,                                           +
                      |     "enterprise_count": null,                                          +
                      |     "legal_unit_count": null,                                          +
                      |     "postal_longitude": null,                                          +
                      |     "postal_postplace": null,                                          +
                      |     "data_source_codes": null,                                         +
                      |     "physical_altitude": null,                                         +
                      |     "physical_latitude": null,                                         +
                      |     "physical_postcode": "4340",                                       +
                      |     "physical_longitude": null,                                        +
                      |     "physical_postplace": "BRYNE",                                     +
                      |     "postal_region_code": null,                                        +
                      |     "postal_region_path": null,                                        +
                      |     "establishment_count": null,                                       +
                      |     "physical_region_code": "1121",                                    +
                      |     "physical_region_path": "11.21",                                   +
                      |     "postal_address_part1": null,                                      +
                      |     "postal_address_part2": null,                                      +
                      |     "postal_address_part3": null,                                      +
                      |     "postal_country_iso_2": null,                                      +
                      |     "physical_address_part1": "Jupitervegen 2/nM44- Nedremarka",       +
                      |     "physical_address_part2": null,                                    +
                      |     "physical_address_part3": null,                                    +
                      |     "physical_country_iso_2": "NO",                                    +
                      |     "activity_category_paths": [                                       +
                      |         "G.47.7.5"                                                     +
                      |     ],                                                                 +
                      |     "include_unit_in_reports": true,                                   +
                      |     "primary_activity_category_code": "47.75",                         +
                      |     "primary_activity_category_path": "G.47.7.5",                      +
                      |     "secondary_activity_category_code": null,                          +
                      |     "secondary_activity_category_path": null                           +
                      | }
stats                 | {                                                                      +
                      | }
stats_summary         | {                                                                      +
                      | }
-[ RECORD 15 ]--------+------------------------------------------------------------------------
valid_after           | 12-31-2016
valid_from            | 01-01-2017
valid_to              | infinity
unit_type             | legal_unit
external_idents       | {"tax_ident": "976126637"}
statistical_unit_data | {                                                                      +
                      |     "name": "DONNA CLASSICA AS",                                       +
                      |     "search": "'as':3 'classica':2 'donna':1",                         +
                      |     "landline": null,                                                  +
                      |     "tag_paths": [                                                     +
                      |     ],                                                                 +
                      |     "birth_date": "1996-02-15",                                        +
                      |     "death_date": null,                                                +
                      |     "fax_number": null,                                                +
                      |     "sector_code": "2100",                                             +
                      |     "sector_name": "Private aksjeselskaper mv.",                       +
                      |     "sector_path": "innl.a_ikke_fin.2100",                             +
                      |     "status_code": "active",                                           +
                      |     "web_address": null,                                               +
                      |     "phone_number": null,                                              +
                      |     "email_address": null,                                             +
                      |     "invalid_codes": null,                                             +
                      |     "mobile_number": null,                                             +
                      |     "has_legal_unit": true,                                            +
                      |     "legal_form_code": "AS",                                           +
                      |     "legal_form_name": "Aksjeselskap",                                 +
                      |     "postal_altitude": null,                                           +
                      |     "postal_latitude": null,                                           +
                      |     "postal_postcode": null,                                           +
                      |     "enterprise_count": null,                                          +
                      |     "legal_unit_count": null,                                          +
                      |     "postal_longitude": null,                                          +
                      |     "postal_postplace": null,                                          +
                      |     "data_source_codes": null,                                         +
                      |     "physical_altitude": null,                                         +
                      |     "physical_latitude": null,                                         +
                      |     "physical_postcode": "4340",                                       +
                      |     "physical_longitude": null,                                        +
                      |     "physical_postplace": "BRYNE",                                     +
                      |     "postal_region_code": null,                                        +
                      |     "postal_region_path": null,                                        +
                      |     "establishment_count": null,                                       +
                      |     "physical_region_code": "1121",                                    +
                      |     "physical_region_path": "11.21",                                   +
                      |     "postal_address_part1": null,                                      +
                      |     "postal_address_part2": null,                                      +
                      |     "postal_address_part3": null,                                      +
                      |     "postal_country_iso_2": null,                                      +
                      |     "physical_address_part1": "Jupitervegen 2/nM44- Nedremarka",       +
                      |     "physical_address_part2": null,                                    +
                      |     "physical_address_part3": null,                                    +
                      |     "physical_country_iso_2": "NO",                                    +
                      |     "activity_category_paths": [                                       +
                      |         "G.47.7.1"                                                     +
                      |     ],                                                                 +
                      |     "include_unit_in_reports": true,                                   +
                      |     "primary_activity_category_code": "47.71",                         +
                      |     "primary_activity_category_path": "G.47.7.1",                      +
                      |     "secondary_activity_category_code": null,                          +
                      |     "secondary_activity_category_path": null                           +
                      | }
stats                 | {                                                                      +
                      | }
stats_summary         | {                                                                      +
                      | }
-[ RECORD 16 ]--------+------------------------------------------------------------------------
valid_after           | 12-31-2014
valid_from            | 01-01-2015
valid_to              | 12-31-2015
unit_type             | enterprise
external_idents       | {"tax_ident": "918420533"}
statistical_unit_data | {                                                                      +
                      |     "name": "BYGGMESTER RICHARD FOSSER MINGE AS",                      +
                      |     "search": "'as':5 'byggmester':1 'fosser':3 'minge':4 'richard':2",+
                      |     "landline": null,                                                  +
                      |     "tag_paths": [                                                     +
                      |     ],                                                                 +
                      |     "birth_date": "2014-01-01",                                        +
                      |     "death_date": null,                                                +
                      |     "fax_number": null,                                                +
                      |     "sector_code": "2100",                                             +
                      |     "sector_name": "Private aksjeselskaper mv.",                       +
                      |     "sector_path": "innl.a_ikke_fin.2100",                             +
                      |     "status_code": "active",                                           +
                      |     "web_address": null,                                               +
                      |     "phone_number": null,                                              +
                      |     "email_address": null,                                             +
                      |     "invalid_codes": null,                                             +
                      |     "mobile_number": null,                                             +
                      |     "has_legal_unit": true,                                            +
                      |     "legal_form_code": "AS",                                           +
                      |     "legal_form_name": "Aksjeselskap",                                 +
                      |     "postal_altitude": null,                                           +
                      |     "postal_latitude": null,                                           +
                      |     "postal_postcode": null,                                           +
                      |     "enterprise_count": null,                                          +
                      |     "legal_unit_count": 1,                                             +
                      |     "postal_longitude": null,                                          +
                      |     "postal_postplace": null,                                          +
                      |     "data_source_codes": null,                                         +
                      |     "physical_altitude": null,                                         +
                      |     "physical_latitude": null,                                         +
                      |     "physical_postcode": "1406",                                       +
                      |     "physical_longitude": null,                                        +
                      |     "physical_postplace": "SKI",                                       +
                      |     "postal_region_code": null,                                        +
                      |     "postal_region_path": null,                                        +
                      |     "establishment_count": null,                                       +
                      |     "physical_region_code": "3207",                                    +
                      |     "physical_region_path": "32.07",                                   +
                      |     "postal_address_part1": null,                                      +
                      |     "postal_address_part2": null,                                      +
                      |     "postal_address_part3": null,                                      +
                      |     "postal_country_iso_2": null,                                      +
                      |     "physical_address_part1": "Måsaveien 42",                          +
                      |     "physical_address_part2": null,                                    +
                      |     "physical_address_part3": null,                                    +
                      |     "physical_country_iso_2": "NO",                                    +
                      |     "activity_category_paths": [                                       +
                      |         "F.41.2"                                                       +
                      |     ],                                                                 +
                      |     "include_unit_in_reports": true,                                   +
                      |     "primary_activity_category_code": "41.2",                          +
                      |     "primary_activity_category_path": "F.41.2",                        +
                      |     "secondary_activity_category_code": null,                          +
                      |     "secondary_activity_category_path": null                           +
                      | }
stats                 | 
stats_summary         | {                                                                      +
                      | }
-[ RECORD 17 ]--------+------------------------------------------------------------------------
valid_after           | 12-31-2015
valid_from            | 01-01-2016
valid_to              | 12-31-2017
unit_type             | enterprise
external_idents       | {"tax_ident": "918420533"}
statistical_unit_data | {                                                                      +
                      |     "name": "BYGGMESTER RICHARD FOSSER MINGE AS",                      +
                      |     "search": "'as':5 'byggmester':1 'fosser':3 'minge':4 'richard':2",+
                      |     "landline": null,                                                  +
                      |     "tag_paths": [                                                     +
                      |     ],                                                                 +
                      |     "birth_date": "2014-01-01",                                        +
                      |     "death_date": null,                                                +
                      |     "fax_number": null,                                                +
                      |     "sector_code": "8200",                                             +
                      |     "sector_name": "Personlig næringsdrivende",                        +
                      |     "sector_path": "innl.e_hush.8200",                                 +
                      |     "status_code": "active",                                           +
                      |     "web_address": null,                                               +
                      |     "phone_number": null,                                              +
                      |     "email_address": null,                                             +
                      |     "invalid_codes": null,                                             +
                      |     "mobile_number": null,                                             +
                      |     "has_legal_unit": true,                                            +
                      |     "legal_form_code": "AS",                                           +
                      |     "legal_form_name": "Aksjeselskap",                                 +
                      |     "postal_altitude": null,                                           +
                      |     "postal_latitude": null,                                           +
                      |     "postal_postcode": null,                                           +
                      |     "enterprise_count": null,                                          +
                      |     "legal_unit_count": 1,                                             +
                      |     "postal_longitude": null,                                          +
                      |     "postal_postplace": null,                                          +
                      |     "data_source_codes": null,                                         +
                      |     "physical_altitude": null,                                         +
                      |     "physical_latitude": null,                                         +
                      |     "physical_postcode": "1406",                                       +
                      |     "physical_longitude": null,                                        +
                      |     "physical_postplace": "SKI",                                       +
                      |     "postal_region_code": null,                                        +
                      |     "postal_region_path": null,                                        +
                      |     "establishment_count": null,                                       +
                      |     "physical_region_code": "3207",                                    +
                      |     "physical_region_path": "32.07",                                   +
                      |     "postal_address_part1": null,                                      +
                      |     "postal_address_part2": null,                                      +
                      |     "postal_address_part3": null,                                      +
                      |     "postal_country_iso_2": null,                                      +
                      |     "physical_address_part1": "Måsaveien 42",                          +
                      |     "physical_address_part2": null,                                    +
                      |     "physical_address_part3": null,                                    +
                      |     "physical_country_iso_2": "NO",                                    +
                      |     "activity_category_paths": [                                       +
                      |         "F.41.2"                                                       +
                      |     ],                                                                 +
                      |     "include_unit_in_reports": true,                                   +
                      |     "primary_activity_category_code": "41.2",                          +
                      |     "primary_activity_category_path": "F.41.2",                        +
                      |     "secondary_activity_category_code": null,                          +
                      |     "secondary_activity_category_path": null                           +
                      | }
stats                 | 
stats_summary         | {                                                                      +
                      | }
-[ RECORD 18 ]--------+------------------------------------------------------------------------
valid_after           | 12-31-2017
valid_from            | 01-01-2018
valid_to              | infinity
unit_type             | enterprise
external_idents       | {"tax_ident": "918420533"}
statistical_unit_data | {                                                                      +
                      |     "name": "BYGGMESTER RICHARD FOSSER MINGE AS",                      +
                      |     "search": "'as':5 'byggmester':1 'fosser':3 'minge':4 'richard':2",+
                      |     "landline": null,                                                  +
                      |     "tag_paths": [                                                     +
                      |     ],                                                                 +
                      |     "birth_date": "2014-01-01",                                        +
                      |     "death_date": null,                                                +
                      |     "fax_number": null,                                                +
                      |     "sector_code": "8200",                                             +
                      |     "sector_name": "Personlig næringsdrivende",                        +
                      |     "sector_path": "innl.e_hush.8200",                                 +
                      |     "status_code": "active",                                           +
                      |     "web_address": null,                                               +
                      |     "phone_number": null,                                              +
                      |     "email_address": null,                                             +
                      |     "invalid_codes": null,                                             +
                      |     "mobile_number": null,                                             +
                      |     "has_legal_unit": true,                                            +
                      |     "legal_form_code": "AS",                                           +
                      |     "legal_form_name": "Aksjeselskap",                                 +
                      |     "postal_altitude": null,                                           +
                      |     "postal_latitude": null,                                           +
                      |     "postal_postcode": null,                                           +
                      |     "enterprise_count": null,                                          +
                      |     "legal_unit_count": 1,                                             +
                      |     "postal_longitude": null,                                          +
                      |     "postal_postplace": null,                                          +
                      |     "data_source_codes": null,                                         +
                      |     "physical_altitude": null,                                         +
                      |     "physical_latitude": null,                                         +
                      |     "physical_postcode": "3114",                                       +
                      |     "physical_longitude": null,                                        +
                      |     "physical_postplace": "TØNSBERG",                                  +
                      |     "postal_region_code": null,                                        +
                      |     "postal_region_path": null,                                        +
                      |     "establishment_count": null,                                       +
                      |     "physical_region_code": "3905",                                    +
                      |     "physical_region_path": "39.05",                                   +
                      |     "postal_address_part1": null,                                      +
                      |     "postal_address_part2": null,                                      +
                      |     "postal_address_part3": null,                                      +
                      |     "postal_country_iso_2": null,                                      +
                      |     "physical_address_part1": "Ingrids vei 29",                        +
                      |     "physical_address_part2": null,                                    +
                      |     "physical_address_part3": null,                                    +
                      |     "physical_country_iso_2": "NO",                                    +
                      |     "activity_category_paths": [                                       +
                      |         "F.41.2"                                                       +
                      |     ],                                                                 +
                      |     "include_unit_in_reports": true,                                   +
                      |     "primary_activity_category_code": "41.2",                          +
                      |     "primary_activity_category_path": "F.41.2",                        +
                      |     "secondary_activity_category_code": null,                          +
                      |     "secondary_activity_category_path": null                           +
                      | }
stats                 | 
stats_summary         | {                                                                      +
                      | }
-[ RECORD 19 ]--------+------------------------------------------------------------------------
valid_after           | 12-31-2014
valid_from            | 01-01-2015
valid_to              | 12-31-2015
unit_type             | enterprise
external_idents       | {"tax_ident": "929267486"}
statistical_unit_data | {                                                                      +
                      |     "name": "REPPE GEIR RYTMISKE TJENESTER",                           +
                      |     "search": "'geir':2 'reppe':1 'rytmiske':3 'tjenester':4",         +
                      |     "landline": null,                                                  +
                      |     "tag_paths": [                                                     +
                      |     ],                                                                 +
                      |     "birth_date": null,                                                +
                      |     "death_date": null,                                                +
                      |     "fax_number": null,                                                +
                      |     "sector_code": "8200",                                             +
                      |     "sector_name": "Personlig næringsdrivende",                        +
                      |     "sector_path": "innl.e_hush.8200",                                 +
                      |     "status_code": "active",                                           +
                      |     "web_address": null,                                               +
                      |     "phone_number": null,                                              +
                      |     "email_address": null,                                             +
                      |     "invalid_codes": null,                                             +
                      |     "mobile_number": null,                                             +
                      |     "has_legal_unit": true,                                            +
                      |     "legal_form_code": "ENK",                                          +
                      |     "legal_form_name": "Enkeltpersonforetak",                          +
                      |     "postal_altitude": null,                                           +
                      |     "postal_latitude": null,                                           +
                      |     "postal_postcode": null,                                           +
                      |     "enterprise_count": null,                                          +
                      |     "legal_unit_count": 1,                                             +
                      |     "postal_longitude": null,                                          +
                      |     "postal_postplace": null,                                          +
                      |     "data_source_codes": null,                                         +
                      |     "physical_altitude": null,                                         +
                      |     "physical_latitude": null,                                         +
                      |     "physical_postcode": "2005",                                       +
                      |     "physical_longitude": null,                                        +
                      |     "physical_postplace": "RÆLINGEN",                                  +
                      |     "postal_region_code": null,                                        +
                      |     "postal_region_path": null,                                        +
                      |     "establishment_count": null,                                       +
                      |     "physical_region_code": "3224",                                    +
                      |     "physical_region_path": "32.24",                                   +
                      |     "postal_address_part1": null,                                      +
                      |     "postal_address_part2": null,                                      +
                      |     "postal_address_part3": null,                                      +
                      |     "postal_country_iso_2": null,                                      +
                      |     "physical_address_part1": "Stormyrvegen 9",                        +
                      |     "physical_address_part2": null,                                    +
                      |     "physical_address_part3": null,                                    +
                      |     "physical_country_iso_2": "NO",                                    +
                      |     "activity_category_paths": [                                       +
                      |         "R.90.0.1.1"                                                   +
                      |     ],                                                                 +
                      |     "include_unit_in_reports": true,                                   +
                      |     "primary_activity_category_code": "90.011",                        +
                      |     "primary_activity_category_path": "R.90.0.1.1",                    +
                      |     "secondary_activity_category_code": null,                          +
                      |     "secondary_activity_category_path": null                           +
                      | }
stats                 | 
stats_summary         | {                                                                      +
                      | }
-[ RECORD 20 ]--------+------------------------------------------------------------------------
valid_after           | 12-31-2015
valid_from            | 01-01-2016
valid_to              | infinity
unit_type             | enterprise
external_idents       | {"tax_ident": "929267486"}
statistical_unit_data | {                                                                      +
                      |     "name": "REPPE GEIR RYTMISKE TJENESTER",                           +
                      |     "search": "'geir':2 'reppe':1 'rytmiske':3 'tjenester':4",         +
                      |     "landline": null,                                                  +
                      |     "tag_paths": [                                                     +
                      |     ],                                                                 +
                      |     "birth_date": null,                                                +
                      |     "death_date": null,                                                +
                      |     "fax_number": null,                                                +
                      |     "sector_code": "8200",                                             +
                      |     "sector_name": "Personlig næringsdrivende",                        +
                      |     "sector_path": "innl.e_hush.8200",                                 +
                      |     "status_code": "active",                                           +
                      |     "web_address": null,                                               +
                      |     "phone_number": null,                                              +
                      |     "email_address": null,                                             +
                      |     "invalid_codes": null,                                             +
                      |     "mobile_number": null,                                             +
                      |     "has_legal_unit": true,                                            +
                      |     "legal_form_code": "ENK",                                          +
                      |     "legal_form_name": "Enkeltpersonforetak",                          +
                      |     "postal_altitude": null,                                           +
                      |     "postal_latitude": null,                                           +
                      |     "postal_postcode": null,                                           +
                      |     "enterprise_count": null,                                          +
                      |     "legal_unit_count": 1,                                             +
                      |     "postal_longitude": null,                                          +
                      |     "postal_postplace": null,                                          +
                      |     "data_source_codes": null,                                         +
                      |     "physical_altitude": null,                                         +
                      |     "physical_latitude": null,                                         +
                      |     "physical_postcode": "4550",                                       +
                      |     "physical_longitude": null,                                        +
                      |     "physical_postplace": "FARSUND",                                   +
                      |     "postal_region_code": null,                                        +
                      |     "postal_region_path": null,                                        +
                      |     "establishment_count": null,                                       +
                      |     "physical_region_code": "4206",                                    +
                      |     "physical_region_path": "42.06",                                   +
                      |     "postal_address_part1": null,                                      +
                      |     "postal_address_part2": null,                                      +
                      |     "postal_address_part3": null,                                      +
                      |     "postal_country_iso_2": null,                                      +
                      |     "physical_address_part1": "Stormyrvegen 9",                        +
                      |     "physical_address_part2": null,                                    +
                      |     "physical_address_part3": null,                                    +
                      |     "physical_country_iso_2": "NO",                                    +
                      |     "activity_category_paths": [                                       +
                      |         "R.90.0.1.1"                                                   +
                      |     ],                                                                 +
                      |     "include_unit_in_reports": true,                                   +
                      |     "primary_activity_category_code": "90.011",                        +
                      |     "primary_activity_category_path": "R.90.0.1.1",                    +
                      |     "secondary_activity_category_code": null,                          +
                      |     "secondary_activity_category_path": null                           +
                      | }
stats                 | 
stats_summary         | {                                                                      +
                      | }
-[ RECORD 21 ]--------+------------------------------------------------------------------------
valid_after           | 12-31-2014
valid_from            | 01-01-2015
valid_to              | 12-31-2015
unit_type             | enterprise
external_idents       | {"tax_ident": "876278812"}
statistical_unit_data | {                                                                      +
                      |     "name": "BOBILER AS",                                              +
                      |     "search": "'as':2 'bobiler':1",                                    +
                      |     "landline": null,                                                  +
                      |     "tag_paths": [                                                     +
                      |     ],                                                                 +
                      |     "birth_date": "1996-05-01",                                        +
                      |     "death_date": null,                                                +
                      |     "fax_number": null,                                                +
                      |     "sector_code": "2100",                                             +
                      |     "sector_name": "Private aksjeselskaper mv.",                       +
                      |     "sector_path": "innl.a_ikke_fin.2100",                             +
                      |     "status_code": "active",                                           +
                      |     "web_address": null,                                               +
                      |     "phone_number": null,                                              +
                      |     "email_address": null,                                             +
                      |     "invalid_codes": null,                                             +
                      |     "mobile_number": null,                                             +
                      |     "has_legal_unit": true,                                            +
                      |     "legal_form_code": "AS",                                           +
                      |     "legal_form_name": "Aksjeselskap",                                 +
                      |     "postal_altitude": null,                                           +
                      |     "postal_latitude": null,                                           +
                      |     "postal_postcode": "5350",                                         +
                      |     "enterprise_count": null,                                          +
                      |     "legal_unit_count": 1,                                             +
                      |     "postal_longitude": null,                                          +
                      |     "postal_postplace": "BRATTHOLMEN",                                 +
                      |     "data_source_codes": null,                                         +
                      |     "physical_altitude": null,                                         +
                      |     "physical_latitude": null,                                         +
                      |     "physical_postcode": "5350",                                       +
                      |     "physical_longitude": null,                                        +
                      |     "physical_postplace": "BRATTHOLMEN",                               +
                      |     "postal_region_code": "4626",                                      +
                      |     "postal_region_path": "46.26",                                     +
                      |     "establishment_count": null,                                       +
                      |     "physical_region_code": "4626",                                    +
                      |     "physical_region_path": "46.26",                                   +
                      |     "postal_address_part1": "Skrubbenesvegen 82",                      +
                      |     "postal_address_part2": null,                                      +
                      |     "postal_address_part3": null,                                      +
                      |     "postal_country_iso_2": "NO",                                      +
                      |     "physical_address_part1": "Brattholmen",                           +
                      |     "physical_address_part2": null,                                    +
                      |     "physical_address_part3": null,                                    +
                      |     "physical_country_iso_2": "NO",                                    +
                      |     "activity_category_paths": [                                       +
                      |         "G.45.1.1.2"                                                   +
                      |     ],                                                                 +
                      |     "include_unit_in_reports": true,                                   +
                      |     "primary_activity_category_code": "45.112",                        +
                      |     "primary_activity_category_path": "G.45.1.1.2",                    +
                      |     "secondary_activity_category_code": null,                          +
                      |     "secondary_activity_category_path": null                           +
                      | }
stats                 | 
stats_summary         | {                                                                      +
                      | }
-[ RECORD 22 ]--------+------------------------------------------------------------------------
valid_after           | 12-31-2015
valid_from            | 01-01-2016
valid_to              | infinity
unit_type             | enterprise
external_idents       | {"tax_ident": "876278812"}
statistical_unit_data | {                                                                      +
                      |     "name": "BOBILER AS",                                              +
                      |     "search": "'as':2 'bobiler':1",                                    +
                      |     "landline": null,                                                  +
                      |     "tag_paths": [                                                     +
                      |     ],                                                                 +
                      |     "birth_date": "1996-01-05",                                        +
                      |     "death_date": null,                                                +
                      |     "fax_number": null,                                                +
                      |     "sector_code": "2100",                                             +
                      |     "sector_name": "Private aksjeselskaper mv.",                       +
                      |     "sector_path": "innl.a_ikke_fin.2100",                             +
                      |     "status_code": "active",                                           +
                      |     "web_address": null,                                               +
                      |     "phone_number": null,                                              +
                      |     "email_address": null,                                             +
                      |     "invalid_codes": null,                                             +
                      |     "mobile_number": null,                                             +
                      |     "has_legal_unit": true,                                            +
                      |     "legal_form_code": "AS",                                           +
                      |     "legal_form_name": "Aksjeselskap",                                 +
                      |     "postal_altitude": null,                                           +
                      |     "postal_latitude": null,                                           +
                      |     "postal_postcode": "5350",                                         +
                      |     "enterprise_count": null,                                          +
                      |     "legal_unit_count": 1,                                             +
                      |     "postal_longitude": null,                                          +
                      |     "postal_postplace": "BRATTHOLMEN",                                 +
                      |     "data_source_codes": null,                                         +
                      |     "physical_altitude": null,                                         +
                      |     "physical_latitude": null,                                         +
                      |     "physical_postcode": "5350",                                       +
                      |     "physical_longitude": null,                                        +
                      |     "physical_postplace": "BRATTHOLMEN",                               +
                      |     "postal_region_code": "4626",                                      +
                      |     "postal_region_path": "46.26",                                     +
                      |     "establishment_count": null,                                       +
                      |     "physical_region_code": "4626",                                    +
                      |     "physical_region_path": "46.26",                                   +
                      |     "postal_address_part1": "Skrubbenesvegen 82",                      +
                      |     "postal_address_part2": null,                                      +
                      |     "postal_address_part3": null,                                      +
                      |     "postal_country_iso_2": "NO",                                      +
                      |     "physical_address_part1": "Brattholmen",                           +
                      |     "physical_address_part2": null,                                    +
                      |     "physical_address_part3": null,                                    +
                      |     "physical_country_iso_2": "NO",                                    +
                      |     "activity_category_paths": [                                       +
                      |         "G.45.1.1.2"                                                   +
                      |     ],                                                                 +
                      |     "include_unit_in_reports": true,                                   +
                      |     "primary_activity_category_code": "45.112",                        +
                      |     "primary_activity_category_path": "G.45.1.1.2",                    +
                      |     "secondary_activity_category_code": null,                          +
                      |     "secondary_activity_category_path": null                           +
                      | }
stats                 | 
stats_summary         | {                                                                      +
                      | }
-[ RECORD 23 ]--------+------------------------------------------------------------------------
valid_after           | 12-31-2014
valid_from            | 01-01-2015
valid_to              | 12-31-2015
unit_type             | enterprise
external_idents       | {"tax_ident": "996294552"}
statistical_unit_data | {                                                                      +
                      |     "name": "MYHRE ANLEGG & INDUSTRI AS",                              +
                      |     "search": "'anlegg':2 'as':4 'industri':3 'myhre':1",              +
                      |     "landline": null,                                                  +
                      |     "tag_paths": [                                                     +
                      |     ],                                                                 +
                      |     "birth_date": "2010-03-12",                                        +
                      |     "death_date": null,                                                +
                      |     "fax_number": null,                                                +
                      |     "sector_code": "2100",                                             +
                      |     "sector_name": "Private aksjeselskaper mv.",                       +
                      |     "sector_path": "innl.a_ikke_fin.2100",                             +
                      |     "status_code": "active",                                           +
                      |     "web_address": null,                                               +
                      |     "phone_number": null,                                              +
                      |     "email_address": null,                                             +
                      |     "invalid_codes": null,                                             +
                      |     "mobile_number": null,                                             +
                      |     "has_legal_unit": true,                                            +
                      |     "legal_form_code": "AS",                                           +
                      |     "legal_form_name": "Aksjeselskap",                                 +
                      |     "postal_altitude": null,                                           +
                      |     "postal_latitude": null,                                           +
                      |     "postal_postcode": "3516",                                         +
                      |     "enterprise_count": null,                                          +
                      |     "legal_unit_count": 1,                                             +
                      |     "postal_longitude": null,                                          +
                      |     "postal_postplace": "HØNEFOSS",                                    +
                      |     "data_source_codes": null,                                         +
                      |     "physical_altitude": null,                                         +
                      |     "physical_latitude": null,                                         +
                      |     "physical_postcode": "3516",                                       +
                      |     "physical_longitude": null,                                        +
                      |     "physical_postplace": "HØNEFOSS",                                  +
                      |     "postal_region_code": "3305",                                      +
                      |     "postal_region_path": "33.05",                                     +
                      |     "establishment_count": null,                                       +
                      |     "physical_region_code": "3305",                                    +
                      |     "physical_region_path": "33.05",                                   +
                      |     "postal_address_part1": "Pålerudbyen 84",                          +
                      |     "postal_address_part2": null,                                      +
                      |     "postal_address_part3": null,                                      +
                      |     "postal_country_iso_2": "NO",                                      +
                      |     "physical_address_part1": "Hensveien 180",                         +
                      |     "physical_address_part2": null,                                    +
                      |     "physical_address_part3": null,                                    +
                      |     "physical_country_iso_2": "NO",                                    +
                      |     "activity_category_paths": [                                       +
                      |         "H.49.4.1"                                                     +
                      |     ],                                                                 +
                      |     "include_unit_in_reports": true,                                   +
                      |     "primary_activity_category_code": "49.41",                         +
                      |     "primary_activity_category_path": "H.49.4.1",                      +
                      |     "secondary_activity_category_code": null,                          +
                      |     "secondary_activity_category_path": null                           +
                      | }
stats                 | 
stats_summary         | {                                                                      +
                      | }
-[ RECORD 24 ]--------+------------------------------------------------------------------------
valid_after           | 12-31-2015
valid_from            | 01-01-2016
valid_to              | 12-31-2017
unit_type             | enterprise
external_idents       | {"tax_ident": "996294552"}
statistical_unit_data | {                                                                      +
                      |     "name": "MYHRE ANLEGG & INDUSTRI AS",                              +
                      |     "search": "'anlegg':2 'as':4 'industri':3 'myhre':1",              +
                      |     "landline": null,                                                  +
                      |     "tag_paths": [                                                     +
                      |     ],                                                                 +
                      |     "birth_date": "2010-12-03",                                        +
                      |     "death_date": null,                                                +
                      |     "fax_number": null,                                                +
                      |     "sector_code": "2100",                                             +
                      |     "sector_name": "Private aksjeselskaper mv.",                       +
                      |     "sector_path": "innl.a_ikke_fin.2100",                             +
                      |     "status_code": "active",                                           +
                      |     "web_address": null,                                               +
                      |     "phone_number": null,                                              +
                      |     "email_address": null,                                             +
                      |     "invalid_codes": null,                                             +
                      |     "mobile_number": null,                                             +
                      |     "has_legal_unit": true,                                            +
                      |     "legal_form_code": "AS",                                           +
                      |     "legal_form_name": "Aksjeselskap",                                 +
                      |     "postal_altitude": null,                                           +
                      |     "postal_latitude": null,                                           +
                      |     "postal_postcode": "3516",                                         +
                      |     "enterprise_count": null,                                          +
                      |     "legal_unit_count": 1,                                             +
                      |     "postal_longitude": null,                                          +
                      |     "postal_postplace": "HØNEFOSS",                                    +
                      |     "data_source_codes": null,                                         +
                      |     "physical_altitude": null,                                         +
                      |     "physical_latitude": null,                                         +
                      |     "physical_postcode": "3516",                                       +
                      |     "physical_longitude": null,                                        +
                      |     "physical_postplace": "HØNEFOSS",                                  +
                      |     "postal_region_code": "3305",                                      +
                      |     "postal_region_path": "33.05",                                     +
                      |     "establishment_count": null,                                       +
                      |     "physical_region_code": "3305",                                    +
                      |     "physical_region_path": "33.05",                                   +
                      |     "postal_address_part1": "Pålerudbyen 84",                          +
                      |     "postal_address_part2": null,                                      +
                      |     "postal_address_part3": null,                                      +
                      |     "postal_country_iso_2": "NO",                                      +
                      |     "physical_address_part1": "Hensveien 180",                         +
                      |     "physical_address_part2": null,                                    +
                      |     "physical_address_part3": null,                                    +
                      |     "physical_country_iso_2": "NO",                                    +
                      |     "activity_category_paths": [                                       +
                      |         "F.41.2"                                                       +
                      |     ],                                                                 +
                      |     "include_unit_in_reports": true,                                   +
                      |     "primary_activity_category_code": "41.2",                          +
                      |     "primary_activity_category_path": "F.41.2",                        +
                      |     "secondary_activity_category_code": null,                          +
                      |     "secondary_activity_category_path": null                           +
                      | }
stats                 | 
stats_summary         | {                                                                      +
                      | }
-[ RECORD 25 ]--------+------------------------------------------------------------------------
valid_after           | 12-31-2017
valid_from            | 01-01-2018
valid_to              | infinity
unit_type             | enterprise
external_idents       | {"tax_ident": "996294552"}
statistical_unit_data | {                                                                      +
                      |     "name": "MYHRE ANLEGG & INDUSTRI AS",                              +
                      |     "search": "'anlegg':2 'as':4 'industri':3 'myhre':1",              +
                      |     "landline": null,                                                  +
                      |     "tag_paths": [                                                     +
                      |     ],                                                                 +
                      |     "birth_date": "2010-12-03",                                        +
                      |     "death_date": null,                                                +
                      |     "fax_number": null,                                                +
                      |     "sector_code": "7000",                                             +
                      |     "sector_name": "Ideelle organisasjoner",                           +
                      |     "sector_path": "innl.d_ideell.7000",                               +
                      |     "status_code": "active",                                           +
                      |     "web_address": null,                                               +
                      |     "phone_number": null,                                              +
                      |     "email_address": null,                                             +
                      |     "invalid_codes": null,                                             +
                      |     "mobile_number": null,                                             +
                      |     "has_legal_unit": true,                                            +
                      |     "legal_form_code": "AS",                                           +
                      |     "legal_form_name": "Aksjeselskap",                                 +
                      |     "postal_altitude": null,                                           +
                      |     "postal_latitude": null,                                           +
                      |     "postal_postcode": "3516",                                         +
                      |     "enterprise_count": null,                                          +
                      |     "legal_unit_count": 1,                                             +
                      |     "postal_longitude": null,                                          +
                      |     "postal_postplace": "HØNEFOSS",                                    +
                      |     "data_source_codes": null,                                         +
                      |     "physical_altitude": null,                                         +
                      |     "physical_latitude": null,                                         +
                      |     "physical_postcode": "3516",                                       +
                      |     "physical_longitude": null,                                        +
                      |     "physical_postplace": "HØNEFOSS",                                  +
                      |     "postal_region_code": "3305",                                      +
                      |     "postal_region_path": "33.05",                                     +
                      |     "establishment_count": null,                                       +
                      |     "physical_region_code": "3305",                                    +
                      |     "physical_region_path": "33.05",                                   +
                      |     "postal_address_part1": "Pålerudbyen 84",                          +
                      |     "postal_address_part2": null,                                      +
                      |     "postal_address_part3": null,                                      +
                      |     "postal_country_iso_2": "NO",                                      +
                      |     "physical_address_part1": "Hensveien 180",                         +
                      |     "physical_address_part2": null,                                    +
                      |     "physical_address_part3": null,                                    +
                      |     "physical_country_iso_2": "NO",                                    +
                      |     "activity_category_paths": [                                       +
                      |         "F.41.2"                                                       +
                      |     ],                                                                 +
                      |     "include_unit_in_reports": true,                                   +
                      |     "primary_activity_category_code": "41.2",                          +
                      |     "primary_activity_category_path": "F.41.2",                        +
                      |     "secondary_activity_category_code": null,                          +
                      |     "secondary_activity_category_path": null                           +
                      | }
stats                 | 
stats_summary         | {                                                                      +
                      | }
-[ RECORD 26 ]--------+------------------------------------------------------------------------
valid_after           | 12-31-2015
valid_from            | 01-01-2016
valid_to              | 12-31-2016
unit_type             | enterprise
external_idents       | {"tax_ident": "928554198"}
statistical_unit_data | {                                                                      +
                      |     "name": "ENGEN DETALJHANDEL",                                      +
                      |     "search": "'detaljhandel':2 'engen':1",                            +
                      |     "landline": null,                                                  +
                      |     "tag_paths": [                                                     +
                      |     ],                                                                 +
                      |     "birth_date": null,                                                +
                      |     "death_date": null,                                                +
                      |     "fax_number": null,                                                +
                      |     "sector_code": "8200",                                             +
                      |     "sector_name": "Personlig næringsdrivende",                        +
                      |     "sector_path": "innl.e_hush.8200",                                 +
                      |     "status_code": "active",                                           +
                      |     "web_address": null,                                               +
                      |     "phone_number": null,                                              +
                      |     "email_address": null,                                             +
                      |     "invalid_codes": null,                                             +
                      |     "mobile_number": null,                                             +
                      |     "has_legal_unit": true,                                            +
                      |     "legal_form_code": "ENK",                                          +
                      |     "legal_form_name": "Enkeltpersonforetak",                          +
                      |     "postal_altitude": null,                                           +
                      |     "postal_latitude": null,                                           +
                      |     "postal_postcode": null,                                           +
                      |     "enterprise_count": null,                                          +
                      |     "legal_unit_count": 1,                                             +
                      |     "postal_longitude": null,                                          +
                      |     "postal_postplace": null,                                          +
                      |     "data_source_codes": null,                                         +
                      |     "physical_altitude": null,                                         +
                      |     "physical_latitude": null,                                         +
                      |     "physical_postcode": "4550",                                       +
                      |     "physical_longitude": null,                                        +
                      |     "physical_postplace": "FARSUND",                                   +
                      |     "postal_region_code": null,                                        +
                      |     "postal_region_path": null,                                        +
                      |     "establishment_count": null,                                       +
                      |     "physical_region_code": "4206",                                    +
                      |     "physical_region_path": "42.06",                                   +
                      |     "postal_address_part1": null,                                      +
                      |     "postal_address_part2": null,                                      +
                      |     "postal_address_part3": null,                                      +
                      |     "postal_country_iso_2": null,                                      +
                      |     "physical_address_part1": "Lyngdalsveien 810",                     +
                      |     "physical_address_part2": null,                                    +
                      |     "physical_address_part3": null,                                    +
                      |     "physical_country_iso_2": "NO",                                    +
                      |     "activity_category_paths": [                                       +
                      |         "G.47.9.1.2"                                                   +
                      |     ],                                                                 +
                      |     "include_unit_in_reports": true,                                   +
                      |     "primary_activity_category_code": "47.912",                        +
                      |     "primary_activity_category_path": "G.47.9.1.2",                    +
                      |     "secondary_activity_category_code": null,                          +
                      |     "secondary_activity_category_path": null                           +
                      | }
stats                 | 
stats_summary         | {                                                                      +
                      | }
-[ RECORD 27 ]--------+------------------------------------------------------------------------
valid_after           | 12-31-2016
valid_from            | 01-01-2017
valid_to              | 12-31-2017
unit_type             | enterprise
external_idents       | {"tax_ident": "928554198"}
statistical_unit_data | {                                                                      +
                      |     "name": "ENGEN DETALJHANDEL",                                      +
                      |     "search": "'detaljhandel':2 'engen':1",                            +
                      |     "landline": null,                                                  +
                      |     "tag_paths": [                                                     +
                      |     ],                                                                 +
                      |     "birth_date": null,                                                +
                      |     "death_date": null,                                                +
                      |     "fax_number": null,                                                +
                      |     "sector_code": "8200",                                             +
                      |     "sector_name": "Personlig næringsdrivende",                        +
                      |     "sector_path": "innl.e_hush.8200",                                 +
                      |     "status_code": "active",                                           +
                      |     "web_address": null,                                               +
                      |     "phone_number": null,                                              +
                      |     "email_address": null,                                             +
                      |     "invalid_codes": null,                                             +
                      |     "mobile_number": null,                                             +
                      |     "has_legal_unit": true,                                            +
                      |     "legal_form_code": "ENK",                                          +
                      |     "legal_form_name": "Enkeltpersonforetak",                          +
                      |     "postal_altitude": null,                                           +
                      |     "postal_latitude": null,                                           +
                      |     "postal_postcode": null,                                           +
                      |     "enterprise_count": null,                                          +
                      |     "legal_unit_count": 1,                                             +
                      |     "postal_longitude": null,                                          +
                      |     "postal_postplace": null,                                          +
                      |     "data_source_codes": null,                                         +
                      |     "physical_altitude": null,                                         +
                      |     "physical_latitude": null,                                         +
                      |     "physical_postcode": "4550",                                       +
                      |     "physical_longitude": null,                                        +
                      |     "physical_postplace": "FARSUND",                                   +
                      |     "postal_region_code": null,                                        +
                      |     "postal_region_path": null,                                        +
                      |     "establishment_count": null,                                       +
                      |     "physical_region_code": "4206",                                    +
                      |     "physical_region_path": "42.06",                                   +
                      |     "postal_address_part1": null,                                      +
                      |     "postal_address_part2": null,                                      +
                      |     "postal_address_part3": null,                                      +
                      |     "postal_country_iso_2": null,                                      +
                      |     "physical_address_part1": "Lyngdalsveien 810",                     +
                      |     "physical_address_part2": null,                                    +
                      |     "physical_address_part3": null,                                    +
                      |     "physical_country_iso_2": "NO",                                    +
                      |     "activity_category_paths": [                                       +
                      |         "L.68.2.0.9"                                                   +
                      |     ],                                                                 +
                      |     "include_unit_in_reports": true,                                   +
                      |     "primary_activity_category_code": "68.209",                        +
                      |     "primary_activity_category_path": "L.68.2.0.9",                    +
                      |     "secondary_activity_category_code": null,                          +
                      |     "secondary_activity_category_path": null                           +
                      | }
stats                 | 
stats_summary         | {                                                                      +
                      | }
-[ RECORD 28 ]--------+------------------------------------------------------------------------
valid_after           | 12-31-2017
valid_from            | 01-01-2018
valid_to              | infinity
unit_type             | enterprise
external_idents       | {"tax_ident": "928554198"}
statistical_unit_data | {                                                                      +
                      |     "name": "ENGEN DETALJHANDEL",                                      +
                      |     "search": "'detaljhandel':2 'engen':1",                            +
                      |     "landline": null,                                                  +
                      |     "tag_paths": [                                                     +
                      |     ],                                                                 +
                      |     "birth_date": null,                                                +
                      |     "death_date": null,                                                +
                      |     "fax_number": null,                                                +
                      |     "sector_code": "8200",                                             +
                      |     "sector_name": "Personlig næringsdrivende",                        +
                      |     "sector_path": "innl.e_hush.8200",                                 +
                      |     "status_code": "active",                                           +
                      |     "web_address": null,                                               +
                      |     "phone_number": null,                                              +
                      |     "email_address": null,                                             +
                      |     "invalid_codes": null,                                             +
                      |     "mobile_number": null,                                             +
                      |     "has_legal_unit": true,                                            +
                      |     "legal_form_code": "AS",                                           +
                      |     "legal_form_name": "Aksjeselskap",                                 +
                      |     "postal_altitude": null,                                           +
                      |     "postal_latitude": null,                                           +
                      |     "postal_postcode": null,                                           +
                      |     "enterprise_count": null,                                          +
                      |     "legal_unit_count": 1,                                             +
                      |     "postal_longitude": null,                                          +
                      |     "postal_postplace": null,                                          +
                      |     "data_source_codes": null,                                         +
                      |     "physical_altitude": null,                                         +
                      |     "physical_latitude": null,                                         +
                      |     "physical_postcode": "3014",                                       +
                      |     "physical_longitude": null,                                        +
                      |     "physical_postplace": "DRAMMEN",                                   +
                      |     "postal_region_code": null,                                        +
                      |     "postal_region_path": null,                                        +
                      |     "establishment_count": null,                                       +
                      |     "physical_region_code": "3301",                                    +
                      |     "physical_region_path": "33.01",                                   +
                      |     "postal_address_part1": null,                                      +
                      |     "postal_address_part2": null,                                      +
                      |     "postal_address_part3": null,                                      +
                      |     "postal_country_iso_2": null,                                      +
                      |     "physical_address_part1": "Edvard Stangs gate 33",                 +
                      |     "physical_address_part2": null,                                    +
                      |     "physical_address_part3": null,                                    +
                      |     "physical_country_iso_2": "NO",                                    +
                      |     "activity_category_paths": [                                       +
                      |         "L.68.2.0.9"                                                   +
                      |     ],                                                                 +
                      |     "include_unit_in_reports": true,                                   +
                      |     "primary_activity_category_code": "68.209",                        +
                      |     "primary_activity_category_path": "L.68.2.0.9",                    +
                      |     "secondary_activity_category_code": null,                          +
                      |     "secondary_activity_category_path": null                           +
                      | }
stats                 | 
stats_summary         | {                                                                      +
                      | }
-[ RECORD 29 ]--------+------------------------------------------------------------------------
valid_after           | 12-31-2015
valid_from            | 01-01-2016
valid_to              | 12-31-2016
unit_type             | enterprise
external_idents       | {"tax_ident": "976126637"}
statistical_unit_data | {                                                                      +
                      |     "name": "DONNA CLASSICA AS",                                       +
                      |     "search": "'as':3 'classica':2 'donna':1",                         +
                      |     "landline": null,                                                  +
                      |     "tag_paths": [                                                     +
                      |     ],                                                                 +
                      |     "birth_date": "2015-02-15",                                        +
                      |     "death_date": null,                                                +
                      |     "fax_number": null,                                                +
                      |     "sector_code": "2100",                                             +
                      |     "sector_name": "Private aksjeselskaper mv.",                       +
                      |     "sector_path": "innl.a_ikke_fin.2100",                             +
                      |     "status_code": "active",                                           +
                      |     "web_address": null,                                               +
                      |     "phone_number": null,                                              +
                      |     "email_address": null,                                             +
                      |     "invalid_codes": null,                                             +
                      |     "mobile_number": null,                                             +
                      |     "has_legal_unit": true,                                            +
                      |     "legal_form_code": "AS",                                           +
                      |     "legal_form_name": "Aksjeselskap",                                 +
                      |     "postal_altitude": null,                                           +
                      |     "postal_latitude": null,                                           +
                      |     "postal_postcode": null,                                           +
                      |     "enterprise_count": null,                                          +
                      |     "legal_unit_count": 1,                                             +
                      |     "postal_longitude": null,                                          +
                      |     "postal_postplace": null,                                          +
                      |     "data_source_codes": null,                                         +
                      |     "physical_altitude": null,                                         +
                      |     "physical_latitude": null,                                         +
                      |     "physical_postcode": "4340",                                       +
                      |     "physical_longitude": null,                                        +
                      |     "physical_postplace": "BRYNE",                                     +
                      |     "postal_region_code": null,                                        +
                      |     "postal_region_path": null,                                        +
                      |     "establishment_count": null,                                       +
                      |     "physical_region_code": "1121",                                    +
                      |     "physical_region_path": "11.21",                                   +
                      |     "postal_address_part1": null,                                      +
                      |     "postal_address_part2": null,                                      +
                      |     "postal_address_part3": null,                                      +
                      |     "postal_country_iso_2": null,                                      +
                      |     "physical_address_part1": "Jupitervegen 2/nM44- Nedremarka",       +
                      |     "physical_address_part2": null,                                    +
                      |     "physical_address_part3": null,                                    +
                      |     "physical_country_iso_2": "NO",                                    +
                      |     "activity_category_paths": [                                       +
                      |         "G.47.7.5"                                                     +
                      |     ],                                                                 +
                      |     "include_unit_in_reports": true,                                   +
                      |     "primary_activity_category_code": "47.75",                         +
                      |     "primary_activity_category_path": "G.47.7.5",                      +
                      |     "secondary_activity_category_code": null,                          +
                      |     "secondary_activity_category_path": null                           +
                      | }
stats                 | 
stats_summary         | {                                                                      +
                      | }
-[ RECORD 30 ]--------+------------------------------------------------------------------------
valid_after           | 12-31-2016
valid_from            | 01-01-2017
valid_to              | infinity
unit_type             | enterprise
external_idents       | {"tax_ident": "976126637"}
statistical_unit_data | {                                                                      +
                      |     "name": "DONNA CLASSICA AS",                                       +
                      |     "search": "'as':3 'classica':2 'donna':1",                         +
                      |     "landline": null,                                                  +
                      |     "tag_paths": [                                                     +
                      |     ],                                                                 +
                      |     "birth_date": "1996-02-15",                                        +
                      |     "death_date": null,                                                +
                      |     "fax_number": null,                                                +
                      |     "sector_code": "2100",                                             +
                      |     "sector_name": "Private aksjeselskaper mv.",                       +
                      |     "sector_path": "innl.a_ikke_fin.2100",                             +
                      |     "status_code": "active",                                           +
                      |     "web_address": null,                                               +
                      |     "phone_number": null,                                              +
                      |     "email_address": null,                                             +
                      |     "invalid_codes": null,                                             +
                      |     "mobile_number": null,                                             +
                      |     "has_legal_unit": true,                                            +
                      |     "legal_form_code": "AS",                                           +
                      |     "legal_form_name": "Aksjeselskap",                                 +
                      |     "postal_altitude": null,                                           +
                      |     "postal_latitude": null,                                           +
                      |     "postal_postcode": null,                                           +
                      |     "enterprise_count": null,                                          +
                      |     "legal_unit_count": 1,                                             +
                      |     "postal_longitude": null,                                          +
                      |     "postal_postplace": null,                                          +
                      |     "data_source_codes": null,                                         +
                      |     "physical_altitude": null,                                         +
                      |     "physical_latitude": null,                                         +
                      |     "physical_postcode": "4340",                                       +
                      |     "physical_longitude": null,                                        +
                      |     "physical_postplace": "BRYNE",                                     +
                      |     "postal_region_code": null,                                        +
                      |     "postal_region_path": null,                                        +
                      |     "establishment_count": null,                                       +
                      |     "physical_region_code": "1121",                                    +
                      |     "physical_region_path": "11.21",                                   +
                      |     "postal_address_part1": null,                                      +
                      |     "postal_address_part2": null,                                      +
                      |     "postal_address_part3": null,                                      +
                      |     "postal_country_iso_2": null,                                      +
                      |     "physical_address_part1": "Jupitervegen 2/nM44- Nedremarka",       +
                      |     "physical_address_part2": null,                                    +
                      |     "physical_address_part3": null,                                    +
                      |     "physical_country_iso_2": "NO",                                    +
                      |     "activity_category_paths": [                                       +
                      |         "G.47.7.1"                                                     +
                      |     ],                                                                 +
                      |     "include_unit_in_reports": true,                                   +
                      |     "primary_activity_category_code": "47.71",                         +
                      |     "primary_activity_category_path": "G.47.7.1",                      +
                      |     "secondary_activity_category_code": null,                          +
                      |     "secondary_activity_category_path": null                           +
                      | }
stats                 | 
stats_summary         | {                                                                      +
                      | }

\x
ROLLBACK;
