-- Test the full C-ABI validator function via the test_validator_wrapper.
-- Set the secret via the GUC. This is how the real validator will get it.
SET
-- Create a temp table to hold the secret for the sign() function.
CREATE TABLE
-- Test 1: Valid token, issuer, and scope
Test 1: Should return true for a valid token with correct issuer and scope
 is_valid 
----------
 t
(1 row)

-- Test 2: Wrong issuer
Test 2: Should return false for a token with the wrong issuer
 is_valid 
----------
 f
(1 row)

-- Test 3: Wrong scope
Test 3: Should return false for a token with the wrong scope
 is_valid 
----------
 f
(1 row)

-- Test 4: Expired token
Test 4: Should return false for an expired token
 is_valid 
----------
 f
(1 row)
