<?plantuml 1.2026.1?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="DESCRIPTION" height="1655px" preserveAspectRatio="none" style="width:1137px;height:1655px;background:#FEFEFE;" version="1.1" viewBox="0 0 1137 1655" width="1137px" zoomAndPan="magnify"><title>StatBus 1-2-3 Architecture</title><defs/><g><rect fill="#FEFEFE" height="1655" style="stroke:none;stroke-width:1;" width="1137" x="0" y="0"/><g class="title" data-source-line="10"><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="196.957" x="463.1321" y="23.5352">StatBus 1-2-3 Architecture</text></g><!--cluster Level 1 & 2: Browser Access--><g class="cluster" data-qualified-name="Level 1 . 2. Browser Access" data-source-line="13" id="ent0002"><rect fill="#E3F2FD" height="399.71" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:1;" width="400" x="325.27" y="44.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="68.5029" x="491.0185" y="60.0234">&#171;Browser&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="200.7646" x="424.8877" y="76.5117">Level 1 &amp; 2: Browser Access</text></g><!--cluster webui--><g class="cluster" data-qualified-name="Level 1 . 2. Browser Access.webui" data-source-line="15" id="ent0004"><rect fill="none" height="113.49" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:1;" width="275" x="418.27" y="298.7083"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="115.9443" x="497.7978" y="314.2434">Web UI (Level 1)</text></g><!--cluster restapi--><g class="cluster" data-qualified-name="Level 1 . 2. Browser Access.restapi" data-source-line="18" id="ent0006"><rect fill="none" height="129.98" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:1;" width="294" x="357.27" y="111.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="130.1221" x="439.209" y="127.0234">REST API (Level 2)</text></g><!--cluster Level 3: Direct Access--><g class="cluster" data-qualified-name="Level 3. Direct Access" data-source-line="23" id="ent0008"><rect fill="#F5F5F5" height="355.71" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:1;" width="349" x="749.27" y="96.7283"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="70.0752" x="888.7324" y="112.2634">&#171;External&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="156.5361" x="845.5019" y="128.7517">Level 3: Direct Access</text></g><!--cluster sqlclients--><g class="cluster" data-qualified-name="Level 3. Direct Access.sqlclients" data-source-line="25" id="ent0010"><rect fill="none" height="129.97" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:1;" width="285" x="781.27" y="290.4683"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="82.3525" x="882.5937" y="306.0034">SQL Clients</text></g><!--cluster Caddy Routing Layer--><g class="cluster" data-qualified-name="Caddy Routing Layer" data-source-line="30" id="ent0012"><rect fill="#FFF3E0" height="245.47" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:1;" width="403" x="322.27" y="516.4383"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="67.5117" x="490.0141" y="531.9734">&#171;Routing&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="149.7002" x="448.9199" y="548.4617">Caddy Routing Layer</text></g><!--cluster caddy--><g class="cluster" data-qualified-name="Caddy Routing Layer.caddy" data-source-line="31" id="ent0013"><rect fill="none" height="146.47" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:1;" width="339" x="354.27" y="583.4383"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="42.3965" x="502.5718" y="598.9734">caddy</text></g><!--cluster Application Services--><g class="cluster" data-qualified-name="Application Services" data-source-line="36" id="ent0015"><rect fill="#E8F5E9" height="471.93" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:1;" width="626" x="425.27" y="810.9083"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="62.002" x="707.269" y="826.4434">&#171;Service&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="145.6191" x="665.4604" y="842.9317">Application Services</text></g><!--cluster postgrest--><g class="cluster" data-qualified-name="Application Services.postgrest" data-source-line="37" id="ent0016"><rect fill="none" height="146.47" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:1;" width="279" x="679.27" y="1104.3683"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="76.0771" x="780.7314" y="1119.9034">PostgREST</text></g><!--cluster nextjs--><g class="cluster" data-qualified-name="Application Services.nextjs" data-source-line="40" id="ent0018"><rect fill="none" height="146.46" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:1;" width="255" x="764.27" y="877.9083"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="82.4209" x="850.5596" y="893.4434">Next.js App</text></g><!--cluster worker--><g class="cluster" data-qualified-name="Application Services.worker" data-source-line="43" id="ent0020"><rect fill="none" height="146.46" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:1;" width="267" x="457.27" y="877.9083"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="51.3857" x="565.0771" y="893.4434">Worker</text></g><!--cluster PostgreSQL - THE Backend--><g class="cluster" data-qualified-name="PostgreSQL - THE Backend" data-source-line="48" id="ent0022"><rect fill="#C8E6C9" height="276.95" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:1;" width="353" x="275.27" y="1346.8383"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="77.335" x="413.1025" y="1362.3734">&#171;Database&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="194.4004" x="354.5698" y="1378.8617">PostgreSQL - THE Backend</text></g><!--cluster db--><g class="cluster" data-qualified-name="PostgreSQL - THE Backend.db" data-source-line="49" id="ent0023"><path d="M307.27,1423.8383 C307.27,1413.8383 451.77,1413.8383 451.77,1413.8383 C451.77,1413.8383 596.27,1413.8383 596.27,1423.8383 L596.27,1581.7883 C596.27,1591.7883 451.77,1591.7883 451.77,1591.7883 C451.77,1591.7883 307.27,1591.7883 307.27,1581.7883 L307.27,1423.8383" fill="none" style="stroke:#181818;stroke-width:1;"/><path d="M307.27,1423.8383 C307.27,1433.8383 451.77,1433.8383 451.77,1433.8383 C451.77,1433.8383 596.27,1433.8383 596.27,1423.8383" fill="none" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="66.8623" x="418.3388" y="1449.3734">Database</text></g><!--entity user--><g class="entity" data-qualified-name="Level 1 . 2. Browser Access.user" data-source-line="14" id="ent0003"><ellipse cx="694.2726" cy="156.2283" fill="#F1F1F1" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M694.2726,164.2283 L694.2726,191.2283 M681.2726,172.2283 L707.2726,172.2283 M694.2726,191.2283 L681.2726,206.2283 M694.2726,191.2283 L707.2726,206.2283" fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.3652" x="679.09" y="221.2634">User</text></g><!--entity Import / Search / Report--><g class="entity" data-qualified-name="Level 1 . 2. Browser Access.webui.Import . Search . Report" data-source-line="16" id="ent0005"><rect fill="#F1F1F1" height="46.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="207.5693" x="442.48" y="341.7083"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="630.0493" y="346.7083"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="628.0493" y="348.7083"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="628.0493" y="352.7083"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="167.5693" x="457.48" y="375.2434">Import / Search / Report</text></g><!--entity Copy /rest calls to scripts\nAdd API key for automation--><g class="entity" data-qualified-name="Level 1 . 2. Browser Access.restapi.Copy .rest calls to scripts.nAdd API key for automation" data-source-line="19" id="ent0007"><rect fill="#F1F1F1" height="62.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="226.833" x="380.85" y="154.4883"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="587.683" y="159.4883"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="585.683" y="161.4883"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="585.683" y="165.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="174.6104" x="395.85" y="188.0234">Copy /rest calls to scripts</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="186.833" x="395.85" y="204.5117">Add API key for automation</text></g><!--entity poweruser--><g class="entity" data-qualified-name="Level 3. Direct Access.poweruser" data-source-line="24" id="ent0009"><ellipse cx="1044.2641" cy="156.2283" fill="#F1F1F1" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M1044.2641,164.2283 L1044.2641,191.2283 M1031.2641,172.2283 L1057.2641,172.2283 M1044.2641,191.2283 L1031.2641,206.2283 M1044.2641,191.2283 L1057.2641,206.2283" fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75.4482" x="1006.54" y="221.2634">Power User</text></g><!--entity psql / DBeaver / pgAdmin\nApplication drivers--><g class="entity" data-qualified-name="Level 3. Direct Access.sqlclients.psql . DBeaver . pgAdmin.nApplication drivers" data-source-line="26" id="ent0011"><rect fill="#F1F1F1" height="62.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="217.8711" x="805.33" y="333.4683"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="1003.2011" y="338.4683"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1001.2011" y="340.4683"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1001.2011" y="344.4683"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="177.8711" x="820.33" y="367.0034">psql / DBeaver / pgAdmin</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="127.7773" x="820.33" y="383.4917">Application drivers</text></g><!--entity HTTPS :443\nPostgreSQL TLS+SNI :5432\nCookie-to-header JWT conversion--><g class="entity" data-qualified-name="Caddy Routing Layer.caddy.HTTPS .443.nPostgreSQL TLS.SNI .5432.nCookie-to-header JWT conversion" data-source-line="32" id="ent0014"><rect fill="#F1F1F1" height="79.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="271.2598" x="378.64" y="626.4383"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="629.8998" y="631.4383"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="627.8998" y="633.4383"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="627.8998" y="637.4383"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78.6885" x="393.64" y="659.9734">HTTPS :443</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="182.4512" x="393.64" y="676.4617">PostgreSQL TLS+SNI :5432</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="231.2598" x="393.64" y="692.95">Cookie-to-header JWT conversion</text></g><!--entity Auto-generated REST API\nJWT validation\nNo custom backend code--><g class="entity" data-qualified-name="Application Services.postgrest.Auto-generated REST API.nJWT validation.nNo custom backend code" data-source-line="38" id="ent0017"><rect fill="#F1F1F1" height="79.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="211.7324" x="703.4" y="1147.3683"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="895.1324" y="1152.3683"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="893.1324" y="1154.3683"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="893.1324" y="1158.3683"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="171.7324" x="718.4" y="1180.9034">Auto-generated REST API</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95.7988" x="718.4" y="1197.3917">JWT validation</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="171.7119" x="718.4" y="1213.88">No custom backend code</text></g><!--entity Web interface\nServer-side rendering\nTypeScript + React--><g class="entity" data-qualified-name="Application Services.nextjs.Web interface.nServer-side rendering.nTypeScript . React" data-source-line="41" id="ent0019"><rect fill="#F1F1F1" height="79.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="188.1895" x="788.17" y="920.9083"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="956.3595" y="925.9083"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="954.3595" y="927.9083"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="954.3595" y="931.9083"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.3672" x="803.17" y="954.4434">Web interface</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="148.1895" x="803.17" y="970.9317">Server-side rendering</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="128.0918" x="803.17" y="987.42">TypeScript + React</text></g><!--entity Background processing\nImport jobs\nMaterialization updates--><g class="entity" data-qualified-name="Application Services.worker.Background processing.nImport jobs.nMaterialization updates" data-source-line="44" id="ent0021"><rect fill="#F1F1F1" height="79.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="199.4004" x="481.57" y="920.9083"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="660.9704" y="925.9083"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="658.9704" y="927.9083"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="658.9704" y="931.9083"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="158.6621" x="496.57" y="954.4434">Background processing</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78.7158" x="496.57" y="970.9317">Import jobs</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="159.4004" x="496.57" y="987.42">Materialization updates</text></g><!--entity Row Level Security (RLS)\nOne user = one role\nTemporal tables (sql_saga)\nAuto-materialized views--><g class="entity" data-qualified-name="PostgreSQL - THE Backend.db.Row Level Security .RLS..nOne user . one role.nTemporal tables .sql_saga..nAuto-materialized views" data-source-line="50" id="ent0024"><rect fill="#F1F1F1" height="95.9531" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="221.6924" x="331.42" y="1471.8383"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="533.1124" y="1476.8383"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="531.1124" y="1478.8383"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="531.1124" y="1482.8383"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="162.374" x="346.42" y="1505.3734">Row Level Security (RLS)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="136.8281" x="346.42" y="1521.8617">One user = one role</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="181.6924" x="346.42" y="1538.35">Temporal tables (sql_saga)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="165.8057" x="346.42" y="1554.8383">Auto-materialized views</text></g><g class="entity" data-qualified-name="GMN36" data-source-line="69" id="ent0037"><path d="M644.74,1484.1883 L644.74,1555.4305 L887.8001,1555.4305 L887.8001,1494.1883 L877.8001,1484.1883 L644.74,1484.1883" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M877.8001,1484.1883 L877.8001,1494.1883 L887.8001,1494.1883 L877.8001,1484.1883" fill="#FEFFDD" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="171.0439" x="650.74" y="1501.7566">Security at database level</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="222.0601" x="650.74" y="1517.0672">- All access methods use same RLS</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="209.1489" x="650.74" y="1532.3777">- JWT tokens &#8594; PostgreSQL roles</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185.415" x="650.74" y="1547.6883">- No backend secrets needed</text></g><g class="entity" data-qualified-name="GMN39" data-source-line="76" id="ent0040"><path d="M191.54,925.0183 L191.54,996.2605 L408.9936,996.2605 L408.9936,935.0183 L398.9936,925.0183 L191.54,925.0183" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M398.9936,925.0183 L398.9936,935.0183 L408.9936,935.0183 L398.9936,925.0183" fill="#FEFFDD" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="196.4536" x="197.54" y="942.5866">Routing by path and protocol</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.3008" x="197.54" y="957.8972">- /* &#8594; Next.js (Web UI)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174.5352" x="197.54" y="973.2077">- /rest/* &#8594; PostgREST (API)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="192.8608" x="197.54" y="988.5183">- PostgreSQL wire &#8594; Database</text></g><!--link user to webui--><g class="link" data-entity-1="ent0003" data-entity-2="ent0004" data-link-type="dependency" data-source-line="54" id="lnk25"><path d="M692.36,224.5083 C691.71,237.2933 690.9506,252.2308 690.175,267.487 C689.7872,275.1152 689.3953,282.823 689.011,290.3812 C688.9149,292.2708 688.8193,294.151 688.7244,296.0183 C688.7007,296.4852 688.677,296.9512 688.6533,297.4163 C688.6415,297.6489 688.9344,291.889 688.9226,292.1212" fill="none" id="user-to-webui" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="688.6179,298.1134,693.0697,289.3281,688.8718,293.1199,685.0801,288.9219,688.6179,298.1134" style="stroke:#181818;stroke-width:1;"/></g><!--link webui to caddy--><g class="link" data-entity-1="ent0004" data-entity-2="ent0013" data-link-type="dependency" data-source-line="55" id="lnk26"><path d="M685.27,412.7338 C685.27,413.1654 685.27,413.5992 685.27,414.0352 C685.27,441.937 685.27,478.7583 685.27,515.5783 C685.27,533.9883 685.27,552.398 685.27,569.6923 C685.27,574.0158 685.27,578.2697 685.27,582.4364 C685.27,582.6968 685.27,576.9569 685.27,577.2167" fill="none" id="webui-to-caddy" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="685.27,583.2167,689.27,574.2167,685.27,578.2167,681.27,574.2167,685.27,583.2167" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40.1807" x="694.8298" y="482.0066">HTTPS</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57.3003" x="686.27" y="497.3172">/* routes</text></g><!--link restapi to caddy--><g class="link" data-entity-1="ent0006" data-entity-2="ent0013" data-link-type="dependency" data-source-line="56" id="lnk27"><path d="M635.5753,241.7536 C635.5214,241.864 635.4672,241.9742 635.4126,242.0842 C635.3035,242.3043 635.193,242.5236 635.0811,242.742 C634.8574,243.1789 634.6281,243.6124 634.3932,244.0423 C633.4535,245.7619 632.4233,247.4235 631.2944,249.0092 C629.0366,252.1806 626.3838,255.0483 623.27,257.4683 C610.23,267.5883 337.78,253.6383 326.27,265.4683 C6,594.4783 609.3,450.0983 666.27,508.4383 C690.395,533.1483 695.375,571.5033 694.2113,604.0858 C694.0658,608.1586 693.8243,612.1412 693.5122,615.9957 C693.4732,616.4775 693.4331,616.9573 693.392,617.4351 C693.3714,617.6739 693.8809,611.9358 693.8598,612.1736" fill="none" id="restapi-to-caddy" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="693.3294,618.1501,698.1093,609.5389,693.7714,613.1697,690.1406,608.8318,693.3294,618.1501" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40.1807" x="340.9241" y="362.5166">HTTPS</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88.1689" x="316.93" y="377.8272">/rest/* routes</text></g><!--link poweruser to sqlclients--><g class="link" data-entity-1="ent0009" data-entity-2="ent0010" data-link-type="dependency" data-source-line="57" id="lnk28"><path d="M1047.24,224.5083 C1048.25,237.2933 1049.4306,252.2308 1050.6367,267.487 C1051.2398,275.1152 1051.3762,276.8416 1051.9739,284.3999" fill="none" id="poweruser-to-sqlclients" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="1052.4468,290.3812,1055.725,281.094,1052.0527,285.3968,1047.7498,281.7246,1052.4468,290.3812" style="stroke:#181818;stroke-width:1;"/></g><!--link sqlclients to caddy--><g class="link" data-entity-1="ent0010" data-entity-2="ent0013" data-link-type="dependency" data-source-line="58" id="lnk29"><path d="M1055.2264,420.8062 C1055.1607,421.1293 1055.0939,421.4526 1055.026,421.776 C1054.8901,422.4228 1054.7498,423.0702 1054.6048,423.7179 C1054.0248,426.3086 1053.3706,428.9036 1052.6338,431.4831 C1049.6863,441.8014 1045.415,451.8733 1039.27,460.4383 C986.7,533.6933 899.165,584.6533 824.295,617.4095 C786.86,633.7877 752.5913,645.6148 727.4425,653.4025 C714.8681,657.2963 704.5738,660.1803 697.3036,662.1183 C696.3948,662.3605 695.5333,662.588 694.7205,662.8008 C694.3141,662.9072 699.7275,661.5029 699.3456,661.602" fill="none" id="sqlclients-to-caddy" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="693.538,663.109,703.2542,664.7202,698.3777,661.8531,701.2448,656.9767,693.538,663.109" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52.8379" x="1038.4944" y="482.0066">TLS+SNI</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62.3467" x="1033.74" y="497.3172">Port 5432</text></g><!--link caddy to nextjs--><g class="link" data-entity-1="ent0013" data-entity-2="ent0018" data-link-type="dependency" data-source-line="60" id="lnk30"><path d="M693.4799,667.9483 C693.8321,667.9855 694.1948,668.0243 694.5679,668.0647 C695.3141,668.1454 696.1017,668.2325 696.9296,668.3262 C703.5527,669.0758 712.7497,670.2505 723.8731,672.0145 C746.12,675.5427 776.0725,681.4283 808.55,690.9858 C873.505,710.1008 948.56,743.9033 992.27,802.9083 C1002.5475,816.7833 1008.9169,833.3208 1012.6792,850.3702 C1014.5604,858.8948 1015.7898,867.5475 1016.5301,876.0593 C1016.5764,876.5913 1016.142,871.1418 1016.1845,871.6727" fill="none" id="caddy-to-nextjs" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="1016.6632,877.6535,1019.9324,868.3631,1016.2643,872.6695,1011.9579,869.0014,1016.6632,877.6535" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="13.0825" x="982.01" y="791.4766">/*</text></g><!--link caddy to postgrest--><g class="link" data-entity-1="ent0013" data-entity-2="ent0016" data-link-type="dependency" data-source-line="61" id="lnk31"><path d="M693.6964,666.9603 C693.8976,666.9576 694.1022,666.9549 694.31,666.9523 C694.7257,666.9472 695.1547,666.9425 695.5968,666.9382 C696.4809,666.9296 697.4173,666.9229 698.4041,666.9187 C706.2989,666.8848 717.424,667.0104 730.8705,667.6256 C757.7634,668.8561 793.9419,672.0452 832.1338,679.8345 C908.5175,695.4133 992.955,729.3933 1027.27,802.9083 C1079.77,915.3883 1107.64,966.0483 1059.27,1080.3683 C1046.325,1110.9633 1019.7175,1137.0558 996.0325,1155.6658 C984.19,1164.9708 973.0781,1172.4052 964.77,1177.5964 C962.693,1178.8942 960.7912,1180.0518 959.097,1181.0634 C958.8852,1181.1899 963.8355,1178.2503 963.6303,1178.3722" fill="none" id="caddy-to-postgrest" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="958.4715,1181.4359,968.2522,1180.2796,962.7705,1178.8828,964.1672,1173.4011,958.4715,1181.4359" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="43.9512" x="1085.27" y="965.7066">/rest/*</text></g><!--link caddy to db--><g class="link" data-entity-1="ent0013" data-entity-2="ent0023" data-link-type="dependency" data-source-line="62" id="lnk32"><path d="M686.7008,730.0944 C686.6346,730.4454 686.5668,730.7962 686.4973,731.1466 C686.3581,731.8475 686.2121,732.5473 686.0588,733.2454 C685.4457,736.038 684.7174,738.8052 683.8583,741.5205 C680.4219,752.3814 674.8925,762.4108 666.27,769.9083 C658.5,776.6583 491.54,777.2683 481.27,777.9083 C412.95,782.1583 220.66,752.5783 174.27,802.9083 C102.73,880.4983 127.24,945.8883 174.27,1040.3683 C272.32,1237.3483 461,1147.2783 569.27,1338.8383 C579.01,1356.0708 585.1069,1375.7214 588.7638,1395.5562 C589.678,1400.515 590.4397,1405.4852 591.0677,1410.432 C591.1462,1411.0504 591.2226,1411.6684 591.297,1412.2859 C591.3342,1412.5947 590.6725,1406.9441 590.7086,1407.2527" fill="none" id="caddy-to-db" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="591.407,1413.2119,594.3323,1403.8075,590.825,1408.2459,586.3866,1404.7387,591.407,1413.2119" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="71.3604" x="202.7928" y="1061.9366">PostgreSQL</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83.186" x="196.88" y="1077.2472">wire protocol</text></g><!--link postgrest to db--><g class="link" data-entity-1="ent0016" data-entity-2="ent0023" data-link-type="dependency" data-source-line="64" id="lnk33"><path d="M950.7066,1251.2149 C950.5681,1251.9164 950.423,1252.6172 950.2712,1253.317 C949.6641,1256.116 948.949,1258.8975 948.1116,1261.6362 C944.7619,1272.5914 939.455,1282.8633 931.27,1290.8383 C833.28,1386.2783 726.7,1244.8983 627.27,1338.8383 C612.6275,1352.6708 602.83,1370.5945 596.3795,1389.7581 C594.7669,1394.549 593.3635,1399.4174 592.1458,1404.3187 C591.537,1406.7694 590.9746,1409.2283 590.4558,1411.6899 C590.3261,1412.3053 591.3867,1407.0395 591.2624,1407.6552" fill="none" id="postgrest-to-db" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="590.0748,1413.5364,595.7771,1405.5063,591.0645,1408.6354,587.9354,1403.9228,590.0748,1413.5364" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.0322" x="952.1956" y="1312.4066">SQL</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87.4834" x="920.47" y="1327.7172">(respects RLS)</text></g><!--link nextjs to postgrest--><g class="link" data-entity-1="ent0018" data-entity-2="ent0016" data-link-type="dependency" data-source-line="65" id="lnk34"><path d="M1002.3424,1024.4812 C1002.2294,1024.7327 1002.1151,1024.9835 1001.9994,1025.2337 C1001.7681,1025.7339 1001.5315,1026.2313 1001.2894,1026.7257 C1000.8052,1027.7144 1000.2992,1028.6909 999.7703,1029.6529 C997.655,1033.5009 995.175,1037.1183 992.27,1040.3683 C985.33,1048.1283 976.83,1040.2983 970.27,1048.3683 C960.66,1060.1758 954.5687,1074.5133 950.8463,1089.4205 C949.9156,1093.1473 949.133,1096.9097 948.4805,1100.677 C948.3174,1101.6189 948.1624,1102.561 948.0153,1103.503 C947.9785,1103.7385 948.8443,1098.0422 948.8085,1098.2777" fill="none" id="nextjs-to-postgrest" style="stroke:#181818;stroke-width:1;stroke-dasharray:7,7;"/><polygon fill="#181818" points="947.9064,1104.2095,953.2141,1095.9132,948.6581,1099.2663,945.305,1094.7104,947.9064,1104.2095" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72.1855" x="976.7068" y="1061.9366">Server-side</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83.0591" x="971.27" y="1077.2472">data fetching</text></g><!--link worker to db--><g class="link" data-entity-1="ent0020" data-entity-2="ent0023" data-link-type="dependency" data-source-line="66" id="lnk35"><path d="M705.9819,1024.4171 C705.7691,1024.9322 705.552,1025.4453 705.3305,1025.9561 C704.8874,1026.9779 704.4267,1027.9906 703.9475,1028.9925 C702.0309,1033 699.82,1036.8333 697.27,1040.3683 C673.67,1073.0683 641.13,1053.8583 620.27,1088.3683 C595.65,1129.0883 587.5825,1235.3433 585.7025,1332.0883 C585.2325,1356.2745 585.1492,1379.8664 585.2907,1401.6913 C585.3084,1404.4194 585.3296,1407.1199 585.354,1409.7906 C585.3662,1411.1259 585.3167,1406.454 585.3304,1407.7741" fill="none" id="worker-to-db" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="585.3929,1413.7738,589.2989,1404.7326,585.3408,1408.774,581.2994,1404.8159,585.3929,1413.7738" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65.7236" x="621.27" y="1184.6666">Direct SQL</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52.6919" x="627.7859" y="1199.9772">(Level 3)</text></g><!--link db to GMN36--><g class="link" data-entity-1="ent0023" data-entity-2="ent0037" data-link-type="association" data-source-line="69" id="lnk38"><path d="M596.3191,1519.8083 C596.4634,1519.8083 596.6077,1519.8083 596.752,1519.8083 C597.0406,1519.8083 597.3292,1519.8083 597.6178,1519.8083 C598.195,1519.8083 598.7722,1519.8083 599.3494,1519.8083 C600.5038,1519.8083 601.6581,1519.8083 602.8125,1519.8083 C607.43,1519.8083 612.0475,1519.8083 616.665,1519.8083 C625.9,1519.8083 635.135,1519.8083 644.37,1519.8083" fill="none" id="db-GMN36" style="stroke:#181818;stroke-width:1;stroke-dasharray:7,7;"/></g><!--link caddy to GMN39--><g class="link" data-entity-1="ent0013" data-entity-2="ent0040" data-link-type="association" data-source-line="76" id="lnk41"><path d="M685.6622,730.2404 C685.5237,730.942 685.3787,731.6429 685.2269,732.3427 C684.62,735.1419 683.9056,737.9241 683.0694,740.6641 C679.7244,751.6239 674.43,761.9083 666.27,769.9083 C601.61,833.2683 546.34,762.6183 465.27,802.9083 C407.24,831.7383 355.85,887.9583 326.4,924.6383" fill="none" id="caddy-GMN39" style="stroke:#181818;stroke-width:1;stroke-dasharray:7,7;"/></g><g class="caption" data-source-line="11"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="276.5137" x="423.3538" y="1643.3234">Database-Centric Progressive Disclosure</text></g><?plantuml-src TLNHRY8t57sVhxXYfOgmcgGRaceNRICH0jfKDAKCgpnqgifuRi1XiAUs1vQkyjeFw2VsIthj6HYp9V0oOnzVdtlkkNVCIiY2QRQ6EUEhXLQbp0OgLnhUZ8Rk7va3GYEtJ2voXAyHqE_s-CJ7ZxTQRGtgcnjuC-oEBaTtfs73BnQrPBd3ZQxT_pHkgaehvCB3HgFkyFlJi0JrHd3qjxuVNGy_d8RTCSlcp7ZSuFtmXy67w2MAhB2KJsAPlIqDl8iluoxqDLyAIycM6YFE2YkKXFtnU83IQi5XejL2ep5YWt0d3C-LSVYeKQarnWtcy0w-WyiUrE90dtCwrO9GhafFnYtftlfCQorW1afwy1j1o4USm-TxQDUXppnmY_DIr47SxxVxTQ6qXGj8a54oz315j_AxXxny6tGwJ6RGdnp2NbPXAJlBYgF00rNiuC9j06TvRi0gC5oBmffKzhFCHrdX3fue4rPQjMPElVszBoVawVP8FhSQA1Cuv4YQYTgIWWU12lTwIgNarp4CSa6LCXve_invzHecKz0oINDtYsn3OI-WMFIpjP2KIL7aWdlga6cgi3QdKnYmBDj1RLGOivrZ5ZhtwxVKk3lXIVcdaC-dsMoIGE_ggflAYJAMxEKIcOsJjyd3FVIkhxgNgHmejH8OMnKlaMN4-wV76N0b7SbNfGuJgll52ztqpl-8UWRE6RNKdW_LFI3SfmB72vIecSKCzZPAfQEqORd8_8sfV530IqDky5C6PKQ4Ctp5ZG_unPu_6o3E_cf9xyz7XNDD82HPv8bnJALB0dLiH8OKHv8cf7qgPxi24-zDU4l-9mkzSk6ZqglQKLl_6DxLp14ej786zS7h3djMSpB-pvI-5fJlNvN2PK69uokM2IeRm-pJq4ygOktA4SoeYa9MBq1hl-LfPlEGubHjeUgb17cfXTr1UpfEpbBvYqG_HU17KFIeLKvopT1nPpbGm1mDjAaD_Z1imUY0h-Zwa0uLTIDm6sRYmyNnJJLqechqkFVApZtmBaxbHOUkAqc5Q3z6Je7SNeCyzBF7DaqR1VqRHgaxmtKBrSArHnHLUmvL-wO7T46mt3Yv1_NzmIufsuEcHAdSqcnobRUAgpoAcjC7j8UrQQsW8XjmoaVrtUVdn_S5JasbgoqyeQMFZLn4jVCEKUkPM0Ml9-LP54bbgOvYiRIWdWX9XUbq3cLdjd5CxivqEWI8eP_dD4ATUM6DTgao_t41mzRe-7gCwrcho8a6_ltxdq03RnlZCTJ7-mOso3LQrvsOOHQv9SUjPZXNrdKxKVJIUfRxAJdVGS7i4bZLKbxOcYTLojszdm3jwcjtLktLNZcGy-EcJVEcsWy8-vevtBvf6dh_0G00?></g></svg>