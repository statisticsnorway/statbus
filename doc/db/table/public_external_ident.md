```sql
                                      Table "public.external_ident"
       Column        |           Type           | Collation | Nullable |             Default              
---------------------+--------------------------+-----------+----------+----------------------------------
 id                  | integer                  |           | not null | generated by default as identity
 type_id             | integer                  |           | not null | 
 shape               | external_ident_shape     |           | not null | 
 ident               | character varying(50)    |           |          | 
 idents              | ltree                    |           |          | 
 labels              | ltree                    |           |          | 
 establishment_id    | integer                  |           |          | 
 legal_unit_id       | integer                  |           |          | 
 enterprise_id       | integer                  |           |          | 
 enterprise_group_id | integer                  |           |          | 
 edit_comment        | character varying(512)   |           |          | 
 edit_by_user_id     | integer                  |           | not null | 
 edit_at             | timestamp with time zone |           | not null | statement_timestamp()
Indexes:
    "external_ident_enterprise_group_id_idx" btree (enterprise_group_id)
    "external_ident_enterprise_id_idx" btree (enterprise_id)
    "external_ident_establishment_id_idx" btree (establishment_id)
    "external_ident_hierarchical_gist" gist (idents) WHERE shape = 'hierarchical'::external_ident_shape
    "external_ident_hierarchical_uniqueness" UNIQUE, btree (type_id, idents) WHERE shape = 'hierarchical'::external_ident_shape
    "external_ident_ident_hash_idx" hash (ident)
    "external_ident_legal_unit_id_idx" btree (legal_unit_id)
    "external_ident_lookup_covering_idx" btree (type_id, ident) INCLUDE (legal_unit_id, establishment_id)
    "external_ident_regular_uniqueness" UNIQUE, btree (type_id, ident) WHERE shape = 'regular'::external_ident_shape
    "external_ident_type_unit_association_nulls_not_distinct" UNIQUE, btree (type_id, establishment_id, legal_unit_id, enterprise_id, enterprise_group_id) NULLS NOT DISTINCT
    "ix_external_ident_edit_by_user_id" btree (edit_by_user_id)
Check constraints:
    "One and only one statistical unit id must be set" CHECK (num_nonnulls(establishment_id, legal_unit_id, enterprise_id, enterprise_group_id) = 1)
    "external_ident_enterprise_group_id_check" CHECK (admin.enterprise_group_id_exists(enterprise_group_id))
    "external_ident_establishment_id_check" CHECK (admin.establishment_id_exists(establishment_id))
    "external_ident_legal_unit_id_check" CHECK (admin.legal_unit_id_exists(legal_unit_id))
    "hierarchical_depth_valid" CHECK (shape <> 'hierarchical'::external_ident_shape OR nlevel(idents) = nlevel(labels))
    "shape_data_consistency" CHECK (shape = 'regular'::external_ident_shape AND ident IS NOT NULL AND idents IS NULL AND labels IS NULL OR shape = 'hierarchical'::external_ident_shape AND ident IS NULL AND idents IS NOT NULL AND labels IS NOT NULL)
Foreign-key constraints:
    "external_ident_edit_by_user_id_fkey" FOREIGN KEY (edit_by_user_id) REFERENCES auth."user"(id) ON DELETE RESTRICT
    "external_ident_enterprise_id_fkey" FOREIGN KEY (enterprise_id) REFERENCES enterprise(id) ON DELETE CASCADE
    "external_ident_type_id_fkey" FOREIGN KEY (type_id) REFERENCES external_ident_type(id) ON DELETE RESTRICT
Policies:
    POLICY "external_ident_admin_user_manage"
      TO admin_user
      USING (true)
      WITH CHECK (true)
    POLICY "external_ident_authenticated_read" FOR SELECT
      TO authenticated
      USING (true)
    POLICY "external_ident_regular_user_manage"
      TO regular_user
      USING (true)
      WITH CHECK (true)
Triggers:
    a_external_ident_log_delete AFTER DELETE ON external_ident REFERENCING OLD TABLE AS old_rows FOR EACH STATEMENT EXECUTE FUNCTION worker.log_base_change()
    a_external_ident_log_insert AFTER INSERT ON external_ident REFERENCING NEW TABLE AS new_rows FOR EACH STATEMENT EXECUTE FUNCTION worker.log_base_change()
    a_external_ident_log_update AFTER UPDATE ON external_ident REFERENCING OLD TABLE AS old_rows NEW TABLE AS new_rows FOR EACH STATEMENT EXECUTE FUNCTION worker.log_base_change()
    b_external_ident_ensure_collect AFTER INSERT OR DELETE OR UPDATE ON external_ident FOR EACH STATEMENT EXECUTE FUNCTION worker.ensure_collect_changes()
    external_ident_derive_shape_labels BEFORE INSERT OR UPDATE OF type_id ON external_ident FOR EACH ROW EXECUTE FUNCTION external_ident_derive_shape_labels()
    trigger_prevent_external_ident_id_update BEFORE UPDATE OF id ON external_ident FOR EACH ROW EXECUTE FUNCTION admin.prevent_id_update()

```
